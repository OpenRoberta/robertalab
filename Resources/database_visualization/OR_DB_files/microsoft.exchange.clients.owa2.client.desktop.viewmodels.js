try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.desktop.viewmodels.js'] = (new Date()).getTime();
Type.registerNamespace("_i");_i.$1=function(){};_i.$1.get_$9l1=function(){return _fm.$B.$9("conversations_showdeleted.png")};_i.$1.get_$6LS=function(){return _fm.$B.$9("conversations_hidedeleted.png")};_i.$1.get_$6mL=function(){return _fm.$B.$9("conversations_newestontop.png")};_i.$1.get_$95e=function(){return _fm.$B.$9("conversations_oldestontop.png")};_i.$1.get_$5LA=function(){return _fm.$B.$9("readingpane_off.png")};_i.$1.get_$9KM=function(){return _fm.$B.$9("readingpane_onbottom.png")};_i.$1.get_$6wo=function(){return _fm.$B.$9("readingpane_onright.png")};_i.$1.get_$A5f=function(){return _fm.$G.$9("alert-triangle-yellow","x18","owa","owa-color-neutral-yellow")};_i.$IG=function(n,t,i,r,u){this.$$d_$Dif=Function.createDelegate(this,this.$Dif);this.$$d_$Dig=Function.createDelegate(this,this.$Dig);this.$$d_$Did=Function.createDelegate(this,this.$Did);this.$$d_$Die=Function.createDelegate(this,this.$Die);this.$$d_$DiY=Function.createDelegate(this,this.$DiY);this.$$d_$Dib=Function.createDelegate(this,this.$Dib);this.$$d_$Dic=Function.createDelegate(this,this.$Dic);_i.$IG.initializeBase(this,[n]);this.$d=t;this.set_$kI(this.$2lR());this.$N=i;this.$2Y=r;this.$W7=!!u&&u.$2r("FolderBasedClutter")};_i.$IG.prototype={$W7:!1,$d:null,$3Fu:!1,$2kq:!1,$3Fv:!1,$Ld:null,$wj:1,$O3:0,$10R:0,$28I:null,$3hK:!1,$2uN:0,$6NX:0,$3LH:0,$ng:0,$3LE:0,$3LI:0,$1CO:0,$1yN:null,$2MO:0,$2Ae:null,$13E:null,$4sq:0,$6N4:null,$N:null,$1oW:!1,$2Y:null,$1Lh:!1,$6N7:!1,$1fp:!1,get_$2tB:function(){return 3},get_$8Wm:function(){return this.$d.get_$9N().get_$2Vs()},set_$6zT:function(n){if(n!==this.$2uN){this.$2uN=n;this.$4("ReportJunkOption")}return n},set_$kI:function(n){if(this.$Ld!==n){this.$Ld=n;this.$4("PivotOptions")}return n},set_$Gq:function(n){if(this.$O3!==n){this.$O3=n;this.$5Fn();this.$4("PivotSelectedOptionIndex")}return n},set_$2vN:function(n){if(this.$wj!==n){this.$wj=n;this.$4("SelectedPivot")}return n},set_$8aB:function(n){if(n!==this.$3LH){this.$3LH=n;this.$4("ListViewMessageFormat")}return n},set_$32b:function(n){this.$ng=n;this.$4("AutoSelectFirstMessage");return n},set_$4Wi:function(n){if(n!==this.$1CO){this.$1CO=n;this.$4("ConversationOrder")}this.$EWQ(n);return n},set_$3kJ:function(n){if(n!==this.$1yN){this.$1yN=n;this.$4("ConversationOrderImage")}return n},set_$8Mk:function(n){if(n!==this.$2MO){this.$2MO=n;this.$4("HideDeletedItemsOption")}this.$EZf(n);return n},set_$7Ex:function(n){if(n!==this.$2Ae){this.$2Ae=n;this.$4("ShowOrHideDeletedItemsImage")}return n},set_$8a5:function(n){if(n!==this.$3LE){this.$3LE=n;this.$4("ListViewClutterOption")}return n},set_$8aD:function(n){if(n!==this.$3LI){this.$3LI=n;this.$4("ListViewPreviewOption")}return n},set_$5LB:function(n){if(n!==this.$10R){this.$10R=n;this.$4("ReadingPanePositionOption")}this.$9ic(n);return n},set_$3Um:function(n){if(n!==this.$28I){this.$28I=n;this.$4("ReadingPanePositionImage")}return n},set_$7Vt:function(n){this.$3hK=n;this.$4("ApplyRPPositionToAllFolders");return n},set_$1Ek:function(n){if(n!==this.$1Lh){this.$1Lh=n;this.$4("IsOptimizedForAccessibility")}return n},get_$C20:function(){return!this.$W7},get_$DcD:function(){var n=this;return function(t){n.$1oW||n.$DcC()}},get_$DSB:function(){var n=this;return function(t){n.$1oW||n.$DSA()}},get_$DcG:function(){var n=this;return function(t){n.$1oW||n.$DcF()}},get_$DhA:function(){var n=this;return function(t){n.$1oW||n.$Dh9()}},get_$DUo:function(){var n=this;return function(t){n.$1oW||n.$DUn()}},get_$Da9:function(){var n=this;return function(t){n.$1oW||n.$Da8()}},get_$DU7:function(){var n=this;return function(t){n.$1oW||n.$DU6()}},set_$DoZ:function(n){if(this.$1fp!==n){this.$1fp=n;this.$4("OwaLightEnabled");this.$4("OwaLightOptionDescription")}return n},get_$9EW:function(){return this.$1fp?_nbs.NonBootStrings.l_SettingsOwaLightOptionDescription_Text:_nbs.NonBootStrings.l_SettingsOwaLightOptionDisabled_Text},$EZY:function(n){n&&this.set_$Gq(2)},$EA:function(){this.$1oW=!0;this.$A7G();this.$13E=this.$4nK();this.$4sq=this.$10R;this.$6N4=this.$d.get_$6m().$1bk;this.$6N7=this.$1Lh;this.$6NX=this.$2uN;this.$2kq=!1;this.$3Fu=!1;this.$3Fv=!1;this.set_$GZ(1);this.$26o=!1;this.$1oW=!1},$Ar:function(){var n=this.$AQt();var i=null;var r=null;this.set_$GZ(3);if(this.$3hK){this.$d.get_$1j().set_$1na(this.$10R);var f=this.$d.get_$6m().$1bk;for(var u in f){var t={key:u,value:f[u]};if(t.value.$MF!==3){t.value.set_$1AH(3);this.$d.get_$6m().$1w4(t.value)}}i=_h.$21.$4Vw(this.$d.get_$6m().get_$b6(),OwaApplication.$2B,this.$$d_$Dic,this.$$d_$DiY);_a.$i.$Ga(this.$8HP())}else if(this.$4sq!==this.$10R){i=_h.$21.$4Vw(this.$d.get_$6m().get_$b6(),OwaApplication.$2B,this.$$d_$Dic,this.$$d_$Dib);this.$2kq=!0;_a.$i.$Ga(this.$8HP())}if(n){n.add_$2s(this.$$d_$Die);n.add_$2b(this.$$d_$Did);this.$n.$1V(n);this.$3Fu=!0}this.$1fp&&!n&&this.$1Lh!==this.$d.get_$1j().get_$1Ek()&&(r=this.$9QI());this.$6NX!==this.$2uN&&this.$EZJ(this.$2uN);n||i||r||this.$5dh()},$Gg:function(){this.$9Pa();this.$9PZ();this.$9Pb();SettingsPanelViewModelBase.prototype.$Gg.call(this)},$Die:function(n){var t=this.$4nK();if(this.$13E.ConversationSortOrder!==t.ConversationSortOrder||this.$13E.HideDeletedItems!==t.HideDeletedItems){this.$d.get_$1j().set_$ea(this.$1CO);this.$d.get_$1j().set_$rl(this.$2MO===1);this.$N.$1p(_y.$x0,new _y.$x0);this.$N.$1p(_h.$Ps,new _h.$Ps(9))}this.$W7&&!this.$d.get_$9N().get_$2Uq()&&t.ShowInferenceUiElements&&this.$d.get_$9N().set_$2Uq(!0);this.$3Fu=!1;this.$1fp&&this.$1Lh!==this.$d.get_$1j().get_$1Ek()&&this.$9QI();this.$5dh()},$Dic:function(n){this.$2kq=!1;this.$5dh()},$Dig:function(n){this.$3Fv=!1;this.$5dh()},$Did:function(n){this.$3Fu=!1;this.set_$GZ(5);this.$9Pa()},$Dib:function(n){this.$2kq=!1;this.set_$GZ(5);this.$9PZ()},$DiY:function(n){this.$2kq=!1;this.set_$GZ(5);this.$E5i()},$Dif:function(n){this.$3Fv=!1;this.set_$GZ(5);this.$9Pb()},$5dh:function(){var n=!this.$3Fu&&!this.$2kq&&!this.$3Fv;if(n){this.set_$GZ(4);this.$26o=!0;this.get_$h1()&&this.get_$h1()()}},$2lR:function(){var n=[];Array.add(n,new _ff.$4O(_nbs.NonBootStrings.l_ViewSettingsMessageListPivot_Text,1));Array.add(n,new _ff.$4O(_nbs.NonBootStrings.l_ViewSettingsConversationsPivot_Text,2));Array.add(n,new _ff.$4O(_nbs.NonBootStrings.l_ViewSettingsReadingPanePivot_Text,0));this.get_$8Wm()&&Array.add(n,new _ff.$4O(_nbs.NonBootStrings.l_JunkEmailSetting_Text,5));Array.add(n,new _ff.$4O(_nbs.NonBootStrings.l_ViewSettingsOwaVersionPivot_Text,4));return n},$5Fn:function(){this.set_$2vN(this.$Ld[this.$O3].$1e)},$CFG:function(n){if(this.$13E.ShowInferenceUiElements!==n.ShowInferenceUiElements){if(this.$d.get_$1j().get_$15Z())this.$2Y.$9sc();else{this.$2Y.$9sb(2);this.$E48()}return!0}return this.$13E.ShowSenderOnTopInListView!==n.ShowSenderOnTopInListView?!0:this.$13E.ShowPreviewTextInListView!==n.ShowPreviewTextInListView?!0:this.$13E.ConversationSortOrder!==n.ConversationSortOrder?!0:this.$13E.HideDeletedItems!==n.HideDeletedItems?!0:this.$13E.GlobalReadingPanePosition!==n.GlobalReadingPanePosition?!0:this.$13E.ShowFirstMessageOnSignIn!==n.ShowFirstMessageOnSignIn?!0:!1},$4nK:function(){var n=new _g.$Oq;n.ShowInferenceUiElements=!this.$3LE;n.ShowSenderOnTopInListView=!this.$3LH;n.ShowFirstMessageOnSignIn=!this.$ng;n.ShowPreviewTextInListView=!this.$3LI;n.ConversationSortOrder=this.$1CO;n.HideDeletedItems=this.$2MO===1;n.GlobalReadingPanePosition=this.$3hK?this.$10R:this.$d.get_$1j().get_$1na();return n},$A72:function(n){this.$d.get_$1j().set_$15Z(n.ShowInferenceUiElements);this.$d.get_$1j().set_$1OY(n.ShowSenderOnTopInListView);this.$d.get_$1j().set_$1OV(n.ShowPreviewTextInListView);this.$d.get_$1j().set_$ea(n.ConversationSortOrder);this.$d.get_$1j().set_$rl(n.HideDeletedItems);this.$d.get_$1j().set_$1OX(n.ShowFirstMessageOnSignIn);this.$d.get_$1j().set_$1na(n.GlobalReadingPanePosition)},$A7G:function(){this.set_$8a5(this.$d.get_$1j().get_$15Z()?0:1);this.set_$8aB(this.$d.get_$1j().get_$1OY()?0:1);this.set_$32b(this.$d.get_$1j().get_$1OX()?0:1);this.set_$8aD(this.$d.get_$1j().get_$1OV()?0:1);this.set_$5LB(_y.$1O.$2kA(this.get_$124(),this.$d));this.set_$7Vt(!1);(this.$d.get_$1j().get_$ea()==="ChronologicalNewestOnTop"||this.$d.get_$1j().get_$ea()==="ChronologicalNewestOnBottom")&&this.set_$4Wi(this.$d.get_$1j().get_$ea());this.set_$8Mk(this.$d.get_$1j().get_$rl()?1:0);this.set_$1Ek(this.$d.get_$1j().get_$1Ek());this.set_$DoZ(this.$d.get_$9N().get_$6ru());this.$d.get_$1j().get_$gy()?this.set_$6zT(this.$d.get_$1j().get_$mh()?1:2):this.set_$6zT(0)},$EZJ:function(n){switch(n){case 0:this.$d.get_$1j().set_$gy(!1);break;case 1:this.$d.get_$1j().set_$mh(!0);this.$d.get_$1j().set_$gy(!0);break;case 2:this.$d.get_$1j().set_$mh(!1);this.$d.get_$1j().set_$gy(!0);break}_h.$21.$Kq(this.$d.get_$1j().$Hm,OwaApplication.$2B)},$9ic:function(n){switch(n){case 2:this.set_$3Um(_i.$1.get_$9KM());break;case 0:this.set_$3Um(_i.$1.get_$5LA());break;case 1:this.set_$3Um(_i.$1.get_$6wo());break}},$EWQ:function(n){switch(n){case"ChronologicalNewestOnBottom":this.set_$3kJ(_i.$1.get_$95e());break;case"ChronologicalNewestOnTop":this.set_$3kJ(_i.$1.get_$6mL());break}},$EZf:function(n){switch(n){case 1:this.set_$7Ex(_i.$1.get_$6LS());break;case 0:this.set_$7Ex(_i.$1.get_$9l1());break}},$DcC:function(){this.$d.get_$1j().set_$1OY(!this.$3LH)},$DSA:function(){this.$d.get_$1j().set_$1OX(!this.$ng)},$DcF:function(){this.$d.get_$1j().set_$1OV(!this.$3LI)},$Dh9:function(){this.$7Vr(this.$10R)},$7Vr:function(n){var t=this.$d.get_$6m().$fD(this.get_$124());t.set_$1AH(n);this.$d.get_$6m().$1w4(t)},$AQt:function(){var n=this.$4nK();return this.$CFG(n)?new _c.$pf(n):null},$DUn:function(){this.$N.$1p(_y.$Ic,new _y.$Ic(this.$1CO,this.$2MO===1))},$Da8:function(){this.$N.$1p(_y.$Ic,new _y.$Ic(this.$1CO,this.$2MO===1))},$DU6:function(){this.$d.get_$1j().set_$15Z(!this.$3LE)},$E48:function(){this.$d.get_$1j().set_$3u4(!1);this.$d.get_$1j().set_$3u7(!1);this.$d.get_$1j().set_$3u5(!1);this.$d.get_$1j().set_$3u8(!1);this.$d.get_$1j().set_$3u6(!1);this.$d.get_$1j().set_$3u9(!1);this.$d.get_$1j().set_$fb(this.$d.get_$1j().get_$fb()&-2);this.$d.get_$1j().set_$fb(this.$d.get_$1j().get_$fb()&-3);_h.$21.$Kq(this.$d.get_$1j().$Hm,OwaApplication.$2B)},$9Pa:function(){this.$A72(this.$13E);var n=this.$4nK();(this.$13E.ConversationSortOrder!==n.ConversationSortOrder||this.$13E.HideDeletedItems!==n.HideDeletedItems)&&this.$N.$1p(_y.$Ic,new _y.$Ic(this.$13E.ConversationSortOrder,this.$13E.HideDeletedItems))},$9PZ:function(){this.$7Vr(this.$4sq)},$E5i:function(){var i=this.$6N4;for(var r in i){var n={key:r,value:i[r]};var t=this.$d.get_$6m().$1bk[n.key];t.set_$1AH(n.value.$MF);this.$d.get_$6m().$1w4(t)}},$9Pb:function(){this.$d.get_$1j().set_$1Ek(this.$6N7)},$9QI:function(){this.$d.get_$1j().set_$1Ek(this.$1Lh);var n=_h.$21.$4Vw(this.$d.get_$1j().$Hm,OwaApplication.$2B,this.$$d_$Dig,this.$$d_$Dif);this.$3Fv=!0;return n},$8HP:function(){var n=null;switch(this.$10R){case 0:n="VM.MailUsage.SetReadingPaneOff";break;case 1:n="VM.MailUsage.SetReadingPaneRight";break;case 2:n="VM.MailUsage.SetReadingPaneBottom";break}return n}};_i.$vc=function(n,t,i,r,u){this.$$d_$Hc=Function.createDelegate(this,this.$Hc);this.$$d_$5N=Function.createDelegate(this,this.$5N);this.$$d_$Gg=Function.createDelegate(this,this.$Gg);this.$$d_$6nU=Function.createDelegate(this,this.$6nU);_i.$vc.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_i.$vc.initializeBase(this);_a.$4.$z(n,"eventAggregator");_a.$4.$z(t,"offlineBootStrapper");_a.$4.$z(i,"userAgent");_a.$4.$z(r,"bookmarker");this.$N=n;this.$I1=t;this.$1E=i;this.$qf=r;this.$xN=u;this.$XM=new _C(this.$$d_$6nU,_a.$0.$L3);this.$8W=new _C(this.$$d_$Gg,_a.$0.$L3);this.$5a=new _C(this.$$d_$5N,_a.$0.$L3);this.$3RT=new _C(this.$$d_$Hc,_a.$0.$L3);this.$H6=1;this.$34e=0;this.$3uc=!1;this.$4HF=!1;this.set_$8WP(!0)};_i.$vc.prototype={$1E:null,$qf:null,$N:null,$I1:null,$xN:null,$DE:null,$48:null,$5a:null,$8W:null,$3RT:null,$XM:null,$H6:0,$34e:0,$3uc:!1,$4HF:!1,$5Kb:!1,$4xg:!1,set_$8WP:function(n){if(this.$4xg!==n){this.$4xg=n;this.$4("IsProvisioning")}return n},get_$Df:function(){return this.$1E.get_$Df()},get_$A2R:function(){return this.$1E.get_$2OB()?_nbs.NonBootStrings.l_OfflineUserAddBookmark_Manual_Mac_Text:_nbs.NonBootStrings.l_OfflineUserAddBookmark_Manual_PC_Text},get_$CHa:function(){return this.$5Kb?_nbs.NonBootStrings.l_OfflineNotAvailable_Text:_nbs.NonBootStrings.l_OfflineSettingsDone_Text},set_$9kZ:function(n){if(this.$4HF!==n){this.$4HF=n;this.$4("ShowAbortProvisionInfo")}return n},set_$6Le:function(n){if(this.$3uc!==n){this.$3uc=n;this.$4("HideNextButton")}return n},set_$AIa:function(n){if(this.$34e!==n){this.$34e=n;this.$4("ComputerPrivacyMode");this.$34e===1?this.$9zC():this.$AJY()}return n},get_$5F:function(){return this.$48},set_$5F:function(n){this.$48=n;return n},get_$h1:function(){return this.$DE},set_$h1:function(n){this.$DE=n;return n},get_$7ly:function(){return!1},get_$3tc:function(){return null},get_$2tB:function(){return 3},get_$4Yk:function(){return this.$H6},set_$4Yk:function(n){if(this.$H6!==n){this.$H6=n;this.$H6===4&&this.set_$6Le(!0);this.$4("CurrentStep");this.$4("StepInfo")}return n},get_$EkG:function(){return String.format(_nbs.NonBootStrings.l_StepInfo_Text,this.$H6,4)},$5N:function(){this.$DE();this.$N.$1p(_a.$PC,new _a.$PC);this.set_$8WP(!1)},$6nU:function(){_js.Trace.logInfo(_a.$0.$L3,"OfflineSettingProvision is invoking OK");this.$5N()},$Gg:function(){_js.Trace.logInfo(_a.$0.$L3,"OfflineSettingProvision is cancelling offline provision");this.$5N();if(this.$H6>1){this.$63T(!1);this.$I1.$6yt(_g.$1H.$1Q,window.location)}},$Hc:function(){_js.Trace.logInfo(_a.$0.$L3,"OfflineSettingProvision is invoking next");switch(this.$H6){case 1:this.$C6t();break;case 3:this.$63T(!1);break;default:break}this.$5Kb?this.set_$4Yk(4):this.set_$4Yk(this.get_$4Yk()+1)},$9zC:function(){this.set_$6Le(!0);this.set_$9kZ(!0)},$AJY:function(){this.set_$6Le(!1);this.set_$9kZ(!1)},$C6t:function(){var t=this,n=this;this.$I1.$6v4(_g.$1H.$1Q,null,!0,_js.$D.get_$Q(),"Mouse",function(n){_g.$1H.set_$Q(n);t.$N.$1p(_a.$PB,new _a.$PB(!0))},function(t){_js.Trace.logError(_a.$0.$1c,"Failed to install offline components. {0}",t);if(n.$4xg){n.$5Kb=!0;n.$4("LastStepInfo")}else{var i=new _a.$2y([_nbs.NonBootStrings.l_OfflineNotAvailable_Text],1,null);n.$N.$1p(_a.$2y,i)}});this.$qf.$Dsw(this.$xN)},$63T:function(n){this.$qf.$63T(n)}};_i.$nu=function(n,t,i,r,u,f,e,o){this.$$d_$6X3=Function.createDelegate(this,this.$6X3);this.$$d_$Gg=Function.createDelegate(this,this.$Gg);this.$$d_$6nU=Function.createDelegate(this,this.$6nU);_i.$nu.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_i.$nu.initializeBase(this);_a.$4.$z(n,"eventAggregator");_a.$4.$z(t,"offlineBootStrapper");_a.$4.$z(r,"userAgent");_a.$4.$z(u,"bookmarker");_a.$4.$z(i,"owaShell");this.$N=n;this.$I1=t;this.$1E=r;this.$qf=u;this.$xN=f;this.$I=i;this.$1Yw=e;this.$35=o;this.$XM=new _C(this.$$d_$6nU,_a.$0.$L3);this.$8W=new _C(this.$$d_$Gg,_a.$0.$L3);this.$QD=new _C(this.$$d_$6X3,_a.$0.$L3)};_i.$nu.prototype={$I:null,$N:null,$I1:null,$1E:null,$qf:null,$xN:null,$35:null,$1Yw:null,$DE:null,$48:null,$4sp:0,$2fn:0,$XM:null,$8W:null,$QD:null,$1s0:null,$Ld:null,$wj:0,$O3:0,get_$5F:function(){return this.$48},set_$5F:function(n){this.$48=n;return n},get_$h1:function(){return this.$DE},set_$h1:function(n){this.$DE=n;return n},get_$7ly:function(){return!1},get_$3tc:function(){return null},get_$2tB:function(){return 3},set_$7j3:function(n){if(this.$2fn!==n){this.$2fn=n;this.$4("CurrentOfflinEnabledStatus");this.$4("ShowOptOutWarningInfo")}return n},get_$EfC:function(){return!this.$2fn&&this.$I1.get_$6ri()>0},set_$DQO:function(n){if(n!==this.$1s0){this.$1s0=n;this.$4("OfflineFoldersViewModel")}return n},set_$kI:function(n){if(this.$Ld!==n){this.$Ld=n;this.$4("PivotOptions")}return n},set_$Gq:function(n){if(this.$O3!==n){this.$O3=n;this.$5Fn();this.$4("PivotSelectedOptionIndex")}return n},set_$2vN:function(n){if(this.$wj!==n){this.$wj=n;this.$4("SelectedPivot")}return n},$5N:function(){this.$DE()},$2lR:function(){var n=[];Array.add(n,new _ff.$4O(_nbs.NonBootStrings.l_SetUp_Text,0));Array.add(n,new _ff.$4O(_nbs.NonBootStrings.l_OfflineFolders_Text,1));return n},$5Fn:function(){this.set_$2vN(this.$Ld[this.$O3].$1e)},$6X3:function(){this.$4sp=this.$I1.$BJ.get_$1iY()?1:0;this.set_$7j3(this.$4sp);if(this.$I1.$BJ.get_$YO()){this.$1s0||this.set_$DQO(new _d.$Ee(this.$I,_nbs.NonBootStrings.l_OfflineFolders_Text,this.$N,this.$1Yw,this.$48,this.$35));this.$1s0.$5WI();this.$Ld||this.set_$kI(this.$2lR())}},$6nU:function(){_js.Trace.logInfo(_a.$0.$L3,"OfflineSettings Invoking OK");this.$5N();if(this.$2fn!==this.$4sp)if(this.$2fn===1){var n=new _i.$vc(this.$N,this.$I1,this.$1E,this.$qf,this.$xN);this.$I.$Az(n)}else this.$I1.$6yt(_g.$1H.$1Q,window.location);else this.$9K3();this.$1s0&&this.$1s0.$71N()},$Gg:function(){this.$5N();this.$1s0&&this.$1s0.$5WI();this.$9K3()},$9K3:function(){this.$N.$1p(_a.$PC,new _a.$PC)}};function SettingsPanelFactory(n,t,i,r,u,f,e,o,s){this.$n=n;this.$d=t;this.$N=i;this.$1E=r;this.$2Y=u;this.$3Y=o;this.$85=s;this.$1Yw=f;this.$35=e}SettingsPanelFactory.prototype={$n:null,$d:null,$N:null,$1E:null,$2Y:null,$1Yw:null,$35:null,$3Y:null,$85:null,$4Y9:function(){return new _i.$LO(this.$n,this.$d,this.$N)},$4XY:function(){return new _i.$IG(this.$n,this.$d,this.$N,this.$2Y,this.$3Y)},$4Xl:function(n,t,i,r){return new _i.$nu(this.$N,n,t,this.$1E,i,r,this.$1Yw,this.$35)},$4Y6:function(){return new _i.$xY(this.$d,this.$85)}};function SettingsPanelViewModelBase(n){this.$$d_$Dia=Function.createDelegate(this,this.$Dia);this.$$d_$Dih=Function.createDelegate(this,this.$Dih);this.$$d_$9Eu=Function.createDelegate(this,this.$9Eu);this.$$d_$EA=Function.createDelegate(this,this.$EA);this.$$d_$Gg=Function.createDelegate(this,this.$Gg);this.$$d_$Ar=Function.createDelegate(this,this.$Ar);this.$$d_$5N=Function.createDelegate(this,this.$5N);SettingsPanelViewModelBase.initializeBase(this);this.$n=n;this.$5a=new _C(this.$$d_$5N,_a.$0.$1c);this.$E0=new _C(this.$$d_$Ar,_a.$0.$1c);this.$8W=new _C(this.$$d_$Gg,_a.$0.$1c);this.$QD=new _C(this.$$d_$EA,_a.$0.$1c)}SettingsPanelViewModelBase.prototype={$n:null,$48:null,$7c:null,$5a:null,$E0:null,$8W:null,$QD:null,$UV:null,$6Oa:!1,$HL:0,$26o:!1,$3Sk:null,$3jd:null,$4Vk:null,$4Vl:null,get_$8aG:function(){return this.$QD},get_$124:function(){return this.$UV},set_$124:function(n){this.$UV=n;return n},get_$2NN:function(){return this.$6Oa},set_$2NN:function(n){this.$6Oa=n;this.$EZY(n);return n},set_$GZ:function(n){if(this.$HL!==n){this.$HL=n;this.$4("Status")}return n},get_$2tB:function(){return 2},get_$3tc:function(){return this.$$d_$9Eu},get_$5F:function(){return this.$48},set_$5F:function(n){this.$48=n;return n},get_$h1:function(){return this.$7c},set_$h1:function(n){this.$7c=n;return n},get_$7ly:function(){return!1},get_$3Sl:function(){return this.$3Sk},set_$3Sl:function(n){this.$3Sk=n;return n},$ma:function(){},$IX:function(){if(this.$3Sk){_a.$6.$1G(this.$3Sk);this.$3Sk=null}},$pf:function(){},$Tp:function(){if(this.$3jd){_a.$6.$1G(this.$3jd);this.$3jd=null}},$AQr:function(){return null},$9C1:function(n){},$Gg:function(){this.$26o=!0;this.get_$h1()&&this.get_$h1()()},$5Fh:function(n){},$EZY:function(n){},$Ar:function(){var n=this.$AQr();if(n){this.set_$GZ(3);n.add_$2s(this.$$d_$Dih);n.add_$2b(this.$$d_$Dia);this.$n.$1V(n)}else{this.$26o=!0;this.get_$h1()()}},$Dih:function(n){this.set_$GZ(4);this.$9C1(n);this.$26o=!0;this.get_$h1()()},$Dia:function(n){this.set_$GZ(5);this.$5Fh(n)},$5N:function(){this.$4Vk&&this.$4Vl&&(this.$3jd=_a.$6.$1g(this.$4Vk,this.$4Vl,!0));this.$26o=!0;this.get_$h1()()},$9Eu:function(n,t){return!this.$26o}};_i.$LO=function(n,t,i){this.$$d_$9AJ=Function.createDelegate(this,this.$9AJ);this.$$d_$DcV=Function.createDelegate(this,this.$DcV);_i.$LO.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;_i.$LO.initializeBase(this,[n]);var r=t.get_$RA().DefaultTheme;_js.$9.$1h(r)&&(r="base");this.$1AQ=t.get_$1j().get_$4Jh();_js.$9.$1h(this.$1AQ)&&(this.$1AQ=r);this.$N=i;this.$4Vk=_a.$0.$1c;this.$4Vl="ThemesPanelClose"};_i.$LO.prototype={$N:null,$1AQ:null,$10w:null,$2G2:null,$2aW:null,$1AW:null,$2Pn:null,$14z:null,get_$1I7:function(){return this.$10w},set_$1I7:function(n){if(this.$10w!==n){this.$10w=n;this.$4("ThemesList")}return n},get_$16y:function(){return this.$2G2},set_$16y:function(n){if(this.$2G2!==n){this.$2G2=n;this.$4("CssPaths")}return n},set_$9qD:function(n){if(this.$2aW!==n){this.$2aW=n;this.$4("ThemePath")}return n},set_$3X6:function(n){if(this.$1AW!==n){this.$1AW=n;this.$4("SelectedThemeId");this.$N.$1p(_a.$Ss,new _a.$Ss(this.$1AW))}return n},set_$71U:function(n){if(this.$1AQ!==n){this.$1AQ=n;this.$4("SavedThemeId")}return n},$EA:function(){this.$2Pn=_a.$6.$1g(_a.$0.$1c,"ThemesLoad",!0);this.set_$GZ(0);this.$26o=!1;var n=new _c.$1HV;n.add_$2s(this.$$d_$DcV);n.add_$2b(this.$$d_$9AJ);this.$n.$1V(n)},$AQr:function(){this.$14z=_a.$6.$1g(_a.$0.$1c,"ThemesSave",!0);return new _c.$1QN(this.$1AW)},$9C1:function(n){this.set_$71U(n.$46o);this.$N.$1p(_a.$YH,new _a.$YH(this.$1AQ));if(!$C(this.$14z)){var t=new _a.$3z;t.$CX("T",n.$46o);_a.$6.$1G(this.$14z,null,"",n.$FJ(),t.toString());this.$14z=null}},$Gg:function(){SettingsPanelViewModelBase.prototype.$Gg.call(this);this.$N.$1p(_a.$Ss,new _a.$Ss(this.$1AQ))},$5Fh:function(n){if(!$C(this.$14z)){_a.$6.$1G(this.$14z,null,n.$2H?n.$2H.toString():"unknown",n.$FJ());this.$14z=null}},$DcV:function(n){this.set_$GZ(1);var r=!1;if(!$C(n)){var t=n.$7JR;this.set_$16y(t.CssPaths);this.set_$9qD(t.ThemePath);this.set_$1I7(t.Themes);($C(this.$10w)||!this.$10w.length)&&this.$9AJ(n);for(var i=0;i<this.$10w.length;i++)if(this.$10w[i].FolderName===this.$1AQ){r=!0;break}}r||this.set_$71U("base");this.set_$3X6(this.$1AQ);if(!$C(this.$2Pn)){_a.$6.$1G(this.$2Pn,null,"",n.$FJ());this.$2Pn=null}},$9AJ:function(n){this.set_$GZ(2);if(!$C(this.$2Pn)){_a.$6.$1G(this.$2Pn,null,n.$2H?n.$2H.toString():"unknown",n.$FJ());this.$2Pn=null}}};_i.$xY=function(n,t){this.$$d_$7bZ=Function.createDelegate(this,this.$7bZ);this.$$d_$Bo2=Function.createDelegate(this,this.$Bo2);this.$$d_$Gg=Function.createDelegate(this,this.$Gg);this.$$d_$6nU=Function.createDelegate(this,this.$6nU);this.$$d_$6X3=Function.createDelegate(this,this.$6X3);_i.$xY.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_i.$xY.initializeBase(this);this.$1Oy=new _i.$18d;this.$d=n;this.$85=t;this.$QD=new _C(this.$$d_$6X3,_a.$0.$53);this.$XM=new _C(this.$$d_$6nU,_a.$0.$53);this.$8W=new _C(this.$$d_$Gg,_a.$0.$53);this.$1zK=new _C(_a.$b.$1Ja,_a.$0.$53);this.$188=new _C(this.$$d_$Bo2,_a.$0.$53);this.$34B=new _C(this.$$d_$7bZ,_a.$0.$53)};_i.$xY.prototype={$d:null,$85:null,$QD:null,$XM:null,$8W:null,$1zK:null,$188:null,$34B:null,$1bp:!1,$1bq:!1,$1Io:!1,$1Oy:null,$6rX:null,$34C:null,$G7:!1,$DE:null,$48:null,get_$C6s:function(){return _a.$b.get_$2md()?null:_i.$1.get_$A5f()},get_$8Qf:function(){return _a.$b.get_$8WD()?_a.$b.get_$2md()?String.format(_nbs.NonBootStrings.l_Smime_MostRecentControlIsInstalled_Text,_a.$b.get_$5A()):String.format(_nbs.NonBootStrings.l_Smime_NewControlAvailable_Text,_a.$b.get_$5A()):String.format(_nbs.NonBootStrings.l_Smime_SmimeExtensionWillNotWorkInCurrentDomain_Text,window.location.hostname)},get_$AYf:function(){return _a.$b.get_$2md()?_u.Strings.l_Smime_ReinstallControlLabel_Text:_u.Strings.l_Smime_UpdateControlLabel_Text},get_$5F:function(){return this.$48},set_$5F:function(n){this.$48=n;return n},get_$h1:function(){return this.$DE},set_$h1:function(n){this.$DE=n;return n},get_$7ly:function(){return!1},get_$3tc:function(){return null},get_$2tB:function(){return 3},set_$AsT:function(n){if(this.$1bp!==n){this.$1bp=n;this.$4("ForceEncryptMessage")}return n},set_$Asd:function(n){if(this.$1bq!==n){this.$1bq=n;this.$4("ForceSignMessage")}return n},set_$A5w:function(n){if(this.$1Io!==n){this.$1Io=n;this.$4("AllowUserChoiceOfSigningCertificate")}return n},set_$7d:function(n){if(this.$G7!==n){this.$G7=n;this.$4("IsBusy")}return n},$5N:function(){this.$DE()},$6X3:function(){this.set_$7d(!0);if(this.$d.get_$VV()){this.set_$AsT(this.$d.get_$VV().AlwaysEncrypt);this.set_$Asd(this.$d.get_$VV().AlwaysSign);this.set_$A5w(this.$d.get_$VV().AllowUserChoiceOfSigningCertificate)}this.$1Oy.$8aF(this.$1bp,this.$1bq,this.$1Io);this.$1Oy.set_$4cl(this.$d.get_$1j().get_$2ZO());this.$1Oy.set_$5ZF(this.$d.get_$1j().get_$2ZQ());this.$1Oy.set_$7XE(!this.$d.get_$1j().get_$2oJ());this.$1Oy.set_$3bM(this.$d.get_$1j().get_$2y0());this.$1Oy.set_$5ZD(this.$d.get_$1j().get_$2ZJ());this.$6rX=this.$1Oy.$4o();this.set_$7d(!1)},$7Vx:function(n,t){if(n){(!this.$1bp||t)&&this.$d.get_$1j().set_$2ZO(n.get_$4cl());(!this.$1bq||t)&&this.$d.get_$1j().set_$2ZQ(n.get_$5ZF());if(this.$1Io||t){this.$d.get_$1j().set_$2oJ(!n.$2EA);if(!n.$2EA||t){this.$d.get_$1j().set_$2y0(n.get_$3bM());this.$d.get_$1j().set_$2ZJ(n.$1i0)}}}t&&this.$d.get_$1j().$Hm.$AV()},$6nU:function(){if(!this.$G7){_js.Trace.logInfo(_a.$0.$53,"SmimeSettings Invoking OK");this.set_$7d(!0);this.$7Vx(this.$1Oy,!1);var t=this,n=this;var i=_h.$21.$4Vw(this.$d.get_$1j().$Hm,OwaApplication.$2B,function(){t.set_$7d(!1);t.$5N()},function(t){n.set_$7d(!1);n.$du(_nbs.NonBootStrings.l_Smime_CannotSaveSettings_Text);_js.Trace.logException(_a.$0.$53,t.$2H,"Failed to save S/MIME settings.")});if(!i){this.set_$7d(!1);this.$5N();return}}},$Gg:function(){this.$7Vx(this.$6rX,!0);this.$5N()},$7bZ:function(){if(!this.$G7){var n=this;_a.$b.$14e.$6IM(null,function(t){var r=JsonParser.deserialize(t);if(r.ErrorCode){n.$du(_u.Strings.l_Smime_CannotGetSubjectCertFromStore_Text);return}n.set_$7d(!0);n.$34C=r.Data;var i=new _h.$ld(200,n.$34C,!1);i.add_$2s(function(){if(i.get_$4d().IsValid){n.$1Oy.set_$3bM(_a.$b.$4p4(i.get_$4d().Subject));n.$1Oy.set_$5ZD(i.get_$4d().SubjectKeyIdentifier)}else{_js.Trace.logInfo(_a.$0.$53,"The chosen cert can't be used for signing.");n.$du(_u.Strings.l_Smime_ChoosenCertificateIsInvalid_Text)}});i.add_$2b(function(t){_js.Trace.logException(_a.$0.$53,t.$2H,"Unabled to verify the chosen cert.");n.$du(_u.Strings.l_Smime_CannotVerifyChoosenCertificate_Text)});i.add_$4Q(function(){n.set_$7d(!1)});OwaApplication.$2B.$1V(i)})}},$Bo2:function(){this.$85.$iT(9)},$du:function(n){_a.$3m.$44(n,0)}};_i.$18d=function(){_i.$18d.initializeBase(this)};_i.$18d.prototype={$1bp:!1,$1bq:!1,$1Io:!1,$38g:!1,$3bK:!1,$1Ob:null,$1i0:null,$2EA:!1,get_$4cl:function(){return this.$38g||this.$1bp},set_$4cl:function(n){if(this.$38g!==n){this.$38g=n;this.$4("EncryptMessage")}return n},get_$5ZF:function(){return this.$3bK||this.$1bq},set_$5ZF:function(n){if(this.$3bK!==n){this.$3bK=n;this.$4("SignMessage")}return n},set_$7XE:function(n){if(this.$2EA!==n){this.$2EA=n;this.$4("AutoChooseCert")}return n},get_$3bM:function(){return _js.$9.$o(this.$1Ob)?_u.CommonStrings.l_None_Text:this.$1Ob},set_$3bM:function(n){if(this.$1Ob!==n){this.$1Ob=n;this.$4("SigningCertSubject")}return n},set_$5ZD:function(n){if(this.$1i0!==n){this.$1i0=n;this.$4("SigningCertSubjectKeyId")}return n},$8aF:function(n,t,i){this.$1bp=n;this.$1bq=t;this.$1Io=i},$4o:function(){var n=new _i.$18d;n.$1bp=this.$1bp;n.$1bq=this.$1bq;n.$1Io=this.$1Io;n.$38g=this.$38g;n.$3bK=this.$3bK;n.$2EA=this.$2EA;n.$1Ob=this.$1Ob;n.$1i0=this.$1i0;return n}};function DesktopViewModelsComponent(){}DesktopViewModelsComponent.prototype={$2FV:function(n,t,i){var u=this;n.$r(SettingsPanelFactory).$2a(ISettingsPanelFactory).$1I().$t(function(){return new SettingsPanelFactory(n.$2(_a.$2Y),n.$2(_g.$O),n.$2(_ff.$M),n.$2(_a.UserAgent),n.$2(IInferenceTracker),n.$36(ISyncFolderSettingProcessor),n.$2(_js.$3V),n.$2(_a.$1d),n.$2(IModuleHelpProvider))});var r=this;n.$r(_i.$LO).$2a(IThemesViewModel).$t(function(){return new _i.$LO(n.$2(_a.$2Y),_g.$O.get_$Q(),n.$2(_ff.$M))})},$Bl5:function(){return null}};_i.$1.registerClass("_i.$1");SettingsPanelViewModelBase.registerClass("SettingsPanelViewModelBase",ISettingsPanelViewModelBase,_y.$Ol);_i.$IG.registerClass("_i.$IG",SettingsPanelViewModelBase);_i.$vc.registerClass("_i.$vc",_a.$En,_bc.$Kk,_bc.$e2,_bc.$mB,_a.$1Y6,_js.$13p,Sys.IDisposable);_i.$nu.registerClass("_i.$nu",_a.$En,_bc.$Kk,_bc.$e2,_bc.$mB,_a.$1Y6,_js.$13p,Sys.IDisposable);SettingsPanelFactory.registerClass("SettingsPanelFactory",null,ISettingsPanelFactory);_i.$LO.registerClass("_i.$LO",SettingsPanelViewModelBase,IThemesViewModel,_js.$13p);_i.$xY.registerClass("_i.$xY",_a.$En,_bc.$Kk,_bc.$e2,_bc.$mB,_a.$1Y6,_js.$13p,Sys.IDisposable);_i.$18d.registerClass("_i.$18d",_js.$Ec);DesktopViewModelsComponent.registerClass("DesktopViewModelsComponent",null,_a.$1X7);
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.desktop.viewmodels.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.desktop.viewmodels.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
