try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.extensibility.js'] = (new Date()).getTime();
Type.registerNamespace("_ex");function ExtensibilityComponent(){}ExtensibilityComponent.prototype={$2FV:function(n,t,i){var e=this;n.$r(IExtensibilityStatistics).$2a(IExtensibilityStatistics).$1I().$t(function(){return new _ex.$11f});var o=this;n.$r(_ex.$Ue).$1I().$t(function(){return new _ex.$Ue(n.$2(_g.$Ke),n.$2(IExtensibilityStatistics),n.$2(_a.$1d))});var s=this;n.$r(_ex.$Ui).$1I().$t(function(){return new _ex.$Ui});var r=this,u=this;n.$r(_ex.$Ug).$1I().$t(function(){var t=n.$2(_g.$O);return new _ex.$Ug(t.get_$gg(),t.get_$4P().get_$Lk(),t.get_$4P().get_$Fv(),t.get_$1j().get_$HM(),n.$2(_y.$W),n.$3K(IItemReadingPaneContextFactory),n.$3K(IItemReadingPaneViewModelPopOutFactory),n.$3K(IMailComposeContextFactory),n.$3K(IMailComposeActionFactory),n.$2(_a.$t),n.$2(_a.$3G),n.$2(_a.$2Y),n.$2(_a.$AE))}).$cA(function(t){t.$xk=n.$3K(ICalendarItemDetailsViewModelFactory);t.$zX=n.$3K(IMailComposeViewModelFactory);t.$y0=n.$3K(IComposeCalendarItemViewModelFactory)});var f=this;n.$r(IExtensibilityViewModelFactory).$2a(IExtensibilityViewModelFactory).$1I().$t(function(){var t=n.$2(_g.$O);return new _ex.$11h(n.$2(_a.$1x),n.$2(_ex.$Ui),t.get_$4P().get_$CE(),i.get_$9EE(),n.$2(_a.$3G),n.$2(_a.$t),n.$2(_y.$W),n.$2(_ff.$M),n.$2(_ex.$Ue),n.$2(_ex.$Ug),n.$2(IExtensibilityStatistics),n.$2(_a.$1d))})},$Bl5:function(){return null}};_ex.$lK=function(n,t,i){_ex.$lK.initializeBase(this);this.$Ai=n;this.$PX=t;this.$N5=i};_ex.$lK.prototype={$Ai:null,$PX:null,$N5:null,$6OX:function(n){var i=new _g.$Ua(this.$Ai,this.$PX,this.$N5);var t=new _g.$11T(this.$2k);t.actionName="Ext_ExecuteEwsProxy";n.$4dZ(i,t,this.$$d_$6qk,this.$$d_$1N0)},$6vq:function(n,t,i){t()}};_ex.$le=function(n,t){_ex.$le.initializeBase(this);this.$1vn=new Array(n.length);for(var i=0;i<n.length;i++){this.$1vn[i]=new _g.$Nf(t);this.$1vn[i].Id=n[i]}};_ex.$le.prototype={$1vn:null,$6OX:function(n){var i=new _g.$O7(this.get_$7h());i.Body.TokenRequests=this.$1vn;var t=new _g.$lf(this.$2k);t.actionName="Ext_GetUserIdentityToken";n.$3EF(i,t,this.$$d_$6qk,this.$$d_$1N0)},$wV:function(n){n.ResponseCode==="NoError"&&n.ResponseClass==="Success"&&_ex.$5K.get_$Q().$7UI(n.Token)}};_ex.$lk=function(n){_ex.$lk.initializeBase(this);this.$b=n};_ex.$lk.prototype={$b:null,$6OX:function(n){var i=new _g.$JD(_h.$f.get_$r8());i.ItemIds=[new _g.$1T(this.$b.get_$y().Id)];var t=new _g.$OA(this.$2k);t.clientStoreItem=0;var r=new _g.$JC(this.get_$7h(),i);n.$64(r,t,this.$$d_$6qk,this.$$d_$1N0)},$wV:function(n){var t=n.Items[0];this.$b.set_$r8(t.EntityExtractionResult)}};_ex.$4W=function(){_ex.$4W.initializeBase(this)};_ex.$4W.prototype={$zL:!1,$8l:null,$2Fe:0,$60:null,$11:function(n,t){if(OwaApplication.$1Pc){_ex.$4W.$en=new _g.$O2;_ex.$4W.$en.Extensions=new Array(0)}else if(!this.$zL){this.$60=new _g.$VE(n,t);this.$zL=!0;this.$8l=_a.$8.get_$38();OwaApplication.$2B.$1V(this)}},$6OX:function(n){var t=new _g.$128(this.$2k);t.actionName="Ext_LoadApps";n.$2LD(this.$60,t,this.$$d_$6qk,this.$$d_$1N0)},$6vq:function(n,t,i){this.$2Fe=_a.$8.get_$38().$6M(this.$8l);_ex.$4W.$en=n;t()}};_ex.$Ve=function(n,t){_ex.$Ve.initializeBase(this);if(_js.$9.$o(t))throw Error.argument("scope","scope can not be null or empty.");this.$1vm=new _g.$Nf("ScopedToken");this.$1vm.Id=n;this.$1vm.Scope=t};_ex.$Ve.prototype={$1vm:null,$PX:null,$6OX:function(n){var i=new _g.$O7(this.get_$7h());i.Body.TokenRequests=[this.$1vm];var t=new _g.$lf(this.$2k);t.actionName="Ext_GetAttachmentToken";n.$3EF(i,t,this.$$d_$6qk,this.$$d_$1N0)},$wV:function(n){n.ResponseCode==="NoError"&&n.ResponseClass==="Success"&&(this.$PX=n.Token)}};_ex.$WP=function(n,t){_ex.$WP.initializeBase(this);this.$N5=n;this.$5i=t};_ex.$WP.prototype={$N5:null,$5i:null,$6OX:function(n){var i=new _g.$WQ(this.$N5,this.$5i);var t=new _g.$14d(this.$2k);t.actionName="Ext_LoadExtensionCustomProperties";n.$50w(i,t,this.$$d_$6qk,this.$$d_$1N0)},$6vq:function(n,t,i){t()}};_ex.$17i=function(n){_ex.$17i.initializeBase(this);_a.$4.$1s(n,"input");this.$3H7=n};_ex.$17i.prototype={$3H7:null,$6OX:function(n){var t=new _g.$17j(this.$2k);n.$4CY(this.$3H7,t,this.$$d_$6qk,this.$$d_$1N0)},$6vq:function(n,t,i){if(null===n){i(Error.create("SanitizeHtmlAction failed."));return}_js.Trace.logInfo(_a.$0.$4W,"SanitizeHtml Web Service request successful.");t()}};_ex.$pC=function(n,t,i){_ex.$pC.initializeBase(this);this.$N5=n;this.$5i=t;this.$3XL=i};_ex.$pC.prototype={$N5:null,$5i:null,$3XL:null,$6OX:function(n){var i=new _g.$Xb(this.$N5,this.$5i,this.$3XL);var t=new _g.$17k(this.$2k);t.actionName="Ext_SaveExtensionCustomProperties";n.$5OL(i,t,this.$$d_$6qk,this.$$d_$1N0)},$6vq:function(n,t,i){t()}};_ex.$pD=function(n,t,i){_ex.$pD.initializeBase(this);this.$N5=n;this.$39D=t;this.$3XM=i};_ex.$pD.prototype={$N5:null,$39D:null,$3XM:null,$6OX:function(n){var i=new _g.$Xd(this.$N5,this.$39D,this.$3XM);var t=new _g.$17l(this.$2k);t.actionName="Ext_SaveExtensionSettings";n.$5OM(i,t,this.$$d_$6qk,this.$$d_$1N0)},$6vq:function(n,t,i){t()}};_ex.$5K=function(){this.$1Q4={};this.$1Q1={}};_ex.$5K.get_$Q=function(){$C(_ex.$5K.$1Q)&&(_ex.$5K.$1Q=new _ex.$5K);return _ex.$5K.$1Q};_ex.$5K.prototype={$7UI:function(n){switch(n.TokenType){case"CallerIdentity":this.$1Q4[n.Id]=new _ex.$5K.$3iZ(n);break;case"ExtensionCallback":this.$1Q1[n.Id]=new _ex.$5K.$3iZ(n);break;default:var t=String.format("Error: ClientAccessTokenCache.AddToken type not supported - {0}",_js.$1I.$Gy(_g.$Tw,n));_js.Trace.logError(_a.$0.$Ui,t);break}},$34s:function(n){return n in this.$1Q4&&!this.$1Q4[n].$1oN()},$34r:function(n){return n in this.$1Q1&&!this.$1Q1[n].$1oN()},$8Je:function(n){return this.$34s(n)?this.$1Q4[n].$PX:null},$8F0:function(n){return this.$34r(n)?this.$1Q1[n].$PX:null},$8SQ:function(){var t=this.$1Q4;for(var n in t){var i={key:n,value:t[n]};if(i.value.$1oN())return!0}return!1},$8SJ:function(){var t=this.$1Q1;for(var n in t){var i={key:n,value:t[n]};if(i.value.$1oN())return!0}return!1}};_ex.$5K.$3iZ=function(n){this.$1aO=new Date;this.$PX=n};_ex.$5K.$3iZ.prototype={$1aO:null,$PX:null,$1oN:function(){var t=new Date;var n=t.getTime()-this.$1aO.getTime();return n>=(this.$PX.TTL-15)*6e4}};_ex.$1UG=function(){};_ex.$1UG.registerInterface("_ex.$1UG");_ex.$Ue=function(n,t,i){this.$2I=n;this.$FH=t;this.$1D=i||null};_ex.$Ue.prototype={$2I:null,$FH:null,$1D:null,$4Xu:function(n,t){return new _ex.$6E(n,this.$2I,t,this.$FH)},$4XG:function(n){return new _ex.$11Z(this.$FH,n,this.$1D)}};_ex.$11Z=function(n,t,i){this.$FH=n;this.$o4=t;this.$1D=i||null};_ex.$11Z.prototype={$FH:null,$1D:null,$o4:0,$61e:function(n,t){_a.$6.stPT(_a.$0.$4W,"AppActivationInComposeForm",5);for(var v=_a.$6.$1g(_a.$0.$4W,"AppActivationInComposeForm",!0),y=_a.$8.get_$38(),s=new(_ff.$18.$$(_ex.$7c)),r=0;r<n.length;r++){var l=n[r];var i;var f,h;if(h=_ex.$7c.$5di(l,new _ex.$lG(this.$FH,this.$o4),f={val:i}),i=f.val,h){var e=null;var p=_a.$8.get_$38();var c,o;var u=i.$xS?(o=i.$xS.$2Hj(null,i.$Vt,c={val:e}),e=c.val,o):!1;var a=_a.$8.get_$38();u&&s.$F(i);this.$FH.$5dF(l.Id,a.$6M(p),u)}}this.$FH.$5dK(_a.$8.get_$38().$6M(y));t(s);this.$AV();this.$FH.$4f4();_a.$6.$1G(v,"AppActivationInComposeForm");_a.$6.endPT("AppActivationInComposeForm")},$9k8:function(){return!0},$AV:function(){}};_ex.$6E=function(n,t,i,r){this.$b=n;this.$2Ne=i;this.$FH=r;this.$2I=t};_ex.$6E.get_$5Ch=function(){_ex.$6E.$2T5||(_ex.$6E.$2T5=["junkemail","drafts"]);return _ex.$6E.$2T5};_ex.$6E.prototype={$2Ne:!1,$b:null,$FH:null,$1Cu:null,$2I:null,$61e:function(n,t){var e=!0;this.$1Cu=new(_ff.$18.$$(_ex.$7c));for(var r=0;r<n.length;r++){var s=n[r];var f=new _ex.$lG(this.$FH,1);f.$ru=this.$2Ne;var i;var u,o;if(o=_ex.$7c.$5di(s,f,u={val:i}),i=u.val,o){this.$1Cu.$F(i);i.$xS&&(i.$xS.$4wR(this.$b,i.$Vt)||(e=!1))}}e?this.$4dI(t):this.$8aL(t)},$9k8:function(){if(this.$b.get_$9i()||this.$b.get_$Hz())return!1;if(this.$b.get_$CK()){var n=this.$b.get_$CK().toLowerCase();if(n.startsWith("report")||-1!==n.indexOf(".smime"))return!1}return this.$b.get_$3G()&&!this.$9k9(this.$b.get_$3G().Id)?!1:!0},$AV:function(){this.$1Cu=null},$9k9:function(n){if(!_ex.$6E.$1rm){_ex.$6E.$1rm={};for(var t=0;t<_ex.$6E.get_$5Ch().length;t++){var r=_ex.$6E.get_$5Ch()[t];var i=this.$2I.nameToId(r);i&&(_ex.$6E.$1rm[i.Id]=!0)}}return!(n in _ex.$6E.$1rm)},$4dI:function(n){if(this.$1Cu){_a.$6.stPT(_a.$0.$4W,"AppActivationInReadingPane",5);var c=_a.$6.$1g(_a.$0.$4W,"AppActivationInReadingPane",!0);var e=new(_ff.$18.$$(_ex.$7c));this.$FH.$5dH(this.$b.get_$2tW(),this.$b.get_$r8());for(var h=_a.$8.get_$38(),o=null,i=0;i<this.$1Cu.get_$A();i++){var t=this.$1Cu.get_$E(i);var l=_a.$8.get_$38();var f,u;var r=(u=this.$9kA(t,f={val:o}),o=f.val,u);var s=_a.$8.get_$38();if(r){e.$F(t);t.$9hS(this.$b.get_$r8())}this.$FH.$5dF(t.$5P.Id,s.$6M(l),r)}this.$FH.$5dK(_a.$8.get_$38().$6M(h));n(e);this.$AV();this.$FH.$4f4();_a.$6.$1G(c,"AppActivationInReadingPane","");_a.$6.endPT("AppActivationInReadingPane")}},$9kA:function(n,t){if($C(n)||$C(n.$xS))return!1;var i=!1;n.$Vt.$1Wz={};i=!!(i|n.$xS.$2Hj(this.$b,n.$Vt,t));return i},$8aL:function(n){var t=new _ex.$lk(this.$b);var i=this;t.add_$2s(function(t){i.$4dI(n)});OwaApplication.$2B.$1V(t)}};_ex.$jB=function(n,t,i,r){this.$$d_$9ws=Function.createDelegate(this,this.$9ws);this.$$d_$7Wz=Function.createDelegate(this,this.$7Wz);_ex.$jB.initializeBase(this,[i,r]);this.$75=n;this.$id=t};_ex.$jB.$8Ez=function(n){switch(n){case 0:return 9007;case 3:return 9e3;case 1:default:return 9007}};_ex.$jB.prototype={$75:null,$id:null,$tc:null,$7oo:function(){var n;if(!this.$9sa()){this.$gF();return}var r,i,t;if(t=this.$9s5(r={val:n},i={val:this.$tc}),n=r.val,this.$tc=i.val,t){this.$tc.add_$EE(this.$$d_$7Wz);this.$tc.add_$1GC(this.$$d_$9ws)}else{this.$Z4(n,null);return}},$9ws:function(n){this.$tc.remove_$1GC(this.$$d_$9ws);if(n.get_$3Sn()){var i=_ex.$jB.$8Ez(n.get_$32Q());this.$Z4(i,null);return}var t=this.$id.$F(this.$tc);this.$Tv(t,null)},$7Wz:function(n,t){if(t==="IsDeleted"&&this.$tc.get_$1dX()){this.$tc.remove_$EE(this.$$d_$7Wz);this.$Z4(9006,null)}}};_ex.$yW=function(n,t,i,r){_ex.$yW.initializeBase(this,[n,t,i,r])};_ex.$yW.prototype={get_$To:function(){return"AddFileAttachment"},get_$5IK:function(){return 3},$9sa:function(){var t=this.$1e.uri;var n=this.$1e.name;if(_js.$9.$o(t)||_js.$9.$o(n)){_js.Trace.logError(_a.$0.$4W,"AddFileAttachment got null or empty uri or name");return!1}else if(t.length>2048||n.length>255){_js.Trace.logError(_a.$0.$4W,"AddFileAttachment got too long uri or name");return!1}else return!0},$9s5:function(n,t){var r=this.$1e.uri;var i=this.$1e.name;t.val=this.$75.$4PL(r,i,n);return!!t.val}};_ex.$yX=function(n,t,i,r){_ex.$yX.initializeBase(this,[n,t,i,r])};_ex.$yX.prototype={get_$To:function(){return"AddItemAttachment"},get_$5IK:function(){return 3},$9sa:function(){var t=this.$1e.itemId;var n=this.$1e.name;if(_js.$9.$o(t)||_js.$9.$o(n)){_js.Trace.logError(_a.$0.$4W,"AddItemAttachment got null or empty itemId or name");return!1}else if(t.length>200||n.length>255){_js.Trace.logError(_a.$0.$4W,"AddItemAttachment got too long itemId or name");return!1}else return!0},$9s5:function(n,t){var r=this.$1e.itemId;var u=this.$1e.name;var i=new _g.$7S;i.set_$y(new _g.$1T(r));i.set_$1x(u);i.set_$CA(!1);i.set_$8D(0);t.val=this.$75.$4PQ(i,n);return!!t.val}};_ex.$jH=function(n,t,i,r){_ex.$jH.initializeBase(this,[t,i]);this.$75=n;this.$2F6=r};_ex.$jH.prototype={$2F6:!1,$75:null,get_$To:function(){return this.$2F6?"SetRecipients":"AddRecipients"},get_$5IK:function(){return 3},$9sB:function(n,t){t.val=new(_ff.$18.$$(_g.$1K));if($C(n)||!n.length)return!0;for(var o=n.length,u=0;u<o;u++){var e=n[u];var f=e.address;var r=e.name;if(!r&&!f){_js.Trace.logError(_a.$0.$4W,"Add/SetRecipientsAsync null for both displayName and address");this.$gF();return!1}if(r&&r.length>255){_js.Trace.logError(_a.$0.$4W,"Add/SetRecipientsAsync got displayName lengths over the limit");this.$gF();return!1}if(_a.$2i.$YR(f)){var i=new _g.$1K;i.EmailAddress=f;i.Name=r;i.MailboxType="OneOff";i.RoutingType="SMTP";t.val.$F(i)}}if(t.val.get_$A()>0)return!0;else{this.$Z4(9013,null);return!1}},$7oo:function(){var u=this.$1e.recipientField;var r=this.$1e.recipientArray;var n;if(r.length>100){_js.Trace.logError(_a.$0.$4W,"Add/SetRecipientsAsync got more recipients in the list than the limit.");this.$gF();return}var t,i;if(i=this.$9sB(r,t={val:n}),n=t.val,i){if(this.$2F6)this.$75.$9ie(u,n);else if(!this.$75.$9s3(u,n)){this.$Z4(9012,null);return}this.$Tv(null,null)}}};_ex.$1ZA=function(n,t){this.$1e=n;this.$1Gq=t};_ex.$1ZA.prototype={$1e:null,$1Gq:null,$Ej:null,$11:function(n){if(!this.$7pc(n)){_js.Trace.logError(_a.$0.$4W,String.format("API call failing due to insufficient permission {0}",this.get_$To()));this.$gF();return}_a.$6.stPT(_a.$0.$4W,this.get_$To(),5);this.$Ej=_a.$6.$1g(_a.$0.$4W,this.get_$To(),!0);this.$7oo()},$Tv:function(n,t){this.$1Gq(_ex.$1R.$4Y7(n));_a.$6.$1G(this.$Ej,this.get_$To(),"",t);_a.$6.endPT(this.get_$To())},$Z4:function(n,t){this.$1Gq(_ex.$1R.$7gM(n));_a.$6.$1G(this.$Ej,this.get_$To(),_ex.$F5.$8cB(n),t);_a.$6.endPT(this.get_$To())},$2WF:function(n,t){this.$1Gq(n);_a.$6.$1G(this.$Ej,this.get_$To(),"",t);_a.$6.endPT(this.get_$To())},$9PW:function(n,t,i){this.$1Gq(n);_a.$6.$1G(this.$Ej,this.get_$To(),t,i);_a.$6.endPT(this.get_$To())},$gF:function(){this.$1Gq(null);_a.$6.$1G(this.$Ej,this.get_$To(),"NonAPI",null);_a.$6.endPT(this.get_$To())},$7pc:function(n){return n===2?!0:this.get_$5IK()===2?!1:n>=this.get_$5IK()}};_ex.$zL=function(n,t,i,r){_ex.$zL.initializeBase(this,[n,t,i,r])};_ex.$zL.prototype={get_$To:function(){return"BodyPrepend"},get_$5IK:function(){return 3},$2NB:function(n){this.$75_1.$9Hu(n,this.$xx===3);this.$Tv(null,null)}};_ex.$zM=function(n,t,i,r){_ex.$zM.initializeBase(this,[n,t,i,r])};_ex.$zM.prototype={get_$To:function(){return"BodySetSelectedData"},get_$5IK:function(){return 3},$2NB:function(n){this.$75_1.$8QM(n,this.$xx===3);this.$Tv(null,null)}};_ex.$1ZB=function(){};_ex.$1ZB.$Vj=function(){};_ex.$1ZB.$Vj.prototype={text:0,html:3};_ex.$1ZB.$Vj.registerEnum("_ex.$1ZB.$Vj",!1);_ex.$11X=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$9ht=Function.createDelegate(this,this.$9ht);this.$$d_$8GL=Function.createDelegate(this,this.$8GL);this.$$d_$9jK=Function.createDelegate(this,this.$9jK);this.$$d_$8JQ=Function.createDelegate(this,this.$8JQ);_ex.$11X.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$N4=n};_ex.$11X.prototype={$N4:null,$1Il:function(n,t){n.itemType=5;var i=this;_ex.$1a9.prototype.$1Il.call(this,n,function(){t()})},$2Cu:function(n){n.$3y([_ex.$29.$9("GetTimeAsync",this.$$d_$8JQ),_ex.$29.$9("SetTimeAsync",this.$$d_$9jK),_ex.$29.$9("GetLocationAsync",this.$$d_$8GL),_ex.$29.$9("SetLocationAsync",this.$$d_$9ht)]);_ex.$1a9.prototype.$2Cu.call(this,n)},$8JQ:function(n,t){new _ex.$12R(this.$N4,n,t).$11(this.$8e.$5P.RequestedCapabilities)},$9jK:function(n,t){new _ex.$18O(this.$N4,n,t).$11(this.$8e.$5P.RequestedCapabilities)},$9ht:function(n,t){new _ex.$18G(this.$N4,n,t).$11(this.$8e.$5P.RequestedCapabilities)},$8GL:function(n,t){new _ex.$12C(this.$N4,n,t).$11(this.$8e.$5P.RequestedCapabilities)}};_ex.$1Ep=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){_ex.$1Ep.initializeBase(this,[n,t,i,r,u,!1,f,e,o,s,h,c,l,a,v,y,p,w])};_ex.$1Ep.prototype={$1Il:function(n,t){var r=this.$b.get_$CK()?this.$b.get_$CK().toLowerCase():"";if(_ex.$F9.$6Ow(r)){n.itemType=2;var i=this.$b;this.$A2J(i,n)}var u=this;_ex.$4e.prototype.$1Il.call(this,n,function(){t()})},$A2J:function(n,t){if(!this.get_$1LX()){_ex.$4e.$1wn(t,"to",n.get_$Bm(),n.get_$MD());_ex.$4e.$1wn(t,"cc",n.get_$DH(),null);_ex.$4e.$1wn(t,"resources",n.get_$EP(),null);n.get_$MD()&&_ex.$4e.$3gG(t,"organizer",n.get_$MD())}n.get_$6E()&&(t.location=n.get_$6E().get_$26());n.get_$1T()&&(t.start=n.get_$1T().$fF().getTime());n.get_$2y()&&(t.end=n.get_$2y().$fF().getTime())}};_ex.$1a9=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$8DS=Function.createDelegate(this,this.$8DS);this.$$d_$4dh=Function.createDelegate(this,this.$4dh);this.$$d_$4db=Function.createDelegate(this,this.$4db);this.$$d_$9Hv=Function.createDelegate(this,this.$9Hv);this.$$d_$9iv=Function.createDelegate(this,this.$9iv);this.$$d_$9iu=Function.createDelegate(this,this.$9iu);this.$$d_$8Ia=Function.createDelegate(this,this.$8Ia);this.$$d_$9j8=Function.createDelegate(this,this.$9j8);this.$$d_$8J5=Function.createDelegate(this,this.$8J5);this.$$d_$9if=Function.createDelegate(this,this.$9if);this.$$d_$7Ti=Function.createDelegate(this,this.$7Ti);this.$$d_$8Hr=Function.createDelegate(this,this.$8Hr);this.$$d_$1X4=Function.createDelegate(this,this.$1X4);this.$$d_$4PL=Function.createDelegate(this,this.$4PL);this.$$d_$4PQ=Function.createDelegate(this,this.$4PQ);_ex.$1a9.initializeBase(this,[t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$75=n};_ex.$1a9.prototype={$75:null,$id:null,get_$2Db:function(){return"ComposeAppSelection"},get_$4RT:function(){return"ComposeAppSelectionToProgressDone"},get_$32V:function(){this.$id||(this.$id=new(_ex.$Uh.$$(_y.$OU))(this.$8e.$5P.Id));return this.$id},$4PQ:function(n,t){new _ex.$yX(this.$75,this.get_$32V(),n,t).$11(this.$8e.$5P.RequestedCapabilities)},$4PL:function(n,t){new _ex.$yW(this.$75,this.get_$32V(),n,t).$11(this.$8e.$5P.RequestedCapabilities)},$1X4:function(n,t){new _ex.$17T(this.get_$32V(),n,t).$11(this.$8e.$5P.RequestedCapabilities)},$8Hr:function(n,t){new _ex.$VZ(this.$75,n,t).$11(this.$8e.$5P.RequestedCapabilities)},$9if:function(n,t){new _ex.$jH(this.$75,n,t,!0).$11(this.$8e.$5P.RequestedCapabilities)},$7Ti:function(n,t){new _ex.$jH(this.$75,n,t,!1).$11(this.$8e.$5P.RequestedCapabilities)},$8J5:function(n,t){new _ex.$12O(this.$75,n,t).$11(this.$8e.$5P.RequestedCapabilities)},$9j8:function(n,t){new _ex.$18N(this.$75,n,t).$11(this.$8e.$5P.RequestedCapabilities)},$8Ia:function(n,t){new _ex.$12M(this.$75,n,t).$11(this.$8e.$5P.RequestedCapabilities)},$9iu:function(n,t){new _ex.$18M(this.$75,n,t,this.$n).$11(this.$8e.$5P.RequestedCapabilities)},$9iv:function(n,t){new _ex.$zM(this.$75,n,t,this.$n).$11(this.$8e.$5P.RequestedCapabilities)},$9Hv:function(n,t){new _ex.$zL(this.$75,n,t,this.$n).$11(this.$8e.$5P.RequestedCapabilities)},$8DS:function(n,t){new _ex.$123(this.$75,n,t).$11(this.$8e.$5P.RequestedCapabilities)},$1Il:function(n,t){t()},$2Cu:function(n){_ex.$1R.prototype.$2Cu.call(this,n);n.$3y([_ex.$29.$9("AddItemAttachmentAsync",this.$$d_$4PQ),_ex.$29.$9("AddFileAttachmentAsync",this.$$d_$4PL),_ex.$29.$9("RemoveAttachmentAsync",this.$$d_$1X4),_ex.$29.$9("GetRecipientsAsync",this.$$d_$8Hr),_ex.$29.$9("AddRecipientsAsync",this.$$d_$7Ti),_ex.$29.$9("SetRecipientsAsync",this.$$d_$9if),_ex.$29.$9("GetSubjectAsync",this.$$d_$8J5),_ex.$29.$9("SetSubjectAsync",this.$$d_$9j8),_ex.$29.$9("GetSelectedDataAsync",this.$$d_$8Ia),_ex.$29.$9("SetSelectedDataAsync",this.$$d_$9iu),_ex.$29.$9("BodySetSelectedDataAsync",this.$$d_$9iv),_ex.$29.$9("BodyPrependAsync",this.$$d_$9Hv),_ex.$29.$9("LoadCustomProperties",this.$$d_$4db),_ex.$29.$9("SaveCustomProperties",this.$$d_$4dh),_ex.$29.$9("GetBodyTypeAsync",this.$$d_$8DS)])},$4dh:function(n,t){new _ex.$LD(this.$75,n,this.$8e.$5P.Id,t).$11(this.$8e.$5P.RequestedCapabilities)},$4db:function(n,t){new _ex.$14c(this.$75,n,this.$8e.$5P.Id,this.$n,t).$11(this.$8e.$5P.RequestedCapabilities)}};_ex.$1R=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$8ZU=Function.createDelegate(this,this.$8ZU);this.$$d_$7ov=Function.createDelegate(this,this.$7ov);this.$$d_$7ou=Function.createDelegate(this,this.$7ou);this.$$d_$7ow=Function.createDelegate(this,this.$7ow);this.$$d_$7p4=Function.createDelegate(this,this.$7p4);this.$$d_$9rS=Function.createDelegate(this,this.$9rS);this.$$d_$9Kf=Function.createDelegate(this,this.$9Kf);this.$$d_$9Kb=Function.createDelegate(this,this.$9Kb);this.$$d_$7pF=Function.createDelegate(this,this.$7pF);this.$$d_$7p1=Function.createDelegate(this,this.$7p1);this.$$d_$8Fl=Function.createDelegate(this,this.$8Fl);this.$$d_$98n=Function.createDelegate(this,this.$98n);this.$$d_$9rK=Function.createDelegate(this,this.$9rK);_a.$4.$z(a,"nativeBridge");this.$I=n;this.$kl=t;this.$tO=i;this.$LG=r;this.$PY=u;this.$y0=f;this.$xk=e;this.$zX=o;this.$sB=s;this.$zO=h;this.$fX=c;this.$l=a;this.$n=v;this.$6K=_a.$6j.$9()};_ex.$1R.get_$11b=function(){_ex.$1R.$2Dv||(_ex.$1R.$2Dv=String.format(_nbs.NonBootStrings.l_AsyncMethodNotExecutedBecauseAsyncLimitIsExceeded_Text,3));return _ex.$1R.$2Dv};_ex.$1R.get_$2Dy=function(){_ex.$1R.$2Dx||(_ex.$1R.$2Dx={wasSuccessful:!1,errorMessage:_ex.$1R.get_$11b()});return _ex.$1R.$2Dx};_ex.$1R.get_$7Wf=function(){_ex.$1R.$2Dw||(_ex.$1R.$2Dw={wasProxySuccessful:!1,errorMessage:_ex.$1R.get_$11b()});return _ex.$1R.$2Dw};_ex.$1R.get_$7Wg=function(){_ex.$1R.$2Dz||(_ex.$1R.$2Dz={error:1,errorMessage:_ex.$1R.get_$11b()});return _ex.$1R.$2Dz};_ex.$1R.$4Y7=function(n){return{error:0,data:n}};_ex.$1R.$7gM=function(n){return{error:1,errorCode:n}};_ex.$1R.$6Hf=function(n){switch(n){case"Mouse":return"ThreeColumns";case"TouchNarrow":return"OneColumn";case"TouchWide":return"TwoColumns"}return null};_ex.$1R.prototype={$1RW:0,$tO:null,$LG:null,$PY:null,$I:null,$kl:null,$J8:null,$Vt:null,$8e:null,$2U8:0,$1tz:null,$sB:null,$n:null,$y0:null,$xk:null,$zX:null,$zO:null,$fX:null,$1tp:null,$1ts:null,$11j:0,$2DV:0,$2UT:0,$1lR:!1,$2Cx:!1,$12K:null,$1Cq:null,$1Cr:null,$vZ:null,$1nn:!1,$l:null,$6K:null,$1sG:null,$2LH:0,get_$1LX:function(){return!this.$8e.$5P.RequestedCapabilities},$3e:function(n,t,i){this.$8e=n;this.$J8=t;this.$Vt=i;this.$1sG={};window.msWriteProfilerMark=this.$$d_$9rK},$9sw:function(){window.msWriteProfilerMark=null;this.$11j=0},$8Fl:function(n,t){var u=_a.$8.get_$38();var f=_a.$6.acsa(_a.$0.$4W,"GetInitialData",!0);var i={};i.permissionLevel=this.$8e.$5P.RequestedCapabilities;i.timeZoneOffsets=this.$8JR();i.hostVersion=this.$I.get_$2zv();i.owaView=_ex.$1R.$6Hf(this.$I.get_$U());i.overrideWindowOpen=this.$l.$8G(this.$l.get_$IF())&&this.$l.get_$IF().get_$2H9().get_$2PY();if(!this.get_$1LX()){i.userDisplayName=this.$LG;i.userEmailAddress=this.$PY;i.userTimeZone=this.$tO;i.ewsUrl=this.$J8.EwsUrl}var r=this;this.$1Il(i,function(){_a.$6.acea(f);r.$2LH=_a.$8.get_$38().$6M(u);t(i);r.$1lR=!0;r.$2gs()})},$9LL:function(){if(!this.$1nn){if(!this.$vZ){this.$vZ=new(_ff.$18.$$(_ex.$29));this.$2Cu(this.$vZ)}for(var t=0;t<this.$vZ.get_$A();t++){var n=this.$vZ.get_$E(t);this.$1tz.registerMethod(n.$WE,n.$m6,0,n.$32w)}this.$l.$8G(this.$l.get_$IF())&&this.$l.get_$IF().get_$2H9().get_$2PY()&&this.$1tz.unregisterMethod("ContextActivationManager_openWindowInHost");this.$1nn=!0}},$9tC:function(){if(this.$1nn&&this.$vZ){for(var n=0;n<this.$vZ.get_$A();n++){var t=this.$vZ.get_$E(n);this.$1tz.unregisterMethod(t.$WE)}this.$1nn=!1}},$7p1:function(n,t){_a.$6.stPT(_a.$0.$4W,"ExecuteEwsRequest",5);this.$12K=_a.$6.$1g(_a.$0.$4W,"ExecuteEwsRequest",!0);var i=this.$8e.$5P;if(i.RequestedCapabilities!==2){_js.Trace.logInfo(_a.$0.$4W,"Ext host: Extension '{0}' has insufficient permission for ExecuteEwsRequest",i.DisplayName);t(_ex.$1R.$1S3);this.$Gj(this.$12K,"ExecuteEwsRequest","Failed",null);return}var s=n;var e=s.body;var o=_ex.$5K.get_$Q();if($C(e)||this.$nZ(e.length,_y.$Uf.$41K,"ExecuteEwsRequest")){t(_ex.$1R.$1S3);this.$Gj(this.$12K,"ExecuteEwsRequest","Failed",null);return}var r,u;if(!(u=this.$1QJ(r={val:t},_ex.$1R.get_$7Wf()),t=r.val,u)){this.$Gj(this.$12K,"ExecuteEwsRequest",_ex.$1R.get_$11b(),null);return}if(!o.$34r(i.Id)||o.$8SJ()){var h=this,f=this;this.$4X5("ExtensionCallback",function(r){h.$5Eo(i,n,t)},function(n){t({wasProxySuccessful:!1});f.$Gj(f.$12K,"ExecuteEwsRequest","Failed",n)})}else this.$5Eo(i,n,t)},$7pF:function(n,t){_a.$6.stPT(_a.$0.$4W,"ExecuteSaveSettingsRequest",5);this.$1Cr=_a.$6.$1g(_a.$0.$4W,"ExecuteSaveSettingsRequest",!0);var u=this.$8e;var c=n;var o=c[0];var s=JsonParser.serialize(o);if(this.$nZ(s.length,32768,"ExecuteSaveSettingsRequest")){t({error:1});this.$Gj(this.$1Cr,"ExecuteSaveSettingsRequest","Failed",null);return}var h,f;if(!(f=this.$1QJ(h={val:t},_ex.$1R.get_$7Wg()),t=h.val,f)){this.$Gj(this.$1Cr,"ExecuteSaveSettingsRequest",_ex.$1R.get_$11b(),null);return}var i=new _ex.$pD(u.$5P.Id,u.$5P.Version,s);var r=this;i.add_$2s(function(n){if(i.get_$4d().WasSuccessful){u.set_$5WD(o);t({error:0});r.$Gj(r.$1Cr,"ExecuteSaveSettingsRequest","",n)}else{t({errorMessage:i.get_$4d().ErrorMessage,error:1});r.$Gj(r.$1Cr,"ExecuteSaveSettingsRequest",i.get_$4d().ErrorMessage,n)}});var e=this;i.add_$2b(function(n){t({errorMessage:i.$2H.message,error:1});e.$Gj(e.$1Cr,"ExecuteSaveSettingsRequest",i.$2H.message,n)});this.$n.$1V(i)},$7p4:function(n,t){_a.$6.stPT(_a.$0.$4W,"ExecuteGetUserIdentityTokenRequest",5);this.$1Cq=_a.$6.$1g(_a.$0.$4W,"ExecuteGetUserIdentityTokenRequest",!0);if(this.get_$1LX()){_js.Trace.logInfo(_a.$0.$4W,"Ext host: Extension '{0}' has insufficient permission for ExecuteGetUserIdentityToken",this.$8e.$5P.DisplayName);t(_ex.$1R.$1S3);this.$Gj(this.$1Cq,"ExecuteGetUserIdentityTokenRequest","InsufficientPermission",null);return}var u=_ex.$5K.get_$Q();var r=this.$8e.$5P.Id;if(!u.$34s(r)||u.$8SQ()){var e,o;if(!(o=this.$1QJ(e={val:t},_ex.$1R.get_$2Dy()),t=e.val,o)){this.$Gj(this.$1Cq,"ExecuteGetUserIdentityTokenRequest",_ex.$1R.get_$11b(),null);return}var i=this,f=this;this.$4X5("CallerIdentity",function(n){i.$5Er(r,t);i.$Gj(i.$1Cq,"ExecuteGetUserIdentityTokenRequest","",n)},function(n){t({wasSuccessful:!1});f.$Gj(f.$1Cq,"ExecuteGetUserIdentityTokenRequest","Failed",n)})}else{this.$5Er(r,t);this.$Gj(this.$1Cq,"ExecuteGetUserIdentityTokenRequest","",null)}},$7ow:function(n,t){var u=n;var i=this.$7sd(u);if(!i){t(null);return}var r=this;this.$y0.$9(function(n){if(r.$I.get_$U()==="Mouse"){var f=n.$3AP(i);r.$I.$VL(IComposeCalendarItemViewModelFactory,null,null,_bc.$2I.get_$rB(),f,!1)}else{var u=n.$wd(i.$60,null,null);r.$5YY(u)}t(null)})},$7ou:function(n,t){var f=n;var u=f.itemId;if(_js.$9.$o(u)){t(null);return}var i=new _y.$BD;i.$n5(new _g.$1T(u));var r=this;this.$xk.$9(function(n){if(r.$I.get_$U()==="Mouse")r.$I.$VL(ICalendarItemDetailsViewModelFactory,null,i.$60,_bc.$2I.get_$rB(),null,!1);else{var u=n.$wd(i.$60,null,null);r.$5YY(u)}t(null)})},$7ov:function(n,t){var i=n;this.$8Fx(i.itemId,this.$$d_$98n);t(null)},$8ZU:function(n,t){if(this.$l.$8G(this.$l.get_$IF())){var i=n.launchUrl;i&&this.$l.get_$IF().$2PX(i)}t(null)},$9Kb:function(n,t){var r=n;if(this.$8e.$5P.Origin===3){var i=new _ex.$11i(this.$8e.$5P.DisplayName.replace(_ex.$1R.$1wP,""));i.$9H4(r);i.$1V()}t(null)},$9Kf:function(n,t){var i=n;if(this.$8e.$5P.Origin!==3){t(null);return}var f=_a.$0.$4W;var u="[{0}] {1}";var r=this.$8e.$5P.DisplayName.replace(_ex.$1R.$1wP,"");switch(i.TraceLevel){case"Warning":_js.Trace.logWarning(f,u,r,i.Message);break;case"Error":_js.Trace.logError(f,u,r,i.Message);break;default:break}t(null)},$9rS:function(n,t){var r=n;if(this.$8e.$5P.Origin!==3){t(null);return}var i=this.$8e.$5P.DisplayName.replace(_ex.$1R.$1wP,"")+"."+r.Name.replace(_ex.$1R.$1wP,"");var u=r.Event;switch(u){case"Start":_a.$6.$1g(_a.$0.$4W,i);break;case"End":_a.$6.$1G(null,i);break;default:break}t(null)},setServiceEndPoint:function(n){this.$1tz=n},$8JR:function(){return this.$kl.$3F9(this.$tO)},$7Gi:function(){this.$1lR=!1;this.$2Cx=!1;this.$2DV=0;this.$2LH=0;this.$1RW=0;this.$2UT=0;_a.$6.stPT(_a.$0.$4W,this.get_$2Db(),5);this.$1tp=_a.$6.$1g(_a.$0.$4W,this.get_$2Db(),!0);this.$1ts=_a.$6.$1g(_a.$0.$4W,this.get_$4RT(),!0)},$2gs:function(){if(this.$1tp){this.$38i(!1);var n=this.$1lR?"":"Failed";_a.$6.$1G(this.$1tp,this.get_$2Db(),n,null,this.$4oX());_a.$6.endPT(this.get_$2Db());this.$1tp=null}},$38i:function(n){if(this.$1ts){_a.$6.$1G(this.$1ts,this.get_$4RT(),n?"":"Failed",null,this.$4oX());this.$1ts=null}},$Gj:function(n,t,i,r){i||(i="");var u=null;r&&(_ex.$lK.isInstanceOfType(r)&&r.$68?u=r.$68.correlationId:_ex.$pD.isInstanceOfType(r)&&r.$68?u=r.$68.correlationId:_ex.$WP.isInstanceOfType(r)&&r.$68?u=r.$68.correlationId:_ex.$pC.isInstanceOfType(r)&&r.$68?u=r.$68.correlationId:_ex.$le.isInstanceOfType(r)&&r.$68?u=r.$68.correlationId:_ex.$Ve.isInstanceOfType(r)&&r.$68&&(u=r.$68.correlationId));n?_a.$6.$1G(n,t,i,u):_a.$6.$1G(null,t,i,u);_a.$6.endPT(t)},$2Cu:function(n){n.$3y([_ex.$29.$7fe("GetInitialData",this.$$d_$8Fl),_ex.$29.$9("EwsRequest",this.$$d_$7p1),_ex.$29.$9("saveSettingsAsync",this.$$d_$7pF),_ex.$29.$9("RecordDataPoint",this.$$d_$9Kb),_ex.$29.$9("RecordTrace",this.$$d_$9Kf),_ex.$29.$9("TrackCtq",this.$$d_$9rS),_ex.$29.$9("GetUserIdentityToken",this.$$d_$7p4),_ex.$29.$9("DisplayNewAppointmentForm",this.$$d_$7ow),_ex.$29.$9("DisplayExistingAppointmentForm",this.$$d_$7ou),_ex.$29.$9("DisplayExistingMessageForm",this.$$d_$7ov),_ex.$29.$9("LaunchPalUrl",this.$$d_$8ZU)])},$316:function(n){this.$2UT|=n},$nZ:function(n,t,i){if(n>t){_js.Trace.logWarning(_a.$0.$4W,"{0} in ext host: Extension '{1}' exceeded limit of {2}, actual is {3}.",i,this.$8e.$5P.DisplayName,t,n);return!0}return!1},$1QJ:function(n,t){if(this.$2U8<3){var r=n.val;var i=this;n.val=function(n){i.$7dM();r(n)};this.$2U8++;return!0}n.val(t);return!1},$7dM:function(){this.$2U8--},$9rK:function(n){if(!_js.$9.$o(n)){n===OSF.NotificationUxPerfMarker.RemoveLoadingAnimationEnd?this.$38i(!0):n===OSF.OsfControlActivationPerfMarker.SelectionTimeout?this.$38i(!1):n===OSF.OsfControlActivationPerfMarker.ActivationStart&&this.$2DV++;if(n.endsWith("Start")){n=n.substr(0,n.length-5);var i=_a.$6.acsa(_a.$0.$4W,n,!0);this.$1sG[n]=i}else if(n.endsWith("End")){n=n.substr(0,n.length-3);var t=this.$1sG[n];if(t){_a.$6.acea(t);delete this.$1sG[n]}}}},$5Er:function(n,t){var i="";_ex.$5K.get_$Q().$34s(n)&&(i=_ex.$5K.get_$Q().$8Je(n).TokenValue);t({wasSuccessful:!0,token:i})},$4X5:function(n,t,i){for(var f=new(_ff.$18.$$(String)),r=0;r<this.$J8.Extensions.length;r++){var e=this.$J8.Extensions[r];(n==="CallerIdentity"&&e.RequestedCapabilities>=1||n==="ExtensionCallback"&&e.RequestedCapabilities===2)&&f.$F(this.$J8.Extensions[r].Id)}var u=new _ex.$le(f.$3Q(),n);u.add_$2s(t);u.add_$2b(i);this.$n.$1V(u)},$5Eo:function(n,t,i){var s=t;var o=s.body;var f="";if(_ex.$5K.get_$Q().$34r(n.Id)){f=_ex.$5K.get_$Q().$8F0(n.Id).TokenValue;var r=new _ex.$lK(o,f,n.Id);var u=this;r.add_$2s(function(n){i({wasProxySuccessful:r.get_$4d().WasProxySuccessful,errorMessage:r.get_$4d().ErrorMessage,statusCode:r.get_$4d().StatusCode,statusDescription:r.get_$4d().StatusDescription,body:r.get_$4d().Body});u.$Gj(u.$12K,"ExecuteEwsRequest","",r)});var e=this;r.add_$2b(function(n){i({wasProxySuccessful:!1,errorMessage:r.$2H.message,statusCode:500,statusDescription:r.$2H.message,body:null});e.$Gj(e.$12K,"ExecuteEwsRequest",r.$2H.message,r)});this.$n.$1V(r)}else i({wasProxySuccessful:!0,errorMessage:null,statusCode:200,statusDescription:"",body:""})},$4oX:function(){if(!this.$11j){var r=this.$6K.$64("ExtAppVistedUrls");var u=this.$8e.$1RY.toLowerCase();this.$11j=_js.$9.$o(r)?3:-1!==r.indexOf(u)?1:2}if(!this.$2Cx&&this.$1lR&&this.$11j!==1){var t=this.$6K.$64("ExtAppVistedUrls");var i=this.$8e.$1RY.toLowerCase();if(t){t.length>5e3&&(t=t.substr(i.length));t+=i}else t=i;this.$6K.$I7("ExtAppVistedUrls",t);this.$2Cx=!0}var n=new _a.$3z;n.$5H("G",this.$2LH);n.$5H("S",this.$11j);this.$1RW&&n.$5H("E",this.$1RW);n.$5H("R",this.$2DV);n.$5H("F",this.$2UT);n.$CX("Id",this.$8e.$5P.Id);n.$CX("Name",this.$8e.$5P.DisplayName);return n.toString()},$98n:function(n){if(n.get_$Hz()){var i=this;this.$sB.$9(function(t){var r=t.$H5(!0,!1);r.$4sg(n);i.$zX.$9(function(n){i.$I.$VL(IMailComposeViewModelFactory,function(){return n},null,_bc.$2I.get_$rB(),r,!1)})})}else{var t=this;this.$zO.$9(function(i){var r=i.$9(!1);r.set_$E(n);t.$fX.$9(function(n){t.$I.$VL(IItemReadingPaneViewModelPopOutFactory,function(){return n},null,_bc.$2I.get_$rB(),r,!1)})})}},$7sd:function(n){var t=new _bc.$Nj;if("requiredAttendees"in n){t.set_$Bm(new _js.$X);var e=n.requiredAttendees;if(this.$nZ(e.length,100,"ExecuteDisplayNewAppointmentForm.requiredAttendees"))return null;for(var f=0;f<e.length;f++)t.get_$Bm().$F(_g.$2o.$4fv(e[f]))}if("optionalAttendees"in n){t.set_$DH(new _js.$X);var o=n.optionalAttendees;if(this.$nZ(o.length,100,"ExecuteDisplayNewAppointmentForm.optionalAttendees"))return null;for(var i=0;i<o.length;i++)t.get_$DH().$F(_g.$2o.$4fv(o[i]))}if("start"in n&&!$C(n.start)){var v=n.start;var w=new Date(v);t.set_$1T(_a.$8.$4ft(w))}else{var a=_a.$1y.$35O(_a.$8.get_$38());t.set_$1T(a)}if("end"in n){var p=n.end;var y=new Date(p);t.set_$LO(_a.$8.$4ft(y).$6M(t.get_$1T()))}else t.set_$LO(18e5);if("subject"in n){var s=n.subject;if(this.$nZ(s.length,255,"ExecuteDisplayNewAppointmentForm.subject"))return null;t.set_$3o(s)}if("body"in n){var u=n.body;if(this.$nZ(u.length,32768,"ExecuteDisplayNewAppointmentForm.Body"))return null;var r;r=this.$I.get_$U()==="Mouse"?new _g.$5d("HTML",_a.$1J.$4Wo(u)):new _g.$5d("Text",u);var l=new _g.$5E(r);t.set_$4n(l)}var h=_g.$3Q.$1CR();if("location"in n){var c=n.location;if(this.$nZ(c.length,255,"ExecuteDisplayNewAppointmentForm.location"))return null;h.set_$26(c)}t.set_$6E(h);return t},$8Fx:function(n,t){var f=_h.$o.get_$Q();var i=f.$64(n);if($C(i)||$C(i.get_$4n()))if(!$C(i)&&i.get_$Hz())this.$4nU(n,i.get_$106(),t);else{var u=this;var r=function(i){i.get_$Hz()?u.$4nU(n,i.get_$106(),t):t(i)};this.$3c4(n,_h.$f.get_$3zi(),"ItemNormalizedBody",r)}else t(i)},$4nU:function(n,t,i){var r;r=this.$I.get_$U()==="Mouse"&&t!==1?_h.$f.get_$24c():_h.$f.get_$3Lk();this.$3c4(n,r,"MailCompose",i)},$3c4:function(n,t,i,r){var f=new _g.$1T(n);var u=new _h.$ll(100,[f],t,i,0,!1);var e=this;u.add_$2s(function(t){var i=_h.$o.get_$Q().$64(n);r(i)});this.$n.$1V(u)},$5YY:function(n){this.$I.$Az(n)}};_ex.$Ug=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$kl=n;this.$LG=t;this.$PY=i;this.$tO=r;this.$I=u;this.$zO=f;this.$fX=e;this.$sB=o;this.$1M8=s;this.$1E=h;this.$l=c;this.$n=l;this.$1D=a};_ex.$Ug.prototype={$kl:null,$LG:null,$PY:null,$tO:null,$I:null,$sB:null,$1M8:null,$zO:null,$fX:null,$1D:null,$xk:null,$zX:null,$y0:null,$1E:null,$l:null,$n:null,$4Xf:function(n,t){return new _ex.$11e(this.$I,this.$kl,this.$tO,this.$LG,this.$PY,t,this.$y0,this.$xk,this.$zX,this.$sB,this.$1M8,this.$zO,this.$fX,n,this.$1E,this.$l,this.$n,this.$1D)},$7fo:function(n){return new _ex.$1Ep(this.$I,this.$kl,this.$tO,this.$LG,this.$PY,this.$y0,this.$xk,this.$zX,this.$sB,this.$1M8,this.$zO,this.$fX,n,this.$1E,this.$l,this.$n,this.$1D)},$5up:function(n){return new _ex.$11d(n,this.$I,this.$kl,this.$tO,this.$LG,this.$PY,this.$y0,this.$xk,this.$zX,this.$sB,this.$zO,this.$fX,this.$1E,this.$l,this.$n)},$5u2:function(n){return new _ex.$11X(n,this.$I,this.$kl,this.$tO,this.$LG,this.$PY,this.$y0,this.$xk,this.$zX,this.$sB,this.$zO,this.$fX,this.$1E,this.$l,this.$n)}};_ex.$11d=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){_ex.$11d.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$39C=n};_ex.$11d.prototype={$39C:null,$1Il:function(n,t){n.itemType=4;n.conversationId=this.$39C.$4nG();var i=this;_ex.$1a9.prototype.$1Il.call(this,n,function(){t()})}};_ex.$11e=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){_ex.$11e.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b])};_ex.$11e.prototype={$1Il:function(n,t){var i=this.$b.get_$CK()?this.$b.get_$CK().toLowerCase():"";if(_ex.$F9.$4wo(i)){if(_g.$9y.isInstanceOfType(this.$b)){n.itemType=3;this.$7T1(n)}else n.itemType=1;this.$8aN(n,t)}else _ex.$4e.prototype.$1Il.call(this,n,t)},$8aN:function(n,t){var r=this.$b;n.conversationId=r.get_$5O()?r.get_$5O().Id:null;n.internetMessageId=r.get_$HS();if(this.get_$1LX())_ex.$4e.prototype.$1Il.call(this,n,t);else if(r.$22M){this.$316(16);var i=new _h.$lc(this.$b.get_$y());var f=this;i.add_$2b(function(){_js.Trace.logWarning(_a.$0.$4W,"GetAllRecipients to fetch extra recipients failed "+i.$2H);f.$316(256)});var u=this;i.add_$4Q(function(){u.$4Q0(n,t)});OwaApplication.$2B.$1V(i)}else this.$4Q0(n,t)},$4Q0:function(n,t){var i=this.$b;_ex.$4e.$3gG(n,"from",i.get_$5Q());_ex.$4e.$3gG(n,"sender",i.get_$Em());_ex.$4e.$4PP(n,"to",i.get_$79());_ex.$4e.$4PP(n,"cc",i.get_$7x());n.itemType===3&&this.$7UR(n);_ex.$4e.prototype.$1Il.call(this,n,t)},$7UR:function(n){var t=this.$b;_ex.$4e.$1wn(n,"to",t.get_$Q4().get_$Bm(),t.get_$Q4().get_$MD());_ex.$4e.$1wn(n,"cc",t.get_$Q4().get_$DH(),null);_ex.$4e.$1wn(n,"resources",t.get_$Q4().get_$EP(),null)},$7T1:function(n){var t=this.$b;t.get_$Q4().get_$6E()&&(n.location=t.get_$Q4().get_$6E().get_$26());t.get_$Q4().get_$1T()&&(n.start=t.get_$Q4().get_$1T().$fF().getTime());t.get_$Q4().get_$2y()&&(n.end=t.get_$Q4().get_$2y().$fF().getTime())}};_ex.$Uh=function(n){this.$1rv={};this.$32l=n};_ex.$Uh.$$=function(n){var t="$Uh"+"$"+n.getName().replace(/\./g,"_");if(!_ex[t]){var r=_ex[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_ex.$Uh.apply(this,t)};r.registerClass("_ex."+t);var e={"_ex.$Uh":{T:n}};r.prototype.$$gta=e;var f=_ex.$Uh.prototype;for(var u in f){var i={key:u,value:f[u]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _ex[t]};_ex.$Uh.prototype={$32l:null,$18X:0,$F:function(n){var t=this.$32l+(+new Date).toString()+this.$18X.toString();this.$1rv[t]=n;this.$18X++;return t},$7UX:function(n,t){this.$1rv[n]=t;return n},$9PK:function(n,t){var i=this.$1rv[n];t&&delete this.$1rv[n];return i}};_ex.$4e=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){this.$$d_$7ox=Function.createDelegate(this,this.$7ox);this.$$d_$7oy=Function.createDelegate(this,this.$7oy);this.$$d_$4dh=Function.createDelegate(this,this.$4dh);this.$$d_$4db=Function.createDelegate(this,this.$4db);this.$$d_$7p3=Function.createDelegate(this,this.$7p3);_ex.$4e.initializeBase(this,[n,t,i,r,u,e,o,s,h,l,a,y,p,w]);this.$jb=f;this.$b=v;this.$1D=b;this.$1M8=c};_ex.$4e.$3gG=function(n,t,i){$C(i)||(n[t]=_ex.$4e.$4Xw(i.Mailbox))};_ex.$4e.$4PP=function(n,t,i){if(!$C(i)&&i.get_$A()>0){for(var f=[],r=0;r<i.get_$A()&&r<100;r++){var u=i.get_$E(r);$C(u)||(f[r]=_ex.$4e.$4Xw(u))}n[t]=f}};_ex.$4e.$1wn=function(n,t,i,r){var f=null;var o=0;var s=!1;if(r&&r.Mailbox){s=!0;f=new Array(0);f[o++]=_ex.$4e.$4XA(r.Mailbox,"Organizer")}if(!$C(i)&&i.get_$A()>0){f||(f=new Array(0));for(var e=0;e<i.get_$A()&&o<100;e++){var u=i.get_$E(e);if(u&&u.get_$AB()){if(s&&r.Mailbox.EmailAddress&&u.get_$AB().EmailAddress&&u.get_$AB().EmailAddress.toLowerCase()===r.Mailbox.EmailAddress.toLowerCase())continue;f[o++]=_ex.$4e.$4XA(u.get_$AB(),u.get_$iA())}}}n[t]=f};_ex.$4e.$4Xw=function(n){var t={};t.name=n.Name;t.address=n.EmailAddress;t.recipientType=_ex.$4e.$3Lv(n.MailboxType);return t};_ex.$4e.$3Lv=function(n){switch(n){case"PublicDL":case"PrivateDL":case"PublicFolder":return 1;case"Mailbox":case"Contact":return 2;case"OneOff":return 3;default:return 0}};_ex.$4e.$7St=function(n,t){if(!$C(t)&&t.get_$A()>0){for(var f=[],u=0;u<t.get_$A();u++){var i=t.get_$E(u);var r={};if(i){r.id=i.get_$6J().Id;r.name=i.get_$1x();r.contentType=i.get_$KN();r.size=i.get_$8D();r.attachmentType=_g.$54.isInstanceOfType(i)?0:1;r.isInline=i.get_$CA();f[u]=r}}n.attachments=f}};_ex.$4e.$4XA=function(n,t){var r={};r.name=n.Name;r.address=n.EmailAddress;r.recipientType=_ex.$4e.$3Lv(n.MailboxType);var i=0;switch(t){case"Organizer":i=1;break;case"Tentative":i=2;break;case"Accept":i=3;break;case"Decline":i=4;break;case"NoResponseReceived":i=5;break}r.appointmentResponse=i;return r};_ex.$4e.prototype={$jb:!1,$1D:null,$1M8:null,$b:null,get_$2Db:function(){return"ReadAppSelection"},get_$4RT:function(){return"ReadAppSelectionToProgressDone"},$7p3:function(n,t){_a.$6.stPT(_a.$0.$4W,"ExecuteGetCallbackTokenRequest",5);var i=_a.$6.$1g(_a.$0.$4W,"ExecuteGetCallbackTokenRequest",!0);if(this.get_$1LX()){_js.Trace.logInfo(_a.$0.$4W,"Ext host: Extension '{0}' has insufficient permission for ExecuteGetCallbackToken",this.$8e.$5P.DisplayName);t(_ex.$1R.$1S3);this.$Gj(i,"ExecuteGetCallbackTokenRequest","InsufficientPermission",null);return}var f,e;if(!(e=this.$1QJ(f={val:t},_ex.$1R.get_$2Dy()),t=f.val,e)){this.$Gj(i,"ExecuteGetCallbackTokenRequest",_ex.$1R.get_$11b(),null);return}var r=new _ex.$Ve(this.$8e.$5P.Id,String.format("ParentItemId:{0}",this.$b.get_$y().Id));var u=this;r.add_$2s(function(n){u.$98z(t,n);u.$Gj(i,"ExecuteGetCallbackTokenRequest","",n)});var o=this;r.add_$2b(function(n){t({wasSuccessful:!1});o.$Gj(i,"ExecuteGetCallbackTokenRequest","Failed",n)});OwaApplication.$2B.$1V(r)},$4db:function(n,t){_a.$6.stPT(_a.$0.$4W,"ExecuteLoadCustomPropRequest",5);var r=_a.$6.$1g(_a.$0.$4W,"ExecuteLoadCustomPropRequest",!0);var s=n;var i=new _ex.$WP(this.$8e.$5P.Id,this.$b.get_$y().Id);var f,u;if(!(u=this.$1QJ(f={val:t},_ex.$1R.get_$2Dy()),t=f.val,u)){this.$Gj(r,"ExecuteLoadCustomPropRequest","InsufficientPermission",null);return}var e=this;i.add_$2s(function(n){t({errorMessage:i.get_$4d().ErrorMessage,wasSuccessful:i.get_$4d().WasSuccessful,customProperties:i.get_$4d().CustomProperties});e.$Gj(r,"ExecuteLoadCustomPropRequest","",n)});var o=this;i.add_$2b(function(n){t({errorMessage:i.$2H.message,wasSuccessful:!1,customProperties:null});o.$Gj(r,"ExecuteLoadCustomPropRequest",i.$2H.message,n)});OwaApplication.$2B.$1V(i)},$4dh:function(n,t){_a.$6.stPT(_a.$0.$4W,"ExecuteSaveCustomPropRequest",5);var r=_a.$6.$1g(_a.$0.$4W,"ExecuteSaveCustomPropRequest",!0);var c=n;var h=c.customProperties;var e=JsonParser.serialize(h);if(this.$nZ(e.length,2500,"ExecuteSaveCustomPropertiesRequest")){t(_ex.$1R.$1S3);this.$Gj(r,"ExecuteSaveCustomPropRequest","Failed",null);return}var u,f;if(!(f=this.$1QJ(u={val:t},_ex.$1R.get_$2Dy()),t=u.val,f)){this.$Gj(r,"ExecuteSaveCustomPropRequest",_ex.$1R.get_$11b(),null);return}var i=new _ex.$pC(this.$8e.$5P.Id,this.$b.get_$y().Id,e);var o=this;i.add_$2s(function(n){t({errorMessage:i.get_$4d().ErrorMessage,wasSuccessful:i.get_$4d().WasSuccessful});o.$Gj(r,"ExecuteSaveCustomPropRequest","",n)});var s=this;i.add_$2b(function(n){t({errorMessage:i.$2H.message,wasSuccessful:!1});s.$Gj(r,"ExecuteSaveCustomPropRequest",i.$2H.message,n)});OwaApplication.$2B.$1V(i)},$7oy:function(n,t){if(!this.$8Wl()){t(null);return}var r="";var i=n;if(i&&"htmlBody"in i){r=i.htmlBody;if(this.$nZ(r.length,32768,"ExecuteDisplayReplyForm.htmlBody")){t(null);return}}this.$5YJ(1,r);t(null)},$7ox:function(n,t){if(!this.$8Wk()){t(null);return}var r="";var i=n;if(i&&"htmlBody"in i){r=i.htmlBody;if(this.$nZ(r.length,32768,"ExecuteDisplayReplyAllForm.htmlBody")){t(null);return}}this.$5YJ(2,r);t(null)},$1Il:function(n,t){if(this.$8Uv())this.$8aM(n,t);else{this.$30o(n);t()}},$2Cu:function(n){_ex.$1R.prototype.$2Cu.call(this,n);n.$3y([_ex.$29.$9("GetCallbackToken",this.$$d_$7p3),_ex.$29.$9("LoadCustomProperties",this.$$d_$4db),_ex.$29.$9("SaveCustomProperties",this.$$d_$4dh),_ex.$29.$9("DisplayReplyForm",this.$$d_$7oy),_ex.$29.$9("DisplayReplyAllForm",this.$$d_$7ox)])},$30o:function(n){n.id=this.$b.get_$y().Id;n.itemClass=this.$b.get_$CK();this.$b.get_$1Ce()&&(n.dateTimeCreated=this.$b.get_$1Ce().$fF().getTime());this.$b.get_$Jq()&&(n.dateTimeModified=this.$b.get_$Jq().$fF().getTime());this.$b.get_$173()&&(n.dateTimeSent=this.$b.get_$173().$fF().getTime());$C(this.$b.get_$r8())||(n.entities=this.$8F2(this.$b.get_$r8()));var i=this.$Vt.$er.$8Eb();i&&(n.filteredEntities=i);if(!this.get_$1LX()){n.subject=this.$b.get_$3o();n.normalizedSubject=this.$b.get_$14H();var t=this.$Vt.$1Wz;$C(t)||(n.regExMatches=t);_ex.$4e.$7St(n,this.$b.get_$EW())}},$8Uv:function(){if(this.$b.get_$r8())return!1;var n=this.$b.get_$2tW();return n?n.ExtractedAddresses||n.ExtractedContacts||n.ExtractedEmails||n.ExtractedMeetings||n.ExtractedPhones||n.ExtractedTasks||n.ExtractedUrls:!1},$8aM:function(n,t){var i=new _ex.$lk(this.$b);var u=_a.$8.get_$38();var f=this;i.add_$2s(function(i){f.$1RW=_a.$8.get_$38().$6M(u);f.$30o(n);t()});var r=this;i.add_$2b(function(f){_js.Trace.logWarning(_a.$0.$4W,"GetItem to fetch entities failed "+i.$2H);r.$316(1);r.$1RW=_a.$8.get_$38().$6M(u);r.$30o(n);t()});OwaApplication.$2B.$1V(i)},$8F2:function(n){var t={};t.Addresses=_ex.$3l.$12w(n.Addresses,3,this.$jb);t.Urls=_ex.$3l.$12w(n.Urls,4,this.$jb);t.PhoneNumbers=_ex.$3l.$12w(n.PhoneNumbers,5,this.$jb);if(!this.get_$1LX()){t.Contacts=_ex.$3l.$12w(n.Contacts,7,this.$jb);t.EmailAddresses=_ex.$3l.$12w(n.EmailAddresses,6,this.$jb);t.MeetingSuggestions=_ex.$3l.$12w(n.MeetingSuggestions,1,this.$jb);t.TaskSuggestions=_ex.$3l.$12w(n.TaskSuggestions,2,this.$jb)}return t},$5YJ:function(n,t){var i=this;this.$sB.$9(function(r){var u=r.$H5(!0,!1);u.set_$6X(n);u.$1Tj(i.$b);var e=u.$1kK(!0);var f;if(n===1)f=new _g.$gg;else if(n===2)f=new _g.$gf;else return;f.$3eO(e.get_$Ad());f.set_$2Ss(new _g.$5E(new _g.$5d("HTML",t)));f.set_$2u0(i.$b.get_$y());u.$6NI(f);i.$1M8.$9(function(n){var t=n.$4Xz(u,f,i.$1D);t.$M9=0;t.add_$2s(function(n){_js.Trace.logInfo(_a.$0.$4W,"Create response action succeeded");var t=n;if(t.$99===u.get_$D1()){u.$AV();u.set_$5j(0);u.set_$6X(4);u.set_$Fd(t.$5i);var i=new _y.$Cc;i.$WM(u)}});OwaApplication.$2B.$1V(t)})})},$8Wk:function(){return this.$b?_g.$2g.isInstanceOfType(this.$b)?this.$b.get_$11n():!0:!1},$8Wl:function(){return this.$b?_g.$2g.isInstanceOfType(this.$b)?this.$b.get_$xs():!0:!1},$98z:function(n,t){var i="";t&&_ex.$Ve.isInstanceOfType(t)&&t.$PX&&(i=t.$PX.TokenValue);n({wasSuccessful:!0,token:i})}};_ex.$123=function(n,t,i){_ex.$123.initializeBase(this,[t,i]);this.$75=n};_ex.$123.prototype={$75:null,get_$To:function(){return"GetBodyType"},get_$5IK:function(){return 1},$7oo:function(){var t=this.$75.$2L2();var n=null;t==="Text"?n="text":t==="HTML"&&(n="html");this.$Tv(n,null)}};_ex.$12C=function(n,t,i){_ex.$12C.initializeBase(this,[t,i]);this.$N4=n};_ex.$12C.prototype={$N4:null,get_$To:function(){return"GetLocation"},get_$5IK:function(){return 1},$7oo:function(){var n=this.$N4.$3Ej();this.$Tv(n,null)}};_ex.$VZ=function(n,t,i){_ex.$VZ.initializeBase(this,[t,i]);this.$75=n};_ex.$VZ.$7s2=function(n){var u=[];if(!n)return u;for(var f=n.get_$A()>100?100:n.get_$A(),t=0;t<f;t++){var r=n.get_$E(t).get_$2VR();var i={};i.recipientType=_ex.$4e.$3Lv(r.get_$2Z().MailboxType);i.address=r.get_$2Z().EmailAddress||null;i.name=r.get_$26();u[t]=i}return u};_ex.$VZ.prototype={$75:null,get_$To:function(){return"GetRecipients"},get_$5IK:function(){return 1},$7oo:function(){var i=this.$1e.recipientField;var t=this.$75.$8Hq(i);var n=_ex.$VZ.$7s2(t);this.$Tv(n,null)}};_ex.$12O=function(n,t,i){_ex.$12O.initializeBase(this,[t,i]);this.$75=n};_ex.$12O.prototype={$75:null,get_$To:function(){return"GetSubject"},get_$5IK:function(){return 1},$7oo:function(){var n=this.$75.$v7();this.$Tv(n||"",null)}};_ex.$12M=function(n,t,i){_ex.$12M.initializeBase(this,[t,i]);this.$75=n};_ex.$12M.prototype={$75:null,get_$To:function(){return"GetSelectedData"},get_$5IK:function(){return 1},$7oo:function(){var e=this.$1e;var n=0;var t;var s=e.coercionType;var f,r,u;var o=(u=this.$75.$8IZ(s===_ex.$1ZB.$Vj.toString(3)?_ex.$1ZB.$Vj.toString(3):_ex.$1ZB.$Vj.toString(0),f={val:t},r={val:n}),t=f.val,n=r.val,u);if(n)this.$Z4(n,null);else{var i={};i.data=o;i.sourceProperty=t;this.$Tv(i,null)}}};_ex.$12R=function(n,t,i){_ex.$12R.initializeBase(this,[t,i]);this.$N4=n};_ex.$12R.prototype={$N4:null,get_$To:function(){return"GetTime"},get_$5IK:function(){return 1},$7oo:function(){var n=null;var t=this.$1e.TimeProperty;t===1?n=this.$N4.$3tA():t===2&&(n=this.$N4.$3sb());this.$Tv(n.$fF().getTime(),null)}};_ex.$14c=function(n,t,i,r,u){this.$$d_$2nr=Function.createDelegate(this,this.$2nr);this.$$d_$2nu=Function.createDelegate(this,this.$2nu);_ex.$14c.initializeBase(this,[t,u]);this.$N5=i;this.$75=n;this.$n=r};_ex.$14c.prototype={$N5:null,$75:null,$n:null,get_$To:function(){return"ExecuteLoadCustomPropRequestForCompose"},get_$5IK:function(){return 0},$7oo:function(){var t=this.$75.$3ES();if(t)for(var n=t.get_$A()-1;n>=0;n--)if(_h.$6B.$4ur(t.get_$E(n),this.$N5)){this.$2WF({wasSuccessful:!0,customProperties:t.get_$E(n).get_$1Z()},null);return}var r=this.$75.$2LJ();if(!r){this.$2WF({wasSuccessful:!0,customProperties:"{}"},null);return}var u=this.$1e;var i=new _ex.$WP(this.$N5,this.$75.$2LJ());i.add_$2s(this.$$d_$2nu);i.add_$2b(this.$$d_$2nr);this.$n.$1V(i)},$2nu:function(n){var t=n;var r={wasSuccessful:t.get_$4d().WasSuccessful,customProperties:t.get_$4d().CustomProperties};if(!_js.$9.$o(t.get_$4d().CustomPropertyNames)){var i=this.$75.$3ES();_h.$6B.$4PZ(i,t.get_$4d().CustomPropertyNames)}this.$2WF(r,n.$99)},$2nr:function(n){_js.Trace.logError(_a.$0.$4W,"custom properties load failed with "+n.$2H);var t={errorMessage:n.$2H.message,wasSuccessful:!1,customProperties:null};this.$9PW(t,n.$2H.message,n.$99)}};_ex.$17T=function(n,t,i){this.$$d_$5xl=Function.createDelegate(this,this.$5xl);_ex.$17T.initializeBase(this,[t,i]);this.$id=n};_ex.$17T.prototype={$id:null,$11d:null,$1Pl:null,get_$To:function(){return"RemoveAttachment"},get_$5IK:function(){return 3},$7oo:function(){this.$1Pl=this.$1e.attachmentIndex;if(this.$1Pl.length>200){_js.Trace.logError(_a.$0.$4W,"RemoveFileAttachment got too long attachmentId");this.$gF();return}if(!this.$1Pl){_js.Trace.logError(_a.$0.$4W,"RemoveAttachment got null or empty attachmentIndex");this.$gF();return}this.$11d=this.$id.$9PK(this.$1Pl,!0);if(!this.$11d){this.$Z4(9008,null);return}if(this.$11d.get_$1dX()){this.$Tv(null,null);return}this.$11d.add_$1s4(this.$$d_$5xl);this.$11d.get_$1Cg().$11()},$5xl:function(n){this.$11d.remove_$1s4(this.$$d_$5xl);if(n.get_$3Sn()){this.$id.$7UX(this.$1Pl,this.$11d);this.$Z4(9009,null);return}this.$Tv(null,null)}};_ex.$LD=function(n,t,i,r){_ex.$LD.initializeBase(this,[t,r]);this.$N5=i;this.$75=n};_ex.$LD.prototype={$N5:null,$75:null,get_$To:function(){return"ExecuteSaveCustomPropRequestCompose"},get_$5IK:function(){return 0},$7oo:function(){var f=this.$1e;var e=f.customProperties;var u=JsonParser.serialize(e);if(u.length>2500){this.$gF();return}for(var r=_h.$6B.$7gQ(this.$N5,u),n=this.$75.$3ES(),i=!1,t=0;t<n.get_$A();t++)if(_h.$6B.$4ur(n.get_$E(t),this.$N5)){n.set_$E(t,r);i=!0;break}i||this.$7Ta(n,r);this.$75.$8cG();this.$2WF(_ex.$LD.$4Z8,null)},$7Ta:function(n,t){n.$F(t);_h.$6B.$4PZ(n,t.get_$M0().get_$Ms())}};_ex.$1a6=function(n,t,i,r){this.$$d_$9Q5=Function.createDelegate(this,this.$9Q5);this.$$d_$9Q6=Function.createDelegate(this,this.$9Q6);_ex.$1a6.initializeBase(this,[t,i]);this.$75_1=n;this.$n=r};_ex.$1a6.prototype={$75_1:null,$n:null,$xx:0,$7oo:function(){var i=this.$1e;var n=i.data;if(n.length>1e6){this.$gF();return}var u,r;if(r=this.$9xc(i.coercionType,u={val:this.$xx}),this.$xx=u.val,r)if(this.$xx===3)if(_js.$9.$o(n))this.$2NB("");else{var t=new _ex.$17i(n);t.add_$2s(this.$$d_$9Q6);t.add_$2b(this.$$d_$9Q5);this.$75_1.$9oC();this.$n.$1V(t)}else this.$75_1.$2L2()==="HTML"?this.$2NB(_ff.$2c.$Jh(n)):this.$2NB(n)},$9Q5:function(n){_js.Trace.logError(_a.$0.$4W,"Sanitize html failed with "+n.$2H);this.$Z4(9011,null)},$9Q6:function(n){_js.Trace.logInfo(_a.$0.$4W,"Sanitize html succeeded.");if(this.$75_1.$2L2()==="HTML"){var u=n;var t=u.get_$4d();var r;this.$9NR(r={val:t}),t=r.val;var i=this;this.$75_1.$7b8(function(n){n?i.$Z4(9014,null):i.$2NB(t)})}else this.$Z4(2006,null)},$9NR:function(n){n.val=n.val.trim();n.val.substr(0,5).toLowerCase()==="<div>"&&n.val.substr(n.val.length-6,6).toLowerCase()==="</div>"&&(n.val=n.val.substring(5,n.val.length-6))},$9xc:function(n,t){var i=this.$75_1.$2L2();t.val=n;if(!$C(n)){if(i==="Text"&&t.val===3){this.$Z4(2006,null);return!1}return!0}this.$gF();return!1}};_ex.$18G=function(n,t,i){_ex.$18G.initializeBase(this,[t,i]);this.$N4=n};_ex.$18G.prototype={$N4:null,get_$To:function(){return"SetLocation"},get_$5IK:function(){return 3},$7oo:function(){var n=this.$1e.location;if(n.length>255)this.$gF();else{this.$N4.$9hr(n);this.$Tv(null,null)}}};_ex.$18N=function(n,t,i){_ex.$18N.initializeBase(this,[t,i]);this.$75=n};_ex.$18N.prototype={$75:null,get_$To:function(){return"SetSubject"},get_$5IK:function(){return 3},$7oo:function(){var n=this.$1e.subject;if(n.length>255){this.$gF();return}this.$75.$9j7(n);this.$Tv(null,null)}};_ex.$18M=function(n,t,i,r){_ex.$18M.initializeBase(this,[n,t,i,r]);this.$75=n};_ex.$18M.prototype={$75:null,get_$To:function(){return"SetSelectedData"},get_$5IK:function(){return 3},$2NB:function(n){var t;var i;this.$75.$9it(n,this.$xx===3,i={val:t}),t=i.val;t?this.$Z4(t,null):this.$Tv(null,null)}};_ex.$18O=function(n,t,i){_ex.$18O.initializeBase(this,[t,i]);this.$N4=n};_ex.$18O.prototype={$N4:null,get_$To:function(){return"SetTime"},get_$5IK:function(){return 3},$7oo:function(){var i=this.$1e.TimeProperty;var r=this.$1e.time;var n=_a.$8.$rH(new Date(r));var t=!0;i===1?this.$N4.$9j3(n):i===2&&(t=this.$N4.$9sW(n));t?this.$Tv(null,null):this.$Z4(9010,null)}};_ex.$29=function(n,t,i){this.$WE=n;this.$m6=t;this.$32w=i};_ex.$29.$9=function(n,t){return new _ex.$29(n,t,!1)};_ex.$29.$7fe=function(n,t){return new _ex.$29(n,t,!0)};_ex.$29.prototype={$WE:null,$32w:!1,$m6:null};_ex.$19n=function(n,t){this.$1ZQ=n;this.$3D=t};_ex.$19n.prototype={$1ZQ:null,$3D:null,get_$EzF:function(){return this.$1ZQ},get_$1x:function(){return this.$3D},get_$8D:function(){return 0},get_$6k:function(){return""}};_ex.$kU=function(n,t){this.$$d_$2ID=Function.createDelegate(this,this.$2ID);this.$$d_$3td=Function.createDelegate(this,this.$3td);_ex.$kU.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_ex.$kU.initializeBase(this);this.$65=n;this.$QC=t;if(this.$QC==="TouchNarrow"){this.set_$A2(_y.$1i.$FE(this));var r=this;var i=new _C(function(){r.$5N()},_a.$0.$4W);this.$5w.set_$Tw([_y.$1P.$SG(_nbs.NonBootStrings.l_Close_LowerCase_Text,i)])}};_ex.$kU.prototype={$QC:0,$7c:null,$65:null,$vJ:!1,$11z:null,$pU:null,get_$2tB:function(){return 2},get_$3tc:function(){return this.$$d_$3td},get_$h1:function(){return this.$7c},set_$h1:function(n){this.$7c=n;return n},get_$7ly:function(){return!0},get_$SA:function(){return this.$QC==="TouchNarrow"?1:0},$3td:function(n,t){if(this.$vJ)return!1;if(this.$pU){this.$11z=n;this.$pU(this.$$d_$2ID);return!0}this.$2ID();return!1},$5N:function(){if(!this.$vJ&&this.$7c){this.$7c();this.$65.$32i(!1)}},$2ID:function(){this.$vJ=!0;this.$11z&&this.$11z()}};_ex.$KN=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.$$d_$98M=Function.createDelegate(this,this.$98M);this.$$d_$5FQ=Function.createDelegate(this,this.$5FQ);this.$$d_$4ed=Function.createDelegate(this,this.$4ed);this.$$d_$6pp=Function.createDelegate(this,this.$6pp);this.$$d_$96G=Function.createDelegate(this,this.$96G);this.$$d_$99C=Function.createDelegate(this,this.$99C);this.$$d_$7E7=Function.createDelegate(this,this.$7E7);_ex.$KN.initializeBase(this,[r,u,f,e,o,s,h,c,l,a,v,y,p,w]);_a.$6.stPT(_a.$0.$4W,"EnableAppsButton",5);this.$1uu=_a.$6.$1g(_a.$0.$4W,"EnableAppsButton",!0);this.$FF=t;this.set_$31m(_nbs.NonBootStrings.l_ComposeAppsForOutlook_Text);this.set_$3GE(!1);this.set_$1Pe(!0);this.$2DZ=i;this.$15X=new _C(this.$$d_$7E7,n);this.$15X.set_$87(!1);this.$3GC=new _C(this.$$d_$99C,n);this.$32j=new _C(this.$$d_$96G,n)};_ex.$KN.prototype={$13e:null,$2Da:null,$2MR:!1,$2DZ:null,$1YV:!1,$2IV:!1,$1Pd:!1,$2DY:0,$15X:null,$3GC:null,$32j:null,$2Dg:!1,$FF:null,$So:null,$1uu:null,add_$2TP:function(n){this.$32("OnAppsPaneOpened",n)},remove_$2TP:function(n){this.$5d("OnAppsPaneOpened",n)},add_$5Dt:function(n){this.$32("OnAppsPaneClosed",n)},remove_$5Dt:function(n){this.$5d("OnAppsPaneClosed",n)},add_$2Tb:function(n){this.$32("OnExtensionOpened",n)},remove_$2Tb:function(n){this.$5d("OnExtensionOpened",n)},add_$3Ru:function(n){this.$32("BackToList",n)},remove_$3Ru:function(n){this.$5d("BackToList",n)},get_$2xe:function(){return this.$15X},set_$7rn:function(n){if(this.$2IV!==n){this.$2IV=n;this.$4("ForceHideAppsButton")}return n},get_$5Xc:function(){return this.$1YV},set_$5Xc:function(n){if(this.$1YV!==n){this.$1YV=n;this.$4("ShowAppsButton")}return n},get_$3hN:function(){return this.$2DY},set_$3hN:function(n){if(this.$2DY!==n){this.$2DY=n;this.$4("AppPaneSize")}return n},get_$1Pe:function(){return this.$1Pd},set_$1Pe:function(n){if(this.$1Pd!==n){this.$1Pd=n;this.$4("AppPaneIsHidden")}return n},get_$13S:function(){return this.$FF.$aW===1},get_$6UJ:function(){return this.$VJ.get_$U()==="TouchNarrow"},set_$50p:function(n){this.$13e=n;if(n.$d2===3){var t=this.$13e.$38w.get_$2g().extensionViewModel;this.$1Mz(t)}return n},set_$31m:function(n){if(this.$2Da!==n){this.$2Da=n;this.$4("AppPaneTitle")}return n},set_$3GE:function(n){if(this.$2MR!==n){this.$2MR=n;this.$4("HideExtensionsList")}return n},get_$2Oz:function(){return this.$VJ.get_$U()!=="Mouse"},$73:function(){this.$5Lf();this.set_$1Pe(!0);this.$8NU();this.$FF&&this.$FF.$p("Orientation",this.$$d_$6pp);_ex.$2H.prototype.$73.call(this)},$AJ:function(){this.$9su();this.$FF&&this.$FF.$1B("Orientation",this.$$d_$6pp);_ex.$2H.prototype.$AJ.call(this)},$1Mz:function(n){if(n){this.set_$3GE(!0);this.set_$22S(!1);this.set_$31m(n.get_$1lQ().DisplayName);if(this.$l.$8G(this.$l.get_$IF())){var t=this;this.$l.get_$IF().$4cy(n.get_$4d5(),n.get_$1lQ().DisplayName,function(){t.$5No(n)},this.$$d_$4ed)}else this.$5No(n)}else this.$l.$8G(this.$l.get_$IF())?this.$l.get_$IF().$4dr():this.$4ed()},$7E7:function(){_a.$6.stPT(_a.$0.$4W,"ShowAppPane",3);var n=_a.$6.$1g(_a.$0.$4W,"ShowAppPane",!0);if(this.$VJ.get_$U()==="Mouse"){if(this.$1Pd){this.set_$3hN(342);this.set_$1Pe(!1);this.$5Dr(1)}}else if(this.$VJ.get_$U()!=="TouchNarrow"&&this.$FF.$aW)this.set_$1Pe(!1);else{this.$So=this.$2Hv.$7g0(this,this.$VJ.get_$U());this.$So.$pU=this.$$d_$5FQ;this.$VJ.$Az(this.$So)}this.$6T("OnAppsPaneOpened");_a.$6.$1G(n,"ShowAppPane","");_a.$6.endPT("ShowAppPane")},$22Q:function(n){if(!this.$1Pd){var t=null;if(n){_a.$6.stPT(_a.$0.$4W,"HideAppPane",3);t=_a.$6.$1g(_a.$0.$4W,"HideAppPane",!0)}this.$32i(!1);this.set_$3hN(0);this.set_$1Pe(!0);this.$6T("OnAppsPaneClosed");this.$5Dr(2);if(n){_a.$6.$1G(t,"HideAppPane","");_a.$6.endPT("HideAppPane")}}},$32i:function(n){var t=null;if(n){_a.$6.stPT(_a.$0.$4W,"CloseComposeApp",3);t=_a.$6.$1g(_a.$0.$4W,"CloseComposeApp",!0)}this.$1Mz(null);if(n){_a.$6.$1G(t,"CloseComposeApp","");_a.$6.endPT("CloseComposeApp")}},$4aU:function(n){return!n},$96G:function(){this.$32i(!0)},$6pp:function(n,t){this.get_$13S()?this.$So&&this.$So.$5N():this.$22Q(!1);this.$6T("OnAppsPaneClosed")},$99C:function(){this.$VJ.get_$U()!=="TouchWide"||this.get_$13S()?this.$22Q(!0):this.$So&&this.$So.$5N()},$5No:function(n){this.$6T("OnExtensionOpened");_ex.$2H.prototype.$1Mz.call(this,n);this.$1WO(!0)},$4ed:function(){this.$1tO(!0);this.set_$31m(_nbs.NonBootStrings.l_ComposeAppsForOutlook_Text);this.set_$3GE(!1);this.$6T("BackToList");_ex.$2H.prototype.$1Mz.call(this,null)},$8NU:function(){this.$p(_ex.$2H.$46r,this.$$d_$98M);this.$p(_ex.$2H.$41G,this.$$d_$98M);this.$p("ForceHideAppsButton",this.$$d_$98M);this.$2Dg=!0},$9su:function(){if(this.$2Dg){this.$1B(_ex.$2H.$46r,this.$$d_$98M);this.$1B(_ex.$2H.$41G,this.$$d_$98M);this.$1B("ForceHideAppsButton",this.$$d_$98M);this.$2Dg=!1}},$98M:function(n,t){(t===_ex.$2H.$46r||t===_ex.$2H.$41G||t==="ForceHideAppsButton")&&this.$5Lf()},$5Dr:function(n){this.$2DZ&&this.$2DZ(n)},$5FQ:function(n){this.$1Mz(null);n()},$5Lf:function(){this.set_$5Xc(!this.$2IV&&(!this.$46q||!!this.$1Ur));this.$15X.set_$87(this.$1YV);if(this.$1uu&&this.$1YV){_a.$6.$1G(this.$1uu,"EnableAppsButton");_a.$6.endPT("EnableAppsButton");this.$1uu=null}}};_ex.$11a=function(){_ex.$11a.initializeBase(this,[1,"VM.Extensibility.Stats"])};_ex.$11a.prototype={set_$7eS:function(n){this.$P("ContextRetrievalTime",n);return n},set_$7eP:function(n){this.$P("ContextExtensionsCount",n);return n},set_$8cn:function(n){this.$P("MaxCountOfActiveExtensions",n);return n},set_$7Qs:function(n){this.$P("ActivationTime",n);return n},set_$9r0:function(n){this.$P("TotalActivationStatistics",n);return n},set_$9L8:function(n){this.$P("RegExStatistics",n);return n},set_$9Fi:function(n){this.$P("PerExtensionStatistics",n);return n},set_$vI:function(n){this.$P("Interval",n);return n},set_$7sH:function(n){this.$P("FromHtmlStatistics",n);return n},set_$8QD:function(n){this.$P("InnerTextStatistics",n);return n},set_$8Ne:function(n){this.$P("HtmlBodyLengthStatistics",n);return n},set_$7es:function(n){this.$P("ConvertedBodyLengthStatistics",n);return n},set_$7oT:function(n){this.$P("EntityStatistics",n);return n}};_ex.$F5=function(){};_ex.$F5.$8cB=function(n){var i=n.toString();var t=_ex.$F5.$L2[i];if(!t){t=_js.$1I.$Gy(_y.$11b,n);_ex.$F5.$L2[i]=t}return t};_ex.$BH=function(n,t){this.$$d_$9RQ=Function.createDelegate(this,this.$9RQ);this.$$d_$9HI=Function.createDelegate(this,this.$9HI);_ex.$BH.initializeBase(this);this.$Ij=n;this.$iF=t;this.$10L=new _C(this.$$d_$9HI,_a.$0.$4W);this.$1Jp=new _fm.$1u(new Array(0));this.$rA=new _js.$X};_ex.$BH.prototype={$p7:0,$Ij:null,$rA:null,$1Jp:null,$iF:null,$2MQ:!0,$1I1:null,$13e:null,$10L:null,set_$4r5:function(n){if(this.$2MQ!==n){this.$2MQ=n;this.$4(_ex.$BH.$4r6)}return n},set_$2aH:function(n){if(this.$1I1!==n){this.$1I1=n;$C(n)||this.$4(_ex.$BH.$3cZ)}return n},set_$50p:function(n){this.$13e=n;if(n.$d2===3){var t=this.$13e.$38w.get_$2g().extensionViewModel;if($C(t)||this.$1I1===t){this.$iF.$8e=null;this.$iF.$11();this.$Vi()}else{this.$iF.$8e=t;this.$iF.$11();this.set_$2aH(t)}}return n},$Vi:function(){this.$1I1=null;this.$4(_ex.$BH.$3cZ)},$9HI:function(){if(!(this.$p7<1)){var n=0;var i=this.$Ij.get_$A();var e=!1;var t=this.$1I1;var r=this.$p7;this.$rA.$1u();while(n<r&&n<i){var o=this.$Ij.get_$E(n);var u=n+1===r||n+1===i;($C(t)||o.$5P.Id===t.$5P.Id)&&(e=!0);var f=u&&!e?t:this.$Ij.get_$E(n);this.$rA.$F(f);f.set_$4wX(u&&i<=r);n++}this.set_$2aH(t);this.$4AA()}},$9RQ:function(n){n.set_$4wX(!1);this.$rA.$5W(this.$rA.get_$A()-1);this.$rA.$F(n);this.$iF.$8e=n;this.$iF.$11();this.set_$2aH(n);this.$4AA()},$4AA:function(){var i=this.$Ij.get_$A();if(i>this.$p7){var t=0;this.$1Jp.$1a.$1u();while(t<i){var n=this.$Ij.get_$E(t);if(this.$rA.$7r(n)<0){var r=new _fm.$d(n.$5P.DisplayName,null,new _ex.$bX(this.$$d_$9RQ,n),!0);this.$1Jp.$1a.$F(r)}t++}this.set_$4r5(!1)}else{this.$1Jp.$1a.$1u();this.set_$4r5(!0)}}};_ex.$lM=function(n,t,i){this.$$d_$4ef=Function.createDelegate(this,this.$4ef);this.$$d_$2ID=Function.createDelegate(this,this.$2ID);this.$$d_$3td=Function.createDelegate(this,this.$3td);_ex.$lM.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_ex.$lM.initializeBase(this);this.$65=n;this.$QC=i;if(i!=="Mouse"){this.set_$A2(_y.$1i.$FE(this));var e=this;var o=new _C(function(){e.$5N()},_a.$0.$4W);this.$5w.set_$Tw([_y.$1P.$SG(_nbs.NonBootStrings.l_Close_LowerCase_Text,o)])}if(i==="TouchWide"&&t.get_$2P6())if(_g.$2g.isInstanceOfType(this.$65.$b))this.set_$3KL(this.$65.$b.get_$4n().get_$1Z());else if(this.$65.$b.get_$Mq()&&this.$65.$b.get_$Mq().get_$1Z())this.set_$3KL(this.$65.$b.get_$Mq().get_$1Z());else{var r=_ff.$1o.$4o(_h.$f.get_$3zi());r.MaximumBodySize=0;r.MaximumRecipientsToReturn=0;var u=new _h.$Fz(100,[this.$65.$b.get_$y()],r,"ItemNormalizedBody",0,!1);var f=this;u.add_$2s(function(n){f.set_$3KL(f.$65.$b.get_$Mq().get_$1Z())});OwaApplication.$2B.$1V(u)}};_ex.$lM.prototype={$QC:0,$7c:null,$65:null,$pU:null,$3KK:null,$vJ:!1,$11z:null,set_$3KL:function(n){this.$3KK=n;this.$4("ItemBodyValue");return n},get_$2tB:function(){return 4},get_$3tc:function(){return this.$$d_$3td},get_$h1:function(){return this.$7c},set_$h1:function(n){this.$7c=n;return n},get_$7ly:function(){return!0},get_$SA:function(){return this.$QC!=="Mouse"?1:0},$3td:function(n,t){if(this.$vJ)return!1;if(this.$pU){this.$11z=n;this.$pU(this.$$d_$2ID);return!0}this.$2ID();return!1},$5N:function(){this.$vJ||(this.$QC==="TouchNarrow"?this.$pU?this.$pU(this.$$d_$4ef):this.$4ef():this.$7c&&this.$7c())},$4ef:function(){this.$vJ=!0;this.$7c&&this.$7c()},$2ID:function(){this.$vJ=!0;this.$11z&&this.$11z()}};_ex.$Ui=function(){};_ex.$Ui.prototype={$7gR:function(n,t,i){return new _ex.$lM(n,t,i)},$7g0:function(n,t){return new _ex.$kU(n,t)}};_ex.$11f=function(){this.$$d_$4nO=Function.createDelegate(this,this.$4nO);this.$3Kn=_a.$8.$mH;this.$11M=[];this.$1Cs={};this.$1Ct={}};_ex.$11f.prototype={$52C:100,$36T:6e5,$nX:null,$bG:null,$TM:null,$1Cp:null,$5dI:function(n,t){if(!this.$1ut()){this.$TM||(this.$TM=new _ex.$11f.$4e5);if(!this.$TM.$1t5){this.$TM.$1t5=[];this.$TM.$1X0=[]}Array.add(this.$TM.$1t5,n);Array.add(this.$TM.$1X0,t)}},$9rW:function(n){this.$1Ct[n]=$C(this.$1Ct[n])?1:this.$1Ct[n]+1},$5dF:function(n,t,i){i&&(this.$1Cs[n]=$C(this.$1Cs[n])?1:this.$1Cs[n]+1);if(!this.$1ut()){this.$TM||(this.$TM=new _ex.$11f.$4e5);this.$TM.$3bd=t;this.$TM.$30c=i;this.$TM.$2O=n;this.$nX||(this.$nX=new _ex.$11f.$4Oc);Array.add(this.$nX.$2My,this.$TM);this.$TM=null}},$5dH:function(n,t){if(!this.$1ut()){this.$1Cp||(this.$1Cp=new _ex.$11f.$7pk);this.$1Cp.$5dH(n,t)}},$5dK:function(n){if(!this.$1ut()){this.$nX||(this.$nX=new _ex.$11f.$4Oc);this.$nX.$3dN=n;Array.add(this.$11M,this.$nX);this.$nX=null}},$9rR:function(n,t,i,r){if(!this.$1ut()){this.$bG||(this.$bG=new _ex.$11f.$7Y2);this.$bG.$3GS.$2W(n,null);this.$bG.$3H6.$2W(r,null);this.$bG.$3AK.$2W(i,null);this.$bG.$35C.$2W(t,null)}},$4f4:function(){var n=_a.$8.get_$38();if(n.$6M(this.$3Kn)>=this.$36T){_a.$i.$Ii.$7Rs(this.$$d_$4nO);this.$9OH();this.$3Kn=n}},$9OH:function(){this.$11M=[];this.$1Cs={};this.$1Ct={};this.$nX=null;this.$TM=null;this.$bG=null;this.$1Cp=null},$uY:function(n){var t=new Sys.StringBuilder;if($C(_ex.$4W.$en))t.append("Extensions are not initialized yet.");else{n&&t.append('<TABLE class="errorReportingTable">');t.appendLine(this.$4nO().$Gy(n));n&&t.append("</TABLE>")}return new _a.$F4("Pending Extensibility Statistics",t.toString())},$4nO:function(){var l=_ex.$4W.$en.Extensions.length;var n=new _ex.$11a;n.set_$7eS(_ex.$4W.$2PQ);n.set_$7eP(l);if(this.$11M.length>0){for(var e=0,h=new _ex.$Gz,i={},c=new _ex.$Gz,r=0;r<this.$11M.length;r++){var u=this.$11M[r];h.$2W(u.$3dN,null);for(var f=0,s=0;s<u.$2My.length;s++){var t=u.$2My[s];var o=t.$2O;t.$30c&&f++;$C(i[o])&&(i[o]=new _ex.$Gz);i[o].$2W(t.$3bd,null);t.$9w6(c)}f>e&&(e=f)}n.set_$8cn(e);n.set_$7Qs(this.$11M.length);n.set_$9r0(h.$wn());n.set_$9Fi(this.$9SV(i));n.set_$9L8(c.$wn());n.set_$vI(this.$36T/1e3);if(this.$bG){n.set_$7sH(this.$bG.$3AK.$wn());n.set_$8QD(this.$bG.$3H6.$wn());n.set_$8Ne(this.$bG.$3GS.$wn());n.set_$7es(this.$bG.$35C.$wn())}this.$1Cp&&n.set_$7oT(this.$1Cp.$wn())}return n},$9SV:function(n){for(var t=new Sys.StringBuilder,r=0;r<_ex.$4W.$en.Extensions.length;r++){var i=_ex.$4W.$en.Extensions[r];var f=$C(this.$1Cs[i.Id])?0:this.$1Cs[i.Id];var u=$C(this.$1Ct[i.Id])?0:this.$1Ct[i.Id];t.append("[");t.append(i.Id);t.append(",");t.append(i.DisplayName);t.append(";");t.append(n[i.Id]?n[i.Id].$wn():"");t.append(";");t.append(f.toString());t.append(",");t.append(u.toString());t.append("]")}return t.toString()},$1ut:function(){return this.$11M.length>=this.$52C||!_js.Trace.$43}};_ex.$11f.$4Oc=function(){this.$2My=[]};_ex.$11f.$4Oc.prototype={$3dN:0};_ex.$11f.$7Y2=function(){this.$3AK=new _ex.$Gz;this.$3H6=new _ex.$Gz;this.$3GS=new _ex.$Gz;this.$35C=new _ex.$Gz};_ex.$11f.$4e5=function(){};_ex.$11f.$4e5.prototype={$2O:null,$1t5:null,$1X0:null,$3bd:0,$30c:!1,$9w6:function(n){if(this.$1X0)for(var t=0;t<this.$1X0.length;t++)n.$2W(this.$1X0[t],this.$1t5[t])}};_ex.$11f.$7pk=function(){};_ex.$11f.$7pk.prototype={$3QU:0,$3QV:0,$3QW:0,$3QX:0,$3QY:0,$3QZ:0,$3Qa:0,$14C:null,$5dH:function(n,t){this.$14C=null;var i=!t;if(n){var r=new(_ff.$18.$$(_g.$BN));if(n.ExtractedAddresses&&(i||!t.Addresses)){this.$1Ba(3);this.$3QU++}if(n.ExtractedContacts&&(i||!t.Contacts)){this.$1Ba(7);this.$3QV++}if(n.ExtractedEmails&&(i||!t.EmailAddresses)){this.$1Ba(6);this.$3QW++}if(n.ExtractedMeetings&&(i||!t.MeetingSuggestions)){this.$1Ba(1);this.$3QX++}if(n.ExtractedPhones&&(i||!t.PhoneNumbers)){this.$1Ba(5);this.$3QY++}if(n.ExtractedTasks&&(i||!t.TaskSuggestions)){this.$1Ba(2);this.$3QZ++}if(n.ExtractedUrls&&(i||!t.Urls)){this.$1Ba(4);this.$3Qa++}}},$wn:function(){var n=new Sys.StringBuilder;n.append(String.format("MissingEntitiesCount:{0},{1},{2},{3},{4},{5},{6}.",this.$3QU,this.$3QV,this.$3QW,this.$3QX,this.$3QY,this.$3QZ,this.$3Qa));if(this.$14C){n.append("MissingOnLastMessage:");for(var t=0;t<this.$14C.get_$A();t++){n.append(_g.$BN.toString(this.$14C.get_$E(t)));n.append(",")}}return n.toString()},$1Ba:function(n){this.$14C||(this.$14C=new(_ff.$18.$$(_g.$BN)));this.$14C.$F(n)}};_ex.$11g=function(n){this.$2k=n};_ex.$11g.prototype={$2k:null,$Us:null,$2V:function(n,t,i){this.$Us=_js.$D.get_$Q().$2V(i,this.$2k,n,t)},$33h:function(){this.$Us&&(this.$Us=_js.$D.get_$Q().$6Q(this.$Us))}};_ex.$sr=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$5FQ=Function.createDelegate(this,this.$5FQ);this.$$d_$4ee=Function.createDelegate(this,this.$4ee);this.$$d_$5Hi=Function.createDelegate(this,this.$5Hi);_ex.$sr.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v])};_ex.$sr.prototype={$So:null,$2IC:null,$1Mz:function(n){_ex.$2H.prototype.$1Mz.call(this,n);this.$9lC()},$AJ:function(){_ex.$2H.prototype.$AJ.call(this);this.$So&&this.$So.$5N()},$4aU:function(n){return"Mouse"!==this.$VJ.get_$U()||!n},$5Hi:function(){this.$1WO(!0);this.$7hs()},$9lC:function(){"Mouse"!==this.$VJ.get_$U()&&this.$CN&&(this.$l.$8G(this.$l.get_$IF())?this.$l.get_$IF().$4cy(this.$CN.get_$4d5(),this.$CN.get_$1lQ().DisplayName,this.$$d_$5Hi,this.$$d_$4ee):this.$5Hi())},$7hs:function(){this.$So=this.$2Hv.$7gR(this,this.$b4,this.$VJ.get_$U());this.$So.$pU=this.$$d_$5FQ;this.$VJ.$Az(this.$So)},$5FQ:function(n){this.$dl&&this.$dl.$Vi();this.$2IC=n;this.$1tO(!0);this.$l.$8G(this.$l.get_$IF())?this.$l.get_$IF().$4dr():this.$4ee()},$4ee:function(){this.$2IC&&this.$2IC()}};_ex.$2H=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$7bK=Function.createDelegate(this,this.$7bK);this.$$d_$98l=Function.createDelegate(this,this.$98l);this.$$d_$98L=Function.createDelegate(this,this.$98L);this.$$d_$2LD=Function.createDelegate(this,this.$2LD);this.$$d_$8Kp=Function.createDelegate(this,this.$8Kp);this.$$d_$9Dq=Function.createDelegate(this,this.$9Dq);this.$$d_$1Mz=Function.createDelegate(this,this.$1Mz);_ex.$2H.initializeBase(this);this.$Hn=n;this.$2Hv=u;this.$l=t;this.$b4=i;this.$VJ=r;this.$Ij=new _js.$X;this.$Qa=new _y.$NJ;this.$jT=[];this.$3Sw=_ex.$2H.$8HF(o);this.$iF=new _ex.$bX(this.$$d_$1Mz,null);this.$3Sj=new _C(this.$$d_$9Dq,_a.$0.$4W);this.$2WE=f;this.$vM=e;this.$2Hk=s;this.$FH=h;this.$b=c;this.$xR=l;this.$fK=a;this.$1D=v};_ex.$2H.add_$2Te=function(n){_ex.$2H.$12v||(_ex.$2H.$12v=new Sys.EventHandlerList);_ex.$2H.$12v.addHandler(_ex.$2H.$5En,n)};_ex.$2H.remove_$2Te=function(n){_ex.$2H.$12v&&_ex.$2H.$12v.removeHandler(_ex.$2H.$5En,n)};_ex.$2H.$8HF=function(n){return n?n.replace("osfruntime_strings.js",""):""};_ex.$2H.$2DT=function(n,t){var i=document.createElement("link");i.setAttribute("rel","stylesheet");i.setAttribute("type","text/css");i.setAttribute("href",t);n.appendChild(i)};_ex.$2H.prototype={$VJ:null,$b4:null,$2Hv:null,$FH:null,$Hn:null,$3Sj:null,$Qa:null,$l:null,$3Sw:null,$xR:null,$fK:null,$iF:null,$1QL:null,$14t:null,$J8:null,$1ur:!1,$dl:null,$1an:null,$Ij:null,$CN:null,$b:null,$1TW:!0,$46q:!0,$1Ur:null,$2WE:!1,$vM:!1,$2Hk:null,$1E5:null,$1D:null,$DR:!1,$jT:null,get_$7cS:function(){switch(this.$VJ.get_$U()){case"Mouse":return 3;case"TouchNarrow":return 1;case"TouchWide":return 2}return 3},get_$C2q:function(){return"extensionHighlight"},get_$Ap6:function(){return this.$J8},get_$Dlb:function(){return null},get_$8Um:function(){return this.$J8?this.$J8.IsInOrgMarketplaceRole:!1},set_$5H0:function(n){this.$dl!==n&&(this.$dl=n);this.$4("OverflowMenuViewModel");return n},set_$48o:function(n){if(this.$1an!==n){this.$1an=n;this.$4("OsfContextActivationManager")}return n},get_$1tj:function(){return this.$CN},set_$1tj:function(n){if(this.$CN!==n){$C(n)||this.$FH.$9rW(n.get_$1lQ().Id);this.$CN=n;this.$4("SelectedExtension")}return n},set_$22S:function(n){if(this.$1TW!==n){this.$1TW=n;this.$4(_ex.$2H.$8Mp)}return n},get_$2rO:function(){return this.$46q},set_$2rO:function(n){if(this.$46q!==n){this.$46q=n;this.$4(_ex.$2H.$46r)}return n},get_$22U:function(){return this.$jT},set_$22U:function(n){if(this.$jT!==n){this.$jT=n;this.$4(_ex.$2H.$8NM)}return n},get_$C9d:function(){return!1},set_$6YI:function(n){this.$1Ur=n;this.$4(_ex.$2H.$41G);return n},$1Mz:function(n){n&&this.$CN===n||this.$fK.$2gs();if(n){this.$fK.$7Gi();if(!this.$1an){var t=_a.$6.acsa(_a.$0.$4W,"ContextActivationManager",!0);this.$1WO(!1);this.set_$48o(this.$5uC("15.01"));this.$1tO(!1);_a.$6.acea(t)}this.$61P(n);this.set_$22U(n.get_$22U())}else{this.$3nL();this.set_$22U([])}this.set_$22S(this.$4aU(n));this.set_$1tj(n)},$AJ:function(){_ex.$2H.remove_$2Te(this.$$d_$8Kp);this.$DR=!1;this.$fK.$2gs();this.$3nL();this.set_$1tj(null);this.$dl&&this.$dl.$Vi();this.$dl=null;this.set_$22S(!0);this.$Ij.$1u();this.set_$2rO(!0);this.$xR.$AV();this.$7Zr()},$73:function(){if(this.$b4.get_$95V()){this.$Ij.$1u();if(this.$xR.$9k8()){this.$DR=!0;if(_a.$8J.$4xq()){_a.$8J.$5NN();_ex.$2H.$2Nw=!1;_ex.$2H.add_$2Te(this.$$d_$8Kp);this.$3ET()}else if($C(this.$J8)&&$C(_ex.$4W.$en)){_ex.$2H.add_$2Te(this.$$d_$8Kp);this.$3ET()}else{$C(this.$J8)&&!$C(_ex.$4W.$en)&&(this.$J8=_ex.$4W.$en);this.$4Ob()}}}},$98L:function(n){if(this.$2WE&&this.$14t){this.$14t.$2y();this.$14t=null}this.$9K1(n);if(this.$1E5){var t=null;_ex.$4W.isInstanceOfType(n)&&n.$68&&(t=n.$68.correlationId);_a.$6.$1G(this.$1E5,"GetListOfApps","",t);_a.$6.endPT("GetListOfApps");this.$1E5=null}},$4Ob:function(){if(this.$xR){this.$VJ.get_$U()==="Mouse"&&this.$J8.MarketplaceUrl&&this.set_$6YI(this.$J8.MarketplaceUrl);if(!$C(this.$J8.Extensions)&&this.$J8.Extensions.length){var n=this;this.$xR.$61e(this.$J8.Extensions,function(t){if(n.$xR){if(t.get_$A()>0){n.$Ij.$3y(t.$3Q());n.$Aqh();n.set_$5H0(new _ex.$BH(n.$Ij,n.$iF));n.$dl.$Vi();n.set_$2rO(!1);n.$4(_ex.$2H.$7pb)}else n.set_$2rO(!0);n.$4(_ex.$2H.$7Qv)}})}}},$61P:function(n){this.$fK.$3e(n,this.$J8,n.$Vt);this.$fK.$9LL()},$1WO:function(n){this.$5Ht(n)&&this.$2Hk.$1p(_a.$Ef,new _a.$Ef(!0,"Extensibility"))},$1tO:function(n){this.$5Ht(n)&&this.$2Hk.$1p(_a.$Ef,new _a.$Ef(!1,"Extensibility"))},$5uC:function(n){var i=new OSF.ContextActivationManager({appName:64,appVersion:n,clientMode:1,appUILocale:this.$Hn,dataLocale:"",hostControl:this.$fK,localizedScriptsUrl:this.$3Sw,docUrl:""});var t={frameBorder:"0"};this.$b4.get_$JM()&&this.$b4.get_$8b()&&(t.sandbox="allow-scripts allow-forms allow-same-origin");i.setIframeAttributeBag(t);return i},$5Ht:function(n){return!this.$b4.get_$3Ie()&&!this.$b4.get_$3xZ()?!1:!n||this.$CN&&!this.$CN.get_$1lQ().Type?!0:!1},$9Dq:function(){if(this.$1Ur){_a.$6.stPT(_a.$0.$4W,"GetMoreApps",3);var n=_a.$6.$1g(_a.$0.$4W,"GetMoreApps",!0);this.$Qa.$aV(this.$1Ur);this.$9nS();_a.$6.$1G(n,"GetMoreApps","");_a.$6.endPT("GetMoreApps")}},$Dso:function(){var n=document.getElementsByTagName("head")[0];_ex.$2H.$2DT(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js");_ex.$2H.$2DT(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/o15apptofilemappingtable.js");_ex.$2H.$2DT(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/"+this.$Hn.toLowerCase()+"/office_strings.js");_ex.$2H.$2DT(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/"+this.$Hn.toLowerCase()+"/outlook_strings.js");_ex.$2H.$2DT(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/en-us/office_strings.js");_ex.$2H.$2DT(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/en-us/outlook_strings.js");_ex.$2H.$2DT(n,"https://appsforoffice.microsoft.com/lib/1.1/hosted/outlookwebapp-15.01.js")},$Aqh:function(){this.$4("ActiveExtensions")},$3nL:function(){this.$fK.$9sw();this.$fK.$9tC()},$3ET:function(){if((!_ex.$2H.$2Nw||this.$1ur)&&!this.$vM){_a.$6.stPT(_a.$0.$4W,"GetListOfApps",5);this.$1E5=_a.$6.$1g(_a.$0.$4W,"GetListOfApps",!0);_ex.$2H.$2Nw=!0;this.$2LD();if(this.$2WE){this.$14t=new _ex.$17c(3,3e4,this.$$d_$2LD,_a.$0.$4W,"GetExtensibilityContext");this.$14t.$1T()}}},$2LD:function(){var n=new _ex.$4W;n.add_$2s(this.$$d_$98L);n.add_$2b(this.$$d_$98l);n.$11(this.get_$7cS(),this.$Hn)},$98l:function(n){if(this.$14t&&this.$14t.$2M6&&this.$1E5){var t=null;_ex.$4W.isInstanceOfType(n)&&n.$68&&(t=n.$68.correlationId);_a.$6.$1G(this.$1E5,"GetListOfApps","Failed",t);_a.$6.endPT("GetListOfApps")}},$7Zr:function(){this.$1QL&&this.$1QL.$33h()},$9nS:function(){if(!this.$1QL){this.$1QL=new _ex.$11g("CheckNewApp");this.$5Kt()}},$5Kt:function(){this.$1QL.$2V(this.$$d_$7bK,5e3,_a.$0.$4W)},$7bK:function(){if(_a.$8J.$4xq()){_a.$8J.$5NN();this.$1ur=!0;this.$3ET()}this.$5Kt()},$9K1:function(n){if(_ex.$2H.$12v){var t=_ex.$2H.$12v.getHandler(_ex.$2H.$5En);$C(t)||t(n)}},$8Kp:function(n){_ex.$2H.remove_$2Te(this.$$d_$8Kp);if(this.$J8){if(this.$1ur){this.$1ur=!1;_ex.$4W.$2PQ=n.$2Fe}}else{_ex.$4W.$2PQ=n.$2Fe;this.$J8=_ex.$4W.$en;this.$1D&&this.$1D.$2r("AgavePerformance")&&this.$Dso();this.$4Ob()}}};_ex.$11h=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$FF=n;this.$1lP=t;this.$Hn=i;this.$1N7=r;this.$l=u;this.$1E=f;this.$I=e;this.$N=o;this.$1bc=s;this.$1bd=h;this.$FH=c;this.$1D=l};_ex.$11h.prototype={$Hn:null,$1N7:null,$l:null,$1E:null,$I:null,$1lP:null,$N:null,$1bc:null,$1bd:null,$FH:null,$FF:null,$1D:null,$7gA:function(n){var t=!this.$1D.$2r("ContextualApps");return null},$4Xf:function(n,t){return this.$7k(n,this.$1bc.$4Xu(n,t),this.$1bd.$4Xf(n,t))},$7fo:function(n){return this.$7k(n,this.$1bc.$4Xu(n,!1),this.$1bd.$7fo(n))},$5up:function(n,t){return new _ex.$KN(_a.$0.$16,this.$FF,t,this.$Hn,this.$l,this.$1E,this.$I,this.$1lP,!0,_a.$7b.$zF(),this.$1N7,this.$N,this.$FH,null,this.$1bc.$4XG(2),this.$1bd.$5up(n),this.$1D)},$5u2:function(n,t){return new _ex.$KN(_a.$0.$25,this.$FF,t,this.$Hn,this.$l,this.$1E,this.$I,this.$1lP,!0,_a.$7b.$zF(),this.$1N7,this.$N,this.$FH,null,this.$1bc.$4XG(3),this.$1bd.$5u2(n),this.$1D)},$7iZ:function(n,t){return new _ex.$19n(n,t)},$7k:function(n,t,i){return new _ex.$sr(this.$Hn,this.$l,this.$1E,this.$I,this.$1lP,!0,_a.$7b.$zF(),this.$1N7,this.$N,this.$FH,n,t,i,this.$1D)}};_ex.$11i=function(n){_ex.$11i.initializeBase(this,[1,"VM.Extensibility."+n])};_ex.$11i.prototype={$1V:function(){_a.$i.$Ii.$JY(this)},$9H4:function(n){var r=n;for(var i in r){var t={key:i,value:r[i]};this.$P(t.key,t.value)}}};_ex.$bX=function(n,t){this.$$d_$7pJ=Function.createDelegate(this,this.$7pJ);_ex.$bX.initializeBase(this);this.set_$87(!0);this.set_$17L(this.$$d_$7pJ);this.$3HG=n;this.$8e=t;this.$2D=_a.$0.$4W};_ex.$bX.prototype={$3HG:null,$8e:null,$7pJ:function(){this.$3HG(this.$8e)}};_ex.$7c=function(n,t){this.$$d_$4Pt=Function.createDelegate(this,this.$4Pt);this.$jT=[];_ex.$7c.initializeBase(this);this.$5P=n;this.$Vt=t;this.$xS=_ex.$B7.$9(n.Rule,this.$Vt)};_ex.$7c.$5di=function(n,t,i){i.val=null;var f=new _ex.$7c(n,t);var u=null;var r=0;var s,o,e;if(e=_ex.$7c.$9sD(n,t.$o4,s={val:u},o={val:r}),u=s.val,r=o.val,e){f.$1RY=u;f.$2g1=r;i.val=f;return!0}return!1};_ex.$7c.$9sD=function(n,t,i,r){i.val=null;r.val=0;var e;if(t===1)e=0;else if(t===2||t===3)e=1;else return!1;if(!n.FormSettingsList)return!1;for(var o=n.FormSettingsList,s=o.length,u=0;u<s;++u){var f=o[u];if(f.SettingsType===e){i.val=f.SourceLocation;if(!n.Type){i.val=i.val.replace("{","%7b");i.val=i.val.replace("}","%7d")}r.val=f.RequestedHeight;return!0}}return!1};_ex.$7c.prototype={$1RY:null,$2g1:0,$5P:null,$xS:null,$Vt:null,$3In:!1,$1Td:null,get_$1lQ:function(){return this.$5P},get_$Wm:function(){return this.$5P.AppStatus},get_$4cn:function(){return this.$5P.EndNodeUrl},get_$26:function(){return this.$5P.DisplayName},get_$8Zr:function(){return this.$5P.LicenseType},get_$9JU:function(){return this.$5P.ProviderName},get_$5WD:function(){return _js.$9.$1h(this.$5P.Settings)?{}:JsonParser.deserialize(this.$5P.Settings)},set_$5WD:function(n){this.$5P.Settings=n?JsonParser.serialize(n):"";return n},get_$8Nl:function(){if(!_js.$9.$1h(this.$1Td))return this.$1Td;this.$1Td=_ex.$7c.$4sI?_js.$9.$1h(this.$5P.HighResolutionIconUrl)?this.$5P.IconUrl:this.$5P.HighResolutionIconUrl:_js.$9.$1h(this.$5P.IconUrl)?this.$5P.HighResolutionIconUrl:this.$5P.IconUrl;return this.$1Td},get_$4d5:function(){return this.$1RY},set_$4wX:function(n){if(n!==this.$3In){this.$3In=n;this.$4("IsLastExtension")}return n},get_$22U:function(){return this.$jT},$9hS:function(n){var e=this.$Vt.$3MD;var c=this.$Vt.$1Wz;Array.clear(this.$jT);if(!this.$5P.DisableEntityHighlighting){var t={};var o=c;for(var f in o)for(var h={key:f,value:o[f]},u=h.value,i=0;i<u.length;i++)this.$4Pt(u[i],null,t);for(var r=0;r<e.length;r++){var s=e[r];switch(s){case 3:_ex.$3l.$uX(n.Addresses,"Address",t,this.$$d_$4Pt);break;case 6:_ex.$3l.$uX(n.EmailAddresses,"EmailAddress",t,this.$$d_$4Pt);break;case 4:_ex.$3l.$uX(n.Urls,"Url",t,this.$$d_$4Pt);break;case 1:_ex.$3l.$uX(n.MeetingSuggestions,"MeetingString",t,this.$$d_$4Pt);break;case 2:_ex.$3l.$uX(n.TaskSuggestions,"TaskString",t,this.$$d_$4Pt);break;case 5:_ex.$3l.$uX(n.PhoneNumbers,"OriginalPhoneString",t,this.$$d_$4Pt);break;case 7:_ex.$3l.$uX(n.Contacts,"ContactString",t,this.$$d_$4Pt);break}}this.$Vt.$er.$7rk(t,this.$$d_$4Pt)}},$4Pt:function(n,t,i){var r=i;if(!(n in r)){Array.add(this.$jT,n);r[n]=!0}}};_ex.$17c=function(n,t,i,r,u){this.$$d_$8Qs=Function.createDelegate(this,this.$8Qs);_ex.$17c.initializeBase(this,[u]);this.$1pW=n;this.$1iD=t;this.$8E=i;this.$2D=r};_ex.$17c.prototype={$1pW:0,$1iD:0,$Rw:1,$8E:null,$2M6:!1,$2D:null,$1T:function(){_js.Trace.logInfo(_a.$0.$4W,"RetryTimer.Start");this.$2M6=!1;this.$2V(this.$$d_$8Qs,this.$1iD,this.$2D)},$2y:function(){_js.Trace.logInfo(_a.$0.$4W,"RetryTimer.End");this.$2M6=!0;this.$Rw=this.$1pW;this.$33h()},$8Qs:function(){_js.Trace.logInfo(_a.$0.$4W,"RetryTimer.Callback: count {0}",this.$Rw);this.$8E();if(this.$Rw<this.$1pW){this.$Rw++;this.$2V(this.$$d_$8Qs,this.$1iD,this.$2D)}else{_js.Trace.logInfo(_a.$0.$4W,"RetryTimer.Callback: Retry count {0} exceeds max {1}",this.$Rw,this.$1pW);this.$2y()}}};_ex.$B7=function(){};_ex.$B7.$9=function(n,t){var i=_ex.$B7.$4Xj(n,t);if(!$C(i)){t.$36M>7&&i.$1YK("Number of custom pattern rules exceeds the limit of "+7+".");t.$3WN>15&&i.$1YK("Number of rules exceeds the limit of "+15+".");if(i.$KA)return i}return null};_ex.$B7.$3JQ=function(n){return n.$o4===1};_ex.$B7.$4Xj=function(n,t){return $C(n)?null:++t.$3WN>15?null:n.Type==="Collection"?new _ex.$108(n,t):n.Type==="ItemIs"?new _ex.$F9(n):n.Type==="ItemHasKnownEntity"?new _ex.$3l(n):n.Type==="ItemHasRegularExpressionMatch"?new _ex.$Dr(n,t,_a.UserAgent.getInstance()):n.Type==="ItemHasAttachment"?new _ex.$14G:null};_ex.$B7.prototype={$KA:!0,$4wR:function(n,t){return!0},$1YK:function(n){_js.Trace.logError(_a.$0.$4W,n);this.$KA=!1}};_ex.$108=function(n,t){_ex.$108.initializeBase(this);if($C(n.Mode)){this.$1YK("Collection rule with no required 'mode' attribute found.");return}if($C(n.Rules)||!n.Rules.length){this.$1YK("Collection rule with no required 'rule' attribute found.");return}this.$2NR="And"===n.Mode;this.$11t=new _js.$X;for(var i=0;i<n.Rules.length;i++){var r=_ex.$B7.$4Xj(n.Rules[i],t);$C(r)||this.$11t.$F(r)}};_ex.$108.prototype={$2NR:!1,$11t:null,$2Hj:function(n,t,i){for(var r=this.$2NR,u=0;u<this.$11t.get_$A();u++){var f=this.$11t.get_$E(u);r=this.$2NR?!!(r&f.$2Hj(n,t,i)):!!(r|f.$2Hj(n,t,i))}return r},$4wR:function(n,t){for(var i=0;i<this.$11t.get_$A();i++){var r=this.$11t.get_$E(i);if(!r.$4wR(n,t))return!1}return!0}};_ex.$lG=function(n,t){this.$3MD=[];this.$er=new _ex.$3k;this.$FH=n;this.$o4=t};_ex.$lG.prototype={$36M:0,$3WN:0,$1Wz:null,$ru:!1,$FH:null,$o4:0};_ex.$3k=function(){};_ex.$3k.$1D1=function(n,t,i,r){if(n){var f=n;for(var u in f){var e={key:u,value:f[u]};_ex.$3l.$uX(e.value,t,i,r)}}};_ex.$3k.$1Be=function(n,t,i){i&&(n[t]=i)};_ex.$3k.$1Bd=function(n,t,i){n.val||(n.val={});n.val[t]=i};_ex.$3k.prototype={$Gc:null,$y5:null,$TL:null,$1FE:null,$wR:null,$1I4:null,$xM:null,$8Eb:function(){var n={};_ex.$3k.$1Be(n,"Addresses",this.$Gc);_ex.$3k.$1Be(n,"Contacts",this.$y5);_ex.$3k.$1Be(n,"EmailAddresses",this.$TL);_ex.$3k.$1Be(n,"MeetingSuggestions",this.$1FE);_ex.$3k.$1Be(n,"PhoneNumbers",this.$wR);_ex.$3k.$1Be(n,"TaskSuggestions",this.$1I4);_ex.$3k.$1Be(n,"Urls",this.$xM);return n},$4PI:function(n,t,i){switch(n){case 3:var o;_ex.$3k.$1Bd(o={val:this.$Gc},t,i),this.$Gc=o.val;break;case 7:var s;_ex.$3k.$1Bd(s={val:this.$y5},t,i),this.$y5=s.val;break;case 6:var h;_ex.$3k.$1Bd(h={val:this.$TL},t,i),this.$TL=h.val;break;case 1:var e;_ex.$3k.$1Bd(e={val:this.$1FE},t,i),this.$1FE=e.val;break;case 5:var r;_ex.$3k.$1Bd(r={val:this.$wR},t,i),this.$wR=r.val;break;case 2:var u;_ex.$3k.$1Bd(u={val:this.$1I4},t,i),this.$1I4=u.val;break;case 4:var f;_ex.$3k.$1Bd(f={val:this.$xM},t,i),this.$xM=f.val;break;default:break}},$7rk:function(n,t){_ex.$3k.$1D1(this.$Gc,"Address",n,t);_ex.$3k.$1D1(this.$y5,"ContactString",n,t);_ex.$3k.$1D1(this.$TL,"EmailAddress",n,t);_ex.$3k.$1D1(this.$1FE,"MeetingString",n,t);_ex.$3k.$1D1(this.$wR,"OriginalPhoneString",n,t);_ex.$3k.$1D1(this.$1I4,"TaskString",n,t);_ex.$3k.$1D1(this.$xM,"Url",n,t)}};_ex.$14G=function(){_ex.$14G.initializeBase(this)};_ex.$14G.prototype={$2Hj:function(n,t,i){return _ex.$B7.$3JQ(t)?n.get_$P3()!==undefined&&n.get_$P3():!1}};_ex.$3l=function(n){this.$$d_$7og=Function.createDelegate(this,this.$7og);_ex.$3l.initializeBase(this);$C(n.EntityType)?this.$1YK("ItemHasKnownEntity rule contains null entity type."):this.$Bb=n};_ex.$3l.$uX=function(n,t,i,r){if(n&&n.length>0)for(var u=0;u<n.length;u++){var f;f=t?n[u][t]:n[u];f&&r(f,n[u],i)}};_ex.$3l.$12w=function(n,t,i){if($C(n)||!n.length)return null;for(var f=[],r=0,u=0;u<n.length;u++){var e=n[u].Position;if(_ex.$3l.$8Tu(i,e,t)){f[r]=_ex.$3l.$8F3(n[u],t);r++}}if(r>0)_js.Trace.logInfo(_a.$0.$4W,"GetExtractedEntitiesFilteredByView: {2} entities returned for type {0} isConversationView {1}",t,i,r);else{f=null;_js.Trace.logInfo(_a.$0.$4W,"GetExtractedEntitiesFilteredByView: No entities returned for type {0} isConversationView {1}",t,i)}return f};_ex.$3l.$8Tu=function(n,t,i){var r=!1;n?(t==="LatestReply"||t==="Signature"||t==="Subject")&&(r=!0):_ex.$3l.$4xZ(i)?(t==="LatestReply"||t==="Signature"||t==="Subject")&&(r=!0):r=!0;return r};_ex.$3l.$4xZ=function(n){return n===7||n===1||n===2};_ex.$3l.$8F3=function(n,t){switch(t){case 3:return n.Address;case 6:return n.EmailAddress;case 4:return n.Url;case 1:var i=n;String.isInstanceOfType(i.StartTime)&&(i.StartTime=_a.$8.$5s(i.StartTime,!0).$8a());String.isInstanceOfType(i.EndTime)&&(i.EndTime=_a.$8.$5s(i.EndTime,!0).$8a());return i;default:return n}};_ex.$3l.prototype={$Bb:null,$1Gg:null,$er:null,$4wR:function(n,t){return n.get_$r8()?!0:this.$8Tt(n.get_$2tW())?this.$1Gg?!1:t.$ru?!1:!_ex.$3l.$4xZ(this.$Bb.EntityType):!0},$2Hj:function(n,t,i){if(!_ex.$B7.$3JQ(t))return!1;this.$er=null;var u=n.get_$r8();if($C(u))return!1;if(this.$Bb.RegExFilter){var f,e;if(!(e=_ex.$Dr.$5dk(this.$Bb.RegExFilter,this.$Bb.IgnoreCase,f={val:this.$1Gg}),this.$1Gg=f.val,e))return!1}var r=!1;switch(this.$Bb.EntityType){case 3:r=this.$1Co(t,u.Addresses,null);break;case 7:r=this.$1Co(t,u.Contacts,"ContactString");break;case 6:r=this.$1Co(t,u.EmailAddresses,null);break;case 1:r=this.$1Co(t,u.MeetingSuggestions,"MeetingString");break;case 5:r=this.$1Co(t,u.PhoneNumbers,"OriginalPhoneString");break;case 2:r=this.$1Co(t,u.TaskSuggestions,"TaskString");break;case 4:r=this.$1Co(t,u.Urls,null);break}return r},$1Co:function(n,t,i){var r=null;!$C(t)&&t.length>0&&(r=_ex.$3l.$12w(t,this.$Bb.EntityType,n.$ru));if(r){if(!this.$1Gg){Array.add(n.$3MD,this.$Bb.EntityType);return!0}var u=_a.$8.get_$38();_ex.$3l.$uX(r,i,null,this.$$d_$7og);n.$FH.$5dI(this.$Bb.FilterName,_a.$8.get_$38().$6M(u));if(this.$er){n.$er.$4PI(this.$Bb.EntityType,this.$Bb.FilterName,this.$er);return!0}}this.$1Gg&&n.$er.$4PI(this.$Bb.EntityType,this.$Bb.FilterName,null);return!1},$7og:function(n,t,i){var r=n.match(this.$1Gg);if(r&&r.length>0){this.$er||(this.$er=[]);Array.add(this.$er,t)}},$8Tt:function(n){return n?this.$Bb.EntityType===3&&n.ExtractedAddresses||this.$Bb.EntityType===7&&n.ExtractedContacts||this.$Bb.EntityType===6&&n.ExtractedEmails||this.$Bb.EntityType===1&&n.ExtractedMeetings||this.$Bb.EntityType===5&&n.ExtractedPhones||this.$Bb.EntityType===2&&n.ExtractedTasks||this.$Bb.EntityType===4&&n.ExtractedUrls:!1}};_ex.$Dr=function(n,t,i){_ex.$Dr.initializeBase(this);if(n.RegExName&&n.RegExValue&&n.PropertyName){this.$Bb=n;t.$36M++}else this.$1YK("Invalid ItemHasRegularExpressionMatchRule rule.");this.$1E=i};_ex.$Dr.$5dk=function(n,t,i){i.val=null;try{i.val=new RegExp(n,t?"ig":"g");return!0}catch(r){_js.Trace.logError(_a.$0.$4W,"Failed to create RegularExpression for pattern: {0}",n);return!1}};_ex.$Dr.$9Mg=function(n){for(var t=n.length-1;t>=0;t--){var r=!1;if(t>=50||n[t].length>3072)r=!0;else for(var i=t-1;i>=0;i--)if(n[t]===n[i]){r=!0;break}r&&Array.removeAt(n,t)}return n};_ex.$Dr.$8Fc=function(n,t){if(t){if(n.get_$S7())return n.get_$S7().get_$1Z()}else if(n.get_$Mq())return n.get_$Mq().get_$1Z();else if(n.get_$4n())return n.get_$4n().get_$1Z();_js.Trace.logWarning(_a.$0.$4W,"Skipping regex eval: no body for item with Id: {0}.",n.get_$y()?n.get_$y().Id:"'null id'");return null};_ex.$Dr.prototype={$Bb:null,$1E:null,$4tr:16e3,$3HT:64e3,$4g6:5e5,$2Hj:function(n,t,i){if(!_ex.$B7.$3JQ(t))return!1;var r=null;var o=this.$8G0(n,t,i);if(o){var u;var e,f;if(!(f=_ex.$Dr.$5dk(this.$Bb.RegExValue,this.$Bb.IgnoreCase,e={val:u}),u=e.val,f))return!1;var s=_a.$8.get_$38();r=o.match(u);t.$FH.$5dI(this.$Bb.RegExName,_a.$8.get_$38().$6M(s));if(r&&r.length>0){r=_ex.$Dr.$9Mg(r);if(r.length>0){t.$1Wz[this.$Bb.RegExName]=r;return!0}}}t.$1Wz[this.$Bb.RegExName]=new Array(0);return!1},$8G0:function(n,t,i){if(this.$Bb.PropertyName===1)return n.get_$3o();else if(this.$Bb.PropertyName===4){var r=null;if(_g.$5w.isInstanceOfType(n))n.get_$Em()&&(r=n.get_$Em().Mailbox);else if(_g.$2g.isInstanceOfType(n)){var o=n.get_$MD();o&&(r=o.Mailbox)}if(r&&r.EmailAddress)return r.EmailAddress}else if(this.$Bb.PropertyName===3){var s=null;n.get_$106()===3&&(s=this.$4no(n,t.$ru));return s}else if(this.$Bb.PropertyName===2){if(i.val)return i.val;var u=this.$4no(n,t.$ru);var c=_a.$8.get_$38();var f=$(u);var e=_a.$8.get_$38();f[0]&&(i.val=f[0].innerText);$C(i.val)&&(i.val=f.text());var h=_a.$8.get_$38();t.$FH.$9rR(u?u.length:0,i.val?i.val.length:0,e.$6M(c),h.$6M(e));return i.val}return null},$4no:function(n,t){var i=_ex.$Dr.$8Fc(n,t);if(i){if(i.length>this.$4g6){_js.Trace.logInfo(_a.$0.$4W,"Body size exceeds general activation size limit");i=null}if(this.$1E.get_$3Ie()||this.$1E.get_$3xZ())if(this.$Bb.PropertyName===2){if(i.length>this.$4tr){_js.Trace.logInfo(_a.$0.$4W,"Body size exceeds IPhone/IPad activation size limit");i=null}}else if(this.$Bb.PropertyName===3&&i.length>this.$3HT){_js.Trace.logInfo(_a.$0.$4W,"Body size exceeds IPhone/IPad evaluation size. Truncating to evaluation size");i=i.substr(0,this.$3HT)}}return i}};_ex.$F9=function(n){_ex.$F9.initializeBase(this);this.$3Gi=n.IncludeSubClasses;this.$hi=n.ItemType;this.$1UU=n.FormType;$C(n.ItemClass)||(this.$s4=n.ItemClass.toLowerCase())};_ex.$F9.$4wo=function(n){return n.startsWith("ipm.note")||n.startsWith("ipm.schedule")||n.startsWith("ipm.sharing")};_ex.$F9.$6Ow=function(n){return n.startsWith("ipm.appointment")||n==="ipm.ole.class.{00061055-0000-0000-c000-000000000046}"};_ex.$F9.prototype={$s4:null,$3Gi:!1,$hi:0,$1UU:0,$2Hj:function(n,t,i){if(t.$o4===1&&(this.$1UU===2||this.$1UU===3)){if(!$C(n.get_$CK())){var r=n.get_$CK().toLowerCase();if(this.$hi===1&&_g.$5w.isInstanceOfType(n)&&_ex.$F9.$4wo(r)||this.$hi===2&&_g.$2g.isInstanceOfType(n)&&_ex.$F9.$6Ow(r)){if(!this.$s4)return!0;if(this.$3Gi){if(r.startsWith(this.$s4))return!0}else if(r===this.$s4)return!0}}}else if(t.$o4===2&&this.$hi===1||t.$o4===3&&this.$hi===2)return this.$1UU===1||this.$1UU===3;return!1}};_ex.$Gz=function(){this.$1rG=-1};_ex.$Gz.prototype={$2QL:0,$2QN:null,$3cH:0,$A:0,get_$7XK:function(){return this.$A?Math.round(this.$3cH/this.$A):-1},$2W:function(n,t){this.$A++;this.$3cH+=n;if(n>=this.$2QL){this.$2QL=n;this.$2QN=t}(this.$1rG===-1||n<this.$1rG)&&(this.$1rG=n)},$wn:function(){if(!this.$A)return"";var t=$C(this.$2QN)?"":this.$2QN;var n=[this.$1rG,this.get_$7XK(),this.$2QL,t];return n.join(",")}};_ex.$10E=function(n){_ex.$10E.initializeBase(this,[n])};_ex.$kT=function(n,t){this.$$d_$Dc4=Function.createDelegate(this,this.$Dc4);_ex.$kT.initializeBase(this,[n,t]);this.$Ch=!1;this.$9Y=!0;this.set_$2Gx(!0)};_ex.$kT.prototype={$1E9:null,$jM:!1,$2WD:!1,$93Y:function(){if(this.get_$20().get_$A()>0){this.$4f9();this.$3Vy();this.$jM=!1}else{this.$1E9.$3S();this.$jM=!0}},$3T:function(){_fce.$m.prototype.$3T.call(this);this.get_$S().bind("keydown",this.$$d_$Dc4)},$5I:function(){this.get_$S().unbind("keydown",this.$$d_$Dc4);_js.$7.prototype.$5I.call(this)},$4T:function(){_fce.$m.prototype.$4T.call(this);this.$1E9=this.$u.$1N("GetMoreAppsButton")},$35c:function(){var n=_fce.$m.prototype.$35c.call(this);if(this.$3N.get_$U()==="Mouse"){n.get_$4y().set_$e3(-1);n.get_$4y().set_$Rx(3);var t=this;n.get_$S().keydown(function(i){if(i.which===13||i.which===32){t.$vW(n,new _a.$7E(i));i.preventDefault()}})}return n},$vW:function(n,t){if(this.get_$34()){var i=n.get_$k();t.get_$2g().extensionViewModel=i;this.set_$Cb(new _ff.$Cy(t,3))}},$6oi:function(n){if(!this.$2WD&&this.$jM){this.$jM=!1;this.$1E9.set_$g(-1)}else this.$2WD=!1},$Dc4:function(n){if(this.$jM||this.get_$ZM()){var t=new _a.$7E(n);var r=this.$Hx(this.get_$ZM());var i=this.get_$20().get_$E(r);if(this.$jM&&(t.get_$9k()===32||t.get_$9k()===13))this.$2WD=!0;else if(t.get_$9k()===40){if(!this.$jM){this.$64G();if(this.get_$ZM()===i){this.$1AN(null);this.set_$ZM(null);this.$1E9.set_$g(0);this.$1E9.$3S();this.$jM=!0}}}else if(t.get_$9k()===38)if(this.$jM){this.$4fB();this.$1E9.set_$g(-1);this.$jM=!1}else this.$64I();else t.get_$9k()===9&&_js.$D.get_$Q().$2V(_a.$0.$4W,"ComposeExtensibilityMenuListView",this.$$d_$9Oi,100)}}};_ex.$kV=function(n){this.$$d_$5Ei=Function.createDelegate(this,this.$5Ei);this.$$d_$960=Function.createDelegate(this,this.$960);this.$$d_$5EN=Function.createDelegate(this,this.$5EN);this.$$d_$98A=Function.createDelegate(this,this.$98A);_ex.$kV.initializeBase(this,[n]);this.$5q={}};_ex.$kV.prototype={$5q:null,$2by:!1,$4T:function(){_js.$7.prototype.$4T.call(this);this.$5q.CloseButton=this.$u.$1N("CloseButton");this.$5q.ComposeExtMenuListView=this.$u.$1N("ComposeExtMenuListView");this.$5q.AppsBackButton=this.$u.$1N("AppsBackButton")},$3T:function(){_js.$7.prototype.$3T.call(this);this.get_$S().bind("keydown",this.$$d_$98A);var n=this.get_$k();this.$p("DataContext",this.$$d_$5EN);n&&this.$5EN(null,null)},$5I:function(){var n=this.get_$k();this.get_$S().unbind("keydown",this.$$d_$98A);this.$1B("DataContext",this.$$d_$5EN);if(n&&this.$2by){n.remove_$2TP(this.$$d_$960);n.remove_$3Ru(this.$$d_$960);n.remove_$2Tb(this.$$d_$5Ei);this.$2by=!1}_js.$7.prototype.$5I.call(this)},$5EN:function(n,t){var i=this.get_$k();i.add_$2TP(this.$$d_$960);i.add_$3Ru(this.$$d_$960);i.add_$2Tb(this.$$d_$5Ei);this.$2by=!0},$960:function(){this.$5q.ComposeExtMenuListView.$93Y()},$5Ei:function(){this.$5q.AppsBackButton.$3S()},$98A:function(n){var t=new _a.$7E(n);if(t.get_$9k()===27){var i=this.get_$k();i.$22Q(!1);t.$OB()}}};_ex.$11c=function(n){_ex.$11c.initializeBase(this,[n])};_ex.$11c.prototype={$8O0:function(n){this.get_$S().hide();this.get_$S().prev().show()}};_ex.$3r=function(n,t){this.$$d_$98d=Function.createDelegate(this,this.$98d);this.$$d_$27C=Function.createDelegate(this,this.$27C);this.$$d_$8PG=Function.createDelegate(this,this.$8PG);_ex.$3r.initializeBase(this,[n,t]);this.$I=t;this.$Ch=!1;this.set_$2Gx(!0)};_ex.$3r.prototype={$p7:0,$Ij:null,$10L:null,$3IT:!1,$9o:!1,$I:null,$2OY:!1,set_$2QR:function(n){if(this.$p7!==n){this.$p7=n;this.$4("MaxTabCount");n>0&&this.$5dv()}return n},set_$6ue:function(n){this.$10L=n;this.$2OY&&this.$10L&&this.$5dv();return n},$27C:function(){this.set_$2QR(this.$4TY(this.$3tG(!0)))},$35c:function(){var n=_fce.$m.prototype.$35c.call(this);if(this.$3N.get_$U()==="Mouse"){n.get_$4y().set_$e3(0);n.get_$4y().set_$Rx(3);var t=this;n.get_$S().keydown(function(i){(i.which===13||i.which===32)&&t.$vW(n,new _a.$7E(i))})}return n},$3T:function(){_fce.$m.prototype.$3T.call(this);_js.$D.get_$Q().$2V(this.get_$m(),"ExtensibilityMenuListView - Trigger InternalOnActivate on delay",this.$$d_$8PG,0)},$5I:function(){_js.$7.prototype.$5I.call(this);if(this.$9o&&"Mouse"===this.$3N.get_$U()){this.$I.remove_$PJ(this.$$d_$27C);_g.$O.get_$Q().get_$6m().remove_$1zw(this.$$d_$98d);_g.$O.get_$Q().get_$6m().remove_$3FF(this.$$d_$98d)}},$vW:function(n,t){if(this.get_$34()){var i=n.get_$k();t.get_$2g().extensionViewModel=i;this.set_$Cb(new _ff.$Cy(t,3))}},$4TY:function(n){if(!this.$Ij)return 0;for(var r=this.$Ij.get_$A(),e=-1,u=0,o=0,f=new Array(r),i=0;i<r;i++){f[i]=this.$52R(this.$Ij.get_$E(i).$5P.DisplayName);this.$Ij.get_$E(i)===this.get_$1F()&&(e=i)}if(e>-1){o+=f[e];u++}for(var t=0;t<r;){if(t!==e)if(o+f[t]<n){o+=f[t];u++}else break;t++}t<r&&o+46>=n&&u--;return u},$52R:function(n){if(!(n in _ex.$3r.$2EW)){if(!_ex.$3r.$wf||$("#extensionRuler").length<=0){_ex.$3r.$wf=document.createElement("span");_ex.$3r.$wf.id="extensionRuler";_ex.$3r.$wf.className="extensionRuler";document.body.appendChild(_ex.$3r.$wf)}var t=document.createElement("span");t.className="extensionRulerItem";t.appendChild(document.createTextNode(n));_ex.$3r.$wf.appendChild(t);_ex.$3r.$2EW[n]=_ex.$3r.$wf.offsetWidth;_ex.$3r.$wf.removeChild(t)}return _ex.$3r.$2EW[n]},$3tG:function(n){var r=this.$8FQ();var i=this.get_$S().width();if(i>0)_ex.$3r.$1By=i;else if(!_ex.$3r.$1By||n){var t=this;_ex.$3r.$1By=i;while(!$C(t)&&!$C(t.get_$Bd())&&!$C(t.get_$S())&&_ex.$3r.$1By<=0){t=t.get_$Bd();_ex.$3r.$1By=t.get_$S().width()}}return _ex.$3r.$1By-r},$8FQ:function(){return this.$3IT?0:this.$52R(_nbs.NonBootStrings.l_ExtensibilityTabGetMoreApps_Text)+22},$98d:function(n,t){this.$27C()},$8PG:function(){if(this.get_$34()){this.set_$2QR(0);if("Mouse"===this.$3N.get_$U()){this.$I.add_$PJ(this.$$d_$27C);_g.$O.get_$Q().get_$6m().add_$1zw(this.$$d_$98d);_g.$O.get_$Q().get_$6m().add_$3FF(this.$$d_$98d)}this.set_$2QR(this.$4TY(this.$3tG(!1)));this.$9o=!0}},$5dv:function(){if(this.$10L){this.$10L.$11();this.$2OY=!1}else this.$2OY=!0}};_ex.$1=function(){};_ex.$1.get_$7oZ=function(){return _fm.$G.$9("error-fallback-app-icon","error-fallback-app-icon","owa","ms-bg-color-neutralTertiary ms-font-color-white")};_ex.$1.get_$7WW=function(){return _fm.$G.$9("arrow-left-grey-circle-hover-ext","x16-circle","owa","ms-border-color-neutralSecondary ms-font-color-neutralSecondary")};_ex.$1.get_$1Bc=function(){return _fm.$G.$9("add-small-ext","add-small-ext","owa","ms-font-color-neutralSecondary")};_ex.$1.get_$11T=function(){return _fm.$G.$9("add-small-hover-ext","add-small-hover-ext","owa","ms-font-color-neutralDark")};_ex.$1.get_$5kn=function(){return _fm.$G.$9("affordance-grey-ext","x16","owa","ms-font-color-neutralSecondary")};_ex.$CG=function(n,t){_ex.$CG.initializeBase(this,[n]);this.$I=t};_ex.$CG.prototype={$I:null,$3Ht:!1,$3K6:!1,$1GH:null,$CN:null,$Hn:null,$l:null,$122:null,set_$48o:function(n){if(!$C(n)){this.$1GH=n;this.$3dc()}return n},set_$CE:function(n){if(this.$Hn!==n){this.$Hn=n;this.$3dc()}return n},set_$1tj:function(n){if(this.$CN===n)return n;$C(n)&&this.$5Kh();this.$CN=n;this.$3dc();return n},$4bL:function(n,t,i,r,u,f,e,o,s){this.$1GH.displayNotification({infoType:n,id:t,title:i,description:r,buttonTxt:u,buttonCallback:f,detailView:e,displayDeactive:o,reDisplay:s})},$5Kh:function(){if(_ex.$CG.$2U2>0&&!$C(this.$1GH)&&this.$122){this.$1GH.purgeOsfControl(this.$122,!1);this.$122=null}},$3dc:function(){if(!$C(this.$CN)&&!$C(this.$1GH)&&!$C(this.$Hn)&&!this.get_$17()){this.$5Kh();_ex.$CG.$2U2++;this.$122="ocii"+_ex.$CG.$2U2;var a="DefaultSettings";var e=new OSF.Manifest.ExtensionSettings;e._sourceLocations[this.$Hn]=this.$CN.$1RY;if(OSF.OsfManifestManager.hasManifest(this.$CN.$5P.Id,this.$CN.$5P.Version)){var w=OSF.OsfManifestManager.getCachedManifest(this.$CN.$5P.Id,this.$CN.$5P.Version);w._extensionSettings[a]=e}else{var v=this;var b=new OSF.Manifest.Manifest(function(n){n._id=v.$CN.$5P.Id;n._version=v.$CN.$5P.Version;n._extensionSettings={};n._extensionSettings[a]=e});OSF.OsfManifestManager.cacheManifest(this.$CN.$5P.Id,this.$CN.$5P.Version,b)}var n;if(this.$I.get_$U()==="TouchNarrow"){n=window.innerHeight-50;n<0&&(n=0)}else{n=this.$CN.$2g1;n<32?n=32:n>450&&(n=450)}this.$3Ht||this.get_$S().css("height",n.toString()+"px");this.$1GH.insertOsfControl({div:this.get_$S()[0],id:this.$122,marketplaceID:this.$CN.$5P.Id,marketplaceVersion:this.$CN.$5P.Version,settings:this.$CN.get_$5WD(),store:"",storeType:OSF.StoreType.Exchange});if(_y.$z.$1Q.get_$U()==="Mouse"){var p=this;_js.$D.get_$Q().$6C(_a.$0.$4W,"OsfHostContainerView.TryInsertOsfControl",function(){p.get_$S().children()[0]&&p.get_$S().children()[0].focus()})}if(this.$CN.$5P.Origin===1||this.$CN.$5P.Origin===2&&this.$3K6){var t=this;var y=function(){t.$l&&t.$l.$8G(t.$l.get_$IF())&&t.$l.get_$IF().get_$2H9().get_$2PY()?t.$l.get_$IF().$2PX(t.$CN.get_$4cn()):window.open(t.$CN.get_$4cn())};if(_js.$9.$1h(this.$CN.get_$Wm()))this.$CN.get_$8Zr()===1&&this.$4bL(2,this.$122,_nbs.NonBootStrings.l_AppInfoTitle_Text,_nbs.NonBootStrings.l_AppTrialMessage_Text,_nbs.NonBootStrings.l_AppBuyButton_Text,y,!1,!1,!0);else{var i;var u;var f;var r;var h,c,l,o,s;(s=this.$9sE(this.$CN.get_$Wm(),h={val:i},c={val:u},l={val:f},o={val:r}),i=h.val,u=c.val,f=l.val,r=o.val,s)&&this.$4bL(1,this.$122,_nbs.NonBootStrings.l_AppErrorTitle_Text,i,u,y,f,r,!0)}}}},$9sE:function(n,t,i,r,u){t.val="";i.val="";r.val=!1;u.val=!1;switch(n){case"1.0":t.val=_nbs.NonBootStrings.l_AppErrorCode1_0_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeUpdateAction_Text;r.val=!0;u.val=!0;break;case"1.1":t.val=_nbs.NonBootStrings.l_AppErrorCode1_1_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeUpdateAction_Text;r.val=!0;u.val=!0;break;case"1.2":t.val=_nbs.NonBootStrings.l_AppErrorCode1_2_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeUpdateAction_Text;r.val=!0;u.val=!0;break;case"2.0":t.val=_nbs.NonBootStrings.l_AppErrorCode2_0_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeUpdateAction_Text;break;case"2.1":t.val=_nbs.NonBootStrings.l_AppErrorCode2_1_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeUpdateAction_Text;break;case"3.0":t.val=_nbs.NonBootStrings.l_AppErrorCode3_0_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeDetailsAction_Text;break;case"3.1":t.val=_nbs.NonBootStrings.l_AppErrorCode3_1_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeDetailsAction_Text;break;case"3.2":t.val=_nbs.NonBootStrings.l_AppErrorCode3_2_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeDetailsAction_Text;break;case"3.3":t.val=_nbs.NonBootStrings.l_AppErrorCode3_3_Text;i.val=_nbs.NonBootStrings.l_AppErrorCodeDetailsAction_Text;break;default:_js.Trace.logWarning(this.get_$m(),String.format("The app status {0} does not have corresponding description.",n));return!1}return!0}};_ex._TI=function(){};_ex._TI.$$cctor=function(){var s="ComposeAppsPane";new _A(s,function(){_ex._TI.$1[s]===undefined&&(_ex._TI.$1[s]=[null]);var t=_ex._TI._hf.childNodes[0].cloneNode(!0);var n=new _ex.$kV(t.children[0]);n.set_$6("ComposeExtensibilityView");return new _B(t,[n])},_ex.$KN,_ex.$10E,!1,!1,!1,0,_ex._TI.$1);var o="ComposeExtensibilityPopupView";new _A(o,function(){_ex._TI.$1[o]===undefined&&(_ex._TI.$1[o]=[[[-1,0,["ExtensibilityViewModel"],[_ex._TI.$D06],null,"DataContext",null,_ex._TI.$Z,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[1].cloneNode(!0);var n=new _js.$7(t.children[0]);n.set_$6("ComposeExtensibilityView");return new _B(t,[n])},_ex.$kU,_js.$7,!1,!1,!1,0,_ex._TI.$1);var e="ComposeExtensibilityView._tid1";new _A(e,function(){_ex._TI.$1[e]===undefined&&(_ex._TI.$1[e]=[null,[[-1,4,null,null,null,"AriaLabel",null,_ex._TI.$2n,0,null,null,null,_nbs.NonBootStrings.l_ComposeGetMoreApps_AT_Button_Text],[-1,4,null,null,null,"AriaRole",null,_ex._TI.$6d,0,null,null,0,7],[-1,4,null,null,null,"Text",null,_ex._TI.$1W,0,null,null,null,_nbs.NonBootStrings.l_ComposeGetMoreApps_Text],[-1,0,["IsTouch"],[_ex._TI.$D0A],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["OpenMarketplaceCommand"],[_ex._TI.$8uC],null,"ClickCommand",null,_ex._TI.$a,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[2].cloneNode(!0);var n=new _fc.$H(_B.$3(t,[1,0]));n.set_$g(-1);var i=new _fce.$v(t.children[0]);return new _B(t,[i,n]).R({ListPanel:i,GetMoreAppsButton:n})},_ex.$KN,_ex.$kT,!1,!0,!1,0,_ex._TI.$1);var l="ComposeExtensibilityView.ComposeExtensionListItemTemplate._tid3";new _A(l,function(){_ex._TI.$1[l]===undefined&&(_ex._TI.$1[l]=[null,[[-1,0,["DisplayName"],[_ex._TI.$6hU],null,"Text",null,_ex._TI.$H,1,null,null,null]],[[-1,0,["ProviderName"],[_ex._TI.$D0O],null,"Text",null,_ex._TI.$H,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[3].cloneNode(!0);var i=new _b.$KT(n.children[2]);var r=new _b.$KT(n.children[1]);var t=new _js.$7(n.children[0]);t.set_$6("ComposeExtensibilityView.ExtensionIconImage");return new _B(n,[t,r,i])},_ex.$7c,_js.$7,!1,!0,!1,0,_ex._TI.$1);var c="ComposeExtensibilityView.ComposeExtensionListItemTemplate";new _A(c,function(){_ex._TI.$1[c]===undefined&&(_ex._TI.$1[c]=[[[-1,0,["DisplayName"],[_ex._TI.$6hU],null,"AriaLabel",null,_ex._TI.$1l,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[4].cloneNode(!0);var n=new _js.$7(t.children[0]);n.set_$6("ComposeExtensibilityView.ComposeExtensionListItemTemplate._tid3");return new _B(t,[n])},_ex.$7c,_fce.$22,!1,!1,!1,0,_ex._TI.$1);var h="ComposeExtensibilityView.ExtensionIconImage";new _A(h,function(){_ex._TI.$1[h]===undefined&&(_ex._TI.$1[h]=[[[-1,4,null,null,null,"Id",null,_ex._TI.$14,0,null,null,null,_ex.$1.get_$7oZ()]],[[-1,0,["IconUrl"],[_ex._TI.$D0N],null,"Source",null,_ex._TI.$LY,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[5].cloneNode(!0);var i=new _ex.$11c(n.children[1]);var t=new _fc.$Y(n.children[0],_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));return new _B(n,[t,i])},_ex.$7c,_js.$7,!1,!1,!1,0,_ex._TI.$1);var i="ComposeExtensibilityView";new _A(i,function(){_ex._TI.$1[i]===undefined&&(_ex._TI.$1[i]=[[[-1,5,["SelectedExtension"],[_ex._TI.$44O],null,"_ex_s",null,null,0,_ex._TI.get_$24(),null,null],[-1,5,["IsLandscape"],[_ex._TI.$58h],null,"_ex_p",null,null,0,null,null,null],[-1,5,["IsTouchNarrow"],[_ex._TI.$8u6],null,"tnarrow",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaRole",null,_ex._TI.$6d,0,null,null,0,3],[-1,4,null,null,null,"ImageId",null,_ex._TI.$x,0,null,null,null,_n.$1.get_$5N()],[-1,4,null,null,null,"HoveredImageId",null,_ex._TI.$1o,0,null,null,null,_n.$1.get_$Gi()],[-1,4,null,null,null,"PressedImageId",null,_ex._TI.$5o,0,null,null,null,_n.$1.get_$5rx()],[-1,4,null,null,null,"Title",null,_ex._TI.$1b,0,null,null,null,_nbs.NonBootStrings.l_CloseAppPaneButton_Text],[-1,0,["IsTouchNarrow"],[_ex._TI.$8u6],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["HideAppPaneCommand"],[_ex._TI.$D08],null,"ClickCommand",null,_ex._TI.$a,1,null,null,null],[-1,5,["IsLandscape"],[_ex._TI.$58h],null,"_ex_q",null,null,0,_ex._TI.get_$K(),null,null]],[[-1,4,null,null,null,"AriaRole",null,_ex._TI.$6d,0,null,null,0,3],[-1,4,null,null,null,"Title",null,_ex._TI.$1b,0,null,null,null,_nbs.NonBootStrings.l_AppBackButton_Title_Button_Text],[-1,4,null,null,null,"ImageId",null,_ex._TI.$x,0,null,null,null,_n.$1.get_$7WV()],[-1,4,null,null,null,"HoveredImageId",null,_ex._TI.$1o,0,null,null,null,_ex.$1.get_$7WW()],[-1,0,["BackToListCommand"],[_ex._TI.$8u5],null,"ClickCommand",null,_ex._TI.$a,1,null,null,null],[-1,0,["SelectedExtension"],[_ex._TI.$44O],null,"IsHidden",null,_ex._TI.$8,1,_ex._TI.get_$24(),null,!0]],[[-1,4,null,null,null,"ImageId",null,_ex._TI.$x,0,null,null,null,_b.$1.get_$4Ri()],[-1,4,null,null,null,"PressedImageId",null,_ex._TI.$5o,0,null,null,null,_b.$1.get_$7WU()],[-1,0,["BackToListCommand"],[_ex._TI.$8u5],null,"ClickCommand",null,_ex._TI.$a,1,null,null,null],[-1,0,["SelectedExtension"],[_ex._TI.$44O],null,"IsHidden",null,_ex._TI.$8,1,_ex._TI.get_$24(),null,!0]],[[-1,0,["AppPaneTitle"],[_ex._TI.$D07],null,"Text",null,_ex._TI.$H,1,null,null,null]],[[-1,5,["IsLandscape"],[_ex._TI.$58h],null,"_ex_r",null,null,0,_ex._TI.get_$K(),null,null]],[[-1,0,["HideExtensionsList"],[_ex._TI.$D09],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["ActiveExtensions"],[_ex._TI.$8u8],null,"DataSource",null,_ex._TI.$2o,1,null,null,null],[-1,0,["ListViewEventInfo"],[_ex._TI.$D0B],_ex._TI.$D0C,"EventInfo",_ex._TI.$w3,_ex._TI.$w4,2,null,null,null]],[[-1,0,["OsfContextActivationManager"],[_ex._TI.$6hS],null,"OsfContextActivationManager",null,_ex._TI.$6hV,1,null,null,null],[-1,0,["HideExtensionContainer"],[_ex._TI.$8u9],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["UserCulture"],[_ex._TI.$6hT],null,"UserCulture",null,_ex._TI.$6hX,1,null,null,null],[-1,0,["SelectedExtension"],[_ex._TI.$44O],null,"SelectedExtension",null,_ex._TI.$6hW,1,null,null,null],[-1,0,["IsInOrgMarketplaceRole"],[_ex._TI.$8uA],null,"IsUserInOrgMarketplaceRole",null,_ex._TI.$8uE,1,null,null,!1],[-1,5,["IsLandscape"],[_ex._TI.$58h],null,"_ex_r",null,null,0,_ex._TI.get_$K(),null,null]],[[-1,0,["WindowObjectViewModel"],[_ex._TI.$8uD],null,"DataContext",null,_ex._TI.$Z,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[6].cloneNode(!0);var s=new _b.$Fi(_B.$3(n,[0,3]));var f=new _ex.$CG(_B.$3(n,[0,2]),_js.$2.Instance.$2(_y.$W));f.$3Ht=!0;var t=new _ex.$kT(_B.$3(n,[0,1,0]),_js.$2.Instance.$2(_y.$W));t.set_$3Z("ComposeExtensibilityView.ComposeExtensionListItemTemplate");t.set_$BC("_ex_o");t.set_$6("ComposeExtensibilityView._tid1");var h=new _js.$F(_B.$3(n,[0,1]));var c=new _b.$KT(_B.$3(n,[0,0,3]));var o=new _fc.$H(_B.$3(n,[0,0,2]));var u=new _fc.$H(_B.$3(n,[0,0,1]));var r=new _fc.$H(_B.$3(n,[0,0,0]));r.set_$g(0);var e=new _js.$F(_B.$3(n,[0,0]));return new _B(n,[e,r,u,o,c,h,t,f,s]).R({CloseButton:r,AppsBackButton:u,ComposeExtMenuListView:t})},_ex.$KN,_ex.$kV,!1,!1,!1,0,_ex._TI.$1);var t="ExtensibilityPopupView";new _A(t,function(){_ex._TI.$1[t]===undefined&&(_ex._TI.$1[t]=[[[-1,0,["ExtensibilityViewModel","UserCulture"],[_ex._TI.$58i,_ex._TI.$6hT],null,"UserCulture",null,_ex._TI.$6hX,1,null,null,null],[-1,0,["ExtensibilityViewModel","OsfContextActivationManager"],[_ex._TI.$58i,_ex._TI.$6hS],null,"OsfContextActivationManager",null,_ex._TI.$6hV,1,null,null,null],[-1,0,["ExtensibilityViewModel","OverflowMenuViewModel","TabSelectedExtension"],[_ex._TI.$58i,_ex._TI.$1qi,_ex._TI.$6hR],null,"SelectedExtension",null,_ex._TI.$6hW,1,null,null,null]],[[-1,0,["ItemBodyValue"],[_ex._TI.$D0L],null,"Html",null,_ex._TI.$vr,1,null,null,null],[-1,2,["ExtensibilityViewModel","SelectedExtension","HighlightedTerms"],[_ex._TI.$58i,_ex._TI.$44O,_ex._TI.$1MV],null,_b.$2P.$xC,null,null,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[7].cloneNode(!0);var i=new _b.$2n(n.children[1],_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_a.$C9.$$(ILinkPreviewBuilderFactory)));i.$P(_b.$2P.$lp,"extensionHighlight");var r=new _ex.$CG(n.children[0],_js.$2.Instance.$2(_y.$W));return new _B(n,[r,i])},_ex.$lM,_js.$7,!1,!1,!1,0,_ex._TI.$1);var n="ExtensibilityView._tid4";new _A(n,function(){_ex._TI.$1[n]===undefined&&(_ex._TI.$1[n]=[[[-1,4,null,null,null,"Text",null,_ex._TI.$1W,0,null,null,null,_nbs.NonBootStrings.l_ExtensibilityTabGetMoreApps_Text],[-1,4,null,null,null,"ImageId",null,_ex._TI.$x,0,null,null,null,_ex.$1.get_$1Bc()],[-1,4,null,null,null,"HoveredImageId",null,_ex._TI.$1o,0,null,null,null,_ex.$1.get_$11T()],[-1,0,["MarketplaceUrl"],[_ex._TI.$8uB],null,"IsHidden",null,_ex._TI.$8,1,_ex._TI.get_$2e(),null,!0],[-1,0,["OpenMarketplaceCommand"],[_ex._TI.$8uC],null,"ClickCommand",null,_ex._TI.$a,1,null,null,null]],null,[[-1,4,null,null,null,"ImageId",null,_ex._TI.$x,0,null,null,null,_ex.$1.get_$5kn()],[-1,0,["OverflowMenuViewModel","HideExtensionContextMenu"],[_ex._TI.$1qi,_ex._TI.$8u7],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0]]]);var t=_ex._TI._hf.childNodes[8].cloneNode(!0);var u=new _fc.$H(t.children[2]);var i=new _fce.$1D(_js.$2.Instance.$2(_fc.$l),_js.$2.Instance.$2(_ff.$M),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));i.$M(_E.$D(["OverflowMenuViewModel","ExtensionsContextMenuViewModel"],[_ex._TI.$1qi,_ex._TI.$D0D],null,"MenuDataContext",null,_ex._TI.$3q,1)).$M(_E.$D(["OverflowMenuViewModel","HideExtensionContextMenu"],[_ex._TI.$1qi,_ex._TI.$8u7],null,"IsShown",null,_ex._TI.$3m,1,_ex._TI.get_$K(),null,!1));i.$58=3;u.set_$12([i]);var r=new _fce.$v(t.children[1]);var f=new _fc.$H(t.children[0]);return new _B(t,[f,r,u]).R({ListPanel:r})},_ex.$sr,_ex.$3r,!1,!0,!1,0,_ex._TI.$1);var f="ExtensibilityView.ExtensionListItemTemplate._tid7";new _A(f,function(){_ex._TI.$1[f]===undefined&&(_ex._TI.$1[f]=[[[-1,0,["DisplayName"],[_ex._TI.$6hU],null,"Text",null,_ex._TI.$H,1,null,null,null]]]);var n=_ex._TI._hf.childNodes[9].cloneNode(!0);var t=new _fc.$A(n.children[0]);return new _B(n,[t])},_ex.$7c,_js.$7,!1,!0,!1,0,_ex._TI.$1);var u="ExtensibilityView.ExtensionListItemTemplate";new _A(u,function(){_ex._TI.$1[u]===undefined&&(_ex._TI.$1[u]=[[[-1,5,["IsSelected"],[_ex._TI.$O0],null,"ms-font-color-white ms-bg-color-themeSecondary",null,null,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[10].cloneNode(!0);var n=new _js.$7(t.children[0]);n.set_$6("ExtensibilityView.ExtensionListItemTemplate._tid7");return new _B(t,[n])},_ex.$7c,_fce.$22,!1,!1,!1,0,_ex._TI.$1);var r="ExtensibilityView";new _A(r,function(){_ex._TI.$1[r]===undefined&&(_ex._TI.$1[r]=[[[-1,0,["OverflowMenuViewModel","ExtensionsTabList"],[_ex._TI.$1qi,_ex._TI.$D0E],null,"DataSource",null,_ex._TI.$2o,1,null,null,null],[-1,0,["OverflowMenuViewModel","TabSelectedExtension"],[_ex._TI.$1qi,_ex._TI.$6hR],_ex._TI.$D0K,"SelectedItem",_ex._TI.$6L,_ex._TI.$6I,2,null,null,null],[-1,0,["OverflowMenuViewModel","MaxTabCount"],[_ex._TI.$1qi,_ex._TI.$D0G],_ex._TI.$D0J,"MaxTabCount",_ex._TI.$D0P,_ex._TI.$D0S,2,null,null,0],[-1,0,["ActiveExtensions"],[_ex._TI.$8u8],null,"ActiveExtensions",null,_ex._TI.$D0Q,1,null,null,null],[-1,0,["OverflowMenuViewModel","PopulateMenuItemsCommand"],[_ex._TI.$1qi,_ex._TI.$D0H],null,"PopulateMenuItemsCommand",null,_ex._TI.$D0T,1,null,null,null],[-1,0,["OverflowMenuViewModel","ListViewEventInfo"],[_ex._TI.$1qi,_ex._TI.$D0F],_ex._TI.$D0I,"EventInfo",_ex._TI.$w3,_ex._TI.$w4,2,null,null,null],[-1,0,["MarketplaceUrl"],[_ex._TI.$8uB],null,"IsGetMoreAppHidden",null,_ex._TI.$D0R,1,_ex._TI.get_$2e(),null,!1]],[[-1,0,["OsfContextActivationManager"],[_ex._TI.$6hS],null,"OsfContextActivationManager",null,_ex._TI.$6hV,1,null,null,null],[-1,0,["HideExtensionContainer"],[_ex._TI.$8u9],null,"IsHidden",null,_ex._TI.$8,1,null,null,!0],[-1,0,["UserCulture"],[_ex._TI.$6hT],null,"UserCulture",null,_ex._TI.$6hX,1,null,null,null],[-1,0,["OverflowMenuViewModel","TabSelectedExtension"],[_ex._TI.$1qi,_ex._TI.$6hR],null,"SelectedExtension",null,_ex._TI.$6hW,1,null,null,null],[-1,0,["NativeBridge"],[_ex._TI.$D0M],null,"NativeBridge",null,_ex._TI.$D0U,1,null,null,null],[-1,0,["IsInOrgMarketplaceRole"],[_ex._TI.$8uA],null,"IsUserInOrgMarketplaceRole",null,_ex._TI.$8uE,1,null,null,!1]],[[-1,0,["WindowObjectViewModel"],[_ex._TI.$8uD],null,"DataContext",null,_ex._TI.$Z,1,null,null,null]]]);var t=_ex._TI._hf.childNodes[11].cloneNode(!0);var i=new _b.$Fi(_B.$3(t,[0,2]));var u=new _ex.$CG(_B.$3(t,[0,1]),_js.$2.Instance.$2(_y.$W));var n=new _ex.$3r(_B.$3(t,[0,0,0]),_js.$2.Instance.$2(_y.$W));n.set_$3Z("ExtensibilityView.ExtensionListItemTemplate");n.set_$BC("_ex_x");n.set_$6("ExtensibilityView._tid4");return new _B(t,[n,u,i])},_ex.$sr,_js.$7,!1,!1,!1,0,_ex._TI.$1)};_ex._TI.$9S=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div autoid=\"_ex_0\" class='_ex_2 _ex_3'></div> </div><div> <div autoid=\"_ex_1\" class='_ex_4'></div> </div><div> <div></div> <div class='_ex_l'> <button autoid=\"_ex_7\" type='button' class='_ex_m ms-font-weight-regular'></button> </div> </div><div> <div class='_ex_8'></div> <div autoid=\"_ex_9\" class='_ex_j _ex_5'></div> <div autoid=\"_ex_a\" class='_ex_k ms-font-weight-regular _ex_5'></div> <div style=\"clear:both;\"></div> </div><div> <div autoid=\"_ex_8\" class='_ex_i'></div> </div><div> <span class='_ex_9'></span> <img autoid=\"_ex_b\" class='_ex_a'/> </div><div> <div class='_ex_e'> <div class='_ex_g'> <button autoid=\"_ex_2\" type='button' class='_ex_f'></button>  <button autoid=\"_ex_3\" type='button' class='_ex_6'></button>  <button autoid=\"_ex_4\" type='button' class='_ex_7'></button> <div autoid=\"_ex_5\" class='_ex_h _ex_5'></div> <div style=\"clear:both;\"></div> </div> <div class='_ex_b'> <div autoid=\"_ex_6\" class='_ex_n'></div> </div> <div class='_ex_c'></div> <div class='hidden'> </div> </div>   </div><div> <div class='_ex_t ms-border-color-themeSecondary'></div> <div class='_ex_u ms-bg-color-white'></div> </div><div> <button autoid=\"_ex_d\" type='button' class='_ex_B'></button> <div class='_ex_x'></div> <button type='button' class='_ex_A ms-font-s ms-font-color-themePrimary'></button> </div><div> <span autoid=\"_ex_f\"></span> </div><div> <div autoid=\"_ex_e\" class='_ex_w ms-font-s ms-font-color-themePrimary'></div> </div><div> <div class='_ex_v'> <div class='_ex_y ms-bg-color-neutralLight'> <div autoid=\"_ex_c\"></div> </div> <div class='_ex_z ms-border-color-themeSecondary'></div> <div class='hidden'> </div> </div>  </div>";_js.$F.get_$9G().appendChild(n);return n};_ex._TI.$D06=function(n){return n.$65};_ex._TI.$D0A=function(n){return n.get_$2Oz()};_ex._TI.$8uC=function(n){return n.$3Sj};_ex._TI.$6hU=function(n){return n.get_$26()};_ex._TI.$D0O=function(n){return n.get_$9JU()};_ex._TI.$D0N=function(n){return n.get_$8Nl()};_ex._TI.$44O=function(n){return n.$CN};_ex._TI.$58h=function(n){return n.get_$13S()};_ex._TI.$8u6=function(n){return n.get_$6UJ()};_ex._TI.$D08=function(n){return n.$3GC};_ex._TI.$8u5=function(n){return n.$32j};_ex._TI.$D07=function(n){return n.$2Da};_ex._TI.$D09=function(n){return n.$2MR};_ex._TI.$8u8=function(n){return n.$Ij};_ex._TI.$D0B=function(n){return n.$13e};_ex._TI.$w3=function(n){return n.get_$Cb()};_ex._TI.$6hS=function(n){return n.$1an};_ex._TI.$8u9=function(n){return n.$1TW};_ex._TI.$6hT=function(n){return n.$Hn};_ex._TI.$8uA=function(n){return n.get_$8Um()};_ex._TI.$8uD=function(n){return n.$Qa};_ex._TI.$58i=function(n){return n.$65};_ex._TI.$1qi=function(n){return n.$dl};_ex._TI.$6hR=function(n){return n.$1I1};_ex._TI.$D0L=function(n){return n.$3KK};_ex._TI.$1MV=function(n){return n.get_$22U()};_ex._TI.$8uB=function(n){return n.$1Ur};_ex._TI.$8u7=function(n){return n.$2MQ};_ex._TI.$D0D=function(n){return n.$1Jp};_ex._TI.$O0=function(n){return n.get_$2f()};_ex._TI.$D0E=function(n){return n.$rA};_ex._TI.$6L=function(n){return n.get_$1F()};_ex._TI.$D0G=function(n){return n.$p7};_ex._TI.$D0P=function(n){return n.$p7};_ex._TI.$D0H=function(n){return n.$10L};_ex._TI.$D0F=function(n){return n.$13e};_ex._TI.$D0M=function(n){return n.$l};_ex._TI.$Z=function(n,t){n.set_$k(t)};_ex._TI.$8=function(n,t){n.set_$17(t)};_ex._TI.$a=function(n,t){n.set_$4k(t)};_ex._TI.$2n=function(n,t){n.set_$4E(t)};_ex._TI.$6d=function(n,t){n.set_$18(t)};_ex._TI.$1W=function(n,t){n.set_$1K(t)};_ex._TI.$H=function(n,t){n.set_$1K(t)};_ex._TI.$1l=function(n,t){n.set_$4E(t)};_ex._TI.$14=function(n,t){n.set_$2O(t)};_ex._TI.$LY=function(n,t){n.set_$Br(t)};_ex._TI.$x=function(n,t){n.set_$BI(t)};_ex._TI.$1o=function(n,t){n.set_$Es(t)};_ex._TI.$5o=function(n,t){n.set_$ac(t)};_ex._TI.$1b=function(n,t){n.set_$3u(t)};_ex._TI.$2o=function(n,t){n.set_$20(t)};_ex._TI.$D0C=function(n,t){n.set_$50p(t)};_ex._TI.$w4=function(n,t){n.set_$Cb(t)};_ex._TI.$6hV=function(n,t){n.set_$48o(t)};_ex._TI.$6hX=function(n,t){n.set_$CE(t)};_ex._TI.$6hW=function(n,t){n.set_$1tj(t)};_ex._TI.$8uE=function(n,t){n.$3K6=t};_ex._TI.$vr=function(n,t){n.set_$Sa(t)};_ex._TI.$3q=function(n,t){n.set_$KX(t)};_ex._TI.$3m=function(n,t){n.set_$1C(t)};_ex._TI.$D0K=function(n,t){n.set_$2aH(t)};_ex._TI.$6I=function(n,t){n.set_$1F(t)};_ex._TI.$D0J=function(n,t){n.$p7=t};_ex._TI.$D0S=function(n,t){n.set_$2QR(t)};_ex._TI.$D0Q=function(n,t){n.$Ij=t};_ex._TI.$D0T=function(n,t){n.set_$6ue(t)};_ex._TI.$D0I=function(n,t){n.set_$50p(t)};_ex._TI.$D0R=function(n,t){n.$3IT=t};_ex._TI.$D0U=function(n,t){n.$l=t};_ex._TI.get_$24=function(){_ex._TI.$47||(_ex._TI.$47=new _fc.$6Q);return _ex._TI.$47};_ex._TI.get_$K=function(){_ex._TI.$2L||(_ex._TI.$2L=new _fc.$42);return _ex._TI.$2L};_ex._TI.get_$2e=function(){_ex._TI.$4Y||(_ex._TI.$4Y=new _fc.$6o);return _ex._TI.$4Y};ExtensibilityComponent.registerClass("ExtensibilityComponent",null,_a.$1X7);_ex.$lK.registerClass("_ex.$lK",_h.$1A3.$$(_g.$Ub));_ex.$le.registerClass("_ex.$le",_h.$TS.$$(_g.$V7,_g.$lg));_ex.$lk.registerClass("_ex.$lk",_h.$TS.$$(_g.$OB,_g.$WF));_ex.$4W.registerClass("_ex.$4W",_h.$1A3.$$(_g.$O2));_ex.$Ve.registerClass("_ex.$Ve",_h.$TS.$$(_g.$V7,_g.$lg));_ex.$WP.registerClass("_ex.$WP",_h.$1A3.$$(_g.$WR));_ex.$17i.registerClass("_ex.$17i",_h.$1A3.$$(String));_ex.$pC.registerClass("_ex.$pC",_h.$1A3.$$(_g.$Xc));_ex.$pD.registerClass("_ex.$pD",_h.$1A3.$$(_g.$Xe));_ex.$5K.registerClass("_ex.$5K");_ex.$5K.$3iZ.registerClass("_ex.$5K.$3iZ");_ex.$Ue.registerClass("_ex.$Ue");_ex.$11Z.registerClass("_ex.$11Z",null,_ex.$1UG);_ex.$6E.registerClass("_ex.$6E",null,_ex.$1UG);_ex.$1ZA.registerClass("_ex.$1ZA");_ex.$jB.registerClass("_ex.$jB",_ex.$1ZA);_ex.$yW.registerClass("_ex.$yW",_ex.$jB);_ex.$yX.registerClass("_ex.$yX",_ex.$jB);_ex.$jH.registerClass("_ex.$jH",_ex.$1ZA);_ex.$1a6.registerClass("_ex.$1a6",_ex.$1ZA);_ex.$zL.registerClass("_ex.$zL",_ex.$1a6);_ex.$zM.registerClass("_ex.$zM",_ex.$1a6);_ex.$1ZB.registerClass("_ex.$1ZB");_ex.$1R.registerClass("_ex.$1R");_ex.$1a9.registerClass("_ex.$1a9",_ex.$1R);_ex.$11X.registerClass("_ex.$11X",_ex.$1a9);_ex.$4e.registerClass("_ex.$4e",_ex.$1R);_ex.$1Ep.registerClass("_ex.$1Ep",_ex.$4e);_ex.$Ug.registerClass("_ex.$Ug");_ex.$11d.registerClass("_ex.$11d",_ex.$1a9);_ex.$11e.registerClass("_ex.$11e",_ex.$4e);_ex.$123.registerClass("_ex.$123",_ex.$1ZA);_ex.$12C.registerClass("_ex.$12C",_ex.$1ZA);_ex.$VZ.registerClass("_ex.$VZ",_ex.$1ZA);_ex.$12O.registerClass("_ex.$12O",_ex.$1ZA);_ex.$12M.registerClass("_ex.$12M",_ex.$1ZA);_ex.$12R.registerClass("_ex.$12R",_ex.$1ZA);_ex.$14c.registerClass("_ex.$14c",_ex.$1ZA);_ex.$17T.registerClass("_ex.$17T",_ex.$1ZA);_ex.$LD.registerClass("_ex.$LD",_ex.$1ZA);_ex.$18G.registerClass("_ex.$18G",_ex.$1ZA);_ex.$18N.registerClass("_ex.$18N",_ex.$1ZA);_ex.$18M.registerClass("_ex.$18M",_ex.$1a6);_ex.$18O.registerClass("_ex.$18O",_ex.$1ZA);_ex.$29.registerClass("_ex.$29");_ex.$19n.registerClass("_ex.$19n",null,_y.$mk,_a.$1Iw);_ex.$kU.registerClass("_ex.$kU",_y.$1b6,_bc.$Kk,_bc.$e2,_bc.$mB,_a.$1Y6,_js.$13p,Sys.IDisposable,_y.$tg);_ex.$2H.registerClass("_ex.$2H",_a.$En,_y.$1Iv);_ex.$KN.registerClass("_ex.$KN",_ex.$2H,_y.$1Vm,_y.$1Iv);_ex.$11a.registerClass("_ex.$11a",_a.$AY);_ex.$F5.registerClass("_ex.$F5");_ex.$BH.registerClass("_ex.$BH",_a.$En);_ex.$lM.registerClass("_ex.$lM",_y.$1b6,_bc.$Kk,_bc.$e2,_bc.$mB,_a.$1Y6,_js.$13p,Sys.IDisposable,_y.$tg);_ex.$Ui.registerClass("_ex.$Ui");_ex.$11f.registerClass("_ex.$11f",null,IExtensibilityStatistics);_ex.$11f.$4Oc.registerClass("_ex.$11f.$4Oc");_ex.$11f.$7Y2.registerClass("_ex.$11f.$7Y2");_ex.$11f.$4e5.registerClass("_ex.$11f.$4e5");_ex.$11f.$7pk.registerClass("_ex.$11f.$7pk");_ex.$11g.registerClass("_ex.$11g",null,_y.$1YR);_ex.$sr.registerClass("_ex.$sr",_ex.$2H);_ex.$11h.registerClass("_ex.$11h",null,IExtensibilityViewModelFactory);_ex.$11i.registerClass("_ex.$11i",_a.$AY);_ex.$bX.registerClass("_ex.$bX",_js.$Ct);_ex.$7c.registerClass("_ex.$7c",_a.$En,_y.$1Vi);_ex.$17c.registerClass("_ex.$17c",_ex.$11g);_ex.$B7.registerClass("_ex.$B7");_ex.$108.registerClass("_ex.$108",_ex.$B7);_ex.$lG.registerClass("_ex.$lG");_ex.$3k.registerClass("_ex.$3k");_ex.$14G.registerClass("_ex.$14G",_ex.$B7);_ex.$3l.registerClass("_ex.$3l",_ex.$B7);_ex.$Dr.registerClass("_ex.$Dr",_ex.$B7);_ex.$F9.registerClass("_ex.$F9",_ex.$B7);_ex.$Gz.registerClass("_ex.$Gz");_ex.$10E.registerClass("_ex.$10E",_js.$F);_ex.$kT.registerClass("_ex.$kT",_fce.$m);_ex.$kV.registerClass("_ex.$kV",_js.$7);_ex.$11c.registerClass("_ex.$11c",_b.$J5);_ex.$3r.registerClass("_ex.$3r",_fce.$m);_ex.$1.registerClass("_ex.$1");_ex.$CG.registerClass("_ex.$CG",_js.$F);_ex._TI.registerClass("_ex._TI");_ex.$4W.$en=null;_ex.$4W.$2PQ=0;_ex.$5K.$1Q=null;_ex.$6E.$2T5=null;_ex.$6E.$1rm=null;_ex.$1R.$1S3={wasSuccessful:!1};_ex.$1R.$1wP=new RegExp(" ","g");_ex.$1R.$2Dv=null;_ex.$1R.$2Dw=null;_ex.$1R.$2Dz=null;_ex.$1R.$2Dx=null;_ex.$LD.$4Z8={wasSuccessful:!0};_ex.$F5.$L2={};_ex.$BH.$4r6="HideExtensionContextMenu";_ex.$BH.$3cZ="TabSelectedExtension";_ex.$2H.$8NM="HighlightedTerms";_ex.$2H.$7pb="ExtensionBecomeActiveTestOnly";_ex.$2H.$46r="NoActiveExtensions";_ex.$2H.$41G="MarketplaceUrl";_ex.$2H.$5En="OnGetExtensibilityContextCompleted";_ex.$2H.$8Mp="HideExtensionContainer";_ex.$2H.$7Qv="ActiveExtensionsCount";_ex.$2H.$2Nw=!1;_ex.$2H.$12v=null;_ex.$7c.$4sI=window.matchMedia&&window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 2)").matches;_ex.$3r.$1By=0;_ex.$3r.$2EW={};_ex.$3r.$wf=null;_ex.$CG.$2U2=0;_ex._TI._hf=_ex._TI.$9S();_ex._TI.$47=null;_ex._TI.$2L=null;_ex._TI.$4Y=null;_ex._TI.$1={};_ex._TI.$$cctor();
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.extensibility.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.extensibility.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
