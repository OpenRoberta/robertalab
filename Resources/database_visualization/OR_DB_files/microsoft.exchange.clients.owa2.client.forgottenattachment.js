try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.forgottenattachment.js'] = (new Date()).getTime();
Type.registerNamespace("_fa");_fa.$13H=function(){};_fa.$13H.registerInterface("_fa.$13H");function ForgottenAttachmentComponent(){}ForgottenAttachmentComponent.prototype={$2FV:function(n,t,i){var u=this;n.$r(_fa.$13H).$1I().$t(function(){return new _fa.$JB});var r=this;n.$r(_fa.$120).$2a(IForgottenAttachmentDetectorFactory).$1I().$t(function(){return new _fa.$120(n.$2(_fa.$13H),n.$2(_g.$2Z),n.$2(_a.$2Y))})},$Bl5:function(){return null}};_fa.$1FP=function(n,t){_fa.$1FP.initializeBase(this,[1,"ForgottenAttachment.AttachmentEvent"]);this.set_$38t(n);this.set_$E6B(t)};_fa.$1FP.prototype={set_$38t:function(n){this.$P("Event",n);return n},set_$E6B:function(n){this.$P("RuleNum",n);return n}};_fa.$bz=function(n,t,i,r,u){this.$$d_$ByB=Function.createDelegate(this,this.$ByB);this.$2F=n;this.$LB=t;this.$1lf=i;this.$d=r;this.$n=u;this.$5Wd=r.get_$1j().get_$1aZ()};_fa.$bz.prototype={$2F:null,$LB:null,$d:null,$n:null,$1lf:null,$5yN:!1,$3Kq:null,$5Wd:!1,$6MQ:!1,$4qJ:function(n,t){if(!this.$5Wd||this.$6MQ)return!1;var o=!1;if($C(t)){t=n.get_$EW();o=!0}if(!$C(n.get_$3sY())){n.get_$3sY().$11();var u=!1;if(t)if(o)u=t.get_$A()>0;else for(var i=0;i<t.get_$A();i++){var h=t.get_$E(i);if(!h.get_$kd()){u=!0;break}}var s=n.get_$6P()==="HTML";if(u||s&&this.$C0r(n.get_$MW()))this.$5yN&&this.$1lf.$5LN(2,this.$3Kq);else{var r;var f,e;if(e=this.$1lf.$4qJ(n.get_$3o(),n.get_$MW(),s,this.$d.get_$4P().get_$CE(),f={val:r}),r=f.val,e){this.$3Kq=r;this.$5yN=!0;this.$2F.$RN(1,[_nbs.NonBootStrings.l_MailComposeForgottenAttachmentMessage_Text],this.$$d_$ByB,!0,_nbs.NonBootStrings.l_MailComposeForgottenAttachmentSendAnyway_Text,_nbs.NonBootStrings.l_MailComposeForgottenAttachmentDontSend_Text,_nbs.NonBootStrings.l_MailComposeForgottenAttachmentTitle_Text,this.$2F.$6R);return!0}}}return!1},$ByB:function(n,t){if(t){this.$d.get_$1j().set_$1aZ(!1);_h.$21.$Kq(this.$d.get_$1j().$Hm,this.$n);this.$1lf.$5LN(3,this.$3Kq);this.$5Wd=!1}if(n){this.$6MQ=!0;this.$1lf.$5LN(0,this.$3Kq);this.$LB.$11()}else this.$1lf.$5LN(1,this.$3Kq)},$C0r:function(n){var u=document.createElement("div");var t=$(u);t.html(n);t.find("#divRplyFwdMsg").nextAll().remove();var r=String.format('img[src*="{0}"]',_fa.$bz.$7Wy);var i=t.find(r).first();return i.size()>0}};_fa.$120=function(n,t,i){this.$1lf=n;this.$d=t;this.$n=i};_fa.$120.prototype={$1lf:null,$d:null,$n:null,$7gc:function(n,t){return new _fa.$bz(n,t,this.$1lf,this.$d,this.$n)}};_fa.$JB=function(){};_fa.$JB.$$cctor=function(){_fa.$JB.$7Hi={};_fa.$JB.$7Hi.en=!0};_fa.$JB.$Asi=function(n){return typeof window.NLG!="undefined"&&typeof window.Microsoft_NaturalLanguage_AttachmentRes!="undefined"&&!!window.Microsoft_NaturalLanguage_AttachmentRes[n]};_fa.$JB.$Bov=function(n){return n.substr(0,2)};_fa.$JB.prototype={$4qJ:function(n,t,i,r,u){u.val=null;if($C(r)||r.length<2)return!1;$C(t)&&(t="");$C(n)&&(n="");var e=_fa.$JB.$Bov(r);if(!_fa.$JB.$Asi(e))return!1;var h=_a.$6.$1g(_a.$0.$L1,"ForgottenAttachment.Start",!0);var o=this.$Bnc();var s=i?NLG.PlainTextConverter.getPlainText(t):t;var f=new NLG.EmailData;f.body=NLG.PlainTextConverter.getLastMessage(s,e);f.subject=n;u.val=o.hasAttachments(f,e);_a.$6.$1G(h);return u.val.hasAttachment},$5LN:function(n,t){OwaApplication.$Bk.$F(new _fa.$1FP(n,t.ruleNumber))},$Bnc:function(){return new NLG.FAD.ForgottenAttachmentDetector}};ForgottenAttachmentComponent.registerClass("ForgottenAttachmentComponent",null,_a.$1X7);_fa.$1FP.registerClass("_fa.$1FP",_a.$AY);_fa.$bz.registerClass("_fa.$bz",null,IForgottenAttachmentDetector);_fa.$120.registerClass("_fa.$120",null,IForgottenAttachmentDetectorFactory);_fa.$JB.registerClass("_fa.$JB",null,_fa.$13H,IForgottenAttachmentImplementation);_fa.$bz.$7Wy=String.format("service.svc/s/GetFileAttachment?id={0}","");_fa.$JB.$7Hi=null;_fa.$JB.$$cctor();
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.forgottenattachment.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.forgottenattachment.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
