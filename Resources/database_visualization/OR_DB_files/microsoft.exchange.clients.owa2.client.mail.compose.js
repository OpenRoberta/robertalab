try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.exchange.clients.owa2.client.mail.compose.js'] = (new Date()).getTime();
Type.registerNamespace("_mcp");function MailComposeComponent(){}MailComposeComponent.$9ot=function(n,t,i){var o=n==="Mouse";var s=!(t.get_$Df()&&t.get_$gv().get_$5A()<9);var r=i.get_$4P().get_$CE();var e=!!r&&r.startsWith("en");var f=!!i.get_$bB()&&i.get_$bB().get_$5qj();var u=!!i.get_$1j()&&i.get_$1j().get_$1aZ();return o&&f&&u&&s&&e};MailComposeComponent.prototype={$2FV:function(n,t,i){var e=this;n.$r(_mcp.$mv).$2a(IMailComposeActionFactory).$1I().$t(function(){return new _mcp.$mv});var o=this;n.$r(_mcp.$14u).$2a(IMailResponseViewModelFactory).$1I().$t(function(){return new _mcp.$14u(n.$2(IInferenceTracker),n.$2(_g.$O),n.$2(IMailComposeContextFactory),n.$2(_mcp.$mv),n.$3K(ISmimeCommandFactory))});var s=this;n.$r(IMailComposeContextFactory).$1I().$t(function(){return new _mcp.$1Ky(n.$2(_y.$my),n.$2(_a.$AE))});var r=this;n.$r(_mcp.$14q).$2a(IMailComposeViewModelFactory).$1I().$t(function(){var u=n.$2(_a.$t);var f=n.$2(_g.$2Z);var e=MailComposeComponent.$9ot(i.get_$AA(),u,f);var t=n.$2(_a.$1d);var r=i.get_$AA()==="Mouse"&&t.$2r("ComposeBread1");return new _mcp.$14q(n.$3K(IExtensibilityViewModelFactory),n.$2(_rw.$XO),e?n.$3K(IForgottenAttachmentDetectorFactory):null,n.$3K(IRichPeoplePickerViewModelFactory),n.$2(IMailComposeContextFactory),n.$2(_mcp.$mv),n.$2(_pe.$Ch),n.$2(_y.$W),n.$3K(IOfflineHelpProvider),n.$2(_mcp.$uh),n.$2(_y.$Dp),n.$2(_ff.$M),n.$3K(IAttachmentWellViewModelFactory),t,n.$2(_a.$AE),n.$36(IAttachmentsFilePickerPanelViewModel),n.$2(IInferenceTracker),n.$2(_g.$Lo),n.$2(_a.$3G),n.$2(_g.$AM).get_$9xD(),n.$36(IMyLocationBuilder),n.$3K(IMailTipsHandlerFactory),n.$3K(IPolicyTipsHandlerFactory),i.get_$AA()==="Mouse"?n.$2(_cmc.$kS):null,r?n.$3K(ISendNotificationProviderViewModel):null,r?n.$3K(ISendFailureNotificationProviderViewModel):null,n.$3K(IFindRecipientMailComposeViewModelFactory),n.$36(IComponentOverrideFactory),n.$2(_g.$O).get_$2dr(),n.$3K(IIntroductionControllerFactory))});var u=this;n.$r(_mcp.$uh).$2a(IMailComposeDiscardManager).$1I().$t(function(){return new _mcp.$uh(n.$2(IMailComposeActionFactory))});var f=this;n.$r(_mcp.$mz).$t(function(){return new _mcp.$mz(window.document.createElement("div"),i.get_$AA(),n.$2(_a.$t),n.$2(_a.$AE),n.$2(_a.$1d),n.$2(_a.$3G))})},$Bl5:function(){return null}};_mcp.$sN=function(n){_mcp.$sN.initializeBase(this);this.$1kM=n};_mcp.$sN.prototype={$1kM:null,$6OX:function(n){var i=this.$u4();var t=new _g.$1DP(this.$2k);t.explicitLogonUser=this.$1kM.$Qc;$C(this.$1kM.$Hp)||t.actionName||(t.actionName=this.$1kM.$Hp);n.$7i0(i,t,this.$$d_$6qk,this.$$d_$1N0)},$u4:function(){var t=this.$1kM.$AQg();var i=new _g.$ab(this.get_$7h());var n=new _g.$UI;n.Items=t.Items;n.ItemShape=t.ItemShape;n.ShapeName=t.ShapeName;n.SubjectPrefix=t.SubjectPrefix;n.ClientSupportsIrm=t.ClientSupportsIrm;n.ComplianceId=t.ComplianceId;n.ComposeOperation=t.ComposeOperation;n.IsNonDraft=t.IsNonDraft;n.MessageDisposition=t.MessageDisposition;n.OutboundCharset=t.OutboundCharset;n.SavedItemFolderId=t.SavedItemFolderId;n.SendOnNotFoundError=t.SendOnNotFoundError;n.ShouldSuppressReadReceipt=t.ShouldSuppressReadReceipt;n.UseGB18030=t.UseGB18030;n.UseISO885915=t.UseISO885915;n.TimeFormat=t.TimeFormat;i.Body=n;return i},$1N0:function(n){_h.$1A3.prototype.$1N0.call(this,n)},$wV:function(n){this.$1kM.$Dv7(n)}};var IMailComposeOverridable=function(){};IMailComposeOverridable.registerInterface("IMailComposeOverridable");_mcp.$Gn=function(n,t,i,r,u,f,e,o){this.$$d_$8QZ=Function.createDelegate(this,this.$8QZ);this.$$d_$Dam=Function.createDelegate(this,this.$Dam);this.$$d_$97m=Function.createDelegate(this,this.$97m);this.$$d_$DWF=Function.createDelegate(this,this.$DWF);this.$$d_$9tm=Function.createDelegate(this,this.$9tm);this.$$d_$1tX=Function.createDelegate(this,this.$1tX);this.$$d_$E6s=Function.createDelegate(this,this.$E6s);this.$$d_$DWv=Function.createDelegate(this,this.$DWv);this.$$d_$26p=Function.createDelegate(this,this.$26p);this.$$d_$1s1=Function.createDelegate(this,this.$1s1);this.$$d_$Bk3=Function.createDelegate(this,this.$Bk3);this.$$d_$8QS=Function.createDelegate(this,this.$8QS);this.$$d_$1Pk=Function.createDelegate(this,this.$1Pk);_mcp.$Gn.initializeBase(this,[5,n]);this.$3Y=i;this.$N6=u;this.$F1=t;this.$16M=new _C(this.$$d_$1Pk,this.get_$m());this.$1D=r;this.$5C1=f;this.$tx=e;this.$CY=o};_mcp.$Gn.prototype={$3Y:null,$1D:null,$N6:null,$F1:null,$5C1:null,$WK:null,$tx:null,$16M:null,$1dR:null,$4tD:null,$49u:null,$3vh:null,$4yy:!1,$rD:null,$1aE:null,$3zJ:!1,$9kI:!1,$CY:null,get_$Tf:function(){return this.$w(_mcp.$Gn.$24o)},set_$Tf:function(n){this.$P(_mcp.$Gn.$24o,n);return n},get_$8QU:function(){this.$4tD||(this.$4tD=new _C(this.$$d_$8QS,this.get_$m()));return this.$4tD},add_$6ne:function(n){this.$32("AttachmentWellInitialized",n)},remove_$6ne:function(n){this.$5d("AttachmentWellInitialized",n)},get_$9Z:function(){return this.$w(_mcp.$Gn.$5mq)},set_$9Z:function(n){this.$P(_mcp.$Gn.$5mq,n);return n},get_$Q6:function(){return(this.get_$9Z()?this.get_$9Z().get_$Q6():!1)||(this.$WK?this.$WK.get_$E3a():!1)},get_$P3:function(){return this.get_$9Z()&&this.get_$9Z().get_$1m()?this.get_$9Z().get_$1m().get_$A()>0:!1},$2xE:function(){if(this.$v.get_$4LS()&&!this.$1aE){_js.Trace.logInfo(_a.$0.$16,"Setting attachment component override");this.$1aE=this.$v.get_$4IH().$ALE();this.$1aE.$3e(this.$$d_$Bk3)}},$2F5:function(){if(this.$1aE){this.$1aE.$AV();this.$1aE=null}},$3e:function(){var t=this.$1n.$v.$c;this.$2xE();this.$8PS();var i=!t.get_$OV()||t.get_$3uZ();var r=t.get_$EW();var u=!((t.get_$6X()===4||t.get_$6X()===13)&&!this.$1D.get_$NE());if(this.get_$9Z()){this.get_$9Z().$5Lo(t.get_$Fd(),r,i,t.get_$D1(),t.get_$2E8());this.$7dA(t,i)}else{var n=this;this.$F1.$9(function(f){if(_y.$z.$1Q.get_$U()==="TouchNarrow")n.set_$9Z(f.$2Fw(t.get_$Fd(),r,i,u,t.get_$2E8(),!0,n.$1n.$v.$1d,t.get_$D1()));else{var e=f.$3kT(t.get_$Fd());e.set_$E(t.get_$j0());e.set_$CK(1);n.set_$9Z(f.$4Y2(e,r,i,_y.$z.$1Q.get_$U()==="Mouse"?3:0,u,t.get_$2E8(),!0,n.$1n.$v.$1d,t.get_$D1(),n.$1n.$v.$6R,n.$1n.$v.$mc))}n.get_$9Z().add_$1s1(n.$$d_$1s1);n.get_$9Z().add_$26p(n.$$d_$26p);n.get_$9Z().apcl("EditorCallContext",n.$$d_$DWv);var o=n.$1n.$5m(14);o&&n.get_$9Z().add_$7P6(o.$$d_$kN);n.$AQ("AttachmentWellInitialized",n);n.$7dA(t,i)})}},$Bk3:function(){return this.get_$9Z()},$DWv:function(n,t){if(t==="EditorCallContext"){var i=this.$1n.$5m(27);i.set_$Nf(this.get_$9Z().get_$Nf())}},$7F0:function(n){this.$49u&&this.$49u.set_$17(!n)},$7Ep:function(n){this.$3vh&&this.$3vh.set_$17(!n)},$26p:function(n){if(_a.$5N.$43){var t=this;_js.$D.get_$Q().$6C(_a.$0.$PH,"TriggerPolicyTipsIfNeeded",function(){var n=t.$1n.$5m(25);n.$2BX(8)})}},$1s1:function(){var i=this.$1n.$v;var n=i.$c;if(n.get_$Fd()){this.$4X8(n);this.get_$9Z()&&this.get_$9Z().$1NV(n.get_$Fd(),n.get_$EW(),n.get_$2E8())}else{var t=this.$1n.$5m(8);t.$2NF("Attach",this.$$d_$E6s,this.$$d_$1tX,!1)}},$iZ:function(){if(!this.$4yy&&this.get_$9Z()){var n=this.$1n.$v.$c;if(_y.$z.$1Q.get_$U()==="Mouse")this.get_$9Z().$1NV(n.get_$Fd(),n.get_$EW(),n.get_$2E8());else{_js.Trace.logInfo(_a.$0.$16,"Delaying attachment refresh because we're in not in mouse layout.");this.get_$9Z().$AU9(n.get_$Fd(),n.get_$EW(),n.get_$2E8(),this.$$d_$9tm)}this.$9tm();this.$1n.$v.$N.$1p(_y.$mw,new _y.$mw);this.$4yy=!0}},$9tm:function(){var n=this.$1n.$v.$c;if(n.$jW)if(n.get_$EW()){var t=new _js.$X;t.$3y(n.get_$EW().$3Q());n.$jW.set_$EW(t);n.get_$T9()&&n.get_$T9().set_$EW(t)}else{n.$jW.set_$EW(null);n.get_$T9()&&n.get_$T9().set_$EW(null)}},$AV:function(){var n=this.get_$9Z();if(n){n.remove_$1s1(this.$$d_$1s1);n.remove_$26p(this.$$d_$26p);n.rpcl("EditorCallContext",this.$$d_$DWv);_mcp.$3t.$Jx(this.$1n)}this.$4yy=!1;this.$2F5();_mcp.$14n.prototype.$AV.call(this)},$8Ul:function(){var n=_a.UserAgent.getInstance();return n.get_$8b()&&!!this.$3Y&&this.$1D.get_$NE()&&(this.$3Y.$2r("iOSSharePointRichTextEditor")&&n.get_$JM()||this.$3Y.$2r("AndroidCED")&&n.$YL)},$8D0:function(){var n=[];var t=this.$1n.$5m(15);var i=this.$1n.$5m(22);if(t){t.$1aC.$3s&&Array.add(n,new _y.$2a(_u.CommonStrings.l_NewPhotoSubmenuItemText_Text,t.$1aC));t.$1aD.$3s&&Array.add(n,new _y.$2a(_u.CommonStrings.l_PhotoFromGallerySubmenuItemText_Text,t.$1aD));this.$2Nr()&&Array.add(n,new _y.$2a(this.$4n1(),this.$16M))}else if(i)Array.add(n,new _y.$2a(this.$4n1(),i.$5GJ));else if(_a.UserAgent.getInstance().get_$32R()){Array.add(n,new _y.$2a(this.$4n1(),this.$16M));this.$1D.get_$ps()&&this.$1n.$v.$c.get_$6P()==="HTML"&&!_a.UserAgent.getInstance().get_$8b()&&Array.add(n,new _y.$2a(_u.CommonStrings.l_PictureSubmenuItem_LowerCase_Text,this.$1dR))}return n},$7Nz:function(){var n=this.$1n.$v.$c;if(!_js.$9.$o(n.get_$37U())&&!this.$3zJ&&n.get_$Fd()&&this.get_$9Z()){this.$3zJ=!0;var t=!1;try{this.get_$9Z().$A2q(n.get_$37U(),this.$$d_$DWF,this.$$d_$97m);t=!0}finally{t||(this.$3zJ=!1)}}},$Ez6:function(n){this.$tx&&this.get_$9Z()&&this.$tx.$9(this.get_$9Z(),this.get_$m()).$1Pk(n)},$1Pk:function(){var t=this.$1n.$v;var i=t.$c;_js.Trace.logInfo(_a.$0.$16,"Insert attachment start");if(this.$3Il()&&this.get_$9Z())if(this.$1aE)this.$1aE.$1GD(!1);else if(this.$2Nr()){var n=_a.$6.$1g(_a.$0.$1m,"AttachmentsFilePickerPanelOpen",!0);_js.Trace.logInfo(_a.$0.$16,"Opening OWA's file picker");this.$5YT(n)}else{_js.Trace.logInfo(_a.$0.$16,"Opening OS's file picker");this.get_$9Z().$1GD(!1,null,null)}_js.Trace.logInfo(_a.$0.$16,"Insert attachment end")},$8QZ:function(){var n=this.$1n.$v;var t=n.$c;_js.Trace.logInfo(_a.$0.$16,"Insert picture start");this.$3Il()&&this.get_$9Z()&&(this.$1aE?this.$1aE.$1GD(!0):this.get_$9Z().$1GD(!0,null,null));_js.Trace.logInfo(_a.$0.$16,"Insert picture end")},$8QS:function(){if(this.$WK)this.$8QT(this.$WK);else if(this.$5C1){var n=this;this.$5C1.$9(function(t){n.$WK=t;n.$8QT(n.$WK)})}},$8QT:function(n){_js.Trace.logInfo(_a.$0.$16,"Inserting location");var i=_a.$6.$1g(_a.$0.$sR,"BeamMeUpPlaceholderPopulated",!0);var t=this;n.$8QS(function(i){var r=t.$1n.$5m(27);r.set_$Nf(i);n.$A3J(t.get_$9Z(),i.get_$C6W())},this.$$d_$Dam,i)},$Dam:function(n){if(n){var t=this.$1n.$v;t.$2F.$44(0,n,null)}},$8PS:function(){if(!this.get_$Tf()){var n=[];var t=new _fm.$d(this.$4n1(),null,this.$16M,!1,null,_nbs.NonBootStrings.l_InsertAttachment_AT_MenuItem_Text);Array.add(n,t);if(this.$1D.get_$ps()){this.$1dR=new _C(this.$$d_$8QZ,this.get_$m());this.$49u=new _fm.$d(_u.CommonStrings.l_PictureSubmenuItem_LowerCase_Text,null,this.$1dR,!1,null,_nbs.NonBootStrings.l_InsertPicture_AT_MenuItem_Text);Array.add(n,this.$49u);this.$7F0(this.$1n.$v.$c.get_$6P()==="HTML");if(_a.UserAgent.getInstance().get_$8b()&&this.$3Y&&this.$3Y.$2r("iOSSharePointRichTextEditor")){this.$3vh=new _fm.$d(_nbs.NonBootStrings.l_LocationSubmenuItem_LowerCase_Text,null,this.get_$8QU(),!1,null,_nbs.NonBootStrings.l_InsertLocation_AT_MenuItem_Text);Array.add(n,this.$3vh)}this.$7Ep(this.$1n.$v.$c.get_$6P()==="HTML")}this.set_$Tf(new _fm.$1u(n))}},$7dA:function(n,t){this.get_$9Z().set_$6PY(!n.get_$OV());_js.Trace.logInfo(_a.$0.$16,"Attachment component initialized, ReadOnly={0}",t);n.get_$OV()&&this.$iZ();_mcp.$14n.prototype.$3e.call(this)},$4X8:function(n){n.get_$EW()||n.set_$EW(new _js.$X)},$3Il:function(){var t=this.$1n.$v;var n=t.$c;if($C(n)||!n.get_$OV()){_js.Trace.logInfo(_a.$0.$16,"Show not allowed to add attachment due to context="+(n?"non-null":"null")+"; Upgraded="+n.get_$OV());t.$2F.$44(0,_nbs.NonBootStrings.l_AddingAttachmentNotAllowed_Text,null);return!1}return!0},$E6s:function(n){var i=this.$1n.$v;var t=i.$c;if(n.$99===t.get_$D1()){this.$4X8(t);this.get_$9Z()&&this.get_$9Z().$1NV(t.get_$Fd(),t.get_$EW(),t.get_$2E8());this.$7Nz()}},$1tX:function(n){var t=this.$1n.$v;var i=t.$c;if(this.get_$9Z()&&n.$99===i.get_$D1()){this.get_$9Z().$9MR();t.$2F.$44(0,_nbs.NonBootStrings.l_WarningFileCanNotBeAttachedDisconnected_Text,null);this.$7Nz()}},$5YT:function(n){if(this.$N6){var t=this;this.$N6.$9(function(i){t.$rD=i;if(t.$rD){var r=t.$v.$c.get_$6P()==="Text";t.$rD.$Li(t.get_$9Z(),n,r,t.$1n.$v.$sY,t.$1n.$v.$6R)}})}},$Dsu:function(){if(this.$2Nr()&&this.$N6){var n=this;this.$N6.$9(function(t){n.$rD=t;n.$rD&&n.$rD.$Dss()})}},$2Nr:function(){return!!this.$1D&&!!this.$CY&&this.$1D.$4S6(this.$CY.AttachmentDataProviderAvailable)},$DWF:function(n){this.$1n.$v.$c.set_$37U(null);this.$97m(n)},$97m:function(n){n.remove_$1GC(this.$$d_$DWF);n.remove_$5GC(this.$$d_$97m);this.$3zJ=!1;this.$9kI&&this.$1n.$5m(7).$3XI()},$4n1:function(){return this.$2Nr()?_u.CommonStrings.l_AttachmentSubmenuItem_LowerCase_Text:_u.CommonStrings.l_AttachmentLegacySubmenuItem_LowerCase_Text}};_mcp.$1Ku=function(n,t,i){this.$$d_$A91=Function.createDelegate(this,this.$A91);this.$$d_$A92=Function.createDelegate(this,this.$A92);this.$$d_$DRe=Function.createDelegate(this,this.$DRe);this.$$d_$A90=Function.createDelegate(this,this.$A90);_mcp.$1Ku.initializeBase(this,[n,t,i]);this.$2BH=new _mcp.$1LB(this.$$d_$A90,6e4)};_mcp.$1Ku.prototype={$2BH:null,$3e:function(){var n=this.$1n.$v;var t=n.$c;_js.Trace.logInfo(_a.$0.$16,"Enabling timer during initialization of auto save component");this.$2BH.$4yk=!0;if(!t.get_$4HB()){this.$1T();_js.Trace.logInfo(_a.$0.$16,"Auto save timer started")}_mcp.$Kn.prototype.$3e.call(this);n.$N.$1k(_a.$LY,this.$$d_$DRe)},$A90:function(){var u=this.$1n;var r=u.$v;var n=r.$c;if(!n.get_$4HB()){if(!n.get_$6TN()){_js.Trace.logInfo(_a.$0.$16,"Auto Save not supported for the current operation {0}",n.get_$6X());return}var f=u.$5m(5);_js.Trace.logInfo(_a.$0.$16,"Checking dirty before auto save");var t=r.$IO();var i=f.get_$Q6();if(t&&!i){_js.Trace.logInfo(_a.$0.$16,"AutoSave:Context:"+n.toString());this.$2BH.$1u();this.$2NF("AutoSave",this.$$d_$A92,this.$$d_$A91,!1)}else{this.$2BH.$1T();_js.Trace.logInfo(_a.$0.$16,"Skip auto save since IsDirty={0}, AttachmentInProgress={1}",t,i)}}},$1T:function(){var n=this.$1n.$v.$c;!n.get_$4HB()&&n.get_$6TN()&&this.$2BH.$1T()},$AV:function(){_js.Trace.logInfo(_a.$0.$16,"Disabling the timer on reset");this.$2BH.$37Z();var n=this.$1n.$v;n.$N.$4A(_a.$LY,this.$$d_$DRe);_mcp.$Kn.prototype.$AV.call(this)},$2A:function(){var n=this.$1n.$v;n.$N.$4A(_a.$LY,this.$$d_$DRe)},$DRe:function(n){_js.$D.get_$Q().$6C(_a.$0.$16,"Autosave triggered for PAL OnPause event",this.$$d_$A90)},$A92:function(n){var r=this.$1n;var i=r.$v;var t=i.$c;t.get_$4HB()||this.$2BH.$1T()},$A91:function(n){_js.Trace.logInfo(_a.$0.$16,"AutoSaveActionFailed: Error: {0}",n.$2H.message);this.$1n.$v.$c.get_$4HB()||this.$2BH.$1T()}};_mcp.$JQ=function(n){this.$$d_$EYZ=Function.createDelegate(this,this.$EYZ);this.$$d_$Eek=Function.createDelegate(this,this.$Eek);this.$$d_$DYk=Function.createDelegate(this,this.$DYk);this.$$d_$7N5=Function.createDelegate(this,this.$7N5);_mcp.$JQ.initializeBase(this,[3,n])};_mcp.$JQ.$7fZ=function(n,t){return new _y.$2a(n,t)};_mcp.$JQ.$4Xd=function(n,t){return new _fm.$d(n,null,t,!0)};_mcp.$JQ.prototype={$KO:null,$ta:null,$2O3:!1,$4HZ:null,$E6:null,$3HU:null,$2Ny:!1,set_$3xa:function(n){if(this.$2O3!==n){this.$2O3=n;this.$4("IsIrmProtected")}return n},set_$Eel:function(n){if(this.$4HZ!==n){this.$4HZ=n;this.$4("ShowIrmInformationCommand")}return n},set_$ny:function(n){if(this.$E6!==n){this.$E6=n;this.$4("DialogViewModel")}return n},$3e:function(){var n=this.$1n.$v;var u=n.$c;var o=n.$5w;var r=n.$l7;if(this.$5qA())if(_g.$1H.$Yw){_js.Trace.logInfo(_a.$0.$16,"Checking main window for compliance configuration");this.$ta=_mcp.$JQ.$6Wy;_g.$1H.$Yw.$BpW(this.$$d_$7N5)}else if(r.WasLoadedFromServer)this.$7N5(r);else{_js.Trace.logInfo(_a.$0.$16,"Adding the loading permissions menu item");this.$ta=_mcp.$JQ.$6Wy;if(!r.IsLoadingFromServer){_js.Trace.logInfo(_a.$0.$16,"Submitting GetComplianceConfigurationAction");var e=n.$N;e.$1k(_a.$V9,this.$$d_$DYk);var s=new _h.$V8(r,n.$N);s.$11()}}else if(this.$ta&&this.$2Ny&&o.$1a){n.$5w.$5MY(this.$ta);this.$2Ny=!1}var t=u.get_$9i();this.set_$3xa(!!t&&!t.get_$RG());if(this.$2O3&&"Mouse"===_y.$z.$1Q.get_$U()){var i=n.$1aw();i.$4s.apply(i,[4499].concat([t.get_$2yu(),t.get_$2ys()]));i.$4s.apply(i,[4500].concat([t.get_$2Fc()]))}else if(u.get_$a9()){var f=n.$1aw();f.$4s.apply(f,[3800].concat([u.get_$h0(),u.get_$eW()]))}"Mouse"===_y.$z.$1Q.get_$U()||this.$4HZ||this.set_$Eel(new _C(this.$$d_$Eek,this.get_$m()));_mcp.$14n.prototype.$3e.call(this)},$AV:function(){this.set_$3xa(!1);_mcp.$14n.prototype.$AV.call(this)},$5qA:function(){var i=_g.$O.get_$Q();if(!$C(i.get_$9N())&&!i.get_$9N().get_$3vy()){_js.Trace.logInfo(_a.$0.$16,"IRM segmentation flag has been turned off, user cannot set compliance.");return!1}var n=this.$1n.$v.$c.get_$9i();var t=!n||!!n.get_$RG()||n.get_$KU()||n.get_$4e0();_js.Trace.logInfo(_a.$0.$16,"CanSetCompliance="+t);return t},$3km:function(n,t){var i=this.$1n.$v.$l7;var o=i.RmsTemplates?i.RmsTemplates.length:0;var s=i.MessageClassifications?i.MessageClassifications.length:0;if(0===o&&0===s){_js.Trace.logInfo(_a.$0.$16,"There are neither RmsTemplates nor message classifications available, skip setup of the compliance sub context menu.");return null}var r=new Array(1+o+s);var e=0;r[e++]=t(_nbs.NonBootStrings.l_NoRestriction_Text,new _C(this.$$d_$EYZ,this.get_$m()));for(var f=0,u=0;f<o||u<s;)if(f===o){var l=i.MessageClassifications[u++];r[e++]=t(l.Name,new _C(this.$7fx(l.Id),this.get_$m()))}else if(u===s){var a=i.RmsTemplates[f++];r[e++]=t(a.Name,new _C(this.$7h8(a.Id),this.get_$m()))}else{var h=i.MessageClassifications[u];var c=i.RmsTemplates[f];if(0<c.Name.localeCompare(h.Name)){r[e++]=t(h.Name,new _C(this.$7fx(h.Id),this.get_$m()));u++}else{r[e++]=t(c.Name,new _C(this.$7h8(c.Id),this.get_$m()));f++}}return r},$2Fx:function(){if("Mouse"===_y.$z.$1Q.get_$U()){var i=this.$3km(_fm.$d,_mcp.$JQ.$4Xd);i&&(this.$KO=new _fm.$1u(i))}else if(!this.$2Ny){if(!this.$ta){var r=this.$3km(_y.$2a,_mcp.$JQ.$7fZ);r&&(this.$ta=new _y.$2a(_nbs.NonBootStrings.l_SetPermissions_LowerCase_Text,null,r))}if(this.$ta){var u=this.$1n.$v.$5w;var t=u.$1a;if(t)for(var n=0;n<t.length;n++)if(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text===t[n].$3V){u.$4PT(this.$ta,n+1);this.$2Ny=!0}}}},$DYk:function(n){var t=this.$1n.$v;this.$7N5(t.$l7);t.$N.$4A(_a.$V9,this.$$d_$DYk)},$7N5:function(n){var r=this.$1n.$v;r.$l7=n;_js.Trace.logInfo(_a.$0.$16,"Updating menu with complete compliance configuration.");if("Mouse"!==_y.$z.$1Q.get_$U()){this.$ta&&r.$5w.$5MY(this.$ta);this.$ta=null;this.$2Ny=!1}n.WasLoadedFromServer&&this.$2Fx();if("Mouse"===_y.$z.$1Q.get_$U()){var t=this.$1n.$5m(18);if(t.get_$Tf()){var i=t.$3Ec(_u.CommonStrings.l_LoadingPermissions_LowerCase_Text);i>=0&&t.get_$Tf().$1a.$5W(i);n.WasLoadedFromServer&&t.$A4b()}}},$EYZ:function(){var i=this.$1n.$v;var n=i.$c;_js.Trace.logInfo(_a.$0.$16,"Set no restriction");n.set_$h4("0");var t=i.$1aw();if($C(n.get_$9i())){if(n.get_$a9()){t.$9U(3800);n.set_$a9(!1);n.set_$h0(null);n.set_$eW(null);n.set_$l4(null)}}else{if("Mouse"===_y.$z.$1Q.get_$U()){t.$9U(4499);t.$9U(4500)}n.set_$9i(null);this.set_$3xa(!1)}},$7h8:function(n){var t=this;return function(){_a.$6.stPT(_a.$0.$16,"MailComposeSetIRM",3);var h=_a.$6.$1g(_a.$0.$16,"MailComposeSetIRM",!0);var e=t.$1n.$v;var r=e.$c;r.set_$h4(n);if(r.get_$a9()){e.$1d.$9U(3800);_mcp.$3t.$Jx(t.$1n);r.set_$a9(!1);r.set_$h0(null);r.set_$eW(null);r.set_$l4(null)}for(var s=e.$l7.RmsTemplates,o=0;o<s.length;o++){var u=s[o];if(n.toLowerCase()===u.Id.toLowerCase()){var i=new _g.$gn;i.set_$710(n);i.set_$2Fc(_g.$O.get_$Q().get_$4P().get_$Fv());i.set_$KU(!0);i.set_$RG(0);i.set_$2yu(u.Name);i.set_$2ys(u.Description);i.set_$6P(r.get_$6P());r.set_$9i(i);if("Mouse"===_y.$z.$1Q.get_$U()){var f=e.$1aw();f.$9U(4499);f.$9U(4500);f.$4s.apply(f,[4499].concat([u.Name,u.Description]));f.$4s.apply(f,[4500].concat([i.get_$2Fc()]))}t.set_$3xa(!0);_js.Trace.logInfo(_a.$0.$16,"Set IRM "+u.Name);break}}_a.$6.$1G(h);_a.$6.endPT("MailComposeSetIRM")}},$7fx:function(n){var t=this;return function(){var u=t.$1n.$v;var r=u.$c;r.set_$h4(n);if(!$C(r.get_$9i())&&"Mouse"===_y.$z.$1Q.get_$U()){var s=u.$1aw();s.$9U(4499);s.$9U(4500);r.set_$9i(null);t.set_$3xa(!1)}for(var o=u.$l7.MessageClassifications,f=0;f<o.length;f++){var i=o[f];if(n.toLowerCase()===i.Id.toLowerCase()){r.set_$a9(!0);r.set_$h0(i.Name);r.set_$eW(i.Description);r.set_$l4(i.Id);var e=u.$1aw();e.$9U(3800);e.$4s.apply(e,[3800].concat([i.Name,i.Description]));_js.Trace.logInfo(_a.$0.$16,"Set class "+i.Name);break}}}},$Eek:function(){var t=this.$1n.$v.$c;if(t.get_$9i()){var n=t.get_$9i();this.$Eem(n.get_$2yu(),n.get_$2ys(),n.get_$2Fc())}else _js.Trace.logError(_a.$0.$16,"ShowIrmInformation was triggered without pre-existing license data or compliance entry selected.")},$Eem:function(n,t,i){if($C(this.$E6)){this.set_$ny(new _bc.$DH);this.$E6.$9B.$F(new _ff.$1l(this.$E6.$5a,_nbs.NonBootStrings.l_Close1_Text))}this.$E6.set_$3u(n);$C(this.$3HU)&&(this.$3HU=new _mcp.$147);this.$3HU.set_$iw(t);this.$3HU.set_$AJh(String.format(_nbs.NonBootStrings.l_IrmConversationOwner_Text,i));this.$E6.set_$FD(this.$3HU);this.$E6.set_$1C(!0)}};_mcp.$14n=function(n,t){_mcp.$14n.initializeBase(this);this.$7db=n;this.$1n=t;if(t&&t.$v){this.$v=t.$v;this.$c_2=this.$v.$c;this.$vE=this.$v.$1d}};_mcp.$14n.prototype={$7db:0,$1n:null,$v:null,$c_2:null,$vE:null,$9o:!1,get_$G8:function(){return this.$9o},set_$G8:function(n){this.$9o=n;return n},get_$m:function(){return _a.$0.$16},$3e:function(){this.$9o=!0},$AV:function(){this.$9o=!1},$5jZ:function(n){var t=this.$6GO(n);this.$vE.$4s(t,null);if(t===55||t===50){var i=this;this.$v.$2TL.$9(function(n){n.$7SN(i.$vE);_mcp.$3t.$Jx(i.$1n)})}else _mcp.$3t.$Jx(this.$1n)},$3gR:function(n){this.$vE.$2D7(n);_mcp.$3t.$Jx(this.$1n)},$7Sn:function(n,t){for(var u=[],i=2;i<arguments.length;++i)u[i-2]=arguments[i];var r;(r=this.$vE).$cm.apply(r,[t,n].concat(u));_mcp.$3t.$Jx(this.$1n)},$3VU:function(){this.$vE.$E2N();this.$vE.$ai(_mcp.$Kn.$wS);this.$vE.$ai(_mcp.$G6.$wS);this.$vE.$ai(_mcp.$MZ.$wS);var n=this;this.$v.$2TL.$9(function(t){t.$E11(n.$vE);_mcp.$3t.$Jx(n.$1n)})},$7DK:function(){if(!this.$c_2.$jW)return!0;_js.Trace.logInfo(_a.$0.$16,"Comparing initial baseline to baseline. Context:"+this.$c_2.toString());if(!this.$c_2.$jW.$5b(this.$c_2.get_$T9()))return!0;_js.Trace.logInfo(_a.$0.$16,"Checking dirty before showing discard confirmation.");return this.$v.$IO()?!0:this.$c_2.get_$1TS()?!0:!1},$6GO:function(n){throw Error.notImplemented(String.format("GetErrorInfoBarMessageId is not implemented for type {0}",Object.getType(this)));}};_mcp.$1Kw=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$$d_$AG5=Function.createDelegate(this,this.$AG5);this.$$d_$EWI=Function.createDelegate(this,this.$EWI);this.$$d_$E4A=Function.createDelegate(this,this.$E4A);this.$$d_$C4R=Function.createDelegate(this,this.$C4R);this.$2FQ=[];this.$5sc=new _mcp.$1Kv(this,t,i,r,u,f,e,o,s,h,c,l);this.$v=n};_mcp.$1Kw.prototype={$2FQ:null,$v:null,$5sc:null,$5m:function(n){var t=n;$C(this.$2FQ[t])&&(this.$2FQ[t]=this.$5sc.$AM0(n,this.$v.$I.get_$U()));return this.$2FQ[t]},$3e:function(){this.$4fg(this.$$d_$C4R)},$AV:function(){_js.Trace.logInfo(_a.$0.$16,"Component Map Reset start.");this.$4fg(this.$$d_$E4A,!0);_js.Trace.logInfo(_a.$0.$16,"Component Map Reset end.")},$2xE:function(){_js.Trace.logInfo(_a.$0.$16,"Component Map set override start.");this.$4fg(this.$$d_$EWI);_js.Trace.logInfo(_a.$0.$16,"Component Map set override end.")},$2F5:function(){_js.Trace.logInfo(_a.$0.$16,"Component Map clear override start.");this.$4fg(this.$$d_$AG5);_js.Trace.logInfo(_a.$0.$16,"Component Map clear override end.")},$4fg:function(n,t){if($C(t)||!t)for(var r=0;r<this.$2FQ.length;r++)this.$9Fk(n,r);else for(var i=this.$2FQ.length-1;i>=0;i--)this.$9Fk(n,i)},$9Fk:function(n,t){var i=this.$2FQ[t];$C(i)||n(i,t)},$C4R:function(n,t){_mcp.$14o.isInstanceOfType(n)||n.get_$G8()||n.$3e()},$E4A:function(n,t){var i=Object.getType(n).getName();if(n.get_$G8()){_js.Trace.logInfo(_a.$0.$16,"Reset "+i+" at index "+t);n.$AV()}else _js.Trace.logInfo(_a.$0.$16,"Skip uninitialized "+i+" at index "+t)},$EWI:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.$2xE()},$AG5:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.$2F5()}};_mcp.$1Kx=function(n,t){this.$$d_$EpK=Function.createDelegate(this,this.$EpK);this.$$d_$EpF=Function.createDelegate(this,this.$EpF);this.$$d_$EpJ=Function.createDelegate(this,this.$EpJ);_mcp.$1Kx.initializeBase(this,[17,n]);this.$6R=t};_mcp.$1Kx.prototype={$5ch:null,$5cn:null,$7IB:null,$7I9:null,$6R:null,$1xL:null,set_$7IC:function(n){this.$7IB=n;this.$4("SwitchToPlainTextContent");return n},set_$7IA:function(n){this.$7I9=n;this.$4("SwitchToHtmlContent");return n},$3e:function(){this.$5cn||(this.$5cn=new _C(this.$$d_$EpJ,this.get_$m()));this.$5ch||(this.$5ch=new _C(this.$$d_$EpF,this.get_$m()));_mcp.$14n.prototype.$3e.call(this)},$EpJ:function(){_js.Trace.logInfo(this.get_$m(),"User chose to convert to plain text");if(this.$8TK(_nbs.NonBootStrings.l_CannotConvertToPlainTextUntilMessageIsLoaded_Text)){this.$1n.$v.$c.get_$3sY().$11();var r=this.$1n.$v.$c.get_$MW();var n;var i,t;var f=(t=_a.$1J.$4Wn(r,i={val:n}),n=i.val,t);if(!f){n=r;_js.Trace.logInfo(this.get_$m(),"Using html due to failed conversion")}if(n.length>0){var u=this.$1n.$v.$2F;u.$RN(1,[_nbs.NonBootStrings.l_ConvertToPlainTextWarning_Text],this.$$d_$EpK,!1,null,null,null,this.$6R)}else this.$8Rg()}},$EpK:function(n,t){n&&this.$8Rg()},$8Rg:function(){var t=null;var i,r;if(r=_a.$1J.$1yQ(_a.UserAgent.getInstance(),this.$1n.$v.$c.get_$MW(),i={val:t}),t=i.val,r){if(this.$1xL&&this.$1xL.$3s){this.$1xL.$11();this.$1xL=null}this.$1n.$v.$c.set_$dp(t);this.set_$7IC(t);this.set_$7IC(null);this.$1n.$v.get_$1kA().get_$G8()&&this.$1n.$v.get_$1kA().$9mI();var n=this.$1n.$5m(5);n.$7F0(!1);n.$7Ep(!1);n.get_$9Z()&&n.get_$9Z().$Eeh();this.$1n.$v.$c.set_$6P("Text");_js.Trace.logInfo(this.get_$m(),"MailComposeContentConversionComponent.ToPlainText succeeded.")}else _js.Trace.logWarning(this.get_$m(),"MailComposeContentConversionComponent.ToPlainText failed because of ConvertFromHtmlToText error.")},$EpF:function(){_js.Trace.logInfo(this.get_$m(),"User chose to convert to html");if(this.$8TK(_nbs.NonBootStrings.l_CannotConvertToHtmlUntilMessageIsLoaded_Text)){var u=this.$1n;var n=u.$v;var t=n.$c;t.get_$8JO().$11();var f=n.$c.get_$1vd();t.set_$6P("HTML");var i=_a.$1J.$1yR(f);t.set_$dp(i);this.set_$7IA(i);this.set_$7IA(null);n.get_$1kA().$9mJ();var r=u.$5m(5);r.$7F0(!0);r.$7Ep(!0);_js.Trace.logInfo(this.get_$m(),"MailComposeContentConversionComponent.ToHtml succeeded.")}},$8TK:function(n){_js.Trace.logInfo(this.get_$m(),"Checking if the email has been upgraded which is a pre-requisite of content conversion.");if(!this.$1n.$v.$c.get_$OV()){this.$1n.$v.$2F.$44(0,n,null);_js.Trace.logInfo(this.get_$m(),"Conversion is not available because the email has not yet been upgraded.");return!1}return!0}};_mcp.$Ow=function(n){_mcp.$Ow.initializeBase(this,[18,n]);this.$6r=_g.$O.get_$Q().get_$1j();this.$c=this.$1n.$v.$c};_mcp.$Ow.prototype={$4K8:null,$4K7:null,$6r:null,$c:null,get_$Tf:function(){return this.$w(_mcp.$Ow.$24o)},set_$Tf:function(n){this.$P(_mcp.$Ow.$24o,n);return n},$9mI:function(){this.$4K7.set_$17(!1);this.$4K8.set_$17(!0)},$9mJ:function(){this.$4K7.set_$17(!0);this.$4K8.set_$17(!1)},$3e:function(){if("Mouse"===_y.$z.$1Q.get_$U()){var t=[];var n;if(this.$c.get_$6X()!==8&&!this.$c.get_$1El()&&!_y.$z.$1Q.get_$lN()){var e=this.$1n.$5m(8);n=new _fm.$d(_nbs.NonBootStrings.l_SaveMenuItem_LowerCase_Text,null,e.$E0);Array.add(t,n)}var i=this.$1n.$5m(1);if(!this.$c.get_$1El()){n=new _fm.$d(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text,null,i.$4HI);_g.$O.get_$Q().get_$1j().get_$1Ip()&&n.set_$17(!0);Array.add(t,n);n=new _fm.$d(_nbs.NonBootStrings.l_HideBccMenuItemText_LowerCase_Text,null,i.$4qx);_g.$O.get_$Q().get_$1j().get_$1Ip()||n.set_$17(!0);Array.add(t,n)}if(this.$c.get_$3Jg()||this.$c.get_$s0()){var l=this.$1n.$5m(1);n=new _fm.$d(_nbs.NonBootStrings.l_ShowFromMenuItemText_LowerCase_Text,null,i.$3as);(_g.$O.get_$Q().get_$1j().get_$tY()||this.$c.get_$ow())&&n.set_$17(!0);Array.add(t,n);i.$3as.set_$87(!this.$c.get_$s0());n=new _fm.$d(_nbs.NonBootStrings.l_HideFromMenuItemText_LowerCase_Text,null,i.$4r8);_g.$O.get_$Q().get_$1j().get_$tY()||this.$c.get_$ow()||n.set_$17(!0);Array.add(t,n)}if(!this.$c.get_$1El()&&!_y.$z.$1Q.get_$lN()){n=new _fm.$d(_nbs.NonBootStrings.l_CheckNamesMenuItem_LowerCase_Text,null,i.$1Nd);Array.add(t,n)}var f=this.$1n.$5m(6);if(!$C(f.$KO)){n=new _fm.$CN(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text,null,f.$KO);Array.add(t,n)}var r=this.$1n.$5m(3);if(r.$KO){n=new _fm.$CN(_nbs.NonBootStrings.l_SetPermissions_LowerCase_Text,null,r.$KO);Array.add(t,n)}else if(r.$5qA()&&this.$1n.$v.$l7.IsLoadingFromServer){n=new _fm.$d(_u.CommonStrings.l_LoadingPermissions_LowerCase_Text,null,null);Array.add(t,n)}if(!_y.$z.$1Q.get_$lN()){var c=this.$1n.$5m(12);var h=this.$1n.$5m(5);n=new _fm.$d(_nbs.NonBootStrings.l_SignatureMenuItem_LowerCase_Text,null,c.$4Pj);n.set_$4E(_nbs.NonBootStrings.l_InsertSignatureMenuItem_LowerCase_Text);h.get_$Tf().$1a.$F(n)}var u=this.$1n.$5m(17);this.$4K8=new _fm.$d(_nbs.NonBootStrings.l_ConvertToPlainText_LowerCase_Text,null,u.$5cn);Array.add(t,this.$4K8);this.$4K7=new _fm.$d(_nbs.NonBootStrings.l_ConvertToHtml_Text,null,u.$5ch,!0);Array.add(t,this.$4K7);this.$c.get_$6P()==="HTML"?this.$9mJ():this.$9mI();if(!this.$c.get_$1El()){var o=this.$1n.$5m(10);n=new _fm.$d(_nbs.NonBootStrings.l_ShowMessageOptions_Text,null,o.$3b1);Array.add(t,n)}var s=this.$1n.$5m(18);s.set_$Tf(new _fm.$1u(t))}_mcp.$14n.prototype.$3e.call(this)},$7Na:function(){var t=this.get_$Tf().$1a.get_$E(this.$3Ec(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text));var n=this.get_$Tf().$1a.get_$E(this.$3Ec(_nbs.NonBootStrings.l_HideBccMenuItemText_LowerCase_Text));t.set_$17(this.$c.get_$1LT());n.set_$17(!this.$c.get_$1LT())},$7Nb:function(){var t=this.get_$Tf().$1a.get_$E(this.$3Ec(_nbs.NonBootStrings.l_ShowFromMenuItemText_LowerCase_Text));var n=this.get_$Tf().$1a.get_$E(this.$3Ec(_nbs.NonBootStrings.l_HideFromMenuItemText_LowerCase_Text));t.set_$17(this.$c.get_$ow());n.set_$17(!this.$c.get_$ow())},$3Ec:function(n){var i=this.get_$Tf().$1a;if(i)for(var t=0;t<i.get_$A();t++)if(n===i.get_$E(t).$3V)return t;return-1},$A4b:function(){var t=this.$1n.$5m(3);if(!$C(t.$KO)){var n=this.$3Ec(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text);if(n>=0){var i=new _fm.$CN(_nbs.NonBootStrings.l_SetPermissions_LowerCase_Text,null,t.$KO);this.get_$Tf().$1a.$6i(n+1,i)}}}};_mcp.$1Kz=function(n){this.$$d_$4r3=Function.createDelegate(this,this.$4r3);this.$$d_$5yt=Function.createDelegate(this,this.$5yt);this.$$d_$Edz=Function.createDelegate(this,this.$Edz);_mcp.$1Kz.initializeBase(this,[21,n]);this.$Fp=new _C(this.$$d_$Edz,this.get_$m());this.$Lx=n.$v.$Lx};_mcp.$1Kz.prototype={$Fp:null,$Lx:null,$1kw:null,$237:!1,set_$5yv:function(n){if(n!==this.$1kw){this.$1kw=n;this.$4("DiscardConfirmDialogButtonData")}return n},set_$2lr:function(n){if(n!==this.$237){this.$237=n;this.$4("IsDiscardConfirmDialogShown")}return n},$5yt:function(){var i=this.$1n;var t=i.$v;var n=t.$c;_js.Trace.logInfo(_a.$0.$16,"Discard and close");t.set_$1Ei(!0);if(n.get_$6X()||!n.get_$6X()&&(n.get_$Fd()||t.get_$1Ng().get_$G9())){_js.Trace.logInfo(_a.$0.$16,"Discard");this.$4b0(n.get_$D1(),n.get_$Fd())}n.set_$T9(null);var r=i.$5m(2);r.get_$5F().$2Si(t,!1);_js.Trace.logInfo(_a.$0.$16,"Navigated away from compose")},$5Nm:function(n,t){if(this.$Lx.$1EM(n)){_js.Trace.logInfo(_a.$0.$16,"Resuming discard of "+_h.$D1.$1d1(t));this.$4b0(n,t)}else _js.Trace.logInfo(_a.$0.$16,"User had already discarded.")},$4b0:function(n,t){this.$4r3();var i=this.$1n.$v;var r=i.$c.get_$23O()||i.$c.get_$1TS();this.$Lx.$5yw(n,t,i.$n,r)},$Edz:function(){var t=this.$1n.$v;var n=t.$c;_js.Trace.logInfo(_a.$0.$16,"User chose to discard");if(this.$7DK()){this.$9jc();_js.Trace.logInfo(_a.$0.$16,"Toggle IsDiscardConfirmDialogShown flag to show the dialog. Context:"+n.toString());this.set_$2lr(!0)}else{_js.Trace.logInfo(_a.$0.$16,"User hit discard, we determined there's no need to show confirmation dialog, calling discard and navigating away. Context:"+n.toString());this.$5yt()}},$4r3:function(){_js.Trace.logInfo(_a.$0.$16,"Toggle IsDiscardConfirmDialogShown flag to hide the dialog. Context:"+this.$1n.$v.$c.toString());this.set_$2lr(!1)},$9jc:function(){if($C(this.$1kw)){_js.Trace.logInfo(_a.$0.$16,"Creating discard confirm dialog.");var n=new _js.$X;n.$F(new _ff.$1l(new _C(this.$$d_$5yt,this.get_$m()),_u.Strings.l_ConfirmDialog_Discard_Text,_u.Strings.l_DeleteConfirmDialogButtonDescription_Text));n.$F(new _ff.$1l(new _C(this.$$d_$4r3,this.get_$m()),_u.Strings.l_ConfirmDialog_DontDiscard_Text,_u.Strings.l_ReturnToMessageForEditing_Text));this.set_$5yv(n)}}};_mcp.$1L0=function(n){this.$$d_$6IZ=Function.createDelegate(this,this.$6IZ);this.$$d_$BoY=Function.createDelegate(this,this.$BoY);this.$$d_$2k5=Function.createDelegate(this,this.$2k5);_mcp.$1L0.initializeBase(this,[27,n]);this.$1T5=new _C(this.$$d_$2k5,_a.$0.$16);this.$6Gv=new _C(this.$$d_$BoY,_a.$0.$16);this.$3tD=new _C(this.$$d_$6IZ,_a.$0.$16);var t=n.$v.$c;t.set_$BsS(this.$1T5);t.set_$3sY(this.$6Gv);t.set_$8JO(this.$3tD)};_mcp.$1L0.prototype={$1T5:null,$6Gv:null,$3tD:null,$r4:null,set_$Nf:function(n){this.$r4=n;this.$4("EditorCallContext");return n},$2k5:function(){var n=new _cmc.$s7(!1,!1);this.set_$Nf(n)},$BoY:function(){var n=new _cmc.$s7(!0,!1);this.set_$Nf(n)},$6IZ:function(){var n=new _cmc.$s7(!1,!0);this.set_$Nf(n)}};_mcp.$eU=function(n){this.$$d_$EYN=Function.createDelegate(this,this.$EYN);this.$$d_$EYa=Function.createDelegate(this,this.$EYa);this.$$d_$EXi=Function.createDelegate(this,this.$EXi);_mcp.$eU.initializeBase(this,[6,n])};_mcp.$eU.$7fZ=function(n,t){return new _y.$2a(n,t)};_mcp.$eU.$4Xd=function(n,t){return new _fm.$d(n,null,t,!0)};_mcp.$eU.prototype={$KO:null,$ta:null,$6Qr:!1,$4x8:!1,$6Rf:!1,set_$CBH:function(n){if(n!==this.$6Qr){this.$6Qr=n;this.$4("IsHighImportance")}return n},set_$CD6:function(n){if(n!==this.$4x8){this.$4x8=n;this.$4("IsNormalImportance")}return n},set_$CCR:function(n){if(n!==this.$6Rf){this.$6Rf=n;this.$4("IsLowImportance")}return n},$3e:function(){var i=this.$1n.$v.$c.get_$Bv();this.$5Vg(i);_js.Trace.logInfo(_a.$0.$16,"Importance component initialized and importance set to {0}",i);if("Mouse"===_y.$z.$1Q.get_$U()){if(!this.$KO){var t=this.$3km(_fm.$d,_mcp.$eU.$4Xd);t&&(this.$KO=new _fm.$1u(t))}}else if(!this.$ta){var n=this.$3km(_y.$2a,_mcp.$eU.$7fZ);n&&(this.$ta=new _y.$2a(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text,null,n))}_mcp.$14n.prototype.$3e.call(this)},$EXi:function(){var n=_a.$6.$1g(_a.$0.$16,"MailComposeSetImp",!0);_js.Trace.logInfo(_a.$0.$16,"User sets high importance");this.$5Vg("High");_a.$6.$1G(n)},$EYa:function(){_js.Trace.logInfo(_a.$0.$16,"User sets normal importance");this.$5Vg("Normal")},$EYN:function(){var n=_a.$6.$1g(_a.$0.$16,"MailComposeSetImp",!0);_js.Trace.logInfo(_a.$0.$16,"User sets low importance");this.$5Vg("Low");_a.$6.$1G(n)},$5Vg:function(n){this.$1n.$v.$c.set_$Bv(n);this.set_$CBH("High"===n);this.set_$CD6("Normal"===n);this.set_$CCR("Low"===n)},$3km:function(n,t){return[t(_nbs.NonBootStrings.l_HighImportanceButtonText_Text,new _C(this.$$d_$EXi,this.get_$m())),t(_nbs.NonBootStrings.l_NormalImportanceButtonText_Text,new _C(this.$$d_$EYa,this.get_$m())),t(_nbs.NonBootStrings.l_LowImportanceButtonText_Text,new _C(this.$$d_$EYN,this.get_$m()))]}};_mcp.$1L3=function(n,t){this.$$d_$4aw=Function.createDelegate(this,this.$4aw);this.$$d_$7CG=Function.createDelegate(this,this.$7CG);this.$$d_$7Et=Function.createDelegate(this,this.$7Et);this.$$d_$7Fh=Function.createDelegate(this,this.$7Fh);_mcp.$1L3.initializeBase(this,[26,n]);this.$Sc=_h.$3s.$6Gy(t)};_mcp.$1L3.prototype={$rc:null,$24N:null,$Sc:!1,$1YZ:!1,$1YX:!1,$1Zi:null,$1W5:null,$ck:null,$c8:null,$Va:null,set_$2O9:function(n){if(n!==this.$Sc){this.$Sc=n;this.$4("IsLinkPreviewEnabled")}return n},set_$4o7:function(n){if(n!==this.$rc){this.$rc=n;this.$7HL()}return n},set_$1ZX:function(n){if(n!==this.$Va){this.$Va=n;this.$4("VideoPlayerHtmlLookup")}return n},set_$3LC:function(n){this.$24N=n;this.$4("LinkPreviewResponse");return n},set_$1wV:function(n){if(n!==this.$ck){this.$ck=n;this.$ck&&_h.$3s.$3Fl(this.$ck,null,this.$$d_$7Fh,null)}return n},set_$1rz:function(n){if(n!==this.$c8){this.$c8=n;this.$c8&&_h.$3s.$3Fl(this.$c8,null,this.$$d_$7Et,null)}return n},set_$3bI:function(n){if(this.$1YZ!==n){this.$1YZ=n;this.$4("ShowYouTubePlayer")}return n},set_$3b5:function(n){if(this.$1YX!==n){this.$1YX=n;this.$4("ShowOEmbedVideoPlayer")}return n},set_$7Q8:function(n){this.$1Zi=n;this.$4("YouTubePlayerUrl");return n},set_$3Rn:function(n){this.$1W5=n;this.$4("OEmbedVideoPlayerHtml");return n},$7HL:function(){if(_h.$3s.$3vz){_js.Trace.logInfo(_a.$0.$6c,"Link preview feature is disabled.  Skipping GetLinkPreview action for {0}",this.$rc.Url);this.$4aw();return}if(this.$rc){var i=1;var r=_a.$6.$1g(_a.$0.$6c,"GetComposeLinkPreview",!0);var n=[];Array.add(n,this.$rc);_js.Trace.logInfo(_a.$0.$6c,"Preparing GetLinkPreview action for {0}",this.$rc.Url);this.$rc.Autoplay=!0;var u=new _h.$3s(this.$rc);_js.Trace.logInfo(_a.$0.$6c,"Submitting GetLinkPreview action for {0}",this.$rc.Url);var t=this,f=this;this.$1n.$v.$n.$tE(u,function(u){_h.$3s.$9hm(u,t.$$d_$7CG,t.$$d_$4aw,i,r,"GetComposeLinkPreview",n)},function(t){_h.$3s.$7p0(t,i,r,"GetComposeLinkPreview",n)},null)}},$7CG:function(n){this.set_$3LC(n)},$4aw:function(){this.set_$2O9(!1)},$7Fh:function(n){this.set_$7Q8(n);this.set_$3bI(!!this.$1Zi)},$7Et:function(n){var t=this.$6Iu(n);t?this.set_$3Rn(t):this.set_$3Rn(n);this.set_$3b5(!!this.$1W5)},$6Iu:function(n){return n in this.$Va?this.$Va[n]:null}};_mcp.$eT=function(n){_mcp.$eT.initializeBase(this,[16,n])};_mcp.$eT.prototype={$1d:null,$3jw:0,$1Q6:null,$3e:function(){_mcp.$14n.prototype.$3e.call(this);this.$1Q6=this.$BoF();var n=this.$1n.$v;this.$1d=n.$1aw();this.$3jw=n.$c.get_$6X();_mcp.$7y.$8Xa(n.$c)&&!n.$c.get_$6TM()&&this.$1IV()},$1IV:function(){this.$1d.$ai(_mcp.$eT.$3Tw);this.$7sm()},$BoF:function(){var n=this.$1n.$v.$c;var t=n.get_$IV()||n.get_$j0();return t&&n.get_$oy()?t:null},$Bom:function(){if(_g.$2g.isInstanceOfType(this.$1Q6))return this.$1Q6.get_$Vh();else if(_g.$Mf.isInstanceOfType(this.$1Q6)){var n=this.$1Q6;return n.get_$Q4().get_$Vh()==="RecurringMaster"?n.get_$Q9()?"RecurringMaster":"Occurrence":n.get_$Q4().get_$Vh()}else throw Error.argument("this.Item","Unsupported calendaring type:"+Object.getType(this.$1Q6).getName());},$7sm:function(){if(this.$1Q6){this.$Au1();if(!_g.$Mg.isInstanceOfType(this.$1Q6)){this.$1d.$4s(6800);switch(this.$Bom()){case"Occurrence":case"Exception":this.$Au6();break;case"RecurringMaster":this.$Atz();break}}}},$BoU:function(n){var t;switch(n){case 8:t=3200;break;case 3:t=3205;break;case 5:t=3210;break;case 6:t=3215;break;case 7:t=3220;break;default:throw Error.argument("operation","Unsupported mail compose operation on an occurrence: "+n);}return t},$BoV:function(n){var t;switch(n){case 8:t=3100;break;case 3:t=3105;break;case 5:t=3110;break;case 6:t=3115;break;case 7:t=3120;break;default:throw Error.argument("operation","Unsupported mail compose operation on a series: "+n);}return t},$Atz:function(){var n=this.$BoV(this.$3jw);this.$1d.$4s(n)},$Au6:function(){var i=new _cc.$To;var t=i.$4L(this.$1Q6,null);var n=this.$BoU(this.$3jw);this.$1d.$4s(n,t)},$Au1:function(){if(_g.$9y.isInstanceOfType(this.$1Q6)){var t=this.$1Q6;var i=t.get_$4ux()&&!!t.get_$2VQ();if(i){var n=-1;switch(this.$3jw){case 5:n=3250;break;case 7:n=3260;break;case 6:n=3255;break}n!==-1&&this.$1d.$4s(n,t.get_$2VQ().Mailbox.Name)}}}};_mcp.$14o=function(n,t,i){this.$$d_$BtJ=Function.createDelegate(this,this.$BtJ);this.$$d_$DYo=Function.createDelegate(this,this.$DYo);this.$$d_$Aoh=Function.createDelegate(this,this.$Aoh);this.$$d_$lF=Function.createDelegate(this,this.$lF);this.$$d_$6NE=Function.createDelegate(this,this.$6NE);this.$$d_$Aqe=Function.createDelegate(this,this.$Aqe);this.$$d_$DZB=Function.createDelegate(this,this.$DZB);this.$$d_$95g=Function.createDelegate(this,this.$95g);this.$$d_$DZA=Function.createDelegate(this,this.$DZA);this.$$d_$3Rq=Function.createDelegate(this,this.$3Rq);this.$$d_$DYn=Function.createDelegate(this,this.$DYn);this.$$d_$DUt=Function.createDelegate(this,this.$DUt);this.$$d_$DWx=Function.createDelegate(this,this.$DWx);_mcp.$14o.initializeBase(this,[0,n]);this.$Lx=n.$v.$Lx;this.$1D=t;this.set_$5q5(!0);this.$6R9=i};_mcp.$14o.prototype={$Lx:null,$4yE:!1,$4UR:!1,$5fe:!1,$63j:null,$72P:null,$40T:null,$1D:null,$6R9:!1,$2N3:null,get_$G8:function(){return _mcp.$14n.prototype.get_$G8.call(this)},set_$G8:function(n){if(n!==_mcp.$14n.prototype.get_$G8.call(this)){_mcp.$14n.prototype.set_$G8.call(this,n);this.$4("IsInitialized")}this.$1n.$v.$c.set_$CGL(n);return n},set_$8X6:function(n){if(n!==this.$4yE){this.$4yE=n;this.$4("IsSecondInitializationComplete")}return n},set_$5q5:function(n){if(this.$4UR!==n){this.$4UR=n;this.$4("CanLoadPopoutSuccessfully")}return n},$2F5:function(){if(this.$2N3){this.$2N3.$AV();this.$2N3=null}},$3e:function(){this.$63j=_a.$6.acsa(_a.$0.$16,"VM.MailCompose.FirstInit",!0);var i=this.$1n.$v;var n=i.$c;n.$p("IsEditorReady",this.$$d_$DWx);if(!n.$jW&&!n.get_$Fd()){_js.Trace.logInfo(_a.$0.$16,"Capture initial baseline for a non draft without existing initial baseline, context: "+n.toString());n.$jW=_mcp.$1W.$33t(n);n.get_$23i()||n.set_$1P2(!0)}if(n.get_$rt()){_js.Trace.logInfo(_a.$0.$16,"Finish 1st init for complete context");this.$3o1();_js.Trace.logInfo(_a.$0.$16,"Check begin upgrade for complete context");this.$5nl()}else{var e=i.$n;var r=n.get_$Fd();var t=n.get_$14V();var o=n.get_$9oE();if(!r&&o){var u;var f=_g.$O.get_$Q().get_$4P();u=_js.$9.$o(f.get_$1up())?f.get_$Fv()||"":f.get_$sA()||"";var l=new _g.$QF("StoreId",o,u);var c=new _c.$10b([l],"EwsId");e.$tE(c,this.$$d_$DUt,this.$$d_$DYn,this.$$d_$3Rq);_js.Trace.logInfo(_a.$0.$16,"Calling server to convert id, storeId="+o)}else if(r)if(n.get_$3ey()&&n.get_$23i()){_js.Trace.logInfo(_a.$0.$16,"The message was saving prior to popout, check for save result from main window");this.$9Ik()}else{_js.Trace.logInfo(_a.$0.$16,"Load draft "+_h.$D1.$1d1(r));this.$6Ws(r)}else if((4===n.get_$6X()||13===n.get_$6X())&&n.get_$23i()){_js.Trace.logInfo(_a.$0.$16,"Loading draft without id for the popout from inline case, check id from main window");this.$9Ik()}else if(t){i.$1d.$9U(3400);i.$1d.$4s(3400,null);if(n.get_$1oe()){var a=_cc.$Dj.$H5(t,n.get_$1Lg());var s=new _cc.$Dj(200,a);s.$99=n.get_$D1();e.$tE(s,this.$$d_$DZA,this.$$d_$95g,this.$$d_$3Rq);_js.Trace.logInfo(_a.$0.$16,"Loading original calendar item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}else{var h=i.$Xj.$5uX(t);h.$99=n.get_$D1();e.$tE(h,this.$$d_$DZB,this.$$d_$95g,this.$$d_$3Rq);_js.Trace.logInfo(_a.$0.$16,"Loading original message item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}}else if(0===n.get_$6X()||11===n.get_$6X()){n.set_$OV(!0);n.set_$rt(!0);_js.Trace.logInfo(_a.$0.$16,"Finish 1st init for new mail");this.$3o1()}else{this.$lF("ErrorNoDraftOrOriginalItemId",null,null);throw Error.invalidOperation(String.format("Cannot perform operation {0} without either draft ID or original item ID",_js.$1I.$Gy(_y.$1m,n.get_$6X())));}}_js.$9.$o(_g.$O.get_$Q().get_$4P().get_$1up())||i.$1d.$4s(95,null)},$AV:function(){this.set_$G8(!1);this.set_$8X6(!1);this.set_$5q5(!0);this.$5fe=!1;this.$2F5()},$7Xi:function(){this.$AmY();this.$72P=_a.$6.acsa(_a.$0.$16,"VM.MailCompose.SecondInit",!0);var t=this.$1n;var n=t.$v;var i=n.$c;_js.Trace.logInfo(_a.$0.$16,"Queue 2nd init task, context:"+i.toString());_js.$D.get_$Q().$6C(_a.$0.$16,"Delayed MailCompose Secondary Init",this.$$d_$Aqe);if(n.get_$3w3()&&!n.$5w.$1a){var f=t.$5m(11);_js.Trace.logInfo(_a.$0.$16,"Queue appbar setup task");_js.$D.get_$Q().$6C(_a.$0.$16,"SetupApplicationBarMenu",f.$$d_$Ea8)}if(i.get_$37U()){var u=this.$1n.$5m(8);_js.Trace.logInfo(_a.$0.$16,"Queue diagnostics save to trigger uploading of the diagnostics attachment");_js.$D.get_$Q().$6C(_a.$0.$16,"Diagnostics save:",u.$$d_$E6U)}var r=t.$5m(19);_js.Trace.logInfo(_a.$0.$16,"Queue GetMailTips if needed task");_js.$D.get_$Q().$6C(_a.$0.$16,"TriggerMailTipsIfNeeded",r.$$d_$EqR)},$DYo:function(n){var f=_a.$6.acss(_a.$0.$16,"VM.MailCompose.ProcessDraft");var o=this.$1n.$v.$c;var e=this.$v.get_$5yu();var i=n;var t=n.$99;_js.Trace.logInfo(_a.$0.$16,"Got draft, checking pending discards for "+t);if(this.$Lx.$1EM(t))e.$5Nm(t,i.get_$y());else if(t===this.$c_2.get_$D1()){var r=i.$Ov;if(_g.$Sj.isInstanceOfType(r)){this.$c_2.$6NI(r);this.$5kG(!0);this.$97t(i)}else _a.$b.$43&&r.get_$Mk()?this.$C4n(r,i):this.$6NE(r,i);if(_a.$5N.$43){var u=this;_js.$D.get_$Q().$6C(_a.$0.$16,"TriggerPolicyTipsIfNeeded",function(){var n=u.$1n.$5m(25);n.$2BX(32)})}}else _js.Trace.logInfo(_a.$0.$16,"Skipping get draft processing since action context "+t+" doesn't match current context "+this.$c_2.toString());_a.$6.aces(f);_a.$6.acea(this.$40T)},$C4n:function(n,t){var i=this;this.$v.$5vW(function(){i.$7h4();i.$2N3.$6NE(n,t)})},$7h4:function(){if(!this.$2N3){_js.Trace.logInfo(_a.$0.$16,"Setting initializer component override");this.$2N3=this.$v.get_$4IH().$7h4();var n=this.$1n.$5m(29);this.$2N3.$3e(this.$$d_$6NE,n.$$d_$7So,this.$$d_$lF,this.$v.$n)}},$6NE:function(n,t){this.$c_2.$4sg(n);this.$5kG(!1);this.$97t(t)},$97t:function(n){if(this.$c_2.get_$23i()&&this.$c_2.get_$1P2()){_js.Trace.logInfo(_a.$0.$16,"Capture initial baseline for a loaded draft.");this.$c_2.$jW=_mcp.$1W.$33t(this.$c_2)}_js.Trace.logInfo(_a.$0.$16,"Finish 1st init for a loaded draft.");this.$3o1();var t=this;_js.$D.get_$Q().$6C(_a.$0.$16,"TriggerPolicyTipsIfNeeded",function(){var n=t.$1n.$5m(25);n.$2BX(32)})},$DZA:function(n){var u=this.$1n;var f=u.$v;var t=f.$c;var i=n.$99;if(i===t.get_$D1()&&!this.$Lx.$1EM(i)){var r=n;t.$1Tj(r.$1X);t.set_$1Lg(!1);_js.Trace.logInfo(_a.$0.$16,"Got original cal item, finish 1st init with context:"+t.toString());this.$3o1();_js.Trace.logInfo(_a.$0.$16,"Check begin upgrade on original cal item");this.$5nl()}},$DZB:function(n){var u=this.$1n;var f=u.$v;var t=f.$c;var i=n.$99;if(i===t.get_$D1()&&!this.$Lx.$1EM(i)){var r=n;t.$1Tj(r.$Ov);_js.Trace.logInfo(_a.$0.$16,"Got original message, finish 1st init with context: "+t.toString());this.$3o1();_js.Trace.logInfo(_a.$0.$16,"Check begin upgrade on original message item");this.$5nl()}},$DYn:function(n){var e=this.$1n;var u=e.$v;var f=u.$c;var t=n.$99;t!==f.get_$D1()||this.$Lx.$1EM(t)||u.$n.$t6(n,_nbs.NonBootStrings.l_OpenDraftFailureMessage_Text,_nbs.NonBootStrings.l_OpenDraftFailureMessageDisconnected_Text,_nbs.NonBootStrings.l_OpenDraftFailureMessage_Text,_bms.BootModelsStrings.l_ErrorRequestTimeout_Text,this.$$d_$Aoh);var i="GetDraftFailure_UnknownError";var r="";if(_g.$4k.$1dc(n.$2H)){i=_g.$4k.$2LC(n.$2H)||"GetDraftFailure_UnknownError";r=n.$2H.FaultMessage}_a.$6.acea(this.$40T);this.$lF(i,n.$FJ(),r)},$95g:function(n){var e=this.$1n;var u=e.$v;var f=u.$c;var t=n.$99;t!==f.get_$D1()||this.$Lx.$1EM(t)||u.$n.$9kb(n,this.$$d_$Aoh);var i="GetItemFailure_UnknownError";var r="";if(_g.$4k.$1dc(n.$2H)){i=_g.$4k.$2LC(n.$2H)||"GetItemFailure_UnknownError";r=n.$2H.FaultMessage}_a.$6.acea(this.$40T);this.$lF(i,n.$FJ(),r)},$Aoh:function(n,t){var i=this.$1n.$5m(2);i.get_$5F().$2Si(this.$1n.$v,!1);_js.Trace.logInfo(_a.$0.$16,"Navigate away on action failure")},$3Rq:function(n){var t=this.$1n.$v;var i=t.$c;if(n.$99===i.get_$D1()){t.$1d.$9U(3400);_mcp.$3t.$Jx(this.$1n)}},$3o1:function(){var f=_a.$6.acss(_a.$0.$16,"VM.MailCompose.ComponentInit");var n=this.$1n;var r=n.$v;var t=r.$c;var i=t.get_$6X();n.$5m(7).$3e();n.$5m(8).$3e();n.$5m(1).$3e();t.get_$oy()&&n.$5m(16).$3e();var u=_y.$z.$1Q.get_$U();i&&i!==11||!this.$1D.get_$NE()||t.get_$dp()||t.set_$dp("");t.get_$Xa()&&n.$5m(12).$3e();u!=="Mouse"?n.$5m(11).$3e():n.$5m(24).$3e();_a.$6.aces(f);_a.$6.acea(this.$63j);if(r.$hd){_js.Trace.logInfo(_a.$0.$16,"Begin 2nd init in finish 1st because we are already in view.");this.$7Xi()}this.set_$G8(!0)},$Aqe:function(){var t=this.$1n;var i=t.$v;var n=i.$c;n.get_$6X()||n.get_$dp()||n.set_$dp("");t.$5m(2);t.$3e();n.get_$T9()||n.$7oe();this.set_$8X6(!0);_js.Trace.logInfo(_a.$0.$16,"Finish 2nd init, context:"+n.toString());_a.$6.acea(this.$72P)},$6Ws:function(n){this.$40T=_a.$6.acsa(_a.$0.$16,"VM.MailCompose.LoadDraft",!0);var i=this.$1n.$v;var t=i.$c;var f=i.$n;if(t.get_$23i()){if(t.get_$1P2()){_js.Trace.logInfo(_a.$0.$16,"Capture initial baseline since message was a clean new message before popout, context: "+t.toString());t.$jW=_mcp.$1W.$33t(t)}t.get_$1Ll()&&!t.get_$OV()&&this.$5kG(!0)}else t.set_$23O(!0);i.$1d.$9U(3400);i.$1d.$4s(3400,null);t.get_$3xz()&&i.$1d.$4s(3480);var r=this.$1D.get_$NE()&&t.get_$6P()==="HTML"?_h.$f.get_$24c():_h.$f.get_$3Lk();var e="MailCompose";var u=i.$Xj.$5uX(n,r,e);u.$99=t.get_$D1();f.$tE(u,this.$$d_$DYo,this.$$d_$DYn,this.$$d_$3Rq);_js.Trace.logInfo(_a.$0.$16,"Loading draft with ID="+_h.$D1.$1d1(n)+"; Shape="+r.BodyType+"; Layout="+_y.$z.$1Q.get_$U()+"; ContextBodyType="+t.get_$6P())},$5kG:function(n){if(n!==this.$5fe){var t=this.$1n.$v.$1d;t.$9U(3440);n&&t.$4s(3440,null);_mcp.$3t.$Jx(this.$1n);this.$5fe=n}},$DUt:function(n){var i=n;var t=new _g.$1T(i.get_$7et().Id);this.$1n.$v.$c.set_$Fd(t);this.$6Ws(t)},$5nl:function(){var i=this.$1n;var t=i.$v.$c;var n=t.get_$6X();var u=1===n||2===n||3===n||12===n;if(u&&!t.get_$Fd()&&!t.get_$OV()){var r=i.$5m(13);r.$A9R()}},$9Ik:function(){var n=this.$1n.$v.$c.get_$D1();if(this.$6R9){_js.Trace.logInfo(_a.$0.$16,"Processing save result on main window for popout projection compose window "+n);var t=window.self.windowServiceEndPoint;t.getSaveResultForPopout(n,_a.$3A.$1Zf,this.$$d_$BtJ)}else{_js.Trace.logInfo(_a.$0.$16,"Calling main window to process save result "+n);_g.$1H.$Yw.$BtI(n,_a.$3A.$1Zf,this.$$d_$BtJ)}},$BtJ:function(n){var t=this.$1n.$v.$c;if(n){var i=JsonParser.deserialize(n);_js.Trace.logInfo(_a.$0.$16,"Resume loading draft after main window successfully saved item: "+i.Id);t.get_$1Ll()&&!t.get_$OV()&&t.set_$OV(!0);this.$6Ws(i)}else{_js.Trace.logInfo(_a.$0.$16,"Save failed on the main window for this popout, show failure message.");this.set_$5q5(!1);this.$lF("ErrorSaveFailedOnMainWindow",null,null)}},$DWx:function(n,t){var r=this.$1n.$v;var i=r.$c;if(i.$3wt){if(i.get_$T9()&&!i.$7DX){i.$W2.$11();i.get_$T9().set_$MW(i.get_$MW());i.$jW&&i.$jW.set_$MW(i.get_$MW())}this.$Amh()}},$Amh:function(){var t=this.$1n.$v;var n=t.$c;if(n.get_$1NG()){_y.$2F.$1G(n.get_$1NG(),null,"",null,t.get_$7jE());n.set_$1NG(null)}this.$4cr()},$lF:function(n,t,i){var u=this.$1n.$v;var r=u.$c;if(r.get_$dn()){_y.$2F.$1G(r.get_$dn(),null,n,t,i);r.set_$dn(null)}if(r.get_$1NG()){_y.$2F.$1G(r.get_$1NG(),null,n,t,i);r.set_$1NG(null)}this.$4cr()},$AmY:function(){var t=this.$1n.$v;var n=t.$c;if(n.get_$dn()){_y.$2F.$1G(n.get_$dn(),null,"",null,t.get_$7jE());n.set_$dn(null)}},$4cr:function(){var i=this.$1n.$v;var t=i.$c;if(t.get_$2C0()){var n=null;switch(t.get_$6X()){case 0:n="MailComposeNewLoad";break;case 1:n="MailComposeReplyLoad";break;case 2:n="MailComposeReplyAllLoad";break;case 3:n="MailComposeForwardLoad";break;case 4:n="MailComposeEditDraftLoad";break}if(n){_a.$6.endPT(n);t.set_$2C0(!1)}}}};_mcp.$MZ=function(n,t){this.$$d_$7pt=Function.createDelegate(this,this.$7pt);this.$$d_$E6r=Function.createDelegate(this,this.$E6r);this.$$d_$6uU=Function.createDelegate(this,this.$6uU);this.$$d_$1tX=Function.createDelegate(this,this.$1tX);this.$$d_$2WW=Function.createDelegate(this,this.$2WW);this.$$d_$DOT=Function.createDelegate(this,this.$DOT);this.$$d_$DnH=Function.createDelegate(this,this.$DnH);_mcp.$MZ.initializeBase(this,[9,n]);this.$6qq=new _C(this.$$d_$DnH,this.get_$m());this.$Lx=n.$v.$Lx;this.$1D=t};_mcp.$MZ.prototype={$Lx:null,$1D:null,$6qq:null,$3yM:!1,$3ym:!1,$2ml:!1,$3ex:!1,$4qX:!1,$2NA:null,get_$DnI:function(){return this.$6qq},set_$3yN:function(n){this.$3yM!==n&&(this.$3yM=n);return n},get_$3yn:function(){return this.$3ym},set_$3yn:function(n){if(this.$3ym!==n){this.$3ym=n;this.$7Xz(n)}return n},get_$4y3:function(){return this.$2ml},set_$4y3:function(n){if(this.$2ml!==n){this.$2ml=n;this.$7Xz(n)}return n},$4UP:function(){var n=!0;var u=this.$1n;var i=u.$v;var t=i.$c;var r=i.get_$iH();var o=i.get_$1Ng();var e=t.get_$D1();var s=t.get_$6X();if(this.$Lx.$1EM(e))_js.Trace.logInfo(_a.$0.$16,"User had chose to discard, simply navigate away.");else if(t.get_$1Ll()&&this.$Lx.$7lt(u,!1))_js.Trace.logInfo(_a.$0.$16,"User had navigated away on an unused response, the unused response was discarded.");else if(this.$7az())n=!1;else if(r.$bq){_js.Trace.logInfo(_a.$0.$16,"We're sending the message, can't exit yet.");n=!1}else if(r.$3ye){_js.Trace.logInfo(_a.$0.$16,"We're resolving the recipients, can't exit yet.");r.$7pQ();n=!1}else if(t.get_$1El()){var f=u.$5m(21);f.$Fp.$11();n=!1}else{_js.Trace.logInfo(_a.$0.$16,"Checking dirty before inline navigating away from compose. Context:"+t.toString());if(i.$IO()){this.$4qX=!1;_js.$D.get_$Q().$2V(_a.$0.$16,"NavigatingAwaySaveTimeout",this.$$d_$DOT,1e4);this.$3VU();if(o.$2NF("InlineExit",this.$$d_$2WW,this.$$d_$1tX,!1)){this.set_$4y3(!0);_js.Trace.logInfo(_a.$0.$16,"Save is in progress or failed, can't exit yet.");n=!1}}}return n},$APH:function(){return new _y.$Cc},$7Xz:function(n){var t=this.$1n.$v;t.set_$9qv(_u.CommonStrings.l_Saving_Text);t.set_$9kT(n);t.set_$EbV(n)},$DnH:function(){var i=this.$1n;var t=i.$v;var n=t.$c;var u=n.get_$D1();var l=i.$5m(7);_js.$D.get_$Q().$1Ym(_a.$0.$16,"MailComposePopOut");if(this.$3yM){_js.Trace.logInfo(_a.$0.$16,"Skipped pop out because another pop out is in progress.");return}if(l.$bq){_js.Trace.logInfo(_a.$0.$16,"Skipped pop out because send is in progress.");return}if(this.$7az()||this.$Lx.$1EM(u)){_js.Trace.logInfo(_a.$0.$16,"Skipped pop out because attachment is currently uploading or user had discarded");return}n.set_$dn(this.$2NA=_y.$2F.$1g(_a.$0.$16,"MailComposeInlinePopOut",!0));this.set_$3yN(!0);var s=!1;try{var a=this.$1n.$v.$1d;a.$ai(_mcp.$MZ.$wS);_mcp.$3t.$Jx(i);var r=i.$5m(8);_js.Trace.logInfo(_a.$0.$16,"Checking dirty before popping out from inline. Context:"+n.toString());var e=t.$IO();var f=t.$c.get_$6Py();var c=i.$5m(12);if(!n.get_$Fd()||e||c.$7DH||f){this.set_$3yn(!0);(n.get_$Fd()&&!f||e||r.$1Tu)&&n.set_$1P2(!1);_js.Trace.logInfo(_a.$0.$16,"Set WasCleanNewMessageBeforePopout = "+n.get_$1P2());this.$3ex=!1;_js.$D.get_$Q().$2V(_a.$0.$16,"PopoutSaveTimeout",this.$$d_$6uU,1e4);n.set_$3ey(!0);this.$3VU();t.$Le.get_saveForPopoutMap()[u]=new _y.$1N9;this.$6r6();r.$2NF("Popout",this.$$d_$E6r,this.$$d_$7pt,!1)}else{if(n.get_$23O())n.set_$1P2(!1);else if(n.get_$1TS())n.set_$1P2(!1);else if(r.$1Tu)n.set_$1P2(!1);else if(n.$jW){_js.Trace.logInfo(_a.$0.$16,"Comparing initial baseline with baseline. Context:"+n.toString());n.$jW.$5b(n.get_$T9())||n.set_$1P2(!1)}else n.set_$1P2(!1);n.set_$3ey(!1);_a.$4.$z(t.$Le,"PopoutManager");_a.$4.$z(t.$Le.get_saveForPopoutMap(),"PopoutManager.SaveForPopoutMap");delete t.$Le.get_saveForPopoutMap()[u];this.$6r6()}var h=t.get_$2rE();if(h){var o=h.get_$5F();if(o){_js.Trace.logInfo(_a.$0.$16,"MailComposeInlineComponent::OpenComposeWindow - setting composeConductor.HasNavigatedFromInlineToPopoutCompose = true");o.set_$3tw(!0)}}s=!0}catch(v){_y.$2F.$1G(this.$2NA,null,v.toString(),null,v.message);n.set_$dn(this.$2NA=null);throw v;}finally{if(!s){this.set_$3yN(!1);this.set_$3yn(!1)}}},$7az:function(){var n=this.$1n.$v;var t=this.$1n.$5m(5);if(t.get_$Q6()){if(!n.$2F.$3W){_js.Trace.logInfo(_a.$0.$16,"Show attachment in progress error dialog");n.$2F.$44(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null)}return!0}return!1},$6r6:function(){var i=this.$1n.$v;var t=i.$c;var n=new _mcp.$V;if(this.$1D){n.set_$ps(this.$1D.get_$ps());n.set_$NE(this.$1D.get_$NE())}n.set_$5j(0);n.set_$Xa(!1);if(t.get_$6X()===11||t.get_$6X()===12){n.set_$6X(13);n.set_$19y(t.get_$19y());n.set_$2se(t.get_$2se())}else n.set_$6X(4);n.set_$Fd(t.get_$Fd());n.set_$6P(t.get_$6P());var r=this.$APH();n.set_$23i(!0);n.set_$OV(t.get_$OV());n.set_$1ZN(t.get_$1ZN());n.set_$1Ll(t.get_$1Ll());n.set_$23O(t.get_$23O());n.set_$1TS(t.get_$1TS());n.set_$1P2(t.get_$1P2());n.set_$3ey(t.get_$3ey());n.set_$D1(t.get_$D1());n.set_$3o(t.get_$3o());n.set_$dn(t.get_$dn());t.get_$OV()||t.get_$6X()!==3||t.$6T6()||!t.get_$IV().get_$1m()||n.set_$EW(t.get_$IV().get_$1m().get_$7V());r.$WM(n);if(!t.get_$3ey()){i.set_$1Ei(!0);this.$2Si();this.set_$3yN(!1)}},$E6r:function(n){this.set_$3yn(!1);if(this.$3ex){_js.Trace.logInfo(_a.$0.$16,"Popout was cancelled by timer, skipping save succeeded processing for popout.");_y.$2F.$1G(this.$2NA,null,_mcp.$MZ.$QU.toString(3));this.$2NA=null}else{var i=n.$99;var t=this.$1n.$v;if(i in t.$Le.get_saveForPopoutMap()){var u=_mcp.$Kn.$7pn(n);var r=t.$Le.get_saveForPopoutMap()[i];if(r.$349.length){var f=JsonParser.serialize(u);t.$Le.pushSaveResultToPopout(f,r.$349);delete t.$Le.get_saveForPopoutMap()[i]}else r.$y=u}if(t.$c.get_$D1()===i){_js.Trace.logInfo(_a.$0.$16,"Save succeeded for popout, navigating away from the main window.");t.set_$1Ei(!0);this.$2Si();this.set_$3yN(!1)}else _js.Trace.logInfo(_a.$0.$16,"Skipped navigating away since contextId="+i+"; viewModelId="+t.$c.get_$D1())}},$2WW:function(n){this.$2ml&&this.set_$4y3(!1);if(this.$4qX){_js.Trace.logInfo(_a.$0.$16,"Navigation away was cancelled by timer, skipping navigating from compose.");return}this.$1n.$v.set_$1Ei(!0);this.$2Si()},$1tX:function(n){if(this.$2ml){_js.Trace.logInfo(_a.$0.$16,"Save failed, reset IsSavingForNavigatingAway flag to false");this.set_$4y3(!1)}},$2Si:function(){var n=this.$1n;var t=n.$5m(2);t.get_$5F().$2Si(n.$v,!1);_js.Trace.logInfo(_a.$0.$16,"Navigated away from inline compose")},$7pt:function(n){if(this.$3yM){this.set_$3yN(!1);this.set_$3yn(!1);var f=this.$1n;var i=f.$v;var t;t=n?n.$99:i.$c.get_$D1();if(t in i.$Le.get_saveForPopoutMap()){var r=i.$Le.get_saveForPopoutMap()[t];r.$349.length>0&&i.$Le.pushSaveResultToPopout(null,r.$349);delete i.$Le.get_saveForPopoutMap()[t]}}var u=this.$3ex?2:1;_y.$2F.$1G(this.$2NA,null,_mcp.$MZ.$QU.toString(u));this.$2NA=null},$6uU:function(){_js.Trace.logInfo(_a.$0.$16,"Attempt to popout expired since save did not come back in time");if(this.$3ym){this.$3ex=!0;this.$7pt(null);var n=this.$1n;var t=n.$v.$1d;this.$3VU();t.$4s(84);_mcp.$3t.$Jx(n)}},$DOT:function(){_js.Trace.logInfo(_a.$0.$16,"Attempt to navigate away expired since save did not come back in time");if(this.$2ml){this.$4qX=!0;this.$1tX(null);var n=this.$1n;var t=n.$v.$1d;this.$3VU();t.$4s(86);_mcp.$3t.$Jx(n)}}};_mcp.$MZ.$QU=function(){};_mcp.$MZ.$QU.prototype={popoutSaveFailed:1,popoutSaveExpired:2,popoutSaveSucceededExpired:3};_mcp.$MZ.$QU.registerEnum("_mcp.$MZ.$QU",!1);_mcp.$7y=function(n){_mcp.$7y.initializeBase(this,[4,n])};_mcp.$7y.$8Xa=function(n){switch(n.get_$6X()){case 4:return n.get_$6TM();case 8:case 3:case 5:case 7:case 6:return!0;default:return!1}};_mcp.$7y.prototype={get_$4fr:function(){return this.$w(_mcp.$7y.$65A)},set_$4fr:function(n){this.$P(_mcp.$7y.$65A,n);return n},get_$2va:function(){return this.$w(_mcp.$7y.$73m)},set_$2va:function(n){this.$P(_mcp.$7y.$73m,n);return n},get_$51J:function(){return this.$w(_mcp.$7y.$6XG)},set_$51J:function(n){this.$P(_mcp.$7y.$6XG,n);return n},get_$6Rl:function(){return this.$w(_mcp.$7y.$6Rm)},set_$6Rl:function(n){this.$P(_mcp.$7y.$6Rm,n);return n},$3e:function(){var n=this.$1n.$v.$c;var i=this.$1n.$v.$4x;n.get_$3Fs()?this.set_$51J(new _cc.$Cb(n.get_$6E(),null,this.$1n.$v.$4x,this.$1n.$v.$I)):this.set_$51J(null);if(n.get_$oy()&&n.get_$23R()){var t=1;var f=_pc.$q.$7gj(n.get_$5Q());var e=i.$Na(f,_bc.$6a.$11g,!0,t);this.set_$4fr(e);this.set_$6Rl(!!n.get_$Em()&&!!n.get_$Em().Mailbox&&!!n.get_$5Q()&&!!n.get_$5Q().Mailbox&&!_g.$1Z.$5b(n.get_$5Q().Mailbox,n.get_$Em().Mailbox));if(this.get_$6Rl()){var r=_pc.$q.$7gj(n.get_$Em());var u=i.$Na(r,_bc.$6a.$11g,!0,t);this.set_$2va(u)}else this.get_$2va()&&this.set_$2va(null)}else{this.get_$4fr()&&this.set_$4fr(null);this.get_$2va()&&this.set_$2va(null)}_js.Trace.logInfo(_a.$0.$16,"Meeting component initialized, IsMeeting={0}, IsMeetingForward={1}",n.get_$oy(),n.get_$23R());_mcp.$14n.prototype.$3e.call(this)}};_mcp.$1L5=function(n,t,i){this.$$d_$2qy=Function.createDelegate(this,this.$2qy);this.$$d_$2qx=Function.createDelegate(this,this.$2qx);this.$$d_$7dS=Function.createDelegate(this,this.$7dS);this.$$d_$9zh=Function.createDelegate(this,this.$9zh);this.$$d_$nq=Function.createDelegate(this,this.$nq);this.$$d_$2Um=Function.createDelegate(this,this.$2Um);this.$$d_$Eeu=Function.createDelegate(this,this.$Eeu);_mcp.$1L5.initializeBase(this,[10,n]);this.$6R=t;this.$3Y=i};_mcp.$1L5.prototype={$6R:null,$3Y:null,$3b1:null,$E6:null,$hp:null,$9B:null,set_$Eev:function(n){if(this.$3b1!==n){this.$3b1=n;this.$4("ShowMessageOptionsCommand")}return n},set_$ny:function(n){if(this.$E6!==n){this.$E6=n;this.$4("DialogViewModel")}return n},$3e:function(){this.$3b1||this.set_$Eev(new _C(this.$$d_$Eeu,this.get_$m()));this.$7Tz();_mcp.$14n.prototype.$3e.call(this)},$Eeu:function(){_js.Trace.logInfo(_a.$0.$16,"User chose to show message options");$C(this.$hp)&&(this.$hp=new _mcp.$nO);this.$hp.$1Ti(this.$c_2);if($C(this.$E6)){var t=new _bc.$DH;t.set_$cD(this.$6R);this.set_$ny(t);this.$E6.set_$3u(_nbs.NonBootStrings.l_MessageOptions_Text);this.$9B=[new _ff.$1l(new _C(this.$$d_$2Um,this.get_$m()),_u.CommonStrings.l_Ok_LowerCase_Text,null),new _ff.$1l(new _C(this.$$d_$nq,this.get_$m()),_u.Strings.l_CancelButtonLabel_LowerCase_Text,null)];this.$E6.$9B.$3y(this.$9B)}this.$E6.set_$FD(this.$hp);if("TouchNarrow"===_y.$z.$1Q.get_$U()){var n=this.$1n.$v.get_$5F();this.$hp.set_$5F(n);n.get_$6n().add_$22(this.$$d_$9zh)}this.$E6.set_$1C(!0)},$2Um:function(){if(this.$E6.$G7){_js.Trace.logInfo(_a.$0.$16,"User tried to click OK button more than once.");return}var n=this.$v.$c;if(n.get_$ET()!==this.$hp.$3XJ){"Normal"!==n.get_$ET()&&this.$E2I();n.set_$ET(this.$hp.$3XJ);"Normal"!==n.get_$ET()&&this.$7Tz()}n.set_$Qu(this.$hp.$3wi);n.set_$Q8(this.$hp.$3yU);this.$hp.$1Yg&&!n.get_$PT()||this.$hp.$1Yh&&!n.get_$T0()?this.$v.$5vW(this.$$d_$7dS):this.$7dS()},$7dS:function(){var t=this.$v.$c;var o=this.$1n.$v;var n=this.$v.get_$eM();var i=n.get_$9Z();if(t.get_$PT()!==this.$hp.$1Yg){t.set_$PT(this.$hp.$1Yg);this.$4("SmimeEncryptMessage");_js.Trace.logInfo(_a.$0.$53,"SmimeEncryptMessage option is changed to {0} by user.",this.$hp.$1Yg)}if(t.get_$T0()!==this.$hp.$1Yh){t.set_$T0(this.$hp.$1Yh);this.$4("SmimeSignMessage");_js.Trace.logInfo(_a.$0.$53,"SmimeSignMessage option is changed to {0} by user.",this.$hp.$1Yh)}var r=this.$hp.$1Yg||this.$hp.$1Yh;r&&o.$7FW();i&&i.set_$s0(t.get_$s0());if(this.$hp.$5go&&!r&&n.get_$P3())if(n.get_$Q6()){_js.Trace.logInfo(_a.$0.$53,"Waiting to move attachments because the attachment well is currently in progress.");this.$E6.set_$7d(!0);i.add_$EE(this.$$d_$2qx)}else this.$2qx(null,null);else if(!this.$hp.$5go&&r){var u=this.$c_2.get_$6X();var e=u===1||u===2||u===3;var f=e&&this.$3Y.$2r("ComposeBread1");f&&this.$v.get_$7Nt().get_$7dN().$11();if(n.get_$P3())if(n.get_$Q6()){_js.Trace.logInfo(_a.$0.$53,"Waiting to move attachments because the attachment well is currently in progress.");this.$E6.set_$7d(!0);i.add_$EE(this.$$d_$2qy)}else this.$2qy(null,null);else this.$5Dc()}else this.$5Dc()},$2qx:function(n,t){if(this.$8WY(n,t)){_js.Trace.logInfo(_a.$0.$53,"Started MoveAttachmentsFromClientToServer due to user turned off S/MIME for current message.");if(n){n.remove_$EE(this.$$d_$2qx);this.$E6.set_$7d(!1)}var i=this.$v.get_$eM().get_$9Z();if(this.$v.$c.get_$Fd())i.$2qx();else{var r=this.$v.get_$1Ng();var u=this;r.$2NF("Attach",function(){i.$2qx()},null,!1)}this.$5Dc()}},$2qy:function(n,t){if(this.$8WY(n,t)){_js.Trace.logInfo(_a.$0.$53,"Started MoveAttachmentsFromServerToClient due to user turned on S/MIME for current message.");if(n){n.remove_$EE(this.$$d_$2qy);this.$E6.set_$7d(!1)}this.$v.get_$eM().get_$9Z().$2qy();this.$5Dc()}},$8WY:function(n,t){return!n&&!t?!0:t==="IsInProgress"&&!n.get_$Q6()},$5Dc:function(){_js.Trace.logInfo(_a.$0.$16,"User hit OK on message options dialog, setting Sensitivity="+this.$c_2.get_$ET()+"; DeliveryReceipt="+this.$c_2.get_$Qu()+"; ReadReceipt="+this.$c_2.get_$Q8()+"; SmimeEncryptMessage="+this.$c_2.get_$PT()+"; SmimeSignMessage="+this.$c_2.get_$T0());this.$nq()},$nq:function(){if(this.$E6.$G7){_js.Trace.logInfo(_a.$0.$16,"User tried to close dialog when busy.");return}var t=this.$1n.$v.$c;var i=this.$v.$1aw();if(t.get_$s0()&&t.get_$ow()){_a.$3m.$44(_u.Strings.l_Smime_NotSupportedWithFromRecipientWell_Text,1);i.$4s(750)}else i.$9U(750);this.$v.get_$af().$3as.set_$87(!t.get_$s0());var n=this.$v.get_$eM();if(n.get_$9Z()){n.get_$9Z().remove_$EE(this.$$d_$2qx);n.get_$9Z().remove_$EE(this.$$d_$2qy)}"TouchNarrow"===_y.$z.$1Q.get_$U()&&this.$hp.$48.get_$6n().remove_$22(this.$$d_$9zh);_js.Trace.logInfo(_a.$0.$16,"Close message options dialog");this.$E6.$5a.$11()},$9zh:function(n,t){_mcp.$8n.isInstanceOfType(this.$1n.$v.get_$5F().get_$8q())?this.$E6.set_$1C(!0):this.$E6.set_$1C(!1)},$E2I:function(){var t=this.$1n.$v;var n=t.$1aw();switch(t.$c.get_$ET()){case"Personal":n.$9U(8900);break;case"Confidential":n.$9U(8901);break;case"Private":n.$9U(8902);break}_mcp.$3t.$Jx(this.$1n)},$7Tz:function(){var t=this.$1n.$v;var n=t.$1aw();switch(t.$c.get_$ET()){case"Personal":n.$4s(8900,null);break;case"Confidential":n.$4s(8901,null);break;case"Private":n.$4s(8902,null);break}_mcp.$3t.$Jx(this.$1n)}};_mcp.$1L6=function(n){this.$$d_$9Of=Function.createDelegate(this,this.$9Of);this.$$d_$48M=Function.createDelegate(this,this.$48M);_mcp.$1L6.initializeBase(this,[2,n]);this.$Lx=n.$v.$Lx};_mcp.$1L6.prototype={$Lx:null,$48:null,$1OR:!1,get_$5F:function(){$C(this.$48)&&(this.$48=new _y.$Cc);return this.$48},set_$5F:function(n){this.$48=n;return n},$3e:function(){var n=_y.$z.$1Q;"Mouse"!==n.get_$U()||n.get_$Cp()||n.add_$1w3(this.$$d_$48M);_mcp.$14n.prototype.$3e.call(this)},$4WJ:function(n){this.$1n.$v.$1di&&(this.$1OR=!0);if(!this.$1OR){_js.Trace.logInfo(_a.$0.$16,"Checking dirty before prompting user for before unload confirmation. Context: "+this.$1n.$v.$c.toString());this.$1n.$v.$IO()&&n.$1a4(_nbs.NonBootStrings.l_MailComposeBeforeUnloadConfirmation_Text)}this.$1OR=!0;_js.$D.get_$Q().$2V(_a.$0.$16,"ResetSkipBeforeUnloadConfirmationFlag",this.$$d_$9Of,100)},$9Of:function(){this.$1OR=!1},$48M:function(){_y.$z.$1Q.remove_$1w3(this.$$d_$48M);this.$Lx.$7lt(this.$1n,!0)}};_mcp.$1L7=function(n,t){this.$$d_$1GD=Function.createDelegate(this,this.$1GD);_mcp.$1L7.initializeBase(this,[15,n]);this.$5GJ=new _C(this.$$d_$1GD,this.get_$m());this.$5GJ.set_$87(t.get_$JQ().get_$14F().get_$5C5())};_mcp.$1L7.prototype={$5GJ:null,$1GD:function(){_js.Trace.logInfo(_a.$0.$16,"OpenFilePicker on PAL.");var n=this.$1n.$5m(5);if(!n){_js.Trace.logError(_a.$0.$16,"Unable to open file picker, attachment component is null.");return}if(!n.get_$9Z()){_js.Trace.logError(_a.$0.$16,"Unable to open file picker, attachment well ViewModel is null.");return}if(!_mcp.$Ma.$3Il(this.$1n.$v)){_js.Trace.logError(_a.$0.$16,"Unable to open file picker, ViewModel is not upgraded.");return}n.get_$9Z().$Dne();_js.Trace.logInfo(_a.$0.$16,"OpenFilePicker on PAL end.")}};_mcp.$Ma=function(n,t){this.$$d_$7Wj=Function.createDelegate(this,this.$7Wj);this.$$d_$7Wi=Function.createDelegate(this,this.$7Wi);_mcp.$Ma.initializeBase(this,[15,n]);var i;i=t.$8G(t.get_$JQ())?t.get_$JQ().get_$14F():this;var u=this;this.$1aC=new _C(this.$$d_$7Wi,this.get_$m(),i,"CameraAvailable",function(){return t.$8G(t.get_$JQ())&&t.get_$JQ().get_$14F().get_$4U6()});var r=this;this.$1aD=new _C(this.$$d_$7Wj,this.get_$m(),i,"GalleryAvailable",function(){return t.$8G(t.get_$JQ())&&t.get_$JQ().get_$14F().get_$4g5()})};_mcp.$Ma.$3Il=function(n){var t=n.$c;if($C(t)||!t.get_$OV()){_js.Trace.logInfo(_a.$0.$16,"Show attachment not allowed dialog, Upgraded="+t.get_$OV());n.$2F.$44(0,_nbs.NonBootStrings.l_AddingAttachmentNotAllowed_Text,null);return!1}return!0};_mcp.$Ma.prototype={$1aC:null,$1aD:null,$7Wi:function(){_js.Trace.logInfo(_a.$0.$16,"User chose to attach from camera");var n=this.$1n.$5m(5);if(!n){_js.Trace.logError(_a.$0.$16,"Unable to open camera, attachment component is null.");return}if(!n.get_$9Z()){_js.Trace.logError(_a.$0.$16,"Unable to open camera, attachment well ViewModel is null.");return}if(!_mcp.$Ma.$3Il(this.$1n.$v)){_js.Trace.logError(_a.$0.$16,"Unable to open camera, ViewModel is not upgraded.");return}n.get_$9Z().$9Df(n.$8Ul());_js.Trace.logInfo(_a.$0.$16,"Attach from camera end")},$7Wj:function(){_js.Trace.logInfo(_a.$0.$16,"User chose to attach from gallery");var n=this.$1n.$5m(5);if(!n){_js.Trace.logError(_a.$0.$16,"Unable to open gallery, attachment component is null.");return}if(!n.get_$9Z()){_js.Trace.logError(_a.$0.$16,"Unable to open gallery, attachment well ViewModel is null.");return}if(!_mcp.$Ma.$3Il(this.$1n.$v)){_js.Trace.logError(_a.$0.$16,"Unable to open gallery, ViewModel is not upgraded.");return}n.get_$9Z().$48T(n.$8Ul());_js.Trace.logInfo(_a.$0.$16,"Attach from gallery end")}};_mcp.$HY=function(n){this.$$d_$BjN=Function.createDelegate(this,this.$BjN);this.$$d_$Buu=Function.createDelegate(this,this.$Buu);this.$$d_$Buv=Function.createDelegate(this,this.$Buv);this.$$d_$Bux=Function.createDelegate(this,this.$Bux);this.$$d_$AZk=Function.createDelegate(this,this.$AZk);this.$$d_$DhQ=Function.createDelegate(this,this.$DhQ);this.$$d_$4fe=Function.createDelegate(this,this.$4fe);this.$$d_$7rs=Function.createDelegate(this,this.$7rs);this.$$d_$3SQ=Function.createDelegate(this,this.$3SQ);this.$$d_$1s9=Function.createDelegate(this,this.$1s9);this.$$d_$7rt=Function.createDelegate(this,this.$7rt);this.$$d_$DfH=Function.createDelegate(this,this.$DfH);this.$$d_$6qL=Function.createDelegate(this,this.$6qL);this.$$d_$A4D=Function.createDelegate(this,this.$A4D);this.$$d_$9Bw=Function.createDelegate(this,this.$9Bw);this.$$d_$E8l=Function.createDelegate(this,this.$E8l);this.$$d_$AUw=Function.createDelegate(this,this.$AUw);this.$$d_$C2D=Function.createDelegate(this,this.$C2D);this.$$d_$9lH=Function.createDelegate(this,this.$9lH);this.$$d_$C1v=Function.createDelegate(this,this.$C1v);this.$$d_$EdC=Function.createDelegate(this,this.$EdC);_mcp.$HY.initializeBase(this,[1,n]);this.$GI=this.$5vF();this.$GM=this.$5vF();this.$Ge=this.$5vF();this.$4HI=new _C(this.$$d_$EdC,this.get_$m());this.$4qx=new _C(this.$$d_$C1v,this.get_$m());this.$3as=new _C(this.$$d_$9lH,this.get_$m());this.$4r8=new _C(this.$$d_$C2D,this.get_$m());this.$5xt=new _C(this.$$d_$AUw,this.get_$m());this.$5rP=new _C(this.$$d_$E8l,this.get_$m());this.$1Nd=new _C(this.$$d_$9Bw,this.get_$m());this.$1gP=new(_ff.$18.$$(_y.$mW));this.$A4I()};_mcp.$HY.$DsK=function(n,t){n.set_$79(t)};_mcp.$HY.$Dro=function(n,t){n.set_$7x(t)};_mcp.$HY.$Drl=function(n,t){n.set_$AN(t)};_mcp.$HY.$DsJ=function(n,t){n.set_$10y(t)};_mcp.$HY.$Drn=function(n,t){n.set_$xt(t)};_mcp.$HY.$Drk=function(n,t){n.set_$qd(t)};_mcp.$HY.prototype={$GI:null,$GM:null,$Ge:null,$4HI:null,$4qx:null,$3as:null,$4r8:null,$5xt:null,$5rP:null,$1Nd:null,$5cX:null,$4Uo:null,$4Sj:null,$5YA:null,$4r9:null,$5Xe:null,$4qw:null,$o5:null,$1K1:null,$5Wu:!1,$NH:!1,$4vk:!1,$5lz:!1,$cT:null,$361:null,$4rV:null,$2Oo:!1,$6SW:!1,$7Do:!1,$5X7:!1,$5X5:!1,$1gP:null,add_$9Bv:function(n){this.$32("ResolveOperationSucceeded",n)},remove_$9Bv:function(n){this.$5d("ResolveOperationSucceeded",n)},add_$9Bu:function(n){this.$32("ResolveOperationCanceled",n)},remove_$9Bu:function(n){this.$5d("ResolveOperationCanceled",n)},set_$4fu:function(n){if(this.$o5!==n){this.$o5=n;this.$4("FromPersonaViewModel")}return n},get_$At1:function(){return this.$o5&&this.$o5.get_$3F()?this.$o5.get_$3F().get_$2Z():null},get_$1Rx:function(){if(!this.$1K1){var n=this;this.$v.$39Y.$9(function(t){var i=t.$7gX();i.set_$br(!0);i.set_$17(!1);i.set_$2BZ(100);i.set_$26J(0);i.set_$2ua("PersonaDetailedView");i.$1jT();i.set_$15Q(!0);i.set_$7JL(new _C(n.$$d_$A4D,_a.$0.$16));_y.$z.$1Q.get_$U()!=="Mouse"&&i.set_$Qn(new _C(n.$$d_$A4D,_a.$0.$16));i.add_$1AU(n.$$d_$6qL);n.$1K1=i;if(n.$5X7){n.$9lH();n.$5X7=!1}else if(n.$5X5){n.$6NF();n.$5X5=!1}})}return this.$1K1},set_$9kE:function(n){if(this.$5Wu!==n){this.$5Wu=n;this.$4("ShouldHighlightFromAsInvalid")}return n},get_$18a:function(){var n=this.$1n.$v.$c.get_$ow()&&(!!this.$o5&&this.$o5.get_$18a()||!!this.$1K1&&this.$1K1.get_$18a());return n||this.$GI.get_$18a()||this.$GM.get_$18a()||this.$Ge.get_$18a()},set_$3JT:function(n){this.$NH=n;this.$4("IsReadWrite");return n},set_$6SX:function(n){this.$6SW=n;this.$4("IsPeoplePickerShown");return n},get_$4vl:function(){var n=this.$1n.$v.$c;return!!n.get_$5Q()&&!!n.get_$5Q().Mailbox&&!_a.$2i.$YR(n.get_$5Q().Mailbox.EmailAddress)},get_$3at:function(){this.$5YA||(this.$5YA=new _y.$2a(_nbs.NonBootStrings.l_ShowFromMenuItemText_LowerCase_Text,this.$3as));return this.$5YA},get_$4rA:function(){this.$4r9||(this.$4r9=new _y.$2a(_nbs.NonBootStrings.l_HideFromMenuItemText_LowerCase_Text,this.$4r8));return this.$4r9},get_$7EC:function(){this.$5Xe||(this.$5Xe=new _y.$2a(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text,this.$4HI));return this.$5Xe},get_$6LK:function(){this.$4qw||(this.$4qw=new _y.$2a(_nbs.NonBootStrings.l_HideBccMenuItemText_LowerCase_Text,this.$4qx));return this.$4qw},get_$C9I:function(){return!this.$1n.$v.$c.get_$1El()},get_$CFq:function(){return!this.$1n.$v.$c.get_$1El()},get_$CDy:function(){return this.$1n.$v.$c.get_$1El()},get_$C0x:function(){return this.$5qo(this.$NH?this.$GI.$5X.$Gc:this.$GI.$RC.get_$xW())||this.$5qo(this.$NH?this.$GM.$5X.$Gc:this.$GM.$RC.get_$xW())||this.$5qo(this.$NH?this.$Ge.$5X.$Gc:this.$Ge.$RC.get_$xW())},$3e9:function(){this.$GI.$3e9();this.$GM.$3e9();this.$Ge.$3e9()},$EXk:function(n){this.$4rV=n},$AAD:function(n,t,i){if(this.$cT){this.$cT.remove_$2WS(this.$361);this.$cT.add_$2WS(i);this.$361=i;this.$cT.set_$6x3(t);this.$cT.$9w3(n);this.set_$6SX(!0);this.$1n.$v.$sY(this.$cT)}else{var r=this;this.$v.$3WB.$9(function(u){r.$cT=u.$5vP(n,t);r.$cT.add_$2WS(i);r.$cT.add_$6tf(r.$$d_$DfH);r.$361=i;r.set_$6SX(!0);r.$1n.$v.$sY(r.$cT)})}},$A4H:function(){if(this.$GI.$5X){this.$GI.$5X.remove_$1Mu(this.$$d_$7rt);this.$GI.$5X.remove_$1s9(this.$$d_$1s9);this.$GI.$5X.$3X.remove_$22(this.$$d_$3SQ);this.$GI.$5X.add_$1Mu(this.$$d_$7rt);this.$GI.$5X.add_$1s9(this.$$d_$1s9);this.$GI.$5X.$3X.add_$22(this.$$d_$3SQ)}if(this.$GM.$5X){this.$GM.$5X.remove_$1Mu(this.$$d_$7rs);this.$GM.$5X.remove_$1s9(this.$$d_$1s9);this.$GM.$5X.$3X.remove_$22(this.$$d_$3SQ);this.$GM.$5X.add_$1Mu(this.$$d_$7rs);this.$GM.$5X.add_$1s9(this.$$d_$1s9);this.$GM.$5X.$3X.add_$22(this.$$d_$3SQ)}},get_$wX:function(){return this.$1gP},$3e:function(){var n=this.$1n.$v.$c;var t=n.get_$9i();this.set_$3JT(!t||!!t.get_$RG()||t.get_$6lG()||t.get_$KU());if(n.get_$4IU()&&n.get_$4IU().get_$A()>0){this.$GI.$C5t(n.get_$4IU(),this.$NH,_u.Strings.l_ToRecipientsLabel_Text);n.set_$4IU(null)}else this.$GI.$3e(n.get_$79(),n.get_$10y(),this.$NH,_u.Strings.l_ToRecipientsLabel_Text);this.$GM.$3e(n.get_$7x(),n.get_$xt(),this.$NH,_u.Strings.l_CcRecipientsLabel_Text);_y.$z.$1Q.get_$lN()&&this.$9qo(!0);this.$A4H();var i=_g.$O.get_$Q().get_$4P();if(!_js.$9.$o(i.get_$1up())&&!_js.$9.$o(i.get_$sA())){var r=new _g.$8w;r.Mailbox=this.$Jf(i.get_$sA());n.set_$5Q(r)}("Mouse"===_y.$z.$1Q.get_$U()||n.get_$5Q()||_g.$O.get_$Q().get_$1j().get_$tY()||!$C(n.get_$AN())&&n.get_$AN().get_$A()>0||_g.$O.get_$Q().get_$1j().get_$1Ip())&&this.$1lJ();this.$9wM(n);_mcp.$14n.prototype.$3e.call(this)},$AV:function(){if(this.$o5){this.$o5.$1v();this.$o5=null}if(this.$cT){this.$cT.remove_$2WS(this.$361);this.$cT.remove_$6tf(this.$$d_$DfH);this.$cT.dispose();this.$cT=null;this.$361=null}this.$9NF();if(this.$1K1){this.$1K1.remove_$1AU(this.$$d_$6qL);this.$1K1.$1v();this.$1K1=null}this.$9NF();this.$E22();this.$1gP.$1u();this.$GI.$1v();this.$GM.$1v();this.$Ge.$1v();_mcp.$14n.prototype.$AV.call(this)},$2zW:function(){this.$1lJ();var n=this.$1n.$v.$c;this.$5ek();this.$2Um(n,this.$GI,_mcp.$HY.$DsK,_mcp.$HY.$DsJ);this.$2Um(n,this.$GM,_mcp.$HY.$Dro,_mcp.$HY.$Drn);this.$2Um(n,this.$Ge,_mcp.$HY.$Drl,_mcp.$HY.$Drk)},$4GQ:function(n,t){var u=_a.$2i.$YR(n);if(u){this.get_$1Rx().set_$By("");var f=this.$Jf(n);var e=_pc.$q.$Jf(f);var o=this.$1n.$v.$9M.$1b7;var i=o.$nr(e,4,!0,1);i.set_$4k(this.$5rP);i.set_$OA(!0);i.$2vP=!0;this.set_$4fu(i);this.$ANX()}else{this.get_$1Rx().set_$By(n);this.set_$4fu(null)}if(t){var r=this.$1n.$v.get_$6Xw();r.get_$G8()||r.$3e();r.$2yR()}this.set_$9kE(!u);this.$2zW()},$229:function(){this.$1lJ();return this.$GI.$229()+this.$GM.$229()+this.$Ge.$229()},$Bux:function(){this.$1lJ();return this.$GI.$229()},$Buv:function(){this.$1lJ();return this.$GM.$229()},$Buu:function(){this.$1lJ();return this.$Ge.$229()},$3W3:function(n){this.$1lJ();this.$5ek();this.$ADB();this.$7Do=n;this.$AsZ()},$BjM:function(){var n=new(_ff.$18.$$(String));this.$GI.$5X?n.$3y(this.$GI.$5X.$2L0()):this.$GI.$RC&&n.$3y(this.$GI.$RC.$2L0());this.$GM.$5X?n.$3y(this.$GM.$5X.$2L0()):this.$GM.$RC&&n.$3y(this.$GM.$RC.$2L0());this.$Ge.$5X?n.$3y(this.$Ge.$5X.$2L0()):this.$Ge.$RC&&n.$3y(this.$Ge.$RC.$2L0());return n.$3Q()},$AsZ:function(){this.$GI.$NH?this.$GI.$3A9():this.$7rt(!0)},$7rt:function(n){n?this.$GM.$NH?this.$GM.$3A9():this.$7rs(!0):this.$4fe(!1)},$7rs:function(n){n?this.$Ge.$NH?this.$Ge.$3A9():this.$4fe(!0):this.$4fe(!1)},$4fe:function(n){if(this.$7Do)if(n){_js.Trace.logInfo(_a.$0.$16,"Force resolve completed");this.$6T("ResolveOperationSucceeded")}else{_js.Trace.logInfo(_a.$0.$16,"Force resolve cancelled");this.$6T("ResolveOperationCanceled")}},$1zz:function(){this.$1lJ();this.$5ek();this.$GI.$1zz();this.$GM.$1zz();this.$Ge.$1zz()},$1lJ:function(){if(!this.$5lz){this.$5lz=!0;var n=this.$1n.$v.$c;this.$Ge.$3e(n.get_$AN(),n.get_$qd(),this.$NH,_u.Strings.l_BccRecipientsLabel_Text);if(!$C(n.get_$AN())&&0<n.get_$AN().get_$A()||!_js.$9.$o(n.get_$qd())||_g.$O.get_$Q().get_$1j().get_$1Ip()){n.set_$1LT(!0);_js.Trace.logInfo(_a.$0.$16,"Showing BCC field due to: BccCount={0}, HasBccQueryString={1}, AlwaysShowBcc={2}",$C(n.get_$AN())?0:n.get_$AN().get_$A(),!_js.$9.$o(n.get_$qd()),_g.$O.get_$Q().get_$1j().get_$1Ip())}if(this.$Ge.$5X){this.$Ge.$5X.remove_$1Mu(this.$$d_$4fe);this.$Ge.$5X.remove_$1s9(this.$$d_$1s9);this.$Ge.$5X.$3X.remove_$22(this.$$d_$3SQ);this.$Ge.$5X.add_$1Mu(this.$$d_$4fe);this.$Ge.$5X.add_$1s9(this.$$d_$1s9);this.$Ge.$5X.$3X.add_$22(this.$$d_$3SQ)}_js.Trace.logInfo(_a.$0.$16,"Recipient component initialized, ShouldValidate={0}, From={1}, ToCount={2}, CcCount={3}, BccCount={4}",!0,!n.get_$5Q()||!n.get_$5Q().Mailbox?"<not set>":n.get_$5Q().Mailbox.EmailAddress,$C(n.get_$79())?0:n.get_$79().get_$A(),$C(n.get_$7x())?0:n.get_$7x().get_$A(),$C(n.get_$AN())?0:n.get_$AN().get_$A());this.$9wM(n);if(n.get_$3Jg()&&(n.get_$5Q()||_g.$O.get_$Q().get_$1j().get_$tY()))if(this.get_$1Rx()){this.$6NF();_js.Trace.logInfo(_a.$0.$16,"Showing From field due to: From={0}, AlwaysShowFrom={1}",!n.get_$5Q()||!n.get_$5Q().Mailbox?"<not set>":n.get_$5Q().Mailbox.EmailAddress,_g.$O.get_$Q().get_$1j().get_$tY())}else this.$5X5=!0;else if(_g.$O.get_$Q().get_$1j().get_$tY()&&!$C(n.get_$9i())&&!n.get_$9i().get_$KU()){var t=this.$1n.$v.$1d;t.$9U(4525);t.$4s(4525);_mcp.$3t.$Jx(this.$1n)}}},$51N:function(){this.$GI.$51N();this.$GM.$51N();this.$Ge.$51N()},$BjN:function(){_js.Trace.logInfo(_a.$0.$53,"MailComposeRecipientComponent.GetAllEmailAddresses");var e=this.$1n.$v.$c;var t=new(_ff.$18.$$(_g.$1K));var u=this.$NH?this.$GI.$5X.$Gc:this.$GI.$RC.get_$xW();var f=this.$NH?this.$GM.$5X.$Gc:this.$GM.$RC.get_$xW();var r=this.$NH?this.$Ge.$5X.$Gc:this.$Ge.$RC.get_$xW();if(u){_js.Trace.logInfo(_a.$0.$53,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding to addresses");t.$3y(u.$3Q())}if(f){_js.Trace.logInfo(_a.$0.$53,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding cc addresses");t.$3y(f.$3Q())}if(r){_js.Trace.logInfo(_a.$0.$53,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding bcc addresses");t.$3y(r.$3Q())}_js.Trace.logInfo(_a.$0.$53,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding from address");var n=e.$3sl();if(!n){var i=_g.$O.get_$Q().get_$4P();n=new _g.$1K;n.Name=i.get_$Lk();n.EmailAddress=i.get_$Fv()||i.get_$sA();n.MailboxType="Mailbox";n.RoutingType="SMTP"}t.$F(n);return t},$E8l:function(){if(this.$o5){_js.Trace.logInfo(_a.$0.$16,"User selected from persona");this.$o5.set_$2f(!0);this.$4rV&&this.$4rV()}else _js.Trace.logInfo(_a.$0.$16,"User tries to select from persona, but it is null")},$9Bw:function(){this.$3W3(!1)},$AUw:function(){_js.Trace.logInfo(_a.$0.$16,"User chose to delete from persona");this.set_$4fu(null);this.get_$1Rx().set_$Qw(!0)},$A4D:function(){this.$4GQ(this.get_$1Rx().get_$By(),!0)},$6qL:function(n,t){this.$7Tf()},$5vF:function(){return new _mcp.$JR(this.$1n.$v.$9M,this)},$DhQ:function(n,t){this.$1gP.$1u();this.$7NN(this.$GI);this.$7NN(this.$GM);this.$7NN(this.$Ge)},$7NN:function(n){n.$5X?this.$1gP.$F(n.$5X):n.$RC&&this.$1gP.$F(n.$RC)},$A4I:function(){this.$GI.$p("ReadWriteRecipientWellViewModel",this.$$d_$DhQ);this.$GM.$p("ReadWriteRecipientWellViewModel",this.$$d_$DhQ);this.$Ge.$p("ReadWriteRecipientWellViewModel",this.$$d_$DhQ);this.$GI.$p("ReadOnlyRecipientWellViewModel",this.$$d_$DhQ);this.$GM.$p("ReadOnlyRecipientWellViewModel",this.$$d_$DhQ);this.$Ge.$p("ReadOnlyRecipientWellViewModel",this.$$d_$DhQ)},$E22:function(){this.$GI.$1B("ReadWriteRecipientWellViewModel",this.$$d_$DhQ);this.$GM.$1B("ReadWriteRecipientWellViewModel",this.$$d_$DhQ);this.$Ge.$1B("ReadWriteRecipientWellViewModel",this.$$d_$DhQ);this.$GI.$1B("ReadOnlyRecipientWellViewModel",this.$$d_$DhQ);this.$GM.$1B("ReadOnlyRecipientWellViewModel",this.$$d_$DhQ);this.$Ge.$1B("ReadOnlyRecipientWellViewModel",this.$$d_$DhQ)},$3SQ:function(n,t){this.$GI.get_$1L9()||this.$GM.get_$1L9()||this.$Ge.get_$1L9()||this.$1n.$v.$1d.$9U(65);this.$GI.get_$Iu()&&this.$GM.get_$Iu()&&this.$Ge.get_$Iu()||this.$1n.$v.$1d.$9U(70);_y.$z.$1Q.get_$lN()&&this.$9qo(!1);if(t&&t.$3R===2){var r=this.$1n.$v.get_$6Xw();r.get_$G8()||r.$3e();r.$9N1();if(_a.$5N.$43){var i=this;_js.$D.get_$Q().$6C(_a.$0.$PH,"TriggerPolicyTipsIfNeeded",function(){if(i.$1n&&i.$1n.$v){var n=i.$1n.$v.get_$9Gs();n.$2BX(1)}})}}},$ADB:function(){this.$GI.$5X&&this.$GI.$5X.$33e();this.$GM.$5X&&this.$GM.$5X.$33e();this.$Ge.$5X&&this.$Ge.$5X.$33e()},$DfH:function(){this.set_$6SX(!1)},$9NF:function(){if(this.$GI.$5X){this.$GI.$5X.remove_$1Mu(this.$$d_$7rt);this.$GI.$5X.remove_$1s9(this.$$d_$1s9);this.$GI.$5X.$3X.remove_$22(this.$$d_$3SQ)}if(this.$GM.$5X){this.$GM.$5X.remove_$1Mu(this.$$d_$7rs);this.$GM.$5X.remove_$1s9(this.$$d_$1s9);this.$GM.$5X.$3X.remove_$22(this.$$d_$3SQ)}if(this.$Ge.$5X){this.$Ge.$5X.remove_$1Mu(this.$$d_$4fe);this.$Ge.$5X.remove_$1s9(this.$$d_$1s9);this.$Ge.$5X.$3X.remove_$22(this.$$d_$3SQ)}},$1s9:function(){_mcp.$3t.$Jx(this.$1n)},$EdC:function(){_a.$6.stPT(_a.$0.$16,"MailComposeShowBcc",3);var t=_a.$6.$1g(_a.$0.$16,"MailComposeShowBcc",!0);_js.Trace.logInfo(_a.$0.$16,"User chose to show bcc");this.$1lJ();var n=this.$1n.$v.$c;if(!n.get_$1LT()){n.set_$1LT(!0);_mcp.$3t.$Jx(this.$1n);this.$7Na()}_a.$6.$1G(t);_a.$6.endPT("MailComposeShowBcc")},$C1v:function(){_a.$6.stPT(_a.$0.$16,"MailComposeHideBcc",3);var t=_a.$6.$1g(_a.$0.$16,"MailComposeHideBcc",!0);_js.Trace.logInfo(_a.$0.$16,"User chose to hide bcc");this.$1lJ();var n=this.$1n.$v.$c;if(n.get_$1LT()){n.set_$1LT(!1);_mcp.$3t.$Jx(this.$1n);this.$7Na()}_a.$6.$1G(t);_a.$6.endPT("MailComposeHideBcc")},$7Na:function(){if(_y.$z.$1Q.get_$U()==="Mouse"){var r=this.$1n.$5m(18);r.$7Na()}else{var n=this.$1n.$v.$c;var u=n.get_$1LT()?this.get_$6LK():this.get_$7EC();var t=n.get_$1LT()?this.get_$7EC():this.get_$6LK();var i=this.$1n.$v.$5w;i.$6zG(t,u)}},$9wM:function(n){if("Mouse"!==_y.$z.$1Q.get_$U()){var f=this.$1n;var u=f.$v;var r=u.$5w;if(r){var i=r.$1a;if(i)if(n.get_$3Jg()){if(!this.$2Oo)for(var t=0;t<i.length;t++)if(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text===i[t].$3V){r.$4PT(this.get_$3at(),t+1);this.$2Oo=!0}}else if(this.$2Oo){u.$5w.$5MY(this.get_$3at());this.$2Oo=!1}}}},$5ek:function(){var i=this.$1n.$v.$c;var n=null;if(i.get_$ow()){var t=null;this.$o5?t=this.$o5.get_$3F().get_$2Z():this.$1K1&&!_js.$9.$o(this.$1K1.get_$By())&&(t=this.$Jf(this.$1K1.get_$By()));n=new _g.$8w;n.Mailbox=t;i.set_$5Q(n);this.get_$4vl()||this.$1n.$v.$1d.$9U(66)}return n},$Jf:function(n){var t=new _g.$1K;t.MailboxType="Mailbox";t.RoutingType="SMTP";t.EmailAddress=n;return t},$ANX:function(){var t=_mcp.$JR.$2to;var n=[];(t&4)==4&&Array.add(n,new _fm.$d(_u.Strings.l_EditRecipient_LowerCase_Text,null,new _C(this.$$d_$AZk,_a.$0.$16)));(t&2)==2&&Array.add(n,new _fm.$d(_u.Strings.l_RemoveRecipient_LowerCase_Text,null,new _C(this.$$d_$AUw,_a.$0.$16)));$C(this.$o5.$1kB)||(t&1)!=1||Array.addRange(n,this.$o5.$1kB);this.$o5.set_$1JE(n)},$6NF:function(){var n=this.$1n.$v.$c;var i=null;var t=_g.$O.get_$Q().get_$4P();i=_js.$9.$o(t.get_$1up())||_js.$9.$o(t.get_$sA())?null!==n.get_$5Q()&&n.get_$5Q().Mailbox?n.get_$5Q().Mailbox.EmailAddress:_h.$2k.$4nQ(null)||t.get_$Fv():t.get_$sA();this.$4GQ(i,!1);n.set_$ow(!0);var u=this.$5ek();n.get_$T9()&&n.get_$T9().set_$5Q(u);var r=this.$1n.$5m(20);$C(r.get_$Tf())&&r.$3e()},$AZk:function(){var n=this.$o5.get_$3F().get_$2Z().EmailAddress;this.set_$4fu(null);this.get_$1Rx().set_$By(n);this.get_$1Rx().set_$Qw(!0)},$7Tf:function(){var n=this.get_$1Rx().get_$kU();if($C(n)||$C(n.get_$A3())||$C(n.get_$A3().get_$2Z()))_js.Trace.logWarning(_a.$0.$16,"User selected from but the SelectedResultItem persona is invalid");else{var t=n.get_$A3().get_$2Z().EmailAddress;_js.Trace.logInfo(_a.$0.$16,"User selected from="+t);this.$4GQ(t,!0)}},$9lH:function(){if(!this.get_$1Rx()){this.$5X7=!0;return}_a.$6.stPT(_a.$0.$16,"MailComposeShowFrom",3);var t=_a.$6.$1g(_a.$0.$16,"MailComposeShowFrom",!0);var n=this.$1n.$v.$c;if(n.get_$ow())_js.Trace.logInfo(_a.$0.$16,"Skip show from since it is already shown");else{_js.Trace.logInfo(_a.$0.$16,"User chose to show from");this.$4vk=!0;this.$6NF();_mcp.$3t.$Jx(this.$1n);this.$7Nb()}_a.$6.$1G(t);_a.$6.endPT("MailComposeShowFrom")},$C2D:function(){_a.$6.stPT(_a.$0.$16,"MailComposeHideFrom",3);var r=_a.$6.$1g(_a.$0.$16,"MailComposeHideFrom",!0);var n=this.$1n.$v.$c;if(n.get_$ow()){n.set_$ow(!1);this.$4vk=!1;_mcp.$3t.$Jx(this.$1n);if(_y.$z.$1Q.get_$U()==="Mouse"){var i=this.$1n.$5m(18);i.$7Nb()}else{var t=this.$1n.$v.$5w;t.$6zG(this.get_$4rA(),this.get_$3at())}}else _js.Trace.logInfo(_a.$0.$16,"Skip hide from since it is already hidden");this.$1n.$v.$1d.$9U(750);_a.$6.$1G(r);_a.$6.endPT("MailComposeHideFrom")},$7Nb:function(){if(_y.$z.$1Q.get_$U()==="Mouse"){var r=this.$1n.$5m(18);r.$7Nb()}else{var n=this.$1n.$v.$c;var u=n.get_$ow()?this.get_$4rA():this.get_$3at();var t=n.get_$ow()?this.get_$3at():this.get_$4rA();var i=this.$1n.$v.$5w;i.$6zG(t,u)}},$2Um:function(n,t,i,r){var u=this.$NH?t.$5X:t.$RC;if(!$C(u)){i(n,u.get_$xW());if(_rw.$83.isInstanceOfType(u)){var f=u;f.get_$9Q()&&r(n,f.get_$9Q().get_$By())}}},$9qo:function(n){var e=this.$1n.$v.$c;var i=!1;var u=e.$3sl();if(u){var t=this.$GM.$5X.$Gc;if(t)for(var r=0;r<t.get_$A();r++){var f=t.get_$E(r);if(u.EmailAddress.toLowerCase()===f.EmailAddress.toLowerCase()){i=!0;break}}}if(n&&i){this.$1n.$v.$1d.$9U(4450);this.$1n.$v.$1d.$4s(4450)}else n||i||this.$1n.$v.$1d.$9U(4450)},$5qo:function(n){if(!n||!n.get_$A())return!1;for(var t=0;t<n.get_$A();t++){var i=n.get_$E(t);if(i&&i.MailboxType==="GroupMailbox")return!0}return!1},$Zb:function(n){var t=this.$GI.$63D()||this.$GM.$63D()||this.$Ge.$63D();t&&n.$5X.$3X.$F(t)},get_$Eoj:function(){if(!this.$5cX){var n=this;this.$5cX=new _C(function(){n.$Zb(n.$GI)},_a.$0.$16)}return this.$5cX},get_$AEI:function(){if(!this.$4Uo){var n=this;this.$4Uo=new _C(function(){n.$Zb(n.$GM)},_a.$0.$16)}return this.$4Uo},get_$A9M:function(){if(!this.$4Sj){var n=this;this.$4Sj=new _C(function(){n.$Zb(n.$Ge)},_a.$0.$16)}return this.$4Sj}};_mcp.$JR=function(n,t){this.$$d_$5FK=Function.createDelegate(this,this.$5FK);this.$$d_$6od=Function.createDelegate(this,this.$6od);this.$$d_$8ZW=Function.createDelegate(this,this.$8ZW);_mcp.$JR.initializeBase(this);this.$9M=n;this.$6Xj=t};_mcp.$JR.prototype={$9M:null,$5Nu:null,$5X:null,$RC:null,$NH:!1,$6Xj:null,$1t2:null,$3bg:null,$5M:null,set_$i8:function(n){if(this.$5X!==n){this.$5X=n;this.$4("ReadWriteRecipientWellViewModel")}return n},get_$E5p:function(){this.$5Nu||(this.$5Nu=new _C(this.$$d_$8ZW,_a.$0.$g7));return this.$5Nu},set_$3Uo:function(n){if(n!==this.$RC){this.$RC=n;this.$4("ReadOnlyRecipientWellViewModel")}return n},get_$Iu:function(){var o=this.$NH&&_rw.$4c.$Iu(this.$5X);if(this.$NH){var f;var n;var s="";var t="";var i="";var r="";if(this.$5X){for(var u=0;u<this.$5X.$3X.get_$A();u++){f=this.$5X.$3X.get_$E(u);if(f){s=f.$8X.get_$mk();i=i+" "+s}}for(var e=0;e<this.$5X.$Gc.get_$A();e++){n=this.$5X.$Gc.get_$E(e);if(n){t="";_js.$9.$1h(n.EmailAddress)?_js.$9.$1h(n.Name)||(t=n.Name):t=n.EmailAddress;r=r+" "+t}}}_js.Trace.logInfo(_a.$0.$mg,"{0} Well Is empty? {1} \n Recipients are: {2} \n Addresses are: {3} \n",this.$1t2,o,i,r)}return o},get_$1L9:function(){return this.$NH&&!$C(this.$5X)&&this.$5X.$2NS},$2BY:function(){this.$NH&&this.$5X&&this.$5X.$ErS()},$C5t:function(n,t,i){this.$3bg=n;this.$NH=t;this.$5X?this.$5X.$5Lo(null):this.set_$i8(this.$7hv(null));var r=this.$5X.get_$9Q();if(r){r.set_$By("");r.$8LM(this.$3bg)}else this.$5X.$p("FindRecipientViewModel",this.$$d_$6od);this.$1t2=i},$3e:function(n,t,i,r){this.$NH=i;this.$5M=t;if(i){this.$5X?this.$5X.$5Lo(n):this.set_$i8(this.$7hv(n));var u=this.$5X.get_$9Q();if(u){!_js.$9.$o(u.get_$By())&&_js.$9.$o(t)&&u.set_$By(t);_js.$9.$o(t)||u.set_$By(t)}else this.$5X.$p("FindRecipientViewModel",this.$$d_$6od);this.$1t2=r}else this.$RC?this.$RC.$5Lo(n):this.set_$3Uo(this.$AQP(n))},$3A9:function(){$C(this.$5X)||this.$5X.$3A9()},$1zz:function(){this.$5X&&this.$5X.$1zz()},$3e9:function(){if(!$C(this.$5X)){this.$5X.set_$3e9(!0);this.$5X.set_$3e9(!1)}},$229:function(){var n;n=this.$NH?$C(this.$5X)?0:!this.$5X.get_$9Q()||_js.$9.$o(this.$5X.get_$9Q().get_$By())?this.$5X.$Gc.get_$A():this.$5X.$Gc.get_$A()+1:$C(this.$RC)?0:this.$RC.get_$xW().get_$A();return n},$51N:function(){if(this.$5X){for(var f="",u="",r="",i,n,t=0,o=this.$5X.$3X.get_$A();t<o;t++){i=this.$5X.$3X.get_$E(t);if(i&&!i.$KA){n=this.$5X.$Gc.get_$E(t);if(n){u=_js.$9.$1h(n.Name)?"":n.Name;f=_js.$9.$1h(n.EmailAddress)?"":n.EmailAddress;var e=String.format("( {0} , {1} ),",u,f);r+=e}}}r!==""&&_js.Trace.logInfo(_a.$0.$16,"{0} Well Invalid Recipients are: {1} \n",this.$1t2,r)}},$2A:function(){if(!$C(this.$5X)){this.$5X.set_$7Dp(!1);this.$5X.$1v();this.$5X=null}},$7hv:function(n){return this.$9M.$4Xv(_mcp.$JR.$2to,_pe.$1k.$1xJ,n,!0)},$AQP:function(n){return this.$9M.$1CT(_mcp.$JR.$5LD,_bc.$6a.$11g,n,1)},$6od:function(n,t){var r=n;var i=r.get_$9Q();if(this.$3bg&&this.$3bg.get_$A()>0){i.set_$By("");i.$8LM(this.$3bg)}_js.$9.$1h(this.$5M)||i.set_$By(this.$5M);r.$1B("FindRecipientViewModel",this.$$d_$6od)},$8ZW:function(){if(this.$NH&&!OwaApplication.$Oy){_js.Trace.logInfo(_a.$0.$16,"User chose to launch rich people picker");this.$5X.$1zz();_a.$i.$Ii.$F("VM.PeoplePicker.Launched",_a.$8.get_$38());_a.$6.stPT(_a.$0.$g7,"PeoplePicker",3);_a.$6.$1g(_a.$0.$g7,"PeoplePicker");this.$6Xj.$AAD(this.$5X.$3X,this.$1t2,this.$$d_$5FK)}},$5FK:function(n){_y.$z.$1Q.get_$U()!=="TouchNarrow"&&this.$5X.$3X.$1u();var t=this;n.$Cj(function(n){var i=n;i.$KA?t.$5X.$317(i.$I3):t.$5X.$3gF(i.$I3)})},$63D:function(){for(var t=this.$5X.$3X,r=null,n=0;n<t.get_$A();n++){var i=t.get_$E(n);if(i.$4uL){r=i;t.$5W(n);break}}return r}};_mcp.$3t=function(n,t){this.$$d_$6oo=Function.createDelegate(this,this.$6oo);this.$$d_$kN=Function.createDelegate(this,this.$kN);_mcp.$3t.initializeBase(this,[14,n]);this.$6R=t};_mcp.$3t.$Jx=function(n){var i=n.$5m(14);i&&i.$kN();var t=n.$5m(1);t&&t.$3e9()};_mcp.$3t.prototype={$6R:null,$5gj:!1,get_$3W0:function(){return this.$w(_mcp.$3t.$70C)},set_$3W0:function(n){this.$P(_mcp.$3t.$70C,n);return n},$3e:function(){if(!this.$5gj){this.$ElV();this.$5gj=!0;_g.$O.get_$Q().get_$6m().add_$1zw(this.$$d_$6oo);_g.$O.get_$Q().get_$6m().add_$3FF(this.$$d_$6oo)}this.$kN();_js.Trace.logInfo(_a.$0.$16,"Resize editor component initialized and resize editor called");_mcp.$14n.prototype.$3e.call(this)},$kN:function(){this.$C7c()},$AV:function(){this.$Esz();this.$5gj=!1;_g.$O.get_$Q().get_$6m().remove_$1zw(this.$$d_$6oo);_g.$O.get_$Q().get_$6m().remove_$3FF(this.$$d_$6oo);_js.Trace.logInfo(_a.$0.$16,"Editor resize component reset");_mcp.$14n.prototype.$AV.call(this)},$C7c:function(){!$C(this.get_$3W0())&&this.get_$3W0().$3s?this.get_$3W0().$11():this.$1n.$5m(27).set_$Nf(new _cmc.$1Cm)},$6oo:function(n,t){this.$kN()},$ElV:function(){if(this.$6R){var t=_js.$2q.$3AJ(this.$6R);var n=this;t.$8m("resize",function(t){n.$kN()},"EditorResizeComponent")}else _y.$z.$1Q.add_$1Go(this.$$d_$kN)},$Esz:function(){if(this.$6R){var n=_js.$2q.$3AJ(this.$6R);n.$Be("resize","EditorResizeComponent")}else _y.$z.$1Q.remove_$1Go(this.$$d_$kN)}};_mcp.$Kn=function(n,t,i){this.$$d_$AX9=Function.createDelegate(this,this.$AX9);this.$$d_$AXA=Function.createDelegate(this,this.$AXA);this.$$d_$8RU=Function.createDelegate(this,this.$8RU);this.$$d_$7HP=Function.createDelegate(this,this.$7HP);this.$$d_$Ar=Function.createDelegate(this,this.$Ar);this.$$d_$E6U=Function.createDelegate(this,this.$E6U);this.$WV={};_mcp.$Kn.initializeBase(this,[8,n]);this.$2Y=t;this.$E0=new _C(this.$$d_$Ar,this.get_$m());this.$Lx=n.$v.$Lx;this.$1D=i};_mcp.$Kn.$7pn=function(n){var t=null;_h.$4A.isInstanceOfType(n)?t=n.$5i:_h.$49.isInstanceOfType(n)&&(t=n.$5i);return t};_mcp.$Kn.prototype={$Lx:null,$E0:null,$1D:null,$GQ:!1,$1Tu:!1,$3tx:!1,$4IN:null,$2Yx:!1,$14z:null,$4Cb:null,$2Y:null,$1gn:null,get_$1AP:function(){return this.$E0},get_$G9:function(){return this.$GQ},set_$G9:function(n){if(n!==this.$GQ){this.$GQ=n;this.$4("IsSaving")}return n},get_$C9k:function(){return this.$1Tu},$Ar:function(){this.$7OO(null)},$7OO:function(n){var i=this.$1n;var r=i.$5m(5);var u=i.$v.$2F;var t=i.$v.$c;_js.Trace.logInfo(_a.$0.$16,"SaveStart:Context:"+t.toString());this.$3VU();if(!t.get_$6TN()){_js.Trace.logInfo(_a.$0.$16,"Save not supported for the current operation {0}",t.get_$6X());return}if(r.get_$Q6()){_js.Trace.logInfo(_a.$0.$16,"Skip save and show attachment in progress dialog");u.$44(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null);return}this.$1Tu=!0;this.$2NF("Save",n,null,!1)},$3e:function(){this.$2xE();_mcp.$14n.prototype.$3e.call(this)},$2xE:function(){if(this.$v.get_$4LS()&&!this.$1gn){_js.Trace.logInfo(_a.$0.$16,"Setting save component override");this.$1gn=this.$v.get_$4IH().$AQs();var n=this.$1n.$5m(29);this.$1gn.$3e(this.$$d_$7HP,this.$$d_$8RU,n.$$d_$AAv,n.$$d_$7So)}},$2F5:function(){if(this.$1gn){this.$1gn.$AV();this.$1gn=null}},$2NF:function(n,t,i,r){if(this.$1gn&&!this.$1gn.$8WX()){_js.Trace.logInfo(_a.$0.$16,"saveComponentOverride.IsReadyForSmimeOperation() == false.  Save ignored.");return!0}var f=this.$1n;var s=f.$v;var u=s.$c;var h=s.$1d;var e=u.get_$D1();var a=this.$1n.$v.get_$eM();var c=f.$5m(7);if(c.$bq&&!r){_js.Trace.logInfo(_a.$0.$16,"Send is in progress, this "+n+" save is ignored. ContextId="+e);return!0}if(this.$Lx.$1EM(e)){_js.Trace.logInfo(_a.$0.$16,"User already discarded, clearing all save processors to ignore save effects. ContextId="+e);this.$WV={};return!1}var o=f.$5m(1);o.$1zz();if(_g.$O.get_$Q().get_$6Yg()<o.$229()){h.$4s(800,null);_mcp.$3t.$Jx(f);return!0}o.$2zW();u.get_$3sY().$11();this.$WV[n]=new _mcp.$1NA(t,i);if(!this.$GQ||r){this.$4IN=_mcp.$1W.$33t(u);this.set_$G9(!0)}else{this.$3tx=!this.$4IN.$7oV(u);return!0}if(!u.get_$OV()&&!u.get_$Fd()&&!u.get_$1ZN()){_js.Trace.logInfo(_a.$0.$16,"Save was attempted during upgrade, remembering this save attempt and waiting for upgrade completion to resume this save. ContextId="+e);return!0}_a.$6.stPT(_a.$0.$16,"MailComposeSave",5);this.$14z=_y.$2F.$1g(_a.$0.$16,"MailComposeSave",!0);this.$4Cb=n;_js.$D.get_$Q().$1Ym(_a.$0.$16,"MailComposeSave");_js.Trace.logInfo(_a.$0.$16,"Started new task runner context before starting save.");try{this.$1gn?this.$1gn.$7HP(n):this.$7HP(n);return!0}catch(l){this.$8RU(l);throw l;}},$AV:function(){this.$GQ=!1;this.$3tx=!1;this.$1Tu=!1;this.$2Yx=!1;this.$WV={};this.$4IN=null;this.$2F5();_mcp.$14n.prototype.$AV.call(this)},$5Np:function(){this.$GQ=!1;this.$3tx=!1;_js.Trace.logInfo(_a.$0.$16,"ResumeSave:Context:"+this.$1n.$v.$c.toString());var i=this.$WV;for(var r in i){var n={key:r,value:i[r]};var t=n.value;this.$2NF(n.key,t.$2yW,t.$3nm,!0);break}},$E6U:function(){this.$2NF("Diagnostics",null,null,!1)},$6GO:function(n){return _y.$5y.$4TX(n.$2H,40,50,60,700,88,89,43,57)},$5jZ:function(n){if("InlineExit"in this.$WV||"Popout"in this.$WV){var u=this.$1n.$v;var t=u.$1d;var r=this.$6GO(n);var e=new _y.$ty;var i=e.$4L(r,null);t.$ai(_mcp.$MZ.$wS);"InlineExit"in this.$WV?t.$4s(87,i):t.$4s(85,i);if(r===50){var f=this;u.$2TL.$9(function(n){n.$7SN(t);_mcp.$3t.$Jx(f.$1n)})}else _mcp.$3t.$Jx(this.$1n)}else"Save"in this.$WV&&_mcp.$14n.prototype.$5jZ.call(this,n)},$7HP:function(n){_js.Trace.logInfo(_a.$0.$dT,"Setup save action, context:"+this.$c_2.toString()+"; OriParentFolderId="+(this.$c_2.get_$IV()&&this.$c_2.get_$IV().get_$3G()&&_g.$c.$2I?_g.$c.$2I.idToName(this.$c_2.get_$IV().get_$3G()):"null"));var t=this.$v.$Xj.$5u6(this.$v,0,this.$1D);if((_h.$2k.isInstanceOfType(t)||_h.$49.isInstanceOfType(t))&&("Attach"===n||"Popout"===n)&&this.$c_2.get_$1El()){var i=t;i.$14y=new _g.$8c(new _g.$7H("internalsubmission"))}this.$v.$n.$tE(t,this.$$d_$AXA,this.$$d_$AX9,null);_js.Trace.logInfo(_a.$0.$16,"Save action submitted")},$8RU:function(n){this.set_$G9(!1);this.$1Tu=!1;var t=n.toString();_y.$2F.$1G(this.$14z,null,t,null,this.$6G8(this.$4Cb,n.message));this.$14z=null;_a.$6.endPT("MailComposeSave");_js.Trace.logWarning(_a.$0.$16,"Save failed due to an error before action was submitted: "+t)},$9Iy:function(n){var f=this.$1n;var o=f.$v;var u=o.$c;var t=n.$99;var r=!1;if(this.$Lx.$1EM(t)){u.get_$D1()===t&&(this.$WV={});this.$3lq(n);var e=_mcp.$Kn.$7pn(n);if(e){_js.Trace.logInfo(_a.$0.$16,"Resume discard for context "+t);f.$5m(21).$5Nm(t,e)}r=!0}else if(t===u.get_$D1()){if(this.$2Yx){this.$2Yx=!1;_js.Trace.logInfo(_a.$0.$16,"User issued send while save was in progress, now the save had come back, resume the send and cancel any pending saves. ContextId="+t);this.$WV={};this.$3lq(n);var i=null;_h.$4A.isInstanceOfType(n)?i=n.$5i:_h.$49.isInstanceOfType(n)&&(i=n.$5i);i&&u.set_$Fd(i);var s=f.$5m(7);s.$3XI();r=!0}else if(this.$3tx){_js.Trace.logInfo(_a.$0.$16,"Saving new content per user's request. ContextId="+t);this.$5Np();r=!0}}else _js.Trace.logInfo(_a.$0.$16,"Skipping default save processing due to ContextId="+t+"; viewModelId="+o.$c.get_$D1());return r},$AXA:function(n){var r=this.$1n;var o=r.$v;var f=o.$c;var s=r.$5m(21);var u=n.$99;_js.Trace.logInfo(_a.$0.$16,"Save action returned success, ContextId="+u+"; Context:"+f.toString());if(!this.$9Iy(n)&&u===f.get_$D1()){this.$AU5(n);this.$8bD();var i=!1;var t=null;if("Attach"in this.$WV){if("AutoSave"in this.$WV){t=this.$WV.AutoSave;t&&t.$2yW(n)}t=this.$WV.Attach}else if("Popout"in this.$WV){t=this.$WV.Popout;var e=r.$5m(9);if(e&&e.$3ex&&"InlineExit"in this.$WV){t&&t.$2yW(n);t=this.$WV.InlineExit}}else if("InlineExit"in this.$WV)t=this.$WV.InlineExit;else if("AutoSave"in this.$WV){t=this.$WV.AutoSave;i=!0}else if("Save"in this.$WV){t=this.$WV.Save;i=!0}else"Diagnostics"in this.$WV&&(i=!0);t&&t.$2yW&&t.$2yW(n);i&&r.$5m(5).$7Nz();this.$WV={}}_y.$2F.$1G(this.$14z,null,"",this.$FJ(n),this.$6G8(this.$4Cb,""));this.$14z=null},$8bD:function(){var i="";var t=this.$WV;for(var n in t){var r={key:n,value:t[n]};i+=r.key+":"}_js.Trace.logInfo(_a.$0.$16,"ProcessorKeys:"+i)},$AX9:function(n){var o=this.$1n.$v.$c;var e=n.$99;_js.Trace.logInfo(_a.$0.$16,"Save action returned a failure, ContextId="+e+"; Context:"+o.toString());if(!this.$9Iy(n)&&e===o.get_$D1()){this.$8bD();var t=!1;var h=this.$WV;for(var s in h){var i={key:s,value:h[s]};var u=i.value;if(u.$3nm){u.$3nm(n);if((i.key==="InlineExit"||i.key==="Popout")&&!t){this.$7k9(n);t=!0}}else if(!t){this.$7k9(n);t=!0}}t||this.$3lq(n);this.$WV={}}var r="SaveFailure_UnknownError";var f="";if(_g.$4k.$1dc(n.$2H)){r=_g.$4k.$2LC(n.$2H)||"SaveFailure_UnknownError";f=n.$2H.FaultMessage}_y.$2F.$1G(this.$14z,null,r,this.$FJ(n),this.$6G8(this.$4Cb,f));this.$14z=null},$AU5:function(n){var r=this.$1n;var i=r.$v;var t=i.$c;var f=n.$99;var o=this.$1Tu;if(f===t.get_$D1()){this.$EuD(n);t.set_$6Py(!1);i.$9wn()}this.$6T("MailSaveSucceeded");if(f===t.get_$D1()&&o){var s=_a.$8.get_$38();var u=i.$1d;u.$ai(_mcp.$Kn.$wS);u.$4s(1001,s.$4I(0));_mcp.$3t.$Jx(r)}if(_a.$5N.$43){var e=r.$5m(25);e.$2BX(this.$1Tu?4:2)}this.$3lq(n)},$7k9:function(n){_js.Trace.logInfo(_a.$0.$16,"SaveActionFailed: Error: {0}",n.$2H.message);n.$99===this.$1n.$v.$c.get_$D1()&&this.$5jZ(n);var t=this.$1n.$v;t.$1di&&t.set_$1Ei(!1);this.$3lq(n)},$3lq:function(n){var i=this.$1n;var t=i.$v.$c;if(n.$99===t.get_$D1()){this.set_$G9(!1);this.$1Tu=!1}_a.$6.endPT("MailComposeSave")},$FJ:function(n){var t=null;_h.$4A.isInstanceOfType(n)&&n.$68?t=n.$68.correlationId:_h.$49.isInstanceOfType(n)&&n.$68&&(t=n.$68.correlationId);return t},$6G8:function(n,t){var i=new _a.$3z;i.$CX("Ctx",n||"");i.$CX("Err",t||"");return i.toString()},$EuD:function(n){var t=this.$1n.$v.$c;t.set_$T9(this.$4IN);if(this.$1Tu){t.set_$1TS(!0);this.$1Tu=!1;_js.Trace.logInfo(_a.$0.$16,"Explicit save recorded. ContextId="+t.get_$D1())}if(_h.$2k.isInstanceOfType(n)){var u=n;var r=u.$5i;u.$b.set_$y(r);t.set_$Fd(r);t.set_$j0(u.$b);_js.Trace.logInfo(_a.$0.$16,"Updated context from create action. Context:"+t.toString());this.$2Y.$AYi(r)}else if(_h.$49.isInstanceOfType(n)){var i=n;var s=i.$5i;i.$Fs.set_$y(s);t.set_$Fd(s);t.set_$j0(i.$Fs);_js.Trace.logInfo(_a.$0.$16,"Updated context from update action. Context:"+t.toString())}else if(_h.$Bk.isInstanceOfType(n)){var y=n;var v=y.$5i;t.set_$Fd(v);_js.Trace.logInfo(_a.$0.$16,"Updated context from create response action. Context:"+t.toString())}else if(_mcp.$sN.isInstanceOfType(n)){var p=n;var b=p.$1kM.$5i;t.set_$Fd(b);_js.Trace.logInfo(_a.$0.$16,"Updated context from create response from modern group action. Context:"+t.toString())}else if(_cc.$10h.isInstanceOfType(n)){var e=n;var w=e.meetingResponseMessageId;t.set_$Fd(w);t.set_$j0(e.$Ov);_js.Trace.logInfo(_a.$0.$16,"Updated context from create meeting response message. Context:"+t.toString())}else if(_c.$sM.isInstanceOfType(n)){var a=n;var c=a.$5i;t.set_$Fd(c);_js.Trace.logInfo(_a.$0.$16,"Updated context from create approval response action. Context:"+t.toString())}if(_h.$4A.isInstanceOfType(n)&&t.get_$j0()){var l=n;var f=l.$3hg;var o=t.get_$j0().get_$EW();if(f&&o){var h=0;var k=this;o.$Cj(function(n){var t=n;t.set_$6J(f[h]);h++});_js.Trace.logInfo(_a.$0.$16,"Attachment IDs have been updated.")}}}};_mcp.$II=function(n){this.$$d_$AVA=Function.createDelegate(this,this.$AVA);_mcp.$II.initializeBase(this,[20,n])};_mcp.$II.$4Xd=function(n,t){return new _fm.$d(n,null,t,!0)};_mcp.$II.prototype={get_$Tf:function(){return this.$w(_mcp.$II.$24o)},set_$Tf:function(n){this.$P(_mcp.$II.$24o,n);return n},$3e:function(){if($C(this.get_$Tf())){var n=this.$3km(_fm.$d,_mcp.$II.$4Xd);if(n){this.set_$Tf(new _fm.$1u(n));this.get_$Tf().set_$AJR(new _C(this.$$d_$AVA,this.get_$m()))}}_mcp.$14n.prototype.$3e.call(this)},$AV:function(){this.get_$Tf()&&this.set_$Tf(null);_mcp.$14n.prototype.$AV.call(this)},$4PT:function(n,t){if(this.get_$Tf()){for(var u=_mcp.$II.$4Xd(n,new _C(this.$4Y4(n),this.get_$m())),i=this.get_$Tf().$1a,r=i.get_$A()-1;r>0;r--)if(_fm.$6V.isInstanceOfType(i.get_$E(r))){i.$6i(r+1,u);var f=i.get_$A()-r-1;f>t&&i.$5W(i.get_$A()-1);return}i.$F(new _fm.$6V);i.$F(u)}},$AVA:function(){if(this.get_$Tf()&&this.get_$Tf().$1Y){var f=this.get_$Tf().$1Y;var r=_g.$O.get_$Q().get_$1j().get_$4DQ();var e=r.$3M(f.$3V);if(e){for(var n=this.get_$Tf().$1a,t=n.get_$A()-1;t>0;t--)if(n.get_$E(t).$3V===f.$3V){n.$5W(t);var u=n.get_$A();_fm.$6V.isInstanceOfType(n.get_$E(u-1))&&n.$5W(u-1);break}var i=new(_a.$u.$$(String));r.get_$A()>0?i.$1yS(r):i.$F("");_g.$O.get_$Q().get_$1j().set_$4DQ(i);_h.$21.$Kq(_g.$O.get_$Q().get_$1j().$Hm,OwaApplication.$2B)}}},$3km:function(n,t){var o=_g.$O.get_$Q().get_$4P().get_$2fP();var c=$C(o)?0:o.get_$A();var f=_g.$O.get_$Q().get_$1j().get_$4DQ();var r=$C(f)?0:f.get_$A();if(r===1&&f.get_$E(0)===""){f.$5W(0);r=0}var l=r>0?1:0;var u=new Array(1+c+r+l);var e=0;var i=_g.$O.get_$Q().get_$4P().get_$Fv();u[e++]=t(i,new _C(this.$4Y4(i),this.get_$m()));for(var s=0;s<c;s++){i=o.get_$E(s).EmailAddress;u[e++]=t(i,new _C(this.$4Y4(i),this.get_$m()))}if(r>0){u[e++]=new _fm.$6V;for(var h=0;h<r;h++){i=f.get_$E(h);u[e++]=t(i,new _C(this.$4Y4(i),this.get_$m()))}}return u},$4Y4:function(n){var t=this;return function(){_js.Trace.logInfo(_a.$0.$16,"User chose from="+n);t.$1n.$v.get_$af().$4GQ(n,!0)}}};_mcp.$G6=function(n,t,i,r){this.$$d_$ByC=Function.createDelegate(this,this.$ByC);this.$$d_$9SJ=Function.createDelegate(this,this.$9SJ);this.$$d_$9SQ=Function.createDelegate(this,this.$9SQ);this.$$d_$E9Q=Function.createDelegate(this,this.$E9Q);this.$$d_$E9L=Function.createDelegate(this,this.$E9L);this.$$d_$DhO=Function.createDelegate(this,this.$DhO);this.$$d_$8Ig=Function.createDelegate(this,this.$8Ig);this.$$d_$8Ih=Function.createDelegate(this,this.$8Ih);this.$$d_$EZc=Function.createDelegate(this,this.$EZc);this.$$d_$EZd=Function.createDelegate(this,this.$EZd);this.$$d_$7a2=Function.createDelegate(this,this.$7a2);this.$$d_$3XI=Function.createDelegate(this,this.$3XI);this.$$d_$E9m=Function.createDelegate(this,this.$E9m);this.$$d_$E9v=Function.createDelegate(this,this.$E9v);_mcp.$G6.initializeBase(this,[7,n]);this.$LB=new _C(this.$$d_$E9v,this.get_$m());this.$1a3=new _C(this.$$d_$E9m,this.get_$m());this.$Lx=n.$v.$Lx;this.$1D=t;this.$3Y=i;this.$N=r};_mcp.$G6.prototype={$Lx:null,$1a3:null,$1D:null,$3Y:null,$N:null,$744:null,$73q:null,$LB:null,$bq:!1,$3ye:!1,$1le:null,$2XE:null,$3XF:null,$5gq:!1,$6mB:!1,$1Nu:null,get_$7G5:function(){return this.$1Nu?this.$1Nu.get_$7G5():null},get_$2XC:function(){return this.$LB},set_$2XC:function(n){this.$LB=n;return n},get_$m1:function(){return this.$bq},set_$m1:function(n){if(n!==this.$bq){this.$bq=n;this.$4("IsSending");var t=this.$1n.$v;t.set_$9qv(_u.CommonStrings.l_Sending_Text);t.set_$9kT(n)}return n},get_$DOd:function(){return this.get_$6TY()&&this.$6mB},get_$6TY:function(){return this.$3Y.$2r("ComposeBread1")&&this.$v.$I.get_$U()==="Mouse"&&!this.$v.get_$3yL()&&!this.$c_2.get_$s0()&&!!this.$v.$1tw&&!!this.$v.$sv},get_$73j:function(){return this.$3XF},$2xE:function(){if(this.$v.get_$4LS()&&!this.$1Nu){_js.Trace.logInfo(_a.$0.$16,"Setting send component override");this.$1Nu=this.$v.get_$4IH().$AR3();var t=this.$1n.$5m(29);var n=this.$1n.$5m(1);this.$1Nu.$3e(this.$v.get_$D1(),this.$$d_$3XI,this.$$d_$7a2,this.$$d_$EZd,this.$$d_$EZc,this.$$d_$8Ih,this.$$d_$8Ig,this.$v.$n,this.$1n.$v.$9M,n.$$d_$Bux,n.$$d_$Buv,n.$$d_$Buu,n.$$d_$BjN,t.$$d_$AAv,t.$$d_$A3N,t.$$d_$7So)}},$2F5:function(){if(this.$1Nu){this.$1Nu.$AV();this.$1Nu=null}},$3e:function(){this.$2xE();var n=this.$1n.$5m(1);if(n){n.remove_$9Bv(this.$$d_$DhO);n.remove_$9Bu(this.$$d_$7a2);n.add_$9Bv(this.$$d_$DhO);n.add_$9Bu(this.$$d_$7a2)}_mcp.$14n.prototype.$3e.call(this)},$AV:function(){this.set_$m1(!1);this.$2F5();_mcp.$14n.prototype.$AV.call(this)},$3XI:function(){var u=this.$1n;var i=u.$v;var n=i.$c;var r=u.$5m(8);u.$5m(25).$EYT();if(r.$GQ){r.$2Yx=!0;_js.Trace.logInfo(_a.$0.$16,"Send deferred due to in progress save.")}if(n.get_$OV()||n.get_$Fd()||n.get_$1ZN()){if(!r.$2Yx){var o=this.$1n.$5m(1);o.$2zW();_js.Trace.logInfo(_a.$0.$16,"Send without pending saves, context:"+n.toString()+"; OriParentFolderId="+(n.get_$IV()&&n.get_$IV().get_$3G()&&_g.$c.$2I?_g.$c.$2I.idToName(n.get_$IV().get_$3G()):"null"));var t=i.$Xj.$5u6(i,1,this.$1D);_js.Trace.logInfo(_a.$0.$16,"Submitting send action");var f=_g.$1H.$1Q;_bc.$Og.isInstanceOfType(f)&&(_h.$49.isInstanceOfType(t)?t.add_$28l(this.$$d_$E9L):_h.$2k.isInstanceOfType(t)&&t.add_$28l(this.$$d_$E9L));i.$n.$tE(t,this.$8Ih(),this.$8Ig(),this.$$d_$E9Q);_js.Trace.logInfo(_a.$0.$16,"Send action submitted")}}else{var e=n.get_$D1();_js.Trace.logInfo(_a.$0.$16,"Send was attempted during upgrade for context "+e+", keeping the IsSending state and waiting for upgrade to finish. Upgrade component will resume send.")}},$7a2:function(){var i=this.$1n.$v.$1d;var t=this.$1n.$v.get_$af();var n=null;this.set_$m1(!1);if(t.$GI.get_$1L9()||t.$GM.get_$1L9()||t.$Ge.get_$1L9()){i.$4s(65,null);n=_js.$1I.$Gy(_bc.InfoBarMessageId,65);this.$N.$1p(_a.$CH,new _a.$CH(_u.Strings.l_MailComposeInvalidRecipientsError_Text))}if(t.get_$4vl()){i.$4s(66,null);n=_js.$1I.$Gy(_bc.InfoBarMessageId,66)}_mcp.$3t.$Jx(this.$1n);this.$7pQ();n=n||"CancelSend_UnknownError";this.$lF(n,null,null)},$7pQ:function(){var n=this;_js.$D.get_$Q().$2V(_a.$0.$16,"ExitResolvingRecipientsMode",function(){n.$3ye=!1},2e3)},$7Tx:function(n){if(n&&n.Mailbox){var r=n.Mailbox.EmailAddress;if(r!==_g.$O.get_$Q().get_$4P().get_$Fv()&&!_h.$2k.$4nD(n)){var i=_g.$O.get_$Q().get_$1j().get_$4DQ();if(!$C(i)){if(i.$5l(r))return;i.get_$A()===1&&i.get_$E(0)===""&&i.$5W(0)}var t=new(_a.$u.$$(String));t.$F(r);t.$1yS(i);t.get_$A()>_mcp.$G6.$6Yh&&t.$5W(t.get_$A()-1);_g.$O.get_$Q().get_$1j().set_$4DQ(t);_h.$21.$Kq(_g.$O.get_$Q().get_$1j().$Hm,OwaApplication.$2B);var u=this.$1n.$5m(20);u.$4PT(r,_mcp.$G6.$6Yh)}}},$6GO:function(n){var t;var i=_a.$4.$4or(n.$2H);if(i==="ErrorSendAsDenied")t=80;else{var u,r;i==="ErrorRightsManagementPermanentException"&&(r=this.$Er7(n.$2H,u={val:t}),t=u.val,r)||(t=i==="ErrorSubmissionQuotaExceeded"?47:_y.$5y.$4TX(n.$2H,45,55,62,700,88,89,46,58))}return t},$8Ih:function(){return this.$744||this.$$d_$9SQ},$8Ig:function(){return this.$73q||this.$$d_$9SJ},$EZd:function(n){this.$744=n},$EZc:function(n){this.$73q=n},$Er7:function(n,t){var u=n.MessageXml;if(u)for(var f=Sys.Net.XMLDOM(u),r=0;r<f.firstChild.childNodes.length;r++){var i=f.firstChild.childNodes[r];if(i.nodeType===1&&_a.$3D.$rd(i)==="Value"&&_a.$3D.$8DI(i,"Name")==="HResult"&&-2147168383===Number.parseInvariant(_a.$3D.$YG(i))){t.val=48;return!0}}t.val=-1;return!1},$E9v:function(){if(this.$1Nu&&!this.$1Nu.$8WX()){_js.Trace.logInfo(_a.$0.$16,"saveComponentOverride.IsReadyForSmimeOperation() == false. Exiting SendStart().");return}_a.$6.stPT(_a.$0.$16,"MailComposeSend",5);this.$5gq=!0;this.$2XE=_y.$2F.$1g(_a.$0.$16,"MailComposeSend",!0);this.get_$6TY()&&(this.$3XF=_y.$2F.$1g(_a.$0.$16,"MailComposeSendClose",!0));_js.Trace.logInfo(_a.$0.$16,"SendStart:Context:"+this.$c_2.toString());this.$3VU();this.$c_2.get_$T0()?this.$Dt6():this.$9Ov()},$Dt6:function(){var n=this;var t=function(t){n.$lF(_js.$1I.$Gy(_bc.InfoBarMessageId,t),null,null);n.$c_2.set_$4IJ(null);n.$7a2();t!==-1&&n.$7Sn(_u.Strings.l_Smime_CannotSend_Text,t)};if(this.$c_2.get_$4IJ())this.$9xp(t);else{var i=this;this.$v.get_$Ej1().$AFX(13,function(n){if(i.$c_2.set_$4IJ(n))i.$9xp(t);else{t(-1);_js.Trace.logWarning(_a.$0.$53,"The send is canceled due to unavailable cert.")}})}},$9xp:function(n){var t=new _h.$ld(200,this.$c_2.get_$4IJ(),!0);var i=this,r=this;this.$1n.$v.$n.$tE(t,function(){_js.Trace.logInfo(_a.$0.$53,"Retrieving certs info completed.");if(t.get_$4d().IsValid)i.$9Ov();else{_js.Trace.logWarning(_a.$0.$53,"Retrieving certs info determined the certificate is INVALID.");switch(t.get_$4d().ChainValidityStatus){case 2148204809:case 2148204813:case 2148204810:case 1:n(746);break;case 2148081680:case 2148204812:n(745);break;case 2148081682:case 2148204814:case 2148081683:case 2148098052:n(743);break;default:n(744);break}}},function(){_js.Trace.logWarning(_a.$0.$53,"Retrieving certs info failed. "+t.$2H.message);n(743)},null)},$9Ov:function(){_js.Trace.logInfo(_a.$0.$16,"User chose to send, start force resolve recipients");this.$3ye=!0;var n=this.$1n.$5m(1);n.$3W3(!0)},$DhO:function(){if(this.$bq){_js.Trace.logInfo(_a.$0.$16,"Skip send since another send is in progress");return}this.set_$m1(!0);this.$3ye=!0;_js.$D.get_$Q().$1Ym(_a.$0.$16,"MailComposeSend");_js.Trace.logInfo(_a.$0.$16,"Started new task runner context before starting send.");var r=!0;try{var n;var i,t;(t=this.$CGH(i={val:n}),n=i.val,t)?n?_js.Trace.logInfo(_a.$0.$16,"waiting for a pending validation decision, once decided, send will resume"):this.$7Gs():this.set_$m1(!1);r=!1}finally{if(r){this.set_$m1(!1);_js.Trace.logWarning(_a.$0.$16,"Send failed due to an unhandled exception thrown before the action was submitted");this.$lF("SendFailure_UnhandledException",null,null)}}},$7Gs:function(){this.$c_2.set_$3Fz(!1);if(this.$1Nu)this.$1Nu.$AAh();else{this.$3XI();var n=!1;if(this.get_$6TY()&&!this.$c_2.get_$3yg()){if(this.$v.$sv.get_$bt()){var i=this;this.$v.$sv.$9(function(t){t.get_$3od()>0&&(n=!0)})}if(!n&&this.$v.$1tw.get_$bt()){var r=this;this.$v.$1tw.$9(function(t){t.get_$E9d()>0&&(n=!0)})}if(!n){_js.Trace.logInfo(_a.$0.$16,"Navigating away after submitting action for send via notification");this.$c_2.set_$3Fz(!0);this.$6mB=!0;this.$947();var t=this;this.$v.$1tw.$9(function(){t.$N.$1p(ISendEvent,new _mcp.$1PW(t.$v))})}}}},$CGH:function(n){n.val=!1;var f=this.$1n;var r=f.$v;var t=f.$5m(1);var o=f.$5m(5);var u=r.$1d;var h=f.$5m(25);if(this.$Lx.$1EM(r.$c.get_$D1())){_js.Trace.logInfo(_a.$0.$16,"User had already discarded, skipping send.");this.$lF("InvalidToSend",null,"User has already discarded, skipping send");return!1}else if(t.get_$4vl()){_js.Trace.logInfo(_a.$0.$16,"Not valid to send since sender's address is invalid");u.$4s(66,null);_mcp.$3t.$Jx(this.$1n);this.$lF("InvalidToSend",null,"Sender's address is invalid, not valid to send");return!1}else if(!r.$c.get_$1El()&&t.$GI.get_$Iu()&&t.$GM.get_$Iu()&&t.$Ge.get_$Iu()){_js.Trace.logInfo(_a.$0.$16,"Not valid to send since no recipients were specified");u.$4s(70,null);_mcp.$3t.$Jx(this.$1n);this.$lF("InvalidToSend",null,"No recipients were specified, not valid to send");return!1}else if(t.$GI.get_$1L9()||t.$GM.get_$1L9()||t.$Ge.get_$1L9()){_js.Trace.logInfo(_a.$0.$16,"Not valid to send since invalid recipients are present, IsFromRecipientInvalid={0}, InvalidTo={1}, InvalidCc={2}, InvalidBcc={3}",t.get_$4vl(),t.$GI.get_$1L9(),t.$GM.get_$1L9(),t.$Ge.get_$1L9());t.$51N();u.$4s(65,null);_mcp.$3t.$Jx(this.$1n);this.$lF("InvalidToSend",null,"Invalid recipients are present, not valid to send");return!1}else if(o.get_$Q6()){_js.Trace.logInfo(_a.$0.$16,"Not valid to send since attachment is in progress");var c=r.$2F;c.$44(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null,!1,null,null,null,c.$6R);this.$lF("InvalidToSend",null,"Attachment is in progress, not valid to send");return!1}else if(_g.$O.get_$Q().get_$6Yg()<t.$229()){u.$4s(800,null);_mcp.$3t.$Jx(this.$1n);this.$lF("InvalidToSend",null,"Max recipients exceeded, not valid to send");return!1}else if(_a.$5N.$43&&h.$CF9()){_js.Trace.logInfo(_a.$0.$16,"Not valid to send since policy violation detected");var l=r.$2F;l.$44(0,h.$Btg(),null,!1,null,null,null,l.$6R);this.$lF("InvalidToSend",null,"PolicyTip violation detected, not valid to send");return!1}else if(_js.$9.$o(this.$v.$c.get_$3o())){n.val=!0;var s=r.$2F;s.$RN(2,[_nbs.NonBootStrings.l_MailComposeForgottenSubjectMessage_Text],this.$$d_$ByC,!1,_nbs.NonBootStrings.l_MailComposeForgottenSubjectSendAnyway_Text,_nbs.NonBootStrings.l_MailComposeForgottenSubjectDontSend_Text,_nbs.NonBootStrings.l_MailComposeForgottenSubjectTitle_Text,s.$6R);return!1}else if(o&&o.get_$9Z()&&this.$v.$1D3)if(this.$1le)return this.$7bA();else{n.val=!0;var i=this;this.$v.$1D3.$9(function(n){i.$1le=n.$7gc(i.$v.$2F,i.$LB);i.$7bA()?i.$7Gs():i.set_$m1(!1)})}else if(this.$c_2.get_$s0())if(this.$c_2.get_$ow()){_a.$3m.$44(_u.Strings.l_Smime_NotSupportedWithFromRecipientWell_Text,0);this.$lF("InvalidToSend",null,"User attempted to send an S/MIME message using the SendAs (From) feature");return!1}else if(t.get_$C0x()){_a.$3m.$44(_u.Strings.l_Smime_NotSupportedWithModernGroups_Text,0);this.$lF("InvalidToSend",null,"User attempted to send an S/MIME message to modern groups.");return!1}else if(this.$c_2.get_$EW()){var e=new(_ff.$18.$$(String));var a=this;this.$c_2.get_$EW().$Cj(function(n){_g.$54.isInstanceOfType(n)||_g.$7d.isInstanceOfType(n)||_g.$7S.isInstanceOfType(n)||e.$F(n.get_$1x())});if(e.get_$A()>0){_a.$3m.$44(String.format(_u.Strings.l_Smime_NotSupportedWithCloudAttachments_Text,e.get_$1y().join(", ")),0);this.$lF("InvalidToSend",null,"User attempted to send an S/MIME message with cloud attachments.");return!1}}return!0},$7bA:function(){var n=this.$v.get_$eM();try{if(this.$1le.$4qJ(this.$v.$c,n.get_$9Z().get_$1m())){this.$lF("InvalidToSend",null,"Forgotten attachment detected, not valid to send");return!1}}catch(t){_js.Trace.logException(_a.$0.$16,t,"An exception has been caught for FAD check; keep sending",this.$1le,this.$v.$c,n.get_$9Z().get_$1m())}return!0},$9SQ:function(n){var o=this.$1n;var i=o.$v;var t=i.$c;var f=n.$99;_js.Trace.logInfo(_a.$0.$16,"Send action succeeded, ContextId="+f+"; Context:"+t.toString());this.$7Ba();var e=!1;var h=_g.$1H.$1Q;_bc.$Og.isInstanceOfType(h)&&(e=!0);t.get_$3Jg()&&!e&&this.$7Tx(t.get_$5Q());if(t.$32m&&t.$32m.length>0){var s=this.$1n.$v.$1d;s.$4s(742,t.$32m);_js.Trace.logInfo(_a.$0.$16,"Showing infobar message for Bcc forking failed");this.set_$m1(!1);i.$n.$6wa(n);this.$lF(_js.$1I.$Gy(_bc.InfoBarMessageId,742),null,null)}else{if(f===t.get_$D1()){t.set_$T9(null);if(this.$c_2.get_$3Fz()){_js.Trace.logInfo(_a.$0.$16,"skip navigating away from compose for send via notification since the navigation was already done at send time, raise send succeeded event instead");var c=this;this.$v.$1tw.$9(function(){c.$N.$1p(ISendSucceededEvent,new _mcp.$1Pc(i))})}else{_js.Trace.logInfo(_a.$0.$16,"Context match, navigating away from compose at the end of send success. ContextId="+f);this.$947()}}else _js.Trace.logInfo(_a.$0.$16,"Context does not match, skipping navigating away from compose.");this.$6T("MailSendSucceeded");var u=!i.get_$eM()||!i.get_$eM().get_$9Z()?null:i.get_$eM().get_$9Z().$Bjy();var r=this.$Bl7(t);r?u&&(r=r+"|"+u):r=u;this.$Amb(r)}this.$N.$1p(_a.$CH,new _a.$CH(_nbs.NonBootStrings.l_MailComposeSendComponent_AT_LiveRegion_Text))},$947:function(){var t=this.$1n;var n=t.$v;var i=t.$5m(2);n.set_$1Ei(!0);i.get_$5F().$2Si(n,!0)},$9SJ:function(n){var r=this.$1n.$v;var t=r.$c;var f=n.$99;_js.Trace.logInfo(_a.$0.$16,"Send action failed, ContextId="+f+"; Context:"+t.toString());var i="SendFailure_UnknownError";var u="";if(_g.$4k.$1dc(n.$2H)){i=_g.$4k.$2LC(n.$2H);u=n.$2H.FaultMessage}if(f===t.get_$D1()){if(t.get_$1xK()&&t.get_$1xK().length>0){var o=this.$1n.$v.$1d;o.$4s(65,t.get_$1xK())}this.set_$m1(!1);_js.Trace.logInfo(_a.$0.$16,"Context match. Showing infobar message for ResponseCode="+i);this.$5jZ(n);if(this.$c_2.get_$3Fz()){_js.Trace.logInfo(_a.$0.$16,"Raise send failed event for send via notification");t.set_$9SK(this.$6GO(n));var e=this;this.$v.$sv.$9(function(){e.$N.$1p(ISendFailedEvent,new _mcp.$1PX(r))})}}else _js.Trace.logInfo(_a.$0.$16,"Context does not match. Skip showing infobar message for ResponseCode="+i);this.$lF(i,this.$FJ(n),u);r.$n.$6wa(n)},$E9Q:function(n){this.$4cr();this.$8Nu()&&this.$N.$1p(_y.$tz,new _y.$tz(6))},$8Nu:function(){return this.$3Y.$2r(_mcp.$G6.$8bp)||_a.$2D.$4pN(window.location.href,"survey")==="1"?!0:!1},$FJ:function(n){var t=null;_h.$4A.isInstanceOfType(n)&&n.$68?t=n.$68.correlationId:_h.$49.isInstanceOfType(n)&&n.$68&&(t=n.$68.correlationId);return t},$E9m:function(){this.$1n.$v.get_$5za()&&this.$LB.$3s&&this.$LB.$11()},$7Ba:function(){var t=this.$v.get_$af();var n=this.$v.get_$eM();_js.Trace.logInfo(_a.$0.$16,"Check to see if we have attachments to set permissions for");n.get_$9Z()&&n.get_$9Z().get_$4qU()&&n.get_$9Z().$9gD(t.$BjM())},$Bl7:function(n){if(!n)return null;var r=n.get_$6P()==="HTML"?"html":"text";var i;i=n.get_$6X()===1||n.get_$6X()===2||n.get_$6X()===3?n.get_$OV()?"yes":"no":"na";var u=n.$52g;var t=new _a.$3z;t.$CX("BT",r);t.$CX("U",i);t.$5H("S",u);t.$5H("O",n.get_$6X());return t.toString()},$lF:function(n,t,i){if(this.$2XE){_y.$2F.$1G(this.$2XE,null,n,t,i);this.$2XE=null}if(this.$3XF){_y.$2F.$1G(this.$3XF,null,n,t,i);this.$3XF=null}this.$4cr()},$Amb:function(n){if(this.$2XE){_y.$2F.$1G(this.$2XE,null,null,null,n);this.$2XE=null}},$4cr:function(){if(this.$5gq){_a.$6.endPT("MailComposeSend");this.$5gq=!1}},$ByC:function(n,t){n&&this.$7Gs()},$E9L:function(n){var i=this.$1n;var r=i.$v;var t=r.$c;_h.$2k.isInstanceOfType(n)&&n.remove_$28l(this.$$d_$E9L);_h.$49.isInstanceOfType(n)&&n.remove_$28l(this.$$d_$E9L);t.get_$3Jg()&&this.$7Tx(t.get_$5Q())}};_mcp.$1LA=function(n){this.$$d_$A3N=Function.createDelegate(this,this.$A3N);this.$$d_$AAv=Function.createDelegate(this,this.$AAv);this.$$d_$7So=Function.createDelegate(this,this.$7So);_mcp.$1LA.initializeBase(this,[29,n])};_mcp.$1LA.prototype={$A3N:function(n,t){this.$7Sn(n,t)},$7So:function(n){this.$3gR(n)},$AFX:function(n,t){var e=this;var f=function(i){_js.Trace.logWarning(_a.$0.$53,i.message);if(_a.$2f.$1UK(i)){_a.$2f.$1Ha(i,n);e.$3gR(i);t(null)}else{_js.Trace.logException(_a.$0.$53,i,"An error occurred when choosing cert.");throw i;}};try{var i=_a.$b.$4AK(!0,!0,!1,!1,!1);if(i)if(_a.$2f.$3zQ(i))this.$3gR(i);else throw i;_js.Trace.logInfo(_a.$0.$53,"S/MIME choosing a cert...");var r;var u=_g.$O.get_$Q();r=u.get_$VV().AllowUserChoiceOfSigningCertificate&&u.get_$1j().get_$2oJ()?u.get_$1j().get_$2ZJ():null;_js.Trace.logInfo(_a.$0.$53,"Choosing a cert. KeyIdentifier={0}",r);var s=this;_a.$b.$14e.$6IM(r,function(n){var i=JsonParser.deserialize(n);i.ErrorCode?f(_a.$2f.$9("No certificate was found.",i.ErrorCode)):t(i.Data)})}catch(o){f(o)}},$AAv:function(n,t,i,r){var c=_g.$O.get_$Q().get_$VV();var l=_g.$O.get_$Q().get_$1j();var e=this.$BrT(t,this.$c_2.get_$T0(),this.$c_2.get_$PT());e=e||"SMIMEComposeUndefinedCtq";var d=_a.$6.$1g(_a.$0.$53,e,!0);var nt=this.$c_2.get_$6X();var it=this.$c_2.get_$5j();var y=c.AlwaysSign;var p=c.AlwaysEncrypt;var w=l.get_$2ZQ();var v=l.get_$2ZO();var h=c.ClearSign;var s=c.TripleWrapSignedEncryptedMail;var ht=this;var st=function(n){_a.$6.$1G(d,e,"",null,ht.$7YK(nt,it,y,p,w,v,h,s));$C(i)||i(n)};var ot=this;var tt=function(n){_a.$6.$1G(d,e,n.message,null,ot.$7YK(nt,it,y,p,w,v,h,s));$C(r)||r(n)};try{_js.Trace.logInfo(_a.$0.$53,"Building S/MIME data package...");_js.Trace.logInfo(_a.$0.$53,"Admin.AlwaysEncrypt="+p);_js.Trace.logInfo(_a.$0.$53,"Admin.AlwaysSign="+y);_js.Trace.logInfo(_a.$0.$53,"Admin.IsClearSign="+h);_js.Trace.logInfo(_a.$0.$53,"Admin.TripleWrap="+s);_js.Trace.logInfo(_a.$0.$53,"User.AlwaysEncrypt="+v);_js.Trace.logInfo(_a.$0.$53,"User.AlwaysSign="+w);_js.Trace.logInfo(_a.$0.$53,"User.SigningCert="+l.get_$2y0());_js.Trace.logInfo(_a.$0.$53,"User.SigningCertId="+l.get_$2ZJ());_js.Trace.logInfo(_a.$0.$53,"Context.Encrypt="+this.$c_2.get_$PT());_js.Trace.logInfo(_a.$0.$53,"Context.Sign="+this.$c_2.get_$T0());var f;if(t===2&&this.$c_2.get_$PT()){var u=this.$v.get_$af();var k=u.$NH?u.$GI.$5X.$Gc:u.$GI.$RC.get_$xW();var b=u.$NH?u.$GM.$5X.$Gc:u.$GM.$RC.get_$xW();var g=u.$NH?u.$Ge.$5X.$Gc:u.$Ge.$RC.get_$xW();var at=k?k.get_$A():0;var lt=b?b.get_$A():0;var ct=g?g.get_$A():0;var a=at+lt;f=this.$c_2.$1i1?this.$c_2.$1i1===1?this.$c_2.$4p8(0,a):this.$c_2.$1i1===2?this.$c_2.$4p8(a+this.$c_2.$3kv,1):this.$c_2.$1i1===3?this.$c_2.$4p8(a,ct):null:this.$c_2.get_$9mm()}else f=null;var rt=this.$1kK();var et=JsonParser.serialize(rt.get_$Ad());var ft=f?JsonParser.serialize(f):null;var o;if(!this.$c_2.get_$T0()&&this.$c_2.get_$PT())o=6;else if(this.$c_2.get_$T0()&&!this.$c_2.get_$PT())o=h?11:10;else if(this.$c_2.get_$T0()&&this.$c_2.get_$PT())o=s?14:12;else throw Error.invalidOperation("The context is not in S/MIME mode.");var ut=this;_a.$b.$14e.$ARH(o,et,ft,this.$c_2.get_$4IJ(),function(t){ut.$AmN(t,n,st,tt)})}catch(vt){this.$7pu(vt,tt)}},$1kK:function(){var n=new _g.$5w;n.set_$4n(this.$c_2.$7fg());n.get_$4n().get_$6P()==="HTML"&&n.get_$4n().set_$1Z(_a.$37.$6z4(n.get_$4n().get_$1Z(),!0));this.$DuQ(n,this.$v.get_$eM().get_$9Z().get_$1m());n.set_$5Q(new _g.$8w);n.get_$5Q().Mailbox=this.$c_2.$3sl();if(!n.get_$5Q().Mailbox){var t=_g.$O.get_$Q().get_$4P();n.get_$5Q().Mailbox=new _g.$1K;n.get_$5Q().Mailbox.Name=t.get_$Lk();n.get_$5Q().Mailbox.EmailAddress=t.get_$Fv()||t.get_$sA();n.get_$5Q().Mailbox.MailboxType="Mailbox";n.get_$5Q().Mailbox.RoutingType="SMTP"}n.set_$79(new(_a.$u.$$(_g.$1K)));this.$c_2.get_$79()&&n.get_$79().$3y(this.$c_2.get_$79().$3Q());n.set_$7x(new(_a.$u.$$(_g.$1K)));this.$c_2.get_$7x()&&n.get_$7x().$3y(this.$c_2.get_$7x().$3Q());n.set_$3o(this.$c_2.get_$3o());n.set_$Bv(this.$c_2.get_$Bv());n.set_$ET(this.$c_2.get_$ET());n.set_$173(_a.$8.get_$38());n.set_$Q8(this.$c_2.get_$Q8());n.set_$Qu(this.$c_2.get_$Qu());if(n.set_$a9(this.$c_2.get_$a9())){n.set_$1xv(this.$c_2.get_$1xv());n.set_$l4(this.$c_2.get_$l4());n.set_$h0(this.$c_2.get_$h0());n.set_$eW(this.$c_2.get_$eW())}return n},$DuQ:function(n,t){if(t&&t.get_$A()){var i=new(_a.$2T.$$(_g.Attachment,_g.$Bg));var f=new(_ff.$18.$$(_y.$OU));var s=this;t.$Cj(function(t){var o=t;var r=o.get_$9P();if(r.get_$2mu()){_js.Trace.logInfo(_a.$0.$53,"Skipping SmimeDataPackage.");return}if(!(_g.$54.isInstanceOfType(r)||_g.$7d.isInstanceOfType(r)||_g.$7S.isInstanceOfType(r))){_js.Trace.logWarning(_a.$0.$53,"S/MIME only supports FileAttachment, ItemAttachment, and ItemIdAttachment. The attachment {0} is ignored.",r.get_$1x());return}if(n.get_$4n().get_$6P()==="HTML"&&r.get_$CA()&&n.get_$4n().get_$1Z().indexOf(r.get_$SF())<0){_js.Trace.logInfo(_a.$0.$53,"Removing unreferenced inline attachment: {0}",r.get_$SF());f.$F(o);return}if(_g.$7S.isInstanceOfType(r)){var e=r;var u=new _g.$7d;u.set_$1x(e.get_$1x());u.set_$KN(e.get_$KN()||"message/rfc822");u.set_$8D(e.get_$8D());u.set_$c5(e.get_$c5());i.$F(u)}else i.$F(r)});for(var u=f.get_$1y(),e=u.length,r=0;r<e;++r){var o=u[r];this.$v.get_$eM().get_$9Z().$1X4(o,!1)}n.set_$1m(i.get_$A()>0?i:null)}},$AmN:function(n,t,i,r){var u=JsonParser.deserialize(n);if(u.ErrorCode){var f=_a.$2f.$1Ha(_a.$2f.$9("Cannot encode the message.",u.ErrorCode),15);this.$7pu(f,r)}else{_js.Trace.logInfo(_a.$0.$53,"S/MIME data package built successfully.");this.$c_2.set_$9ml(u.Data);i(t)}},$7pu:function(n,t){_js.Trace.logWarning(_a.$0.$53,n.message);if(_a.$2f.$1UK(n))this.$3gR(n);else{_js.Trace.logException(_a.$0.$53,n,"Unknown error occurred when building data package.");n=_a.$2f.$1Ha(_a.$2f.$9(n.message,11),15);this.$3gR(n)}t(n)},$7YK:function(n,t,i,r,u,f,e,o){var s=new _a.$3z;s.$CX("O",_y.$1m.toString(n));s.$CX("M",_y.$Ox.toString(t));s.$Ik("AS",i);s.$Ik("AE",r);s.$Ik("UAS",u);s.$Ik("UAE",f);s.$Ik("CS",e);s.$Ik("TW",o);return s.toString()},$BrT:function(n,t,i){var r=null;t&&!i?n===2?r="SMIMESendSign":n===3&&(r="SMIMESaveSign"):!t&&i?n===2?r="SMIMESendEncrypt":n===3&&(r="SMIMESaveEncrypt"):t&&i&&(n===2?r="SMIMESendSignAndEncrypt":n===3&&(r="SMIMESaveSignAndEncrypt"));return r}};_mcp.$1L9=function(n,t){_mcp.$1L9.initializeBase(this,[23,n]);this.$l=t};_mcp.$1L9.prototype={$l:null,$3e:function(){if(!this.get_$G8()&&this.$l.get_$5e().get_$Fb().get_$5aC()===2&&this.$l.get_$15U().get_$Eb7().get_$C1G()){var n=this.$1n.$5m(5);_mcp.$Ma.$3Il(this.$1n.$v)&&!$C(n)&&($C(n.get_$9Z())||n.get_$9Z().$A4c())}_mcp.$14n.prototype.$3e.call(this)}};_mcp.$G7=function(n,t){this.$$d_$7U2=Function.createDelegate(this,this.$7U2);_mcp.$G7.initializeBase(this,[12,n]);this.$4Pj=new _C(this.$$d_$7U2,this.get_$m());this.$1D=t;this.$1E=_a.UserAgent.getInstance();this.$6K=_a.$6j.$9()};_mcp.$G7.$6IL=function(n,t){return t?n.get_$1Hm():n.get_$1Yb()};_mcp.$G7.prototype={$4Pj:null,$1D:null,$4I0:null,$7DH:!1,$1E:null,$6K:null,set_$7Fl:function(n){if(this.$4I0!==n){this.$4I0=n;this.$4("Signature")}return n},set_$Xa:function(n){this.$7DH=n;this.$4("ShouldAutoAddSignature");return n},$3e:function(){if(this.$1n.$v.$c.get_$Xa()&&this.$ACK()){_a.$6.stPT(_a.$0.$16,"MailComposeAutoSig",5);var n=_a.$6.$1g(_a.$0.$16,"MailComposeAutoSig",!0);this.set_$Xa(!0);this.$7U2(!0);_a.$6.$1G(n);_a.$6.endPT("MailComposeAutoSig");_js.Trace.logInfo(_a.$0.$16,"Signature has been automatically added due to: contextAutoFlag=true, userOptionAutoFlag=true")}_mcp.$14n.prototype.$3e.call(this)},$BkC:function(){var n=this.$1E.get_$Df()?"<P></P>":"<P><BR></P>";return n+n},$ACK:function(){var n=_g.$O.get_$Q().get_$1j();return"Mouse"===_y.$z.$1Q.get_$U()?n.get_$qc():this.$1E.get_$8b()?this.$6K.$64("MOWA.IsSignatureChanged")==="true"?this.$6K.$64("MOWA.AutoAddSignature")==="true":!0:n.get_$1Pp()},$7ZL:function(n,t){if("Mouse"===_y.$z.$1Q.get_$U())return _mcp.$G7.$6IL(n,t);if(this.$1E.get_$8b()){if(this.$6K.$64("MOWA.IsSignatureChanged")==="true")if(this.$6K.$64("MOWA.UseDesktopSignature")==="true")return _mcp.$G7.$6IL(n,t);else{var r=this.$6K.$64("MOWA.SignatureText")||"";return t?_a.$1J.$1yR(r):r}return t?_a.$1J.$1yR(_c.$MI.$4oH(this.$1E)):_c.$MI.$4oH(this.$1E)}if(n.get_$1IW())return _mcp.$G7.$6IL(n,t);else{var i=n.get_$1Yc()||"";return t?_a.$1J.$1yR(i):i}},$7U2:function(n){var o=null;var a=this.$1n.$5m(27);var c=this.$1n.$v.$c;var h=_g.$O.get_$Q().get_$1j();if(n)c.set_$6Py(!0);else{_a.$6.stPT(_a.$0.$16,"MailComposeInsertSig",3);o=_a.$6.$1g(_a.$0.$16,"MailComposeInsertSig",!0)}var t=c.get_$6P()==="HTML"&&this.$1D.get_$NE();if(t){var r=this.$7ZL(h,t);if(_js.$9.$o(r))_js.Trace.logInfo(_a.$0.$16,"Skipping inserting blank signature in HTML format.");else{var l='<DIV id = "Signature">';var v="</DIV>";var y=n?this.$BkC():_mcp.$G7.$9mU;var e=y+l+r.replace(_mcp.$G7.$9L7," ")+v;_js.Trace.logInfo(_a.$0.$16,"Insert signature for mouse html OriSig="+r+"; FormattedSig="+e);this.set_$7Fl(e)}}else{var u=this.$7ZL(h,t);if(_js.$9.$o(u))_js.Trace.logInfo(_a.$0.$16,"Skipping inserting blank signature in text format.");else{var f="\n\n"+u;_js.Trace.logInfo(_a.$0.$16,"Insert signature for touch text OriSig="+u+"; FormattedSig="+f);this.set_$7Fl(f)}}var s=!_js.$9.$o(this.$4I0);if(s){var i=new _cmc.$MV(0,this.$4I0,t);i.$28c=!0;i.$2zX=!1;a.set_$Nf(i)}else _js.Trace.logInfo(_a.$0.$16,"Skip insert signature due to HasSignature="+s+";");if(!n){_a.$6.$1G(o);_a.$6.endPT("MailComposeInsertSig")}}};_mcp.$ui=function(n,t,i){this.$$d_$3tc=Function.createDelegate(this,this.$3tc);this.$$d_$2WW=Function.createDelegate(this,this.$2WW);this.$$d_$6LP=Function.createDelegate(this,this.$6LP);this.$$d_$5xd=Function.createDelegate(this,this.$5xd);this.$$d_$4CZ=Function.createDelegate(this,this.$4CZ);this.$$d_$9ko=Function.createDelegate(this,this.$9ko);this.$$d_$Ea8=Function.createDelegate(this,this.$Ea8);_mcp.$ui.initializeBase(this,[11,n]);this.$5a=new _C(this.$$d_$9ko,this.get_$m());this.$3Y=t;this.$1D=i};_mcp.$ui.$AL8=function(n){if(OwaApplication.$Oy)return null;var t=n.$5m(24);return new _y.$1P(_y.$U.get_$2dg(),_y.$U.get_$7WA(),_u.CommonStrings.l_AppsTouch_Text,t.$15X)};_mcp.$ui.prototype={$5a:null,$1ah:null,$1oH:!1,$3Y:null,$1D:null,$6Ot:!1,get_$5rl:function(){return this.$1ah},set_$5rl:function(n){if(n!==this.$1ah){this.$1ah=n;this.$4("CloseConfirmDialogButtonData")}return n},get_$2Na:function(){return this.$1oH},set_$2Na:function(n){if(n!==this.$1oH){this.$1oH=n;this.$4("IsCloseConfirmDialogShown")}return n},set_$C8c:function(n){if(n!==this.$6Ot){this.$6Ot=n;this.$4("IsAppBarSetup")}return n},$Ea8:function(){var i=this.$1n;var u=i.$v.$c;_js.Trace.logInfo(_a.$0.$16,"Setup appbar menu. Context: "+u.toString());var n=new(_ff.$18.$$(_y.$2a));var t=i.$5m(1);_g.$O.get_$Q().get_$1j().get_$1Ip()?n.$F(t.get_$6LK()):n.$F(t.get_$7EC());if(u.get_$3Jg())if(_g.$O.get_$Q().get_$1j().get_$tY()){n.$F(t.get_$4rA());t.$2Oo=!1}else{n.$F(t.get_$3at());t.$2Oo=!0}else t.$2Oo=!1;OwaApplication.$Oy||n.$F(new _y.$2a(_nbs.NonBootStrings.l_CheckNamesMenuItem_LowerCase_Text,t.$1Nd));var e=i.$5m(6);n.$F(e.$ta);var r=i.$5m(3);if(r.$ta&&r.$5qA()){n.$F(r.$ta);r.$2Ny=!0}else r.$2Ny=!1;var f=i.$5m(10);n.$F(new _y.$2a(_nbs.NonBootStrings.l_ShowMessageOptions_Text,f.$3b1));i.$v.$5w.set_$vi(n.get_$1y());this.set_$C8c(!0)},$3e:function(){var t=this.$1n;var n=t.$v;var i=n.$c;_js.Trace.logInfo(_a.$0.$16,"InitTouchComponent:Context:"+i.toString());n.$5w||this.$2Fk();t.$5m(23);_mcp.$14n.prototype.$3e.call(this)},$3tc:function(n,t){if(this.$1n.$v.$1di)return!1;else if(this.$7DK()){this.$1oH||this.$9ko();return!0}else if(this.$1n.$v.$c.get_$1Ll()&&!this.$m1()){_js.Trace.logInfo(_a.$0.$16,"Removing unedited reply forward draft if user clicks outside the form.");this.$5xd();return!0}else{this.$1n.$v.set_$1Ei(!0);var r=this.$1n;var i=r.$5m(2);i&&i.get_$5F()&&i.get_$5F().set_$3J7(!0);return!1}},$m1:function(){var n=this.$1n.$5m(7);return n.$bq},$2Fk:function(){var t=this.$1n;var f=t.$v;var o=f.$c;var l=t.$5m(7);var c=new _y.$1P(_y.$U.get_$wm(),_y.$U.get_$4DU(),_u.CommonStrings.l_SendItemMobile_Text,l.$LB);var h=_y.$1P.$SG(_nbs.NonBootStrings.l_Close1_Text,this.$5a);var u=_mcp.$ui.$AL8(t);var r=this.$AOC(o,t);var e=2;e+=u?1:0;e+=r?1:0;var n=new Array(e);var i=0;n[i++]=c;u&&(n[i++]=u);n[i++]=h;r&&(n[i++]=r);_js.Trace.logInfo(_a.$0.$16,"Creating appbar. ContextId="+o.get_$D1());var s=_y.$1i.$FE(f,n,null);s.set_$3IN("TouchNarrow"===_y.$z.$1Q.get_$U());f.$EVh(s)},$9ko:function(){var t=this.$1n;var i=t.$v;var n=i.$c;_js.Trace.logInfo(_a.$0.$16,"User hit close, decide whether to show the confirm dialog. Context:"+n.toString());if(this.$m1()){_js.Trace.logInfo(_a.$0.$16,"Skipping close since send is in progress. This is considered a corner case since going to local store should be quick. If this occurs frequently, an UX solution is needed.");return}if(this.$7DK()){this.$9jY();_js.Trace.logInfo(_a.$0.$16,"Toggle IsCloseConfirmDialogShown flag to show the dialog.");this.set_$2Na(!0)}else if(n.get_$1Ll()){_js.Trace.logInfo(_a.$0.$16,"Removing unedited reply forward draft on close.");this.$5xd()}else{_js.Trace.logInfo(_a.$0.$16,"Navigate away due to unmodified message.");this.$26U()}},$6LP:function(){_js.Trace.logInfo(_a.$0.$16,"Hide close confirm dialog");this.set_$2Na(!1)},$9jY:function(){if($C(this.$1ah)){_js.Trace.logInfo(_a.$0.$16,"Create close confirm dialog.");var n=new _js.$X;OwaApplication.$Oy||n.$F(new _ff.$1l(new _C(this.$$d_$4CZ,this.get_$m()),_u.CommonStrings.l_ConfirmDialog_Save_Text,_nbs.NonBootStrings.l_SaveConfirmDialogButtonDescription_Text));n.$F(new _ff.$1l(new _C(this.$$d_$5xd,this.get_$m()),_u.Strings.l_ConfirmDialog_Discard_Text,_u.Strings.l_DeleteConfirmDialogButtonDescription_Text));n.$F(new _ff.$1l(new _C(this.$$d_$6LP,this.get_$m()),_bcs.BootCommonStrings.l_ConfirmDialog_Cancel_Text,_u.Strings.l_ReturnToMessageForEditing_Text));this.set_$5rl(n)}},$4CZ:function(){_js.Trace.logInfo(_a.$0.$16,"User select save and close");var n=this.$1n;n.$v.set_$1Ei(!0);this.$6LP();var t=n.$5m(8);t.$7OO(this.$$d_$2WW)},$2WW:function(n){this.$26U()},$5xd:function(){_js.Trace.logInfo(_a.$0.$16,"User select discard and close");var n=this.$1n;n.$v.set_$1Ei(!0);this.$6LP();var t=n.$5m(21);t.$5yt()},$26U:function(){var n=this.$1n;n.$v.set_$1Ei(!0);var t=n.$5m(2);t.get_$5F().$2Si(n.$v,!1)},$AOC:function(n,t){if(n.get_$3uZ())return null;var i=new(_ff.$18.$$(_y.$2a));var f=t.$5m(5);var u=f.$8D0();if(u&&u.length>0)for(var e=u,h=e.length,r=0;r<h;++r){var c=e[r];i.$F(c)}if(!OwaApplication.$Oy){var o=t.$5m(12);i.$F(new _y.$2a(_nbs.NonBootStrings.l_InsertSignatureMenuItem_LowerCase_Text,o.$4Pj));if(this.$3Y&&(this.$3Y.$2r("iOSSharePointRichTextEditor")&&_a.UserAgent.getInstance().get_$JM()||this.$3Y.$2r("AndroidCED")&&_a.UserAgent.getInstance().$YL)&&this.$1D.get_$NE()&&_a.UserAgent.getInstance().get_$8b()){f=t.$5m(5);this.$1n.$v.$c.get_$6P()==="HTML"&&i.$F(new _y.$2a(_nbs.NonBootStrings.l_LocationSubmenuItem_LowerCase_Text,f.get_$8QU()))}}if(OwaApplication.$Oy&&i.get_$1y().length===1){var s=i.get_$1y()[0];return new _y.$1P(_y.$U.get_$1Pk(),_y.$U.get_$4SE(),_u.CommonStrings.l_IncludeMenuButtonText_Text,s.get_$Z8())}else return new _y.$1P(_y.$U.get_$1Pk(),_y.$U.get_$4SE(),_u.CommonStrings.l_IncludeMenuButtonText_Text,null,i.get_$1y())}};_mcp.$1LC=function(n,t,i){this.$$d_$9DO=Function.createDelegate(this,this.$9DO);this.$$d_$7bT=Function.createDelegate(this,this.$7bT);this.$$d_$DmX=Function.createDelegate(this,this.$DmX);this.$$d_$AFF=Function.createDelegate(this,this.$AFF);this.$$d_$7dV=Function.createDelegate(this,this.$7dV);this.$$d_$DUQ=Function.createDelegate(this,this.$DUQ);_mcp.$1LC.initializeBase(this,[13,n]);this.$Lx=this.$1n.$v.$Lx;this.$1D=t;this.$3Y=i};_mcp.$1LC.prototype={$Lx:null,$1D:null,$3Y:null,$6Va:null,$2bg:null,$2TX:null,$7Nw:null,$7Nu:null,$7Nx:null,$4W4:null,$3eT:null,$4Li:!1,get_$7dN:function(){this.$4W4||(this.$4W4=new _C(this.$$d_$DUQ,_a.$0.$16));return this.$4W4},get_$9kQ:function(){var n=this.$1n.$v.$c;return this.get_$2OM()&&!n.get_$2mQ()},get_$8YE:function(){var n=this.$1n.$v.$c;return this.get_$2OM()&&n.get_$2mQ()&&!this.$3eT&&!n.get_$1ZN()},get_$2OM:function(){return!1},get_$CDN:function(){return this.get_$9kQ()||this.get_$8YE()},$3e:function(){if(this.get_$2OM()){var t=this.$1n;var n=t.$v.$c;if(n.get_$2mQ()&&n.get_$1ZN()){_js.Trace.logInfo(_a.$0.$dT,"initializing upgrade component, user requested upgrade and upgrade failed, show the failure message");this.$7Eb();_mcp.$3t.$Jx(t)}}_mcp.$14n.prototype.$3e.call(this)},$A9R:function(){_a.$6.stPT(_a.$0.$16,"MailComposeUpgrade",3);this.$2bg=_y.$2F.$1g(_a.$0.$16,"MailComposeUpgrade",!0);var i=this.$1n.$v;var n=i.$c;var u=n.get_$D1();this.$6Va=u;if(!n.get_$OV()){if(!this.get_$2OM()){var f=this;_js.$D.get_$Q().$2V(_a.$0.$16,"ShowUpgradeMessage",function(){n.get_$OV()||n.get_$1ZN()||u!==f.$6Va||f.$7Fd(i.$1d)},5e3)}var t;t=this.$1D.get_$NE()||n.get_$6P()!=="HTML"?n.get_$6P()==="Text"?_h.$f.get_$3Lk():_h.$f.get_$24c():_h.$f.get_$6Xi();if(t===_h.$f.get_$24c()||t===_h.$f.get_$6Xi()){t=_ff.$1o.$4o(t);t.BlockExternalImages=n.get_$IV().get_$vA();t.FilterHtmlContent=n.get_$IV().get_$vA()}var r=i.$Xj.$7hx(n,t,this.$1D);n.get_$6X()===12&&(r.$14y=new _g.$8c(new _g.$7H("internalsubmission")));r.add_$28l(this.$$d_$7dV);_js.Trace.logInfo(_a.$0.$dT,"Begin upgrade, context:"+n.toString()+"; OriParentFolderId="+(n.get_$IV()&&n.get_$IV().get_$3G()&&_g.$c.$2I?_g.$c.$2I.idToName(n.get_$IV().get_$3G()):"null"));r.$Hp="MailComposeUpgrade";if(n.get_$8Vs()){var e=new _mcp.$sN(r);i.$n.$tE(e,this.$$d_$AFF,this.$$d_$DmX,null)}else i.$n.$tE(r,this.$$d_$7bT,this.$$d_$9DO,null)}},$AFF:function(n){var t=n;this.$7bT(t.$1kM)},$DmX:function(n){var i=n;var t=i.$1kM;this.$9DO(t);this.$9Kg(n.$2H,t.$99,t.$68?t.$68.correlationId:null,this.$1n.$v.$c)},$7bT:function(n){var s=this.$1n;var e=s.$v;var r=e.$c;var t=n;var c=s.$5m(21);var u=t.$5i;var i=n.$99;var o=t.$68?t.$68.correlationId:null;var l=!!t.$MG;if(this.$Lx.$1EM(i)){_js.Trace.logInfo(_a.$0.$dT,"Check upgrade callback, resume discard for context "+i);c.$5Nm(i,u)}else if(i===r.get_$D1()){r.set_$Fd(u);_js.Trace.logInfo(_a.$0.$dT,"Context match, updated the draft id. Context:"+r.toString()+"; ResponseMessageBodyType="+(l&&t.$MG.get_$4n()?t.$MG.get_$4n().get_$6P():"null"));var f=e.get_$1Ng();var h=e.get_$iH();if(!f.$GQ&&h.$bq){_js.Trace.logInfo(_a.$0.$dT,"Skipping upgrade for contextId "+i+" since send was triggered during upgrade");this.$4BB("SkipUpgrade",o,"Skip upgrade since send is in progress");h.$3XI();return}if(f.$GQ&&f.$2Yx){_js.Trace.logInfo(_a.$0.$dT,"Skipping upgrade for contextId "+i+" since save and then send was triggered during upgrade");this.$4BB("SkipUpgrade",o,"SkipUpgrade since saving is in progress");f.$5Np();return}}if(t.$MG){_js.Trace.logInfo(_a.$0.$dT,"Check upgrade, action has response message, call complete upgrade. context: "+r.toString()+"; ActionItemId="+_h.$D1.$1d1(u));this.$7dV(n)}else if(n.$99===r.get_$D1()){_js.Trace.logInfo(_a.$0.$dT,"Check upgrade: action has id only, updated draft id. context: "+r.toString()+"; ActionItemId="+_h.$D1.$1d1(u));this.$7nu()}},$AI4:function(n){n.$6T6()&&this.$1n.$v.$1d.$4s(3050)},$7dV:function(n){var o=this.$1n;var r=o.$v;var t=r.$c;var i=n;var c=i.$68?i.$68.correlationId:null;var e=n.$99;i.remove_$28l(this.$$d_$7dV);if(e===t.get_$D1()){t.set_$j0(i.$MG);this.$3eT=i.$MG;t.$EvZ(i.$MG.get_$Bv());try{if(this.get_$2OM())if(t.get_$2mQ()){_js.Trace.logInfo(_a.$0.$dT,"upgrade returned success, user already requested for upgrade, merge body and remove spinner");this.$5sT();this.$3i("IsWaitingForQuotedBody","IsOnDemandUpgradePending");_mcp.$3t.$Jx(o)}else this.$4Li=!0;else this.$5sT();i.$MG.get_$1m()&&t.set_$EW(i.$MG.get_$1m().get_$7V());var s=r.get_$eM();s.$iZ()}finally{t.set_$OV(this.$4Li);t.get_$OV()&&r.$1d.$9U(3440);_js.Trace.logInfo(_a.$0.$dT,"IsUpgraded for context is "+t.get_$OV())}this.$AI4(t);_mcp.$3t.$Jx(this.$1n);_js.Trace.logInfo(_a.$0.$dT,"Complete upgrade context:"+t.toString());var u=r.get_$1Ng();if(u.$GQ)u.$5Np();else if(_a.$5N.$43){var f=this.$1n.$5m(25);var h=this;_js.$D.get_$Q().$6C(_a.$0.$16,"TriggerPolicyTipsIfNeeded",function(){f&&f.$2BX(32)})}r.$N.$1p(_y.$13W,new _mcp.$1LD(t.get_$j0().get_$y().Id,r))}else _js.Trace.logInfo(_a.$0.$dT,"MailComposeUpgrade failed since user switched view model context. ContextId="+e+"; Context="+t.toString())},$DUQ:function(){this.$2TX=_y.$2F.$1g(_a.$0.$16,"MailComposeOnDemandUpgrade",!0);var n=this.$1n.$v.$c;n.set_$2mQ(!0);if(this.$3eT){_js.Trace.logInfo(_a.$0.$dT,"user requests for quoted body, upgrade was successful, complete the body merge");this.$5sT();this.$3i("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending")}else if(n.get_$1ZN()){_js.Trace.logInfo(_a.$0.$dT,"user requests for quoted body, upgrade failed, show error message");this.$3i("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending");this.$7Eb();_mcp.$3t.$Jx(this.$1n);this.$7o2()}else{_js.Trace.logInfo(_a.$0.$dT,"user requests for quoted body, upgrade has yet to come back, show spinner");this.$3i("ShouldShowQuoteBodyButton","IsWaitingForQuotedBody")}},$5sT:function(){var n=this.$1n.$v.$c;var r=!1;if(this.$1D.get_$ps()){if(n.get_$T9()){n.$W2.$11();n.get_$MW()===n.get_$T9().get_$MW()&&(r=!0)}else n.$5CP=!0;n.$4v4=!0}var f=this.$1n.$5m(27);this.$4Li=!1;if(this.$1D.get_$NE()||n.get_$6P()!=="HTML"){var t=this.$3eT.get_$4n().get_$1Z();n.set_$1gL(!this.$1D.get_$ps()&&n.get_$6P()==="Text"?_a.$1J.$AKE(t):t)}else n.set_$1gL(this.$3eT.get_$Mq().get_$1Z());var i=new _cmc.$1L2(n.get_$1gL());try{f.set_$Nf(i)}finally{this.$4Li=i.$7PP}if(r){n.$W2.$11();n.get_$T9().set_$MW(n.get_$MW());var u=n.$jW;u&&n.$jW.set_$MW(n.get_$MW())}this.$7nu()},$9DO:function(n){var o=this.$1n;var i=o.$v;var r=i.$c;var h=o.$5m(21);var f=n;var u=f.$68?f.$68.correlationId:null;r.set_$1ZN(!0);var t=n.$99;if(this.$Lx.$1EM(t)){_js.Trace.logInfo(_a.$0.$dT,"Resume discard for context "+t);h.$5Nm(t,f.$5i)}else if(t===r.get_$D1()){_js.Trace.logInfo(_a.$0.$dT,"Recording on context upgrade failed");var e=i.get_$1Ng();var s=i.get_$iH();if(e.$GQ){if(e.$2Yx){_js.Trace.logInfo(_a.$0.$dT,"Skipping upgrade for context "+t+" since save and then send was triggered during upgrade");this.$4BB("SkipUpgrade",u,"Skip upgrade since saving is in progress");e.$5Np();return}this.$7Fd(i.$1d)}else if(s.$bq){_js.Trace.logInfo(_a.$0.$dT,"Skipping upgrade for context "+t+" since send was triggered during upgrade");this.$4BB("SkipUpgrade",u,"Skip upgrade since send is in progress");s.$3XI();return}else this.$7Fd(i.$1d);if(this.get_$2OM()&&r.get_$2mQ()){_js.Trace.logInfo(_a.$0.$dT,"upgrade failed and user requested for upgrade, show the failure and trigger property changes to hide the spinner");this.$3i("IsWaitingForQuotedBody","IsOnDemandUpgradePending");this.$7Eb();_mcp.$3t.$Jx(this.$1n)}}n.$2H&&this.$9Kg(n.$2H,t,u,r)},$9Kg:function(n,t,i,r){var f="UpgradeFailure_UnknownError";var u="";if(_g.$4k.$1dc(n)){f=_g.$4k.$2LC(n);u=n.FaultMessage}_js.Trace.logWarning(_a.$0.$dT,String.format("Upgrade failed. ContextId={0}, Context={1}, Server Error: {2}",t,r.toString(),u));this.$4BB(f,i,u)},$7Fd:function(n){if(!this.get_$2OM()){n.$9U(3440);n.$4s(3440,null);_mcp.$3t.$Jx(this.$1n)}},$7Eb:function(){var n=this.$1n.$v.$1d;n.$9U(3450);n.$4s(3450,null)},$4BB:function(n,t,i){this.$7Nw=n;this.$7Nu=t;this.$7Nx=i;if(this.$2bg){_y.$2F.$1G(this.$2bg,null,n,t,i);this.$2bg=null;_a.$6.endPT("MailComposeUpgrade")}this.$7o2()},$7nu:function(){if(this.$2bg){_y.$2F.$1G(this.$2bg);this.$2bg=null;_a.$6.endPT("MailComposeUpgrade")}this.$AmX()},$AmX:function(){if(this.$2TX){_y.$2F.$1G(this.$2TX);this.$2TX=null}},$7o2:function(){if(this.$2TX){_y.$2F.$1G(this.$2TX,null,this.$7Nw,this.$7Nu,this.$7Nx);this.$2TX=null}}};_mcp.$1L4=function(n,t){this.$$d_$Dcv=Function.createDelegate(this,this.$Dcv);this.$$d_$EqR=Function.createDelegate(this,this.$EqR);_mcp.$1L4.initializeBase(this,[19,n]);var i=this;t.$9(function(t){i.$zY=t.$9(n.$5m(1),n.$v.$1d);i.$zY.set_$Dcw(i.$$d_$Dcv);if(i.$5Ww){i.$zY.$3e();i.$5Ww=!1}if(i.$5XN){i.$zY.$2yR();i.$5XN=!1}})};_mcp.$1L4.prototype={$zY:null,$5Ww:!1,$5XN:!1,$3e:function(){this.$zY?this.$zY.$3e():this.$5Ww=!0;_mcp.$14n.prototype.$3e.call(this)},$2yR:function(){if(this.$zY){_js.Trace.logInfo(_a.$0.$16,"Prepares to submit mailtips action");this.$zY.$2yR()}else{_js.Trace.logInfo(_a.$0.$16,"Remember to submit MailTips action once the MailTipsHandler is created");this.$5XN=!0}},$EqR:function(){var i=this.$1n;var t=i.$v;var n=t.$c;if(n.get_$3yb()){t.$1d.$9U(4400);t.$1d.$4s(4400);_mcp.$3t.$Jx(this.$1n)}if(n.get_$6X()&&n.get_$6X()!==3&&n.get_$6X()!==11){this.get_$G8()||this.$3e();this.$2yR()}},$9N1:function(){if(this.$zY){_js.Trace.logInfo(_a.$0.$16,"Remove MailTips for deleted recipients");this.$zY.$9N1()}else _js.Trace.logInfo(_a.$0.$16,"MailTips for deleted recipients was called when MailTipsHandler hasn't been created, no operation needed")},$Dcv:function(){_mcp.$3t.$Jx(this.$1n)}};_mcp.$1L8=function(n,t){this.$$d_$9gk=Function.createDelegate(this,this.$9gk);this.$$d_$9BS=Function.createDelegate(this,this.$9BS);this.$$d_$9BR=Function.createDelegate(this,this.$9BR);this.$$d_$9BP=Function.createDelegate(this,this.$9BP);this.$$d_$DgF=Function.createDelegate(this,this.$DgF);_mcp.$1L8.initializeBase(this,[25,n]);if(_a.$5N.$43){var i=this;t.$9(function(t){i.$WT=t.$9(i.$1n.$5m(1),i.$1n.$5m(5),n.$v.$1d);i.$WT.set_$DgG(i.$$d_$DgF);i.$WT.set_$9BQ(i.$$d_$9BP);i.$WT.set_$9BO(i.$$d_$9BR);i.$WT.set_$9BT(i.$$d_$9BS);i.$WT.set_$9CV(i.$$d_$9gk);if(i.$5Wx){i.$WT.$3e();i.$5Wx=!1}if(i.$5X6){i.$2BX(i.$6su);i.$5X6=!1}})}};_mcp.$1L8.prototype={$2PE:null,$WT:null,$5Wx:!1,$5X6:!1,$6su:0,$3e:function(){if(!_a.$5N.$43){_mcp.$14n.prototype.$3e.call(this);return}this.$WT?this.$WT.$3e():this.$5Wx=!0;_mcp.$14n.prototype.$3e.call(this)},$2A:function(){this.$2PE&&(this.$2PE=_js.$D.get_$Q().$6Q(this.$2PE));_js.$Ec.prototype.$2A.call(this)},$CF9:function(){if(!_a.$5N.$43)return!1;switch(this.$3EA()){case 1:return!1;case 2:case 3:return $C(this.$1n.$v.$c.get_$uM())&&$C(this.$1n.$v.$c.get_$r3());case 4:case 5:return $C(this.$1n.$v.$c.get_$r3());default:return!1}},$Btg:function(){if(!_a.$5N.$43)return"";switch(this.$3EA()){case 2:case 3:return _u.CommonStrings.l_PolicyTipsBlockOverrideSend_Text;case 4:case 5:return _u.CommonStrings.l_PolicyTipsBlockSend_Text;default:return""}},$EYT:function(){if(_a.$5N.$43){if(!this.$WT){_js.Trace.logInfo(_a.$0.$PH,"skip setting message sent flag since handler hasn't been created yet.");return}this.$WT.set_$CMv(!0);if(!$C(this.$1n.$v.$c.get_$uM())){var n=_a.$6.$1g(_a.$0.$PH,"DlpPolicyTipOverridden",!0);_a.$6.$1G(n,"DlpPolicyTipOverridden","",null)}}},$2BX:function(n){this.$9rx(n,0)},$4J1:function(n,t,i){_js.Trace.logInfo(_a.$0.$16,"Prepares to submit policyTips action");var u;var r;if(n.get_$T9()){u=_a.$37.$3EE(n.get_$T9().get_$3o());r=_a.$37.$3EE(n.get_$T9().get_$MW())}else{u=_a.$37.$3EE(n.get_$3o());r=_a.$37.$3EE(n.get_$MW())}this.$WT.$4J1(i,n.get_$EW(),u,r,t)},$9rx:function(n,t){if(_a.$5N.$43){if(!this.$WT){_js.Trace.logInfo(_a.$0.$PH,"Remember to resume triggering policy tips once the handler is created");this.$6su=n;this.$5X6=!0;return}var f=this.$1n;var e=f.$v;var r=e.$c;this.get_$G8()||this.$3e();this.$2PE&&(this.$2PE=_js.$D.get_$Q().$6Q(this.$2PE));var i=r.get_$Fd();if(i){_bc.$9F.$2ll(i)&&!_g.$1H.$Yw&&(i=_g.$1H.$1Q.$1d4(i));if(_bc.$9F.$2ll(i)){if(t<4){var u=this;this.$2PE=_js.$D.get_$Q().$2V(_a.$0.$PH,"TriggerPolicyTipsIfNeeded",function(){u.$9rx(n,t+1)},5e3)}}else this.$4J1(r,n,i)}}},$3EA:function(){this.get_$G8()||this.$3e();return this.$WT?this.$WT.$3EA():0},$DgF:function(){_mcp.$3t.$Jx(this.$1n)},$9BP:function(n){var r=this.$1n;var i=r.$v;var t=i.$c;t.set_$uM(n)},$9BR:function(n){var r=this.$1n;var i=r.$v;var t=i.$c;t.set_$r3(n)},$9BS:function(){this.$2BX(64)},$9gk:function(n){var r=this.$1n;var i=r.$v;var t=i.$c;t.set_$178(n)}};_mcp.$1L1=function(n,t){this.$$d_$AmM=Function.createDelegate(this,this.$AmM);this.$$d_$95y=Function.createDelegate(this,this.$95y);this.$$d_$961=Function.createDelegate(this,this.$961);this.$$d_$AIB=Function.createDelegate(this,this.$AIB);this.$$d_$As1=Function.createDelegate(this,this.$As1);this.$$d_$7W9=Function.createDelegate(this,this.$7W9);this.$$d_$Ed7=Function.createDelegate(this,this.$Ed7);_mcp.$1L1.initializeBase(this,[24,n]);this.$2kU=!1;this.$j3=t;this.$15X=new _C(this.$$d_$Ed7,_a.$0.$4W);this.$15X.set_$87(!1)};_mcp.$1L1.prototype={$2kU:!1,$65:null,$j3:null,$eo:null,$15X:null,set_$17N:function(n){if(this.$65!==n){this.$65=n;this.$4("ExtensibilityViewModel")}return n},$3e:function(){if(!this.get_$G8()){var n=this;this.$j3.$9(function(t){n.$eo=t;n.set_$17N(t.$5up(n,n.$$d_$7W9));var i=n.$1n.$5m(3);n.$65.set_$7rn(i.$2O3);var r=n.$1n.$v.$N;r.$1k(_a.$Uq,n.$$d_$As1);n.$65.$73();i.$p("IsIrmProtected",n.$$d_$AIB);n.$65.add_$2TP(n.$$d_$961);n.$65.add_$5Dt(n.$$d_$95y);n.$65.get_$Ap6()?n.$15X.set_$87(n.$65.get_$2xe().$3s):n.$65.get_$2xe().add_$1aX(n.$$d_$AmM);_mcp.$14n.prototype.$3e.call(n)})}},$AV:function(){if(this.get_$G8()){var t=this.$1n.$5m(3);t.$1B("IsIrmProtected",this.$$d_$AIB);this.$65.remove_$2TP(this.$$d_$961);this.$65.remove_$5Dt(this.$$d_$95y);this.$65.$AJ();var n=this.$1n.$v.$N;n.$4A(_a.$Uq,this.$$d_$As1)}_mcp.$14n.prototype.$AV.call(this)},$2L2:function(){return _y.$z.$1Q.get_$U()==="Mouse"?this.$1n.$v.$c.get_$6P():this.$1n.$v.$c.get_$NE()?"HTML":"Text"},$v7:function(){return this.$1n.$v.$c.get_$3o()},$9j7:function(n){this.$1n.$v.$c.set_$3o(n)},$8IZ:function(n,t,i){i.val=0;var r=new _fm.$lq(n);this.$1n.$v.$c.set_$29B(r);r.$2O2&&(i.val=9016);t.val=r.$3bb;return r.$2Wn},$9it:function(n,t,i){i.val=0;var r=new _fm.$u2(n,!0);r.$vN=t;this.$1n.$v.$c.set_$29B(r);r.$4wN?i.val=2006:r.$2O2&&(i.val=9016)},$8Hq:function(n){var t=this.$8D4(n);return t.$3X},$9s3:function(n,t){return this.$9s4(n,t,!1)},$9ie:function(n,t){this.$9s4(n,t,!0)},$4PQ:function(n,t){t.val=0;if(!this.$1n.$v.$c.get_$OV()){_js.Trace.logInfo(_a.$0.$4W,"Attachment not added - well not upgraded.");t.val=9005;return null}var r=this.$1n.$5m(5);var u=_y.$7x.$5uT(n);if(r.get_$9Z()){var f=_a.$6.$1g(_a.$0.$1m,"AttachmentExtensibilityItemAttachments",!0);var i=new(_ff.$18.$$(_y.$OU));r.get_$9Z().$30r(u,i,f);if(!i.get_$A()){_js.Trace.logInfo(_a.$0.$4W,"Attachment not added - max number exceeded.");t.val=9001;return null}return i.get_$E(0)}else{_js.Trace.logInfo(_a.$0.$4W,"Attachment not added - max number exceeded.");t.val=9001;return null}},$4PL:function(n,t,i){i.val=0;if(!this.$1n.$v.$c.get_$OV()){_js.Trace.logInfo(_a.$0.$4W,"Attachment not added - well not upgraded.");i.val=9005;return null}var f=this.$1n.$5m(5);var r=f.get_$9Z();if(r){var u=this.$eo.$7iZ(n,t);return r.$7SZ(u)}_js.Trace.logError(_a.$0.$4W,"ComposeFormNotReadyForAttachments in mail module");i.val=9015;return null},$4nG:function(){return this.$1n.$v.$c.get_$5O()?this.$1n.$v.$c.get_$5O().Id:null},$8QM:function(n,t){var i=new _cmc.$MV(0,n,t);i.$2zX=!0;i.$28c=!0;this.$5Pc(i)},$9Hu:function(n,t){var i=new _cmc.$MV(1,n,t);this.$5Pc(i)},$Ed7:function(){this.$65&&this.$65.$7E7()},$AmM:function(n,t){this.$15X.set_$87(this.$65.get_$2xe().$3s);this.$65.get_$2xe().remove_$1aX(this.$$d_$AmM)},$961:function(){if(_y.$z.$1Q.get_$U()==="TouchWide"&&this.$65.get_$13S()){var n=this.$1n.$v;n.set_$2tB(6)}},$95y:function(){var n=this.$1n.$v;n.set_$2tB(4)},$5Pc:function(n){var t=this.$1n.$5m(27);t.set_$Nf(n)},$2LJ:function(){return this.$1n.$v.$c.get_$Fd()?this.$1n.$v.$c.get_$Fd().Id:null},$3ES:function(){this.$1n.$v.$c.get_$nz()||this.$1n.$v.$c.set_$nz(new _js.$X);return this.$1n.$v.$c.get_$nz()},$8cG:function(){},$9oC:function(){var n=new _cmc.$Tu(null);this.$5Pc(n)},$7b8:function(n){var t=new _cmc.$Tu(n);this.$5Pc(t)},$9s4:function(n,t,i){var u=this.$8D4(n);i&&u.$AV();var f=t.get_$A();if(f+u.$3X.get_$A()>100)return!1;n===2&&this.$1n.$v.get_$af().$4HI.$11();for(var r=0;r<f;r++){var e=t.get_$E(r);u.$5kF(e)}return!0},$As1:function(n){if(this.$2kU){this.$2kU=!1;this.$65.$22Q(!1)}},$kN:function(){var n=this.$1n.$5m(14);n&&n.$kN()},$7W9:function(n){if(n===1){var r=window.document.body.clientWidth;if(r<1367){var i=this.$1n.$v.$N;i.$1p(_a.$eQ,new _a.$eQ(!0));this.$2kU=!0}}else if(n===2&&this.$2kU){var t=this.$1n.$v.$N;t.$1p(_a.$eQ,new _a.$eQ(!1));this.$2kU=!1}this.$kN()},$8D4:function(n){var t=this.$1n.$v.get_$af();return n?n===1?t.$GM.$5X:n===2?t.$Ge.$5X:null:t.$GI.$5X},$AIB:function(n,t){t==="IsIrmProtected"&&this.$EeQ()},$EeQ:function(){var n=this.$1n.$5m(3);this.$65.set_$7rn(n.$2O3);n.$2O3&&this.$65.$22Q(!1)}};_mcp.$1LD=function(n,t){this.$5zs=n;this.$6Xk=t};_mcp.$1LD.prototype={$5zs:null,$6Xk:null,get_$Fd:function(){return this.$5zs},get_$CKZ:function(){return this.$6Xk}};_mcp.$1PW=function(n){this.$v=n};_mcp.$1PW.prototype={$v:null};_mcp.$1PX=function(n){this.$v=n};_mcp.$1PX.prototype={$v:null,get_$4D:function(){return this.$v}};_mcp.$pc=function(n,t,i,r){this.$6QO=n;this.$8E=t;this.$3IQ=i;this.$2If=r};_mcp.$pc.prototype={$6QO:!1,$8E:null,$3IQ:!1,$2If:null,get_$8U4:function(){return this.$6QO},get_$1xc:function(){return this.$8E},get_$4vm:function(){return this.$3IQ},get_$7sP:function(){return this.$2If}};_mcp.$184=function(n){this.$3IQ=n};_mcp.$184.prototype={$3IQ:!1,get_$4vm:function(){return this.$3IQ}};_mcp.$1Pc=function(n){this.$v=n};_mcp.$1Pc.prototype={$v:null,get_$4D:function(){return this.$v}};_mcp.$mv=function(){};_mcp.$mv.prototype={$5u6:function(n,t,i){var r=n.$c;var u=r.get_$6X();var c=3===u||2===u||1===u;var s=i.get_$ps()&&r.get_$OV();n.get_$7Nt().get_$2OM()&&(s=!!(s&r.get_$2mQ()));var f=null;if(c&&!s){_js.Trace.logInfo(_a.$0.$16,"Creating CreateResponseAction for context:"+r.toString()+"; layout="+_y.$z.$1Q.get_$U()+"; disposition="+t);var l=r.$1kK(!1);var o=this.$4Xz(r,l,i);o.$M9=t;r.get_$Fd()&&t===1&&(o.$2zl=n.$2zk);o.$2eF=r.$6Ia(100);o.$2Q4=_y.$1m.toString(r.get_$6X());if(r.get_$8Vs()){var a=new _mcp.$sN(o);f=a}else f=o}else if(r.get_$6TM()){_js.Trace.logInfo(_a.$0.$16,"Creating UpdateMessageForComposeAction for context:"+r.toString()+"; disposition="+t);var h=this.$AS0(t,r,i);t===1&&(h.$2zl=n.$2zk);f=h}else if(8===r.get_$6X()){_js.Trace.logInfo(_a.$0.$16,"Creating CancelCalendarItemAction for context:"+r.toString()+"; disposition="+t);f=this.$Au0(r,t)}else if(u===5||u===6||u===7){_js.Trace.logInfo(_a.$0.$16,"Creating MeetingResponseAction for context:"+r.toString()+"; disposition="+t);f=this.$65V(r,t)}else if(u===9||u===10){_js.Trace.logInfo(_a.$0.$16,"CreateComposeAction: ApprovalRequestAction");f=this.$AtX(r,t,i)}else{_js.Trace.logInfo(_a.$0.$16,"Creating CreateMessageForComposeAction for context:"+r.toString()+"; disposition="+t);var e=null;if(u===11||u===12){e=new _h.$2k(r.$5vC(!1),r.get_$2se());e.$M9=0}else{e=new _h.$2k(r.$1kK(!1),null);e.$M9=t}e.$1k2=!i.get_$NE();$C(r.get_$h4())||(e.$11x=r.get_$h4());e.$2eF=r.$6Ia(100);e.$2Q4=_y.$1m.toString(r.get_$6X());f=e}f.$99=r.get_$D1();return f},$5uX:function(n,t,i){var r=new _h.$1Gs(200,n);r.$WA=t||_h.$f.get_$24c();r.$ZJ=$C(i)?"MailCompose":i;return r},$AMb:function(n,t){var r=t?"HardDelete":"MoveToDeletedItems";return new _h.$1Dn([n],r,2)},$7hx:function(n,t,i){var u=null;u=n.get_$1El()?n.$5vC(!0):n.$1kK(!0);var r=this.$4Xz(n,u,i);r.$WA=t;r.$ZJ=!i.get_$NE()&&n.get_$6P()==="HTML"?"MailComposeNormalizedBody":"MailCompose";r.$2z0=_g.$O.get_$Q().get_$1j().get_$cf();return r},$Au0:function(n,t){var i=new _c.$kE(n.get_$14V(),1,n.get_$17M());i.$Ov=n.$1kK(!1);n.get_$h4()&&(i.$11x=n.get_$h4());return i},$4Xz:function(n,t,i){var u=n.get_$1Lg()?new _h.$6f(n.get_$14V()):n.get_$14V();var r=null;r=new _h.$Bk(this.$4p7(n.get_$6X()),u,i);r.set_$6a(t);r.$28U=n.get_$5Gn();r.$1k2=!i.get_$NE();n.get_$h4()&&(r.$11x=n.get_$h4());r.$Dq_7=n.get_$5O();r.$kE=n.get_$3T8();r.$99=n.get_$D1();n.get_$IV()&&_g.$5w.isInstanceOfType(n.get_$IV())&&n.get_$IV().get_$Q8()&&(r.$3JR=!0);switch(n.get_$6X()){case 1:case 2:r.$4Ix=_u.Strings.l_ReplyPrefix_Text;break;case 3:r.$4Ix=_nbs.NonBootStrings.l_ForwardPrefix_Text;break}return r},$65V:function(n,t){return _cc.$43.$65V(n.get_$IV(),_cc.$43.$2kP(n.get_$6X()),n.$1kK(!1),t,n.get_$5KW())},$AS0:function(n,t,i){var r=null;if(t.get_$1El()){r=new _h.$49(t.$5vC(!1));r.$14y=_g.$1z.$tK(t.get_$2se());r.$M9=0}else{r=new _h.$49(t.$1kK(!1));r.$M9=n}r.$6UU=!i.get_$NE();t.get_$h4()&&(r.$11x=t.get_$h4());r.$2eF=t.$6Ia(100);r.$3k5="AlwaysOverwrite";r.$2Q4=_y.$1m.toString(t.get_$6X());return r},$4p7:function(n){switch(n){case 1:return new _g.$FX;case 2:return new _g.$E6;case 3:return new _g.$F6;case 12:return new _g.$XC;default:throw Error.invalidOperation("Unable to get SmartResponseType from MailComposeOperation "+_y.$1m.toString(n));}},$AtX:function(n,t,i){var u=n.get_$IV();var r=new _c.$sM(u,n.$1kK(!1),n.get_$6X()===9,t);r.$1k2=!i.get_$NE();return r}};_mcp.$1Kv=function(n,t,i,r,u,f,e,o,s,h,c,l){_a.$4.$z(e,"nativeBridge");this.$1n=n;this.$3Y=i;this.$1D=r;this.$N6=u;this.$F1=t;this.$2Y=f;this.$l=e;this.$6R=o;this.$WK=s;this.$16L=h;this.$11c=c;this.$CY=l};_mcp.$1Kv.prototype={$1n:null,$3Y:null,$1D:null,$N6:null,$WK:null,$F1:null,$2Y:null,$l:null,$6R:null,$16L:null,$11c:null,$CY:null,$AM0:function(n,t){switch(n){case 0:return new _mcp.$14o(this.$1n,this.$1D,!!this.$6R);case 1:return new _mcp.$HY(this.$1n);case 2:return new _mcp.$1L6(this.$1n);case 3:return new _mcp.$JQ(this.$1n);case 4:return new _mcp.$7y(this.$1n);case 5:return new _mcp.$Gn(this.$1n,this.$F1,this.$3Y,this.$1D,this.$N6,this.$WK,this.$1n.$v.$tx,this.$CY);case 6:return new _mcp.$eU(this.$1n);case 7:return new _mcp.$G6(this.$1n,this.$1D,this.$3Y,this.$1n.$v.$N);case 8:return new _mcp.$1Ku(this.$1n,this.$2Y,this.$1D);case 9:if(1===this.$1n.$v.$c.get_$5j())return new _mcp.$MZ(this.$1n,this.$1D);break;case 10:return new _mcp.$1L5(this.$1n,this.$6R,this.$3Y);case 11:if("Mouse"!==t)return new _mcp.$ui(this.$1n,this.$3Y,this.$1D);break;case 12:return new _mcp.$G7(this.$1n,this.$1D);case 13:return new _mcp.$1LC(this.$1n,this.$1D,this.$3Y);case 14:if(t==="Mouse")return new _mcp.$3t(this.$1n,this.$6R);break;case 15:if(this.$l.$8G(this.$l.get_$JQ())&&this.$l.get_$JQ().get_$14F().get_$4S4())return new _mcp.$Ma(this.$1n,this.$l);break;case 22:if(this.$l.$8G(this.$l.get_$JQ())&&this.$l.get_$JQ().get_$14F().get_$5C5())return new _mcp.$1L7(this.$1n,this.$l);break;case 16:return new _mcp.$eT(this.$1n);case 17:if("Mouse"===t)return new _mcp.$1Kx(this.$1n,this.$6R);break;case 18:if("Mouse"===t)return new _mcp.$Ow(this.$1n);break;case 20:return new _mcp.$II(this.$1n);case 19:return new _mcp.$1L4(this.$1n,this.$16L);case 25:return new _mcp.$1L8(this.$1n,this.$11c);case 21:return new _mcp.$1Kz(this.$1n);case 23:if(this.$l.$8G(this.$l.get_$15U()))return new _mcp.$1L9(this.$1n,this.$l);break;case 24:return new _mcp.$1L1(this.$1n,this.$1n.$v.$j3);case 26:if(this.$1D.get_$NE())return new _mcp.$1L3(this.$1n,this.$3Y);break;case 27:return new _mcp.$1L0(this.$1n);case 29:return new _mcp.$1LA(this.$1n)}return null}};_mcp.$1Ky=function(n,t){this.$51j=n;this.$1D=t};_mcp.$1Ky.prototype={$1D:null,$51j:null,$H5:function(n,t){var i=new _mcp.$V;if(this.$1D){i.set_$ps(this.$1D.get_$ps());i.set_$NE(this.$1D.get_$NE())}i.set_$5j(n?0:this.$51j.$6G4());return i},$35M:function(n,t,i,r){var u=this.$H5(!1,!1);u.set_$5j(this.$51j.$6G4());u.set_$6X(4);u.set_$Xa(!1);u.set_$Fd(n);u.set_$3xz(t);r&&!r.get_$RG()?u.set_$6P(r.get_$6P()):u.set_$6P(i===1?"Text":"HTML");return u}};_mcp.$14q=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st){_a.$4.$z(k,"nativeBridge");this.$j3=n;this.$9M=t;this.$1D3=i;this.$3WB=r;this.$7G=u;this.$Xj=f;this.$4x=e;this.$I=o;this.$2TL=s;this.$Lx=h;this.$Le=c;this.$N=l;this.$3Y=v;this.$1D=y;this.$N6=p;this.$F1=a;this.$2Y=w;this.$l7=b;this.$l=k;this.$2zk=d;this.$WK=g;this.$16L=nt;this.$11c=tt;this.$tx=it;this.$1tw=rt;this.$sv=ut;this.$39Y=ft;this.$2ZP=et;this.$CY=ot;this.$F4=st};_mcp.$14q.prototype={$j3:null,$9M:null,$1D3:null,$3WB:null,$7G:null,$Xj:null,$N:null,$4x:null,$I:null,$2TL:null,$Lx:null,$Le:null,$3Y:null,$1D:null,$N6:null,$F1:null,$l7:null,$2Y:null,$tx:null,$WK:null,$l:null,$2zk:null,$16L:null,$11c:null,$1tw:null,$sv:null,$39Y:null,$2ZP:null,$CY:null,$F4:null,$wd:function(n,t,i){return this.$C7d(n,null,t,i)},$1CS:function(n,t,i){return this.$8Qx(n,null,t,i)},$C7d:function(n,t,i,r){var u=this.$7G.$H5(!1,!1);u.$6NH(n);return this.$8Qx(u,t,i,r)},$8Qx:function(n,t,i,r){var u=new _mcp.$8n(n,t,this.$j3,this.$9M,this.$1D3,this.$3WB,this.$4x,this.$I,this.$2TL,this.$Lx,this.$Le,this.$N,this.$F1,this.$3Y,this.$1D,this.$N6,this.$2Y,this.$l7,this.$l,this.$2zk,this.$Xj,i,r,this.$WK,this.$16L,this.$11c,this.$tx,this.$1tw,this.$sv,this.$39Y,this.$2ZP,this.$CY,this.$F4);u.$3e();return u}};_mcp.$147=function(){_mcp.$147.initializeBase(this)};_mcp.$147.prototype={$Ql:null,$4Wj:null,set_$iw:function(n){if(this.$Ql!==n){this.$Ql=n;this.$4("Description")}return n},set_$AJh:function(n){if(this.$4Wj!==n){this.$4Wj=n;this.$4("ConversationOwner")}return n}};_mcp.$ug=function(n){this.$$d_$95g=Function.createDelegate(this,this.$95g);_mcp.$ug.initializeBase(this);this.$n=OwaApplication.$2B;this.$2F=n};_mcp.$ug.prototype={$n:null,$2F:null,$tE:function(n,t,i,r){$C(t)||n.add_$2s(t);n.add_$2b(i||this.$$d_$95g);$C(r)||n.add_$4Q(r);this.$n.$1V(n)},$Ekn:function(n,t,i,r,u,f){var e=n[t++];var s=this;var o=function(){t<n.length?s.$Ekn(n,t,i,r,u,f):r(e)};var c=this,h=this;this.$tE(e,function(){o()},function(){u(e);i&&o()},f)},$9kb:function(n,t){var i=_nbs.NonBootStrings.l_MailComposeActionFailed_Text;this.$t6(n,i,null,i,null,t)},$2kD:function(n,t,i,r,u,f){var e=t;var o=n.$2H;if(o){if(_g.$4k.$1dc(o)){var h=o;if(_g.$4k.$8XB(h)){_js.Trace.logInfo(_a.$0.$16,"GetErrorMessage returning service unavailable "+_u.Strings.l_ErrorServiceUnavailable_Text+" since the specified exception was a service unavailable json fault body");e=_u.Strings.l_ErrorServiceUnavailable_Text}else if(_g.$4k.$8Wn(h)&&u){_js.Trace.logInfo(_a.$0.$16,"GetErrorMessage returning request timeout "+u+" since the specified exception was a request timeout json fault body");e=u}else if(_g.$4k.$8Tb(h)&&i){_js.Trace.logInfo(_a.$0.$16,"GetErrorMessage returning disconnected "+i+" since the specified exception was a disconnected json fault body");e=i}}if(e===t){var s=_a.$4.$4or(o);s?r&&s==="ErrorItemNotFound"?e=r:s==="ErrorAccessDenied"?e=_u.Strings.l_WarningNoPermissionToPerformAction_Text:f&&s==="ErrorQuotaExceeded"?e=f:_js.Trace.logInfo(_a.$0.$oj,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not one of the specific jsonFaultBody or response code exceptions we are currently looking for"):_js.Trace.logWarning(_a.$0.$oj,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not a JsonFaultBody exception or an exception with response code. The exception.Message was "+o.message)}}else _js.Trace.logInfo(_a.$0.$16,"GetErrorMessage returning default message "+t+" since the exception was null");_js.Trace.logInfo(_a.$0.$16,"MailComposeActionSubmitter.GetErrorMessage: showing error {0}",e);return e},$t6:function(n,t,i,r,u,f){var e=this.$2kD(n,t,i,r,u,null);this.$2F.$44(0,e,f)},$95g:function(n){this.$9kb(n,null);this.$6wa(n)},$6wa:function(n){this.$AQ("MailComposeActionFailed",n)}};_mcp.$V=function(){this.$$d_$Aqy=Function.createDelegate(this,this.$Aqy);_mcp.$V.initializeBase(this);this.set_$6P("Html"===_g.$O.get_$Q().get_$1j().get_$1yE()?"HTML":"Text");this.$p(_mcp.$V.$48c.$3D,this.$$d_$Aqy);this.$p(_mcp.$V.$4wl.$3D,this.$$d_$Aqy);if(_a.$b.$43&&_a.$b.get_$18m()){this.set_$PT(_g.$O.get_$Q().get_$1j().get_$2ZO());this.set_$T0(_g.$O.get_$Q().get_$1j().get_$2ZQ())}};_mcp.$V.$$cctor=function(){_mcp.$V.$2aq.set_$Qz(new _a.$CA(_g.$1K));_mcp.$V.$2Es.set_$Qz(new _a.$CA(_g.$1K));_mcp.$V.$2EB.set_$Qz(new _a.$CA(_g.$1K));_mcp.$V.$5Zp.set_$Qz(new _a.$CA(_pc.$q));_mcp.$V.$2E4.set_$Qz(new _a.$CA(_g.Attachment));_mcp.$V.$2Hu.set_$Qz(new _a.$CA(_g.$HL))};_mcp.$V.$9F7=function(n,t,i,r){if(!(i in t))return r;var u=t[i];return _js.$9.$o(u)?r:_js.$1I.$Ba(n,u)};_mcp.$V.$9F5=function(n,t,i){if(!(t in n))return i;var r=n[t];return _js.$9.$o(r)?i:Boolean.parse(r)};_mcp.$V.$7Tj=function(n,t,i,r){if(n)for(var f=0;f<n.get_$A();f++){var u=n.get_$E(f);if(_g.$1Z.$5b(u,i)){_js.Trace.logInfo(_a.$0.$16,"Excluding original from {0}",i);continue}if(_mcp.$V.$23q(u.EmailAddress)){_js.Trace.logInfo(_a.$0.$16,"Excluding self address {0}",_mcp.$V.$1h0||"null");continue}if(r&&r.get_$A()!==r.$HE(function(n){return _g.$1Z.$5b(u,n)})){_js.Trace.logInfo(_a.$0.$16,"Excluding address {0} already in to",u);continue}t.$F(u)}};_mcp.$V.$23q=function(n){return!_js.$9.$1h(_mcp.$V.$1h0)&&!_js.$9.$1h(n)&&(_mcp.$V.$1h0===n||_mcp.$V.$1h0.toLowerCase()===n.toLowerCase())};_mcp.$V.$6XR=function(n,t,i,r){r.val+=" "+n+"(";if(t)for(var u=0;u<t.get_$A();u++){r.val+=_g.$1Z.$1d1(t.get_$E(u));u!==t.get_$A()-1&&(r.val+="|")}r.val+=" QS="+i+")"};_mcp.$V.prototype={$6uP:null,$W2:null,$8Q:null,$W3:null,$4pH:null,$3IB:!1,$3wt:!1,$7DX:!1,$2gg:null,$6UY:!1,$jW:null,$5CP:!1,$9kU:!1,$4v4:!1,$8Sq:!1,$1i1:0,$3kv:0,$32m:null,$52g:0,$5ZR:null,$3JE:!1,$48C:null,get_$2MC:function(){return!!this.get_$5KW()},get_$5KW:function(){return this.$w(_mcp.$V.$6w3)},set_$5KW:function(n){this.$P(_mcp.$V.$6w3,_cc.$9d.$AtB(n));return n},get_$F16:function(){return this.get_$2MC()?_nbs.NonBootStrings.l_CurrentMeetingTime_Short_Text:_u.MeetingMsgStrings.l_WhenLabel_Text},get_$6Py:function(){return this.$4v4},set_$6Py:function(n){this.$4v4=n;return n},get_$D1:function(){return this.$w(_mcp.$V.$7Oy)},set_$D1:function(n){this.$P(_mcp.$V.$7Oy,n);return n},get_$6X:function(){return this.$w(_mcp.$V.$48c)},set_$6X:function(n){this.$P(_mcp.$V.$48c,n);return n},get_$5j:function(){return this.$w(_mcp.$V.$26K)},set_$5j:function(n){this.$P(_mcp.$V.$26K,n);return n},get_$14V:function(){return this.$w(_mcp.$V.$6rP)},set_$14V:function(n){this.$P(_mcp.$V.$6rP,n);return n},get_$5Gn:function(){return this.$w(_mcp.$V.$6rN)},set_$5Gn:function(n){this.$P(_mcp.$V.$6rN,n);return n},get_$IV:function(){this.$8Q||(this.$8Q=this.$w(_mcp.$V.$6rQ));return this.$8Q},set_$IV:function(n){this.$8Q=n;this.$P(_mcp.$V.$6rQ,this.$8Q);return n},get_$Fd:function(){return this.$w(_mcp.$V.$5zt)},set_$Fd:function(n){if($C(this.get_$Fd())||!n)this.$P(_mcp.$V.$5zt,n);else{this.get_$Fd().Id=n.Id;this.get_$Fd().ChangeKey=n.ChangeKey}return n},get_$6TM:function(){return!!this.get_$Fd()},get_$9oE:function(){return this.$w(_mcp.$V.$7H7)},set_$9oE:function(n){this.$P(_mcp.$V.$7H7,n);return n},get_$3o:function(){return this.$w(_mcp.$V.$qH)},set_$3o:function(n){this.$P(_mcp.$V.$qH,n);return n},get_$MW:function(){return this.$w(_mcp.$V.$38L)},set_$MW:function(n){this.$P(_mcp.$V.$38L,n);return n},get_$29B:function(){return this.$w(_mcp.$V.$72n)},set_$29B:function(n){this.$P(_mcp.$V.$72n,n);return n},get_$3sY:function(){return this.$W2},set_$3sY:function(n){this.$W2=n;return n},get_$dp:function(){return this.$w(_mcp.$V.$6wi)},set_$dp:function(n){this.$P(_mcp.$V.$6wi,n);return n},set_$BsS:function(n){this.$W3=n;return n},get_$1vd:function(){return this.$w(_mcp.$V.$7JN)},set_$1vd:function(n){this.$P(_mcp.$V.$7JN,n);return n},get_$6P:function(){return this.$w(_mcp.$V.$5o1)},set_$6P:function(n){this.$P(_mcp.$V.$5o1,n);return n},get_$8JO:function(){return this.$4pH},set_$8JO:function(n){this.$4pH=n;return n},get_$79:function(){return this.$w(_mcp.$V.$2aq)},set_$79:function(n){this.$P(_mcp.$V.$2aq,n);return n},get_$4IU:function(){return this.$w(_mcp.$V.$5Zp)},set_$4IU:function(n){this.$P(_mcp.$V.$5Zp,n);return n},get_$10y:function(){return this.$w(_mcp.$V.$3dI)},set_$10y:function(n){this.$P(_mcp.$V.$3dI,n);return n},get_$7x:function(){return this.$w(_mcp.$V.$2Es)},set_$7x:function(n){this.$P(_mcp.$V.$2Es,n);return n},get_$xt:function(){return this.$w(_mcp.$V.$342)},set_$xt:function(n){this.$P(_mcp.$V.$342,n);return n},get_$AN:function(){return this.$w(_mcp.$V.$2EB)},set_$AN:function(n){this.$P(_mcp.$V.$2EB,n);return n},get_$qd:function(){return this.$w(_mcp.$V.$32n)},set_$qd:function(n){this.$P(_mcp.$V.$32n,n);return n},get_$Xa:function(){return this.$w(_mcp.$V.$5WZ)},set_$Xa:function(n){this.$P(_mcp.$V.$5WZ,n);return n},get_$Bv:function(){return this.$w(_mcp.$V.$3Gg)},set_$Bv:function(n){this.$P(_mcp.$V.$3Gg,n);return n},get_$1gL:function(){return this.$w(_mcp.$V.$6wU)},set_$1gL:function(n){this.$P(_mcp.$V.$6wU,n);return n},get_$9ml:function(){return this.$w(_mcp.$V.$7G2)},set_$9ml:function(n){this.$P(_mcp.$V.$7G2,n);return n},get_$4IE:function(){return this.$w(_mcp.$V.$7G4)},set_$4IE:function(n){this.$P(_mcp.$V.$7G4,n);return n},get_$5ZV:function(){return this.$w(_mcp.$V.$7G6)},set_$5ZV:function(n){this.$P(_mcp.$V.$7G6,n);return n},get_$1yd:function(){return this.$3kv},set_$1yd:function(n){this.$3kv=n;return n},get_$1xK:function(){return this.$32m},set_$1xK:function(n){this.$32m=n;return n},get_$2Ak:function(){return this.$1i1},set_$2Ak:function(n){this.$1i1=n;return n},get_$rt:function(){return this.$w(_mcp.$V.$6PW)},set_$rt:function(n){this.$P(_mcp.$V.$6PW,n);return n},get_$oy:function(){return this.$w(_mcp.$V.$4wl)},set_$oy:function(n){this.$P(_mcp.$V.$4wl,n);return n},get_$23R:function(){return this.$w(_mcp.$V.$6Rn)},set_$23R:function(n){this.$P(_mcp.$V.$6Rn,n);return n},get_$3yb:function(){return this.$w(_mcp.$V.$6T5)},set_$3yb:function(n){this.$P(_mcp.$V.$6T5,n);return n},get_$6E:function(){return this.$w(_mcp.$V.$3LQ)},set_$6E:function(n){this.$P(_mcp.$V.$3LQ,n);return n},get_$3Fs:function(){return this.$w(_mcp.$V.$6Kg)},set_$3Fs:function(n){this.$P(_mcp.$V.$6Kg,n);return n},get_$1pY:function(){return this.$w(_mcp.$V.$6Yq)},set_$1pY:function(n){this.$P(_mcp.$V.$6Yq,n);return n},get_$5Q:function(){return this.$w(_mcp.$V.$2Ie)},set_$5Q:function(n){this.$P(_mcp.$V.$2Ie,n);return n},get_$Em:function(){return this.$w(_mcp.$V.$73n)},set_$Em:function(n){this.$P(_mcp.$V.$73n,n);return n},get_$OV:function(){return this.$w(_mcp.$V.$6UV)},set_$OV:function(n){this.$P(_mcp.$V.$6UV,n);return n},get_$ow:function(){return this.$w(_mcp.$V.$6Qd)},set_$ow:function(n){this.$P(_mcp.$V.$6Qd,n);return n},get_$1LT:function(){return this.$w(_mcp.$V.$6P7)},set_$1LT:function(n){this.$P(_mcp.$V.$6P7,n);return n},get_$19y:function(){return this.$w(_mcp.$V.$3T9)},set_$19y:function(n){this.$P(_mcp.$V.$3T9,n);return n},get_$2se:function(){return this.$w(_mcp.$V.$6sU)},set_$2se:function(n){this.$P(_mcp.$V.$6sU,n);return n},get_$1oe:function(){return this.$w(_mcp.$V.$6SP)},set_$1oe:function(n){this.$P(_mcp.$V.$6SP,n);return n},get_$1Lg:function(){return this.$w(_mcp.$V.$6SH)},set_$1Lg:function(n){this.$P(_mcp.$V.$6SH,n);return n},get_$17M:function(){return this.$w(_mcp.$V.$62d)},set_$17M:function(n){this.$P(_mcp.$V.$62d,n);return n},get_$8OT:function(){return this.$w(_mcp.$V.$6Mm)},set_$8OT:function(n){this.$P(_mcp.$V.$6Mm,n);return n},get_$1TS:function(){return this.$w(_mcp.$V.$6KN)},set_$1TS:function(n){this.$P(_mcp.$V.$6KN,n);return n},get_$1Ll:function(){return this.$w(_mcp.$V.$6T7)},set_$1Ll:function(n){this.$P(_mcp.$V.$6T7,n);return n},get_$j0:function(){return this.$w(_mcp.$V.$5zu)},set_$j0:function(n){this.$P(_mcp.$V.$5zu,n);return n},get_$2E8:function(){return this.$w(_mcp.$V.$5mm)},set_$2E8:function(n){this.$P(_mcp.$V.$5mm,n);return n},get_$EW:function(){return this.$w(_mcp.$V.$2E4)},set_$EW:function(n){var i=null;if(n){i=new _js.$X;for(var t=0;t<n.get_$A();t++)i.$F(n.get_$E(t))}this.$P(_mcp.$V.$2E4,i);this.$9tj();return n},get_$1ZN:function(){return this.$w(_mcp.$V.$7Nv)},set_$1ZN:function(n){this.$P(_mcp.$V.$7Nv,n);return n},get_$T9:function(){return this.$w(_mcp.$V.$5nc)},set_$T9:function(n){this.$P(_mcp.$V.$5nc,n);return n},get_$8Vs:function(){return this.$3JE},get_$9i:function(){return this.$w(_mcp.$V.$70y)},set_$9i:function(n){if(n!==this.get_$9i()){this.$P(_mcp.$V.$70y,n);this.$3i("IsCopyRestricted","IsPrintRestricted")}return n},get_$h4:function(){return this.$w(_mcp.$V.$34Z)},set_$h4:function(n){this.$P(_mcp.$V.$34Z,n);return n},set_$Ebr:function(n){this.$7DX=n;return n},get_$6QA:function(){return this.$3IB},set_$6QA:function(n){this.$3IB=n;n&&!this.get_$T9()&&this.$7oe();return n},get_$6QB:function(){return this.$3wt},set_$6QB:function(n){if(this.$3wt!==n){this.$3wt=n;this.$4("IsEditorReady")}return n},set_$4c8:function(n){this.$2gg!==n&&(this.$2gg=n);return n},set_$CGL:function(n){this.$6UY=n;return n},get_$6Yk:function(){return 255},get_$23O:function(){return this.$w(_mcp.$V.$6RV)},set_$23O:function(n){this.$P(_mcp.$V.$6RV,n);return n},get_$1P2:function(){return this.$w(_mcp.$V.$7PO)},set_$1P2:function(n){this.$P(_mcp.$V.$7PO,n);return n},get_$3uZ:function(){return this.$w(_mcp.$V.$6LW)},set_$3uZ:function(n){this.$P(_mcp.$V.$6LW,n);return n},get_$3xz:function(){return this.$w(_mcp.$V.$6S6)},set_$3xz:function(n){this.$P(_mcp.$V.$6S6,n);return n},get_$3ey:function(){return this.$w(_mcp.$V.$7PQ)},set_$3ey:function(n){this.$P(_mcp.$V.$7PQ,n);return n},get_$CE8:function(){return!!this.get_$9i()&&!this.get_$9i().get_$RG()&&!this.get_$9i().get_$4AW()&&!this.get_$9i().get_$KU()},get_$9lZ:function(){return this.get_$oy()&&_mcp.$7y.$8Xa(this)},get_$2Nf:function(){return!!this.get_$9i()&&0===this.get_$9i().get_$RG()&&!this.get_$9i().get_$3ni()&&!this.get_$9i().get_$KU()},get_$3Qb:function(){return null},get_$6uW:function(){return this.get_$3o()},get_$5JN:function(){return this.$6uP},get_$a9:function(){return this.$w(_mcp.$V.$6PN)},set_$a9:function(n){this.$P(_mcp.$V.$6PN,n);return n},get_$l4:function(){return this.$w(_mcp.$V.$5r0)},set_$l4:function(n){this.$P(_mcp.$V.$5r0,n);return n},get_$uM:function(){return this.$w(_mcp.$V.$5zV)},set_$uM:function(n){this.$P(_mcp.$V.$5zV,n);return n},get_$r3:function(){return this.$w(_mcp.$V.$5zU)},set_$r3:function(n){this.$P(_mcp.$V.$5zU,n);return n},get_$178:function(){return this.$w(_mcp.$V.$5zT)},set_$178:function(n){this.$P(_mcp.$V.$5zT,n);return n},get_$h0:function(){return this.$w(_mcp.$V.$5r2)},set_$h0:function(n){this.$P(_mcp.$V.$5r2,n);return n},get_$eW:function(){return this.$w(_mcp.$V.$5qz)},set_$eW:function(n){this.$P(_mcp.$V.$5qz,n);return n},get_$1xv:function(){return this.$w(_mcp.$V.$5r1)},set_$1xv:function(n){this.$P(_mcp.$V.$5r1,n);return n},get_$ET:function(){return this.$w(_mcp.$V.$3XK)},set_$ET:function(n){this.$P(_mcp.$V.$3XK,n);return n},get_$Qu:function(){return this.$w(_mcp.$V.$3I6)},set_$Qu:function(n){this.$P(_mcp.$V.$3I6,n);return n},get_$Q8:function(){return this.$w(_mcp.$V.$3JS)},set_$Q8:function(n){this.$P(_mcp.$V.$3JS,n);return n},get_$EzO:function(){return this.get_$s0()},get_$4IJ:function(){return this.$w(_mcp.$V.$7G7)},set_$4IJ:function(n){this.$P(_mcp.$V.$7G7,n);return n},get_$s0:function(){return _a.$b.$43&&(this.get_$PT()||this.get_$T0())},get_$PT:function(){if(!_a.$b.$43||!_a.$b.get_$231()||!this.$6Tl()||_g.$O.get_$Q().get_$1j().get_$tY())return!1;var n=_g.$O.get_$Q().get_$VV();return!!n&&n.AlwaysEncrypt||this.$w(_mcp.$V.$3bQ)},set_$PT:function(n){this.$P(_mcp.$V.$3bQ,n);this.$4(_mcp.$V.$4LG);_js.Trace.logInfo(_a.$0.$53,"Context.SmimeEncryptMessage is set to "+n);return n},get_$T0:function(){if(!_a.$b.$43||!_a.$b.get_$231()||!this.$6Tl()||_g.$O.get_$Q().get_$1j().get_$tY())return!1;var n=_g.$O.get_$Q().get_$VV();return!!n&&n.AlwaysSign||this.$w(_mcp.$V.$3bT)},set_$T0:function(n){this.$P(_mcp.$V.$3bT,n);this.$4(_mcp.$V.$4LG);_js.Trace.logInfo(_a.$0.$53,"Context.SmimeSignMessage is set to "+n);return n},get_$9mn:function(){return _g.$O.get_$Q().get_$VV()&&(_g.$O.get_$Q().get_$VV().AlwaysEncrypt||_g.$O.get_$Q().get_$1j().get_$tY())||this.get_$ow()?!1:!0},get_$9mo:function(){return _g.$O.get_$Q().get_$VV()&&(_g.$O.get_$Q().get_$VV().AlwaysSign||_g.$O.get_$Q().get_$1j().get_$tY())||this.get_$ow()?!1:!0},get_$5O:function(){return this.$w(_mcp.$V.$356)},set_$5O:function(n){this.$P(_mcp.$V.$356,n);return n},get_$3T8:function(){return this.$w(_mcp.$V.$6sR)},set_$3T8:function(n){this.$P(_mcp.$V.$6sR,n);return n},get_$3Jg:function(){if(this.get_$oy()||_y.$z.$1Q.get_$lN()||this.get_$s0())return!1;var n=this.get_$9i();return!n||!!n.get_$RG()||n.get_$KU()},get_$6TN:function(){return OwaApplication.$Oy?!1:this.get_$6X()!==8&&!this.get_$1El()},get_$23i:function(){return this.$w(_mcp.$V.$6Sd)},set_$23i:function(n){this.$P(_mcp.$V.$6Sd,n);return n},get_$4HB:function(){return this.$9kU},get_$1El:function(){return this.get_$6X()===11||this.get_$6X()===12||this.get_$6X()===13},get_$dn:function(){return this.$w(_mcp.$V.$6t3)},set_$dn:function(n){this.$P(_mcp.$V.$6t3,n);return n},get_$1NG:function(){return this.$w(_mcp.$V.$6t2)},set_$1NG:function(n){this.$P(_mcp.$V.$6t2,n);return n},get_$2C0:function(){return this.$w(_mcp.$V.$7PT)},set_$2C0:function(n){this.$P(_mcp.$V.$7PT,n);return n},set_$ps:function(n){this.$P(_mcp.$V.$9Pe,n);return n},get_$NE:function(){return this.$w(_mcp.$V.$6MC)},set_$NE:function(n){this.$P(_mcp.$V.$6MC,n);return n},get_$nz:function(){return this.$w(_mcp.$V.$2Hu)},set_$nz:function(n){this.$P(_mcp.$V.$2Hu,n);return n},get_$2mQ:function(){return this.$w(_mcp.$V.$6SJ)},set_$2mQ:function(n){this.$P(_mcp.$V.$6SJ,n);return n},get_$3yg:function(){return this.$w(_mcp.$V.$6TE)},set_$3yg:function(n){this.$P(_mcp.$V.$6TE,n);return n},get_$3Fz:function(){return this.$w(_mcp.$V.$6Kr)},set_$3Fz:function(n){this.$P(_mcp.$V.$6Kr,n);return n},get_$9SK:function(){return this.$w(_mcp.$V.$73p)},set_$9SK:function(n){this.$P(_mcp.$V.$73p,n);return n},get_$9mm:function(){this.$5ZR||(this.$5ZR=this.$4p8());return this.$5ZR},get_$4A8:function(){return this.$w(_mcp.$V.$ab)},set_$4A8:function(n){this.$P(_mcp.$V.$ab,n);return n},get_$37U:function(){return this.$w(_mcp.$V.$5yT)},set_$37U:function(n){this.$P(_mcp.$V.$5yT,n);return n},get_$6q4:function(){return this.$48C},set_$6q4:function(n){this.$48C=n;return n},$6NH:function(n){this.set_$5j(_mcp.$V.$9F7(_y.$Ox,n,_mcp.$V.$26K.$3D,0));this.set_$6X(_mcp.$V.$9F7(_y.$1m,n,_mcp.$V.$48c.$3D,0));this.set_$Xa(_mcp.$V.$9F5(n,_mcp.$V.$5WZ.$3D,!0));this.set_$1oe(_mcp.$V.$9F5(n,"IsCalendarItem",!1));if(n&&"StoreId"in n){this.set_$rt(!1);this.set_$9oE(n.StoreId)}this.$C53(n);this.set_$OV(0===this.get_$6X()||4===this.get_$6X())},$6NI:function(n){_g.$gg.isInstanceOfType(n)?this.set_$6X(1):_g.$gf.isInstanceOfType(n)?this.set_$6X(2):_g.$t8.isInstanceOfType(n)&&this.set_$6X(3);this.$9tp(n,n.get_$2Ss());this.set_$14V(n.get_$2u0());this.set_$5Gn(n.get_$4BH());this.set_$Fd(n.get_$y());this.set_$3o(n.get_$3o());this.set_$dp(n.get_$2Ss().get_$1Z());this.set_$5Q(n.get_$5Q());this.set_$79(n.get_$79()?n.get_$79().get_$7V():null);this.set_$7x(n.get_$7x()?n.get_$7x().get_$7V():null);this.set_$AN(n.get_$AN()?n.get_$AN().get_$7V():null);this.set_$Xa(!1);this.set_$Bv(n.get_$Bv());this.$4Wq(n);this.set_$9i(n.get_$9i());this.set_$ET(n.get_$ET());this.set_$Qu(n.get_$Qu());this.set_$Q8(n.get_$Q8());this.get_$9i()&&!this.get_$9i().get_$RG()?this.set_$6P(this.get_$9i().get_$6P()):$C(n.get_$2Ss())||(n.get_$t9()?this.set_$6P(n.get_$t9().get_$6P()):this.set_$6P(n.get_$106()===1?"Text":"HTML"));this.$8PF(n);this.set_$OV(!1);this.set_$rt(!0);_js.Trace.logInfo(_a.$0.$16,"Initialized context with smart response, context:"+this.toString())},$4sg:function(n){if($C(n))throw Error.argumentNull("message");this.$9tp(n,n.get_$4n());this.set_$j0(n);this.set_$Fd(n.get_$y());this.set_$3o(n.get_$3o());this.set_$dp(n.get_$t9()?n.get_$t9().get_$1Z():n.get_$4n().get_$1Z());this.set_$5O(n.get_$5O());if(_g.$5w.isInstanceOfType(n)){var t=n;this.set_$5Q(t.get_$5Q());this.set_$79(t.get_$79()?t.get_$79().$5vV():null);this.set_$7x(t.get_$7x()?t.get_$7x().$5vV():null);this.set_$AN(t.get_$AN()?t.get_$AN().$5vV():null);this.set_$Qu(t.get_$Qu());this.set_$Q8(t.get_$Q8())}else if(_g.$L6.isInstanceOfType(n)){var u=n;this.set_$5Q(u.get_$5Q())}this.set_$Xa(!1);this.set_$Bv(n.get_$Bv());this.$4Wq(n);this.set_$9i(n.get_$9i());this.set_$ET(n.get_$ET());n.get_$9i()&&!n.get_$9i().get_$RG()?this.set_$6P(n.get_$9i().get_$6P()):n.get_$t9()?this.set_$6P(n.get_$t9().get_$6P()):this.set_$6P(n.get_$106()===1?"Text":"HTML");this.set_$oy(_g.$Mf.isInstanceOfType(n));if(this.get_$oy()){var i=n;this.$4cj(i.get_$Q4());this.set_$23R(_g.$9y.isInstanceOfType(i));i.get_$5Q()&&this.set_$5Q(i.get_$5Q());i.get_$Em()&&this.set_$Em(i.get_$Em())}n.get_$1Aw()&&n.get_$1Aw().get_$A()?this.set_$EW(n.get_$1Aw()?n.get_$1Aw().get_$7V():null):(!this.get_$23i()||this.get_$OV())&&this.set_$EW(n.get_$1m()?n.get_$1m().get_$7V():null);if(this.get_$EW()&&n.get_$4n().get_$6P()==="Text")for(var r=0;r<this.get_$EW().get_$A();r++)this.get_$EW().get_$E(r)&&this.get_$EW().get_$E(r).get_$CA()&&this.get_$EW().get_$E(r).set_$CA(!1);this.$8PF(n);this.set_$OV(!0);this.set_$rt(!0);_js.Trace.logInfo(_a.$0.$16,"Initialized context with draft, context:"+this.toString())},$1Tj:function(n){this.set_$IV(n);this.$C4o(n)},$1kK:function(n){var i=new _g.$5w;var t;this.$9i4(i,t={val:n}),n=t.val;return i},$5vC:function(n){var i=new _g.$L6;var t;this.$9i4(i,t={val:n}),n=t.val;return i},$7fg:function(){var t=this.$7hV();_a.$4.$z(this.$W3,"GetRawEditorContentCommand");this.$W3.$11();var n=this.get_$dp();t.set_$1Z(n);this.$52g=_js.$9.$o(n)?0:n.length;_js.Trace.logInfo(_a.$0.$16,"MailComposeContext.CreateBodyFromEditor, RawContentLength: "+this.$52g.toString());return t},$EvZ:function(n){var t=this.get_$T9();if(!t||this.get_$Bv()===t.get_$Bv()){this.set_$Bv(n);t&&t.set_$Bv(n)}},$7oe:function(){if(this.$3IB&&this.$6UY){this.$W2.$11();if($C(this.get_$T9())){this.set_$T9(_mcp.$1W.$33t(this));_js.Trace.logInfo(_a.$0.$16,"Captured baseline for the first time, context:"+this.toString());if(this.$5CP&&this.$jW){this.$jW.set_$MW(this.get_$T9().get_$MW());this.$5CP=!1}if(!this.get_$Fd()||this.get_$23i()&&this.get_$1P2()){this.$jW=_mcp.$1W.$33t(this);_js.Trace.logInfo(_a.$0.$16,"Captured initial baseline for context:"+this.toString())}}else{_mcp.$1W.$2W(this.get_$T9(),this);_js.Trace.logInfo(_a.$0.$16,"Updated baseline, context:"+this.toString())}}},$IO:function(){if($C(this.get_$T9()))return!1;this.$W2.$11();return!this.get_$T9().$7oV(this)},$6Ia:function(n){this.$4pH.$11();var t=this.get_$1vd();t=t?t.length>n?this.get_$1vd().substr(0,n)+"...":t:"";return t},$2AN:function(n,t,i,r){this.set_$79(new _js.$X);var u=n?n.Mailbox:null;if(!_mcp.$V.$1h0){var s=_g.$O.get_$Q().get_$4P();_mcp.$V.$1h0=_js.$9.$o(s.get_$1up())?s.get_$Fv()||"":s.get_$sA()||""}if(this.get_$8OT()||this.get_$6X()!==8&&(!r||!r.get_$A())&&u&&(2!==this.get_$6X()||!_mcp.$V.$23q(u.EmailAddress))){this.get_$79().$F(u);_js.Trace.logInfo(_a.$0.$16,"Adding original From to To, Operation="+this.get_$6X()+"; From="+_g.$1Z.$1d1(n)+"; Self="+_mcp.$V.$1h0)}if(this.get_$6X()===2||this.get_$6X()===8){_js.Trace.logInfo(_a.$0.$16,"Adding "+(t?t.get_$A():0)+" To recipients to To.");_mcp.$V.$7Tj(t,this.get_$79(),u,null);_js.Trace.logInfo(_a.$0.$16,"Adding "+(i?i.get_$A():0)+" Cc recipients to Cc");this.set_$7x(new _js.$X);_mcp.$V.$7Tj(i,this.get_$7x(),u,this.get_$79())}this.$7Tw();if(r&&r.get_$A()>0)if(this.get_$6X()===1){this.get_$79().$1u();for(var o=0;o<r.get_$A();o++){var c=r.get_$E(o);this.get_$79().$F(c)}}else if(this.get_$6X()===2)for(var f=0;f<r.get_$A();f++){var e=r.get_$E(f);var l=this;if(this.get_$79().get_$A()===this.get_$79().$HE(function(n){return _g.$1Z.$5b(e,n)})){var a=this;var h=this.get_$7x().$HE(function(n){return _g.$1Z.$5b(e,n)});h!==this.get_$7x().get_$A()&&this.get_$7x().$5W(h);this.get_$79().$F(e)}}if(this.get_$6X()!==8&&u&&0===this.get_$79().get_$A()&&(!this.get_$7x()||0===this.get_$7x().get_$A())){this.get_$79().$F(u);_js.Trace.logInfo(_a.$0.$16,"Adding original From since there are no recipients left, From="+_g.$1Z.$1d1(n))}},toString:function(){var n="Id="+this.get_$D1()+"; Op="+this.get_$6X()+"; Mode="+this.get_$5j()+"; Oid=";n+=this.get_$14V()?this.get_$14V().Id+":"+this.get_$14V().ChangeKey+";":this.$8Q&&this.$8Q.get_$y()?this.$8Q.get_$y().Id+":"+this.$8Q.get_$y().ChangeKey+";":"null;";n+=" Did=";n+=this.get_$Fd()?this.get_$Fd().Id+":"+this.get_$Fd().ChangeKey+";":this.get_$j0()&&this.get_$j0().get_$y()?this.get_$j0().get_$y().Id+":"+this.get_$j0().get_$y().ChangeKey+";":"null;";n+=" Subject="+this.get_$3o()+"; RawContentLength="+(_js.$9.$o(this.get_$dp())?"0":this.get_$dp().length.toString())+"; ContentLength="+(_js.$9.$o(this.get_$MW())?"0":this.get_$MW().length.toString())+"; TextEditorContentLength="+(_js.$9.$o(this.get_$1vd())?"0":this.get_$1vd().length.toString())+"; BodyType="+this.get_$6P()+";";var r;_mcp.$V.$6XR("To",this.get_$79(),this.get_$10y(),r={val:n}),n=r.val;var i;_mcp.$V.$6XR("Cc",this.get_$7x(),this.get_$xt(),i={val:n}),n=i.val;var t;_mcp.$V.$6XR("Bcc",this.get_$AN(),this.get_$qd(),t={val:n}),n=t.val;n+=" AutoSig="+this.get_$Xa()+"; Imp="+this.get_$Bv()+"; QuotedBodyLength="+(_js.$9.$o(this.get_$1gL())?"0":this.get_$1gL().length.toString())+"; IsComplete="+this.get_$rt()+"; IsMeeting="+this.get_$oy()+"; IsMeetingForward="+this.get_$23R()+"; IsReplyBcc="+this.get_$3yb()+"; HasLocation="+this.get_$3Fs()+"; MeetingTime="+(this.get_$1pY()?this.get_$1pY().get_$Q9()+":"+(this.get_$1pY().get_$1T()?this.get_$1pY().get_$1T().$Er():"null")+":"+(this.get_$1pY().get_$2y()?this.get_$1pY().get_$2y().$Er():"null"):"null")+"; From="+_g.$1Z.$1d1(this.get_$5Q())+"; Sender="+_g.$1Z.$1d1(this.get_$Em())+"; IsFromShown="+this.get_$ow()+"; IsBccShown="+this.get_$1LT()+"; AttachmentCount="+(this.get_$EW()?this.get_$EW().get_$A().toString():"0")+"; UpgradeFailed="+this.get_$1ZN()+"; HasBaseline="+(!!this.get_$T9()).toString()+"; HasInitBaseline="+(!!this.$jW).toString()+"; UserSaved="+this.get_$1TS()+"; IsReplyForward="+this.get_$1Ll()+"; HasDraft="+(!!this.get_$j0()).toString()+"; HasRMLD="+(!!this.get_$9i()).toString()+"; Classified="+this.get_$a9()+"; Class="+this.get_$h0()+"; Sensitivity="+this.get_$ET()+"; DeliveryReceipt="+this.get_$Qu()+"; ReadReceipt="+this.get_$Q8()+"; SmimeEncryptMessage="+this.get_$PT()+"; SmimeSignMessage="+this.get_$T0()+"; ConversationId="+(this.get_$5O()?this.get_$5O().Id+":"+this.get_$5O().ChangeKey:"null")+" ParentConversationNodeId="+this.get_$3T8()+"; IsOriCalId="+this.get_$1oe()+"; OccurrenceRefMaster="+this.get_$1Lg()+"; IsLoadedDraft="+this.get_$23O()+"; IsMovedToDraftFromOutbox="+this.get_$3xz()+"; IsUpgraded="+this.get_$OV()+"; IsCached="+this.$8Sq+";";return n},$AV:function(){_js.Trace.logInfo(_a.$0.$16,"Context reset start.");this.set_$D1(null);this.get_$6X()&&this.set_$6X(0);this.get_$5j()&&this.set_$5j(0);this.get_$14V()&&this.set_$14V(null);this.get_$IV()&&this.set_$IV(null);this.get_$Fd()&&this.set_$Fd(null);_js.$9.$o(this.get_$3o())||this.set_$3o(null);_js.$9.$o(this.get_$dp())||this.set_$dp("");_js.$9.$o(this.get_$MW())||this.set_$MW("");_js.$9.$o(this.get_$1vd())||this.set_$1vd("");this.get_$79()&&this.set_$79(null);_js.$9.$o(this.get_$10y())||this.set_$10y(null);this.get_$7x()&&this.set_$7x(null);_js.$9.$o(this.get_$xt())||this.set_$xt(null);this.get_$AN()&&this.set_$AN(null);_js.$9.$o(this.get_$qd())||this.set_$qd(null);this.get_$Xa()||this.set_$Xa(!0);this.get_$Bv()!=="Normal"&&this.set_$Bv("Normal");_js.$9.$o(this.get_$1gL())||this.set_$1gL(null);this.get_$rt()&&this.set_$rt(!1);this.get_$oy()&&this.set_$oy(!1);this.get_$23R()&&this.set_$23R(!1);this.get_$3yb()&&this.set_$3yb(!1);this.get_$6E()&&this.set_$6E(null);this.get_$3Fs()&&this.set_$3Fs(!1);this.get_$1pY()&&this.set_$1pY(null);this.get_$5Q()&&this.set_$5Q(null);this.get_$Em()&&this.set_$Em(null);this.get_$OV()&&this.set_$OV(!1);this.get_$ow()&&this.set_$ow(!1);this.get_$1LT()&&this.set_$1LT(!1);this.get_$EW()&&this.set_$EW(null);this.get_$1ZN()&&this.set_$1ZN(!1);this.get_$T9()&&this.set_$T9(null);this.get_$1TS()&&this.set_$1TS(!1);this.get_$1Ll()&&this.set_$1Ll(!1);this.get_$j0()&&this.set_$j0(null);this.get_$9i()&&this.set_$9i(null);_js.$9.$o(this.get_$h4())||this.set_$h4(null);this.get_$a9()&&this.set_$a9(!1);_js.$9.$o(this.get_$l4())||this.set_$l4(null);_js.$9.$o(this.get_$h0())||this.set_$h0(null);_js.$9.$o(this.get_$eW())||this.set_$eW(null);this.get_$1xv()&&this.set_$1xv(!1);this.get_$ET()!=="Normal"&&this.set_$ET("Normal");this.get_$Qu()&&this.set_$Qu(!1);this.get_$Q8()&&this.set_$Q8(!1);this.get_$PT()&&this.set_$PT(!1);this.get_$T0()&&this.set_$T0(!1);this.get_$5ZV()&&this.set_$5ZV(null);this.get_$5O()&&this.set_$5O(null);_js.$9.$o(this.get_$3T8())||this.set_$3T8(null);this.get_$1oe()&&this.set_$1oe(!1);this.get_$1Lg()&&this.set_$1Lg(!1);this.get_$23O()&&this.set_$23O(!1);this.get_$3xz()&&this.set_$3xz(!1);this.get_$nz()&&this.set_$nz(null);_js.Trace.logInfo(_a.$0.$16,"Context reset end.")},$6T6:function(){return!!this.get_$IV().get_$9i()&&0===this.get_$IV().get_$9i().get_$RG()&&!this.get_$IV().get_$9i().get_$4bz()&&!this.get_$IV().get_$9i().get_$4e0()},$3sl:function(){var n=null;if(this.get_$5Q()&&this.get_$5Q().Mailbox&&!_js.$9.$o(this.get_$5Q().Mailbox.EmailAddress))n=this.get_$5Q().Mailbox;else if(this.get_$Em()&&this.get_$Em().Mailbox&&!_js.$9.$o(this.get_$Em().Mailbox.EmailAddress))n=this.get_$Em().Mailbox;else if(!_js.$9.$o(_mcp.$V.$1h0)){n=new _g.$1K;n.EmailAddress=_mcp.$V.$1h0;n.MailboxType="Mailbox";n.RoutingType="SMTP"}return n},$6Tl:function(){if(!_a.$b.$43)return!1;switch(this.get_$6X()){case 0:case 1:case 2:case 3:case 4:break;default:return!1}return this.get_$j0()&&!this.$6Tk(this.get_$j0())?!1:this.get_$IV()&&!this.$6Tk(this.get_$IV())?!1:_js.$9.$o(this.get_$37U())?!0:!1},$6Tk:function(n){if(_js.$9.$o(n.get_$CK())||n.get_$CK()==="IPM.Note"||n.get_$Mk())return!0;else{var i=this.get_$6X()===1||this.get_$6X()===2;var t=i||this.get_$6X()===3;return i&&(n.get_$CK().startsWith("IPM.Schedule.Meeting")||n.get_$CK().startsWith("IPM.Appointment"))?!0:t&&n.get_$CK().startsWith("REPORT.IPM.Note")?!0:t&&n.get_$CK().startsWith("IPM.Note.Rules")?!0:t&&n.get_$CK()==="IPM.Post"?!0:!1}},$9wS:function(n){_js.Trace.logInfo(_a.$0.$53,"Updating S/MIME options...");if(_a.$b.$43)switch(n){case 6:this.set_$PT(!0);this.set_$T0(!1);break;case 10:case 11:this.set_$PT(!1);this.set_$T0(!0);break;case 12:case 13:case 14:this.set_$PT(!0);this.set_$T0(!0);break;case-1:case 0:default:this.set_$PT(!1);this.set_$T0(!1);break}},$Ez1:function(n){_js.Trace.logInfo(_a.$0.$53,"Upgrading S/MIME options...");if(_a.$b.$43)switch(n){case 6:this.set_$PT(!0);break;case 10:case 11:this.set_$T0(!0);break;case 12:case 13:case 14:this.set_$PT(!0);this.set_$T0(!0);break;case-1:case 0:default:break}},$7CU:function(){if(this.get_$dn()){var t=!1;var n=this;this.$6uP=function(i){if(!t&&n.get_$dn()){_y.$2F.$1G(n.get_$dn(),null,i);n.set_$dn(null);t=!0}}}},$4p8:function(n,t){var i=this.get_$5ZV();if(!i||!i.length)return null;$C(n)&&(n=0);$C(t)&&(t=i.length);for(var r=new(_ff.$18.$$(String)),h=n;h<n+t;h++){var s=i[h];if(s&&s.length)for(var a=s,v=a.length,f=0;f<v;++f){var u=a[f];_js.$9.$o(u)||r.$5l(u)||r.$F(u)}}if(n+t<i.length){var o=i[i.length-1];if(o&&o.length>0)for(var l=o,y=l.length,e=0;e<y;++e){var c=l[e];_js.$9.$o(c)||r.$5l(c)||r.$F(c)}}return r.get_$A()>0?r.get_$1y():null},$9i4:function(n,t){t.val=$C(t.val)?!1:t.val;n.set_$3o(this.get_$3o());n.set_$Bv(this.get_$Bv());n.set_$y(this.get_$Fd());n.set_$1m(new(_a.$2T.$$(_g.Attachment,_g.$Bg)));if(this.get_$s0()){var o=_g.$O.get_$Q().get_$VV().ClearSign;n.set_$CK(this.get_$PT()?"IPM.Note.SMIME":o?"IPM.Note.SMIME.MultipartSigned":"IPM.Note.SMIME");n.get_$CK()==="IPM.Note.SMIME.MultipartSigned"?n.set_$4n(this.$7ff(t.val)):n.set_$4n(new _g.$5E(new _g.$5d(this.get_$6P(),"")));var e=_a.$5u.$Jh(this.get_$9ml());n.set_$c5(new _g.$Wi(e))}else{n.set_$4n(this.$7ff(t.val));(this.get_$j0()&&this.get_$j0().get_$Mk()||this.get_$IV()&&this.get_$IV().get_$Mk())&&n.set_$CK("IPM.Note");this.get_$EW()&&n.get_$1m().$3y(this.get_$EW().$3Q())}n.set_$9i(this.get_$9i());n.set_$ET(this.get_$ET());n.set_$a9(this.get_$a9());n.set_$h0(this.get_$h0());n.set_$eW(this.get_$eW());n.set_$l4(this.get_$l4());n.set_$uM(this.get_$uM());n.set_$r3(this.get_$r3());n.set_$178(this.get_$178());if(this.get_$nz()){n.set_$Pp(new(_a.$2T.$$(_g.$HL,_g.$Bm)));n.get_$Pp().$3y(this.get_$nz().$3Q())}if(_g.$5w.isInstanceOfType(n)){var i=n;i.set_$5Q(this.get_$5Q());if(this.get_$s0()&&this.$1i1){if(this.$1i1===1){i.set_$79(new(_a.$u.$$(_g.$1K)));this.get_$79()&&i.get_$79().$3y(this.get_$79().$3Q());i.set_$7x(new(_a.$u.$$(_g.$1K)));this.get_$7x()&&i.get_$7x().$3y(this.get_$7x().$3Q())}else if(this.$1i1===2){i.set_$AN(new(_a.$u.$$(_g.$1K)));this.get_$AN()&&i.get_$AN().$F(this.get_$AN().get_$E(this.$3kv))}else if(this.$1i1===3){i.set_$AN(new(_a.$u.$$(_g.$1K)));this.get_$AN()&&i.get_$AN().$3y(this.get_$AN().$3Q())}}else{i.set_$79(new(_a.$u.$$(_g.$1K)));this.get_$79()&&i.get_$79().$3y(this.get_$79().$3Q());i.set_$7x(new(_a.$u.$$(_g.$1K)));this.get_$7x()&&i.get_$7x().$3y(this.get_$7x().$3Q());i.set_$AN(new(_a.$u.$$(_g.$1K)));this.get_$AN()&&i.get_$AN().$3y(this.get_$AN().$3Q())}i.set_$Qu(this.get_$Qu());i.set_$Q8(this.get_$Q8());i.set_$PT(this.get_$PT());i.set_$T0(this.get_$T0())}else{var u=n;u.set_$3G(this.get_$2se());var f=_g.$O.get_$Q().get_$4P();var r=null;r=_js.$9.$o(f.get_$sA())?null!==this.get_$5Q()&&this.get_$5Q().Mailbox?this.get_$5Q().Mailbox.EmailAddress:_h.$2k.$4nQ(null)||f.get_$Fv():f.get_$sA();if(r){u.set_$5Q(new _g.$8w);u.get_$5Q().Mailbox=new _g.$1K;u.get_$5Q().Mailbox.EmailAddress=r}}},$Aqy:function(n,t){this.$4("ShowMeetingReadonlyFields")},$C53:function(n){var t=this.$Dp2(n);switch(this.get_$6X()){case 0:case 4:this.set_$Fd(t);break;case 1:case 2:case 3:this.set_$14V(t);break}},$8PF:function(n){if(n.get_$Pp()){this.set_$nz(new _js.$X);this.get_$nz().$3y(n.get_$Pp().$3Q())}},$Dp2:function(n){var t=null;if(!$C(n)&&"Id"in n){t=new _g.$1T(n.Id);"ChangeKey"in n&&(t.ChangeKey=n.ChangeKey)}return t},$9tp:function(n,t){0===n.get_$106()&&n.set_$106(t&&t.get_$6P()==="Text"?1:3)},$C4r:function(n){var r=_h.$2k.$4nQ(n);if(r){this.set_$5Q(new _g.$8w);this.get_$5Q().Mailbox=new _g.$1K;this.get_$5Q().Mailbox.EmailAddress=r}this.set_$1oe(!1);this.get_$9i()&&!this.get_$9i().get_$RG()?this.set_$6P(n.get_$9i().get_$6P()):n.get_$t9()?this.set_$6P(n.get_$t9().get_$6P()):n.get_$4n()&&this.set_$6P(n.get_$4n().get_$6P());switch(this.get_$6X()){case 1:case 2:case 12:this.$4Wq(n);if(_g.$5w.isInstanceOfType(n)){var t=n;t.get_$SB()?this.$2AN(t.get_$5Q()||t.get_$Em(),null,null,null):this.$2AN(t.get_$5Q()||t.get_$Em(),t.get_$79()?t.get_$79().get_$7V():null,t.get_$7x()?t.get_$7x().get_$7V():null,t.get_$5Mv()?t.get_$5Mv().get_$7V():null);this.set_$3yb(this.get_$6X()===2&&n.get_$52c()&&!t.get_$8UM());this.set_$5Gn(n.get_$2gT())}else if(_g.$L6.isInstanceOfType(n)){var u=n;this.$2AN(u.get_$5Q()||u.get_$Em(),null,null,null)}this.$71O(n);break;case 5:case 6:case 7:if(_g.$5w.isInstanceOfType(n)){var i=n;this.$2AN(i.get_$5Q()||i.get_$Em(),i.get_$79()?i.get_$79().get_$7V():null,i.get_$7x()?i.get_$7x().get_$7V():null,i.get_$5Mv()?i.get_$5Mv().get_$7V():null)}break;case 3:_g.$Mf.isInstanceOfType(n)||this.$4Wq(n);this.set_$5Gn(n.get_$2gT());this.$7Tw();this.$71O(n);break;case 9:case 10:_g.$5w.isInstanceOfType(n)?this.$2AN(n.get_$Em(),null,null,null):_g.$L6.isInstanceOfType(n)&&this.$2AN(n.get_$Em(),null,null,null);this.$71O(n);break;default:this.$9qG();break}_js.Trace.logInfo(_a.$0.$16,"Initialized context with original email message, context:"+this.toString())},$C4o:function(n){this.set_$14V(n.get_$y());var i=this.$6T6();this.set_$9i(i?null:n.get_$9i());this.$EZM(n.get_$14H());this.set_$ET(n.get_$ET());this.set_$dp(this.get_$dp()||"");this.get_$9i()&&!this.get_$9i().get_$RG()?this.set_$6P(this.get_$9i().get_$6P()):n.get_$t9()?this.set_$6P(n.get_$t9().get_$6P()):this.set_$6P(n.get_$106()===1?"Text":"HTML");if(!this.get_$OV()){this.set_$OV(!(this.get_$6X()===1||this.get_$6X()===2||this.get_$6X()===3||this.get_$6X()===12));this.get_$6X()!==3||_a.$b.$43&&n.get_$Mk()||i||this.get_$9i()&&this.get_$9i().get_$RG()||this.set_$EW(n.get_$1m()?n.get_$1m().get_$7V():null)}if(_g.ICalendaring.isInstanceOfType(n)){var t=n;t.$5Vo();this.$C4q(t)}else if(_g.$5w.isInstanceOfType(n)||_g.$L6.isInstanceOfType(n)){if(3===this.get_$6X()&&!this.get_$OV()){this.set_$Bv(n.get_$Bv());_js.Trace.logInfo(_a.$0.$16,"Setting importance to "+this.get_$Bv()+" since we are forwarding item "+_h.$D1.$1d1(n.get_$y())+" with that importance")}this.$C4r(n)}else throw Error.invalidOperation(String.format("Original item of type {0} is not supported.",Object.getType(n).getName()));this.$9tj();_g.$5w.isInstanceOfType(n)&&n.$22M?this.set_$rt(!1):this.set_$rt(!0)},$Bnm:function(n){var t=null;_g.$Mg.isInstanceOfType(n)||_g.$Go.isInstanceOfType(n)?t=n.get_$5Q():n.get_$MD()?t=n.get_$MD():_js.Trace.logError(_a.$0.$16,"ICalendaring doesnt have an organizer");return t},$9tj:function(){var n=new(_ff.$18.$$(String));this.get_$23R()&&n.$3y(_g.$9y.$6Gm(this.get_$EW()));if(this.$8Q&&_a.$b.$43&&this.$8Q.get_$Mk()&&this.$8Q.get_$3G0()){var t=this.$8Q.get_$1m().get_$E(0).get_$6J().Id;n.$F(t)}this.set_$2E8(n.$3Q())},$C4q:function(n){this.set_$1oe(!0);n.get_$4n()&&this.set_$6P(n.get_$4n().get_$6P());var r=this.$Bnm(n);var t;var i;if(_g.$Mg.isInstanceOfType(n)||_g.$Go.isInstanceOfType(n)){t=n.get_$79()?_g.$1Z.$3oW(n.get_$79().get_$7V()):null;i=n.get_$7x()?_g.$1Z.$3oW(n.get_$7x().get_$7V()):null}else{t=n.get_$Bm()?_g.$1Z.$3oW(_g.$2o.$7K5(n.get_$Bm().get_$7V())):null;i=n.get_$DH()?_g.$1Z.$3oW(_g.$2o.$7K5(n.get_$DH().get_$7V())):null}switch(this.get_$6X()){case 1:case 2:this.$2AN(r,t,i,null);break;case 5:case 6:case 7:this.$2AN(r,t,i,null);this.$4cj(n);this.set_$3uZ(!0);break;case 8:var u=n.get_$Bm().$4o();u.$3y(n.get_$EP().$3Q());t=_g.$1Z.$3oW(_g.$2o.$7K5(u.get_$7V()));this.$2AN(r,t,i,null);this.$4cj(n);this.set_$3uZ(!0);break;case 3:if(_g.$9y.isInstanceOfType(n)||_g.$2g.isInstanceOfType(n)){this.set_$23R(!0);this.set_$5Q(r);this.$4cj(n)}break;default:this.$9qG();break}this.set_$oy(!0);_js.Trace.logInfo(_a.$0.$16,"Initialized context from original calendar item, context:"+this.toString())},$4cj:function(n){this.set_$1pY(_cc.$86.$AtA(n));this.set_$6E(n.get_$6E());this.set_$3Fs(!!this.get_$6E()&&!_js.$9.$o(this.get_$6E().get_$26()))},$EZM:function(n){var t="";switch(this.get_$6X()){case 1:case 2:case 12:t=_u.Strings.l_ReplyPrefix_Text;break;case 3:t=_nbs.NonBootStrings.l_ForwardPrefix_Text;break;case 5:t=_nbs.NonBootStrings.l_AcceptPrefix_Text;break;case 6:t=_nbs.NonBootStrings.l_TentativelyAcceptPrefix_Text;break;case 7:t=_nbs.NonBootStrings.l_DeclinePrefix_Text;break;case 8:t=_nbs.NonBootStrings.l_CanceledMeetingMessagePrefix_Text;break;case 9:t=_nbs.NonBootStrings.l_ApprovePrefix_Text;break;case 10:t=_nbs.NonBootStrings.l_RejectPrefix_Text;break}this.get_$2MC()&&(t=_nbs.NonBootStrings.l_NewTimeProposedPrefix_Text);var i=String.format(_nbs.NonBootStrings.l_SubjectFormat_Text,t,n);_js.Trace.logInfo(_a.$0.$16,"Formatted subject with Prefix="+t+"; Operation="+this.get_$6X());if(255<i.length){this.set_$3o(i.substr(0,255));_js.Trace.logInfo(_a.$0.$16,"Truncated subject from "+i+" to "+this.get_$3o()+" to meet the "+255+" characters rule.")}else this.set_$3o(i)},$71O:function(n){this.set_$5O(n.get_$5O());_g.$5w.isInstanceOfType(n)?this.set_$3T8(n.get_$HS()):_g.$L6.isInstanceOfType(n)&&this.set_$3T8(n.get_$HS())},$9qG:function(){var n=_js.$1I.$Gy(_y.$1m,this.get_$6X());throw Error.invalidOperation(String.format("Cannot perform operation {0} with original item.",n));},$4Wq:function(n){this.set_$a9(n.get_$a9());this.set_$l4(n.get_$l4());this.set_$h0(n.get_$h0());this.set_$eW(n.get_$eW());this.set_$1xv(n.get_$1xv())},$7ff:function(n){return n?this.$7hV():this.$7fg()},$7hV:function(){var n=new _g.$5E(new _g.$5d("HTML",""));n.set_$1Z("");if(4!==this.get_$6X()&&13!==this.get_$6X()||this.get_$NE()){_js.Trace.logInfo(_a.$0.$16,"Create new body for action email message, setting body type to context body type: "+this.get_$6P());n.set_$6P(this.get_$6P())}else{_js.Trace.logInfo(_a.$0.$16,"Create new body for action email message, setting body type to text due to lack of support for RichTextEditor.");n.set_$6P("Text")}return n},$7Tw:function(){if(_y.$z.$1Q.get_$lN()){var t=this.$3sl();if(t){var i=!1;if(this.get_$7x())for(var n=0;n<this.get_$7x().get_$A();n++){var r=this.get_$7x().get_$E(n);if(t.EmailAddress.toLowerCase()===r.EmailAddress.toLowerCase()){i=!0;break}}if(!i){this.get_$7x()||this.set_$7x(new _js.$X);this.get_$7x().$F(t);_js.Trace.logInfo(_a.$0.$16,"Adding self to CC")}}else _js.Trace.logError(_a.$0.$16,"Could not add self to CC as the address was missing")}}};_mcp.$uh=function(n){this.$1vH={};this.$Xj=n};_mcp.$uh.prototype={$Xj:null,$1EM:function(n){return n in this.$1vH},$9iJ:function(n,t){if(n in this.$1vH){var i=this.$1vH[n];!i.$5Wp&&t&&(this.$1vH[n]=new _mcp.$w4(t))}else this.$1vH[n]=new _mcp.$w4(t)},$7lt:function(n,t){var u=n.$v;var i=u.$c;var r=i.get_$D1();var o=i.get_$Fd();var f=!1;if(i.get_$23O())_js.Trace.logInfo(_a.$0.$16,"Not discarding a loaded draft for context "+r);else if(i.get_$1TS())_js.Trace.logInfo(_a.$0.$16,"Not discarding an explicitly saved draft for context "+r);else if(u.get_$1Ng().get_$C9k())_js.Trace.logInfo(_a.$0.$16,"Not discarding a draft currently being explicitly saved for context "+r);else if(u.get_$iH().get_$m1())_js.Trace.logInfo(_a.$0.$16,"Not discarding a draft currently being sent for context "+r);else{var e=!1;if(t)_js.Trace.logInfo(_a.$0.$16,"Skipping dirty check for context "+r);else{_js.Trace.logInfo(_a.$0.$16,"Checking dirty for determining whether to discard unused message on navigate away. Context:"+i.toString());e=u.$IO()}if(e)_js.Trace.logInfo(_a.$0.$16,"Not discarding a dirty draft for context "+r);else if(i.$jW)if(i.$jW.$5b(i.get_$T9())){if(_g.$1H.$Yw&&i.get_$1Ll()&&!i.get_$Fd()){_js.Trace.logInfo(_a.$0.$16,"Calling main window to remember the pending discard for context "+r);_g.$1H.$Yw.$9iJ(r,!i.get_$1TS());f=!0}else if(!i.get_$1El()){_js.Trace.logInfo(_a.$0.$16,"Discarding unused draft for context "+r);this.$5yw(r,o,u.$n,i.get_$1TS());f=!0}}else _js.Trace.logInfo(_a.$0.$16,"Not discarding a draft different from the initial baseline for context "+r);else _js.Trace.logInfo(_a.$0.$16,"Not discarding without an initial baseline for context "+r)}return f},$5yw:function(n,t,i,r){i||(i=new _mcp.$ug(new _bc.$3e));var u;if(this.$1vH[n]){var e=this.$1vH[n];u=e.$5Wp}else u=!r;if(t){var f=this.$Xj.$AMb(t,u);i.$tE(f,null,null,null);delete this.$1vH[n];_js.Trace.logInfo(_a.$0.$16,"Delete action submitted, ID={0}, Changekey={1}, isHardDelete={2}",t.Id,t.ChangeKey,u)}else{this.$1vH[n]=new _mcp.$w4(u);_js.Trace.logInfo(_a.$0.$16,"Discard pending because we do not have the draft ID yet. ContextId="+n+"; Hard="+u)}},$AWw:function(n,t){this.$5yw(n,t,new _mcp.$ug(new _bc.$3e),!1)}};_mcp.$1W=function(){_mcp.$1W.initializeBase(this)};_mcp.$1W.$$cctor=function(){_mcp.$1W.$2aq.set_$Qz(_mcp.$1W.$4cK);_mcp.$1W.$2Es.set_$Qz(_mcp.$1W.$4cK);_mcp.$1W.$2EB.set_$Qz(_mcp.$1W.$4cK);_mcp.$1W.$2E4.set_$Qz(new _a.$CA(_g.Attachment));_mcp.$1W.$2Hu.set_$Qz(new _a.$CA(_g.$HL))};_mcp.$1W.$33t=function(n){var t=new _mcp.$1W;_mcp.$1W.$2W(t,n);return t};_mcp.$1W.$2W=function(n,t){n.set_$3o(t.get_$3o());n.set_$MW(t.get_$MW());if(t.get_$79()){n.set_$79(new _js.$X);n.get_$79().$3y(t.get_$79().$3Q())}else n.set_$79(null);n.set_$10y(t.get_$10y());if(t.get_$7x()){n.set_$7x(new _js.$X);n.get_$7x().$3y(t.get_$7x().$3Q())}else n.set_$7x(null);n.set_$xt(t.get_$xt());if(t.get_$AN()){n.set_$AN(new _js.$X);n.get_$AN().$3y(t.get_$AN().$3Q())}else n.set_$AN(null);if(t.get_$EW()){n.set_$EW(new _js.$X);n.get_$EW().$3y(t.get_$EW().$3Q())}else n.set_$EW(null);if(t.get_$nz()){n.set_$nz(new _js.$X);n.get_$nz().$3y(t.get_$nz().$3Q())}else n.set_$nz(null);n.set_$qd(t.get_$qd());n.set_$Bv(t.get_$Bv());n.set_$5Q(t.get_$5Q());n.set_$h4(t.get_$h4());n.set_$ET(t.get_$ET());n.set_$Qu(t.get_$Qu());n.set_$Q8(t.get_$Q8());n.set_$PT(t.get_$PT());n.set_$T0(t.get_$T0())};_mcp.$1W.$31u=function(n,t,i,r){if(i!==r&&!(_js.$9.$o(i)&&_js.$9.$o(r))||!_mcp.$1W.$7mJ(n,t))return!1;if($C(n)||$C(t))return!0;for(var u=0;u<n.get_$A();u++){var e=n.get_$E(u);var f=t.get_$E(u);if(!_mcp.$1W.$5lv(e,f))return!1}return!0};_mcp.$1W.$5lv=function(n,t){return $C(n)&&!$C(t)||$C(t)&&!$C(n)?!1:$C(n)&&$C(t)?!0:_g.$1Z.$5b(n,t)};_mcp.$1W.$7mJ=function(n,t){var r=_mcp.$1W.$8Dx(n);var i=_mcp.$1W.$8Dx(t);return r===i};_mcp.$1W.$8Dx=function(n){return $C(n)?0:n.get_$A()};_mcp.$1W.$7WG=function(n,t){if(!_mcp.$1W.$7mJ(n,t))return!1;if(!n||!t)return!0;for(var i=0;i<n.get_$A();i++){var u=n.get_$E(i);var r=t.get_$E(i);if(!_mcp.$1W.$A7Z(u,r))return!1}return!0};_mcp.$1W.$A7U=function(n,t){return _h.$Ud.$7WI(n,t)};_mcp.$1W.$A7Z=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:!n.get_$6J()&&t.get_$6J()||!t.get_$6J()&&n.get_$6J()?!1:n.get_$6J()&&n.get_$6J().Id!==t.get_$6J().Id?!1:n.get_$1x()!==t.get_$1x()?!1:n.get_$KN()!==t.get_$KN()?!1:n.get_$SF()!==t.get_$SF()?!1:n.get_$4WV()!==t.get_$4WV()?!1:n.get_$8D()!==t.get_$8D()?!1:!n.get_$Jq()&&t.get_$Jq()||!t.get_$Jq()&&n.get_$Jq()?!1:n.get_$Jq()&&!n.get_$Jq().$5b(t.get_$Jq())?!1:n.get_$CA()!==t.get_$CA()?!1:!0};_mcp.$1W.prototype={get_$3o:function(){return this.$w(_mcp.$1W.$qH)},set_$3o:function(n){this.$P(_mcp.$1W.$qH,n);return n},get_$MW:function(){return this.$w(_mcp.$1W.$38L)},set_$MW:function(n){this.$P(_mcp.$1W.$38L,n);return n},get_$79:function(){return this.$w(_mcp.$1W.$2aq)},set_$79:function(n){this.$P(_mcp.$1W.$2aq,n);return n},get_$10y:function(){return this.$w(_mcp.$1W.$3dI)},set_$10y:function(n){this.$P(_mcp.$1W.$3dI,n);return n},get_$7x:function(){return this.$w(_mcp.$1W.$2Es)},set_$7x:function(n){this.$P(_mcp.$1W.$2Es,n);return n},get_$xt:function(){return this.$w(_mcp.$1W.$342)},set_$xt:function(n){this.$P(_mcp.$1W.$342,n);return n},get_$AN:function(){return this.$w(_mcp.$1W.$2EB)},set_$AN:function(n){this.$P(_mcp.$1W.$2EB,n);return n},get_$qd:function(){return this.$w(_mcp.$1W.$32n)},set_$qd:function(n){this.$P(_mcp.$1W.$32n,n);return n},get_$Bv:function(){return this.$w(_mcp.$1W.$3Gg)},set_$Bv:function(n){this.$P(_mcp.$1W.$3Gg,n);return n},get_$5Q:function(){return this.$w(_mcp.$1W.$2Ie)},set_$5Q:function(n){this.$P(_mcp.$1W.$2Ie,n);return n},get_$h4:function(){return this.$w(_mcp.$1W.$34Z)},set_$h4:function(n){this.$P(_mcp.$1W.$34Z,n);return n},get_$ET:function(){return this.$w(_mcp.$1W.$3XK)},set_$ET:function(n){this.$P(_mcp.$1W.$3XK,n);return n},get_$Qu:function(){return this.$w(_mcp.$1W.$3I6)},set_$Qu:function(n){this.$P(_mcp.$1W.$3I6,n);return n},get_$Q8:function(){return this.$w(_mcp.$1W.$3JS)},set_$Q8:function(n){this.$P(_mcp.$1W.$3JS,n);return n},get_$PT:function(){return this.$w(_mcp.$1W.$3bQ)},set_$PT:function(n){this.$P(_mcp.$1W.$3bQ,n);return n},get_$T0:function(){return this.$w(_mcp.$1W.$3bT)},set_$T0:function(n){this.$P(_mcp.$1W.$3bT,n);return n},get_$EW:function(){return this.$w(_mcp.$1W.$2E4)},set_$EW:function(n){this.$P(_mcp.$1W.$2E4,n);return n},get_$nz:function(){return this.$w(_mcp.$1W.$2Hu)},set_$nz:function(n){this.$P(_mcp.$1W.$2Hu,n);return n},$7oV:function(n){if(this.get_$Bv()!==n.get_$Bv()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to importance: snapshotImportance={0}, contextImportance={1}",this.get_$Bv(),n.get_$Bv());return!1}if(this.get_$3o()!==n.get_$3o()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to subject: snapshotSubjectLength={0}, contextSubjectLength={1}",$C(this.get_$3o())?0:this.get_$3o().length,$C(n.get_$3o())?0:n.get_$3o().length);return!1}if(this.get_$h4()!==n.get_$h4()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to compliance ID: snapshotId={0}, contextId={1}",this.get_$h4(),n.get_$h4());return!1}if(this.get_$ET()!==n.get_$ET()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to sensitivity: snapshot={0}, context={1}",this.get_$ET(),n.get_$ET());return!1}if(this.get_$Qu()!==n.get_$Qu()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to IsDeliveryReceiptRequested: snapshot={0}, context={1}",this.get_$Qu(),n.get_$Qu());return!1}if(this.get_$Q8()!==n.get_$Q8()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to IsReadReceiptRequested: snapshot={0}, context={1}",this.get_$Q8(),n.get_$Q8());return!1}if(this.get_$PT()!==n.get_$PT()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to SmimeEncryptMessage: snapshot={0}, context={1}",this.get_$PT(),n.get_$PT());return!1}if(this.get_$T0()!==n.get_$T0()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to SmimeSignMessage: snapshot={0}, context={1}",this.get_$T0(),n.get_$T0());return!1}var i=this.get_$5Q()?this.get_$5Q().Mailbox:null;var t=n.get_$5Q()?n.get_$5Q().Mailbox:null;if(!_mcp.$1W.$5lv(i,t)){_js.Trace.logInfo(_a.$0.$16,"Dirty due to From: snapshotFrom={0}, contextFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.$1W.$31u(this.get_$79(),n.get_$79(),this.get_$10y(),n.get_$10y())){_js.Trace.logInfo(_a.$0.$16,"Dirty due to To: snapshotToCout={0}, contextToCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$C(this.get_$79())?0:this.get_$79().get_$A(),$C(n.get_$79())?0:n.get_$79().get_$A(),$C(this.get_$10y())?0:this.get_$10y().length,$C(n.get_$10y())?0:n.get_$10y().length);return!1}if(!_mcp.$1W.$31u(this.get_$7x(),n.get_$7x(),this.get_$xt(),n.get_$xt())){_js.Trace.logInfo(_a.$0.$16,"Dirty due to To: snapshotCcCout={0}, contextCcCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$C(this.get_$7x())?0:this.get_$7x().get_$A(),$C(n.get_$7x())?0:n.get_$7x().get_$A(),$C(this.get_$xt())?0:this.get_$xt().length,$C(n.get_$xt())?0:n.get_$xt().length);return!1}if(!_mcp.$1W.$31u(this.get_$AN(),n.get_$AN(),this.get_$qd(),n.get_$qd())){_js.Trace.logInfo(_a.$0.$16,"Dirty due to To: snapshotBccCout={0}, contextBccCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$C(this.get_$AN())?0:this.get_$AN().get_$A(),$C(n.get_$AN())?0:n.get_$AN().get_$A(),$C(this.get_$qd())?0:this.get_$qd().length,$C(n.get_$qd())?0:n.get_$qd().length);return!1}if(!_mcp.$1W.$7WG(this.get_$EW(),n.get_$EW())){_js.Trace.logInfo(_a.$0.$16,"snapshotAttachmentCount="+(this.get_$EW()?this.get_$EW().get_$A():0)+", contextAttachmentCount="+(n.get_$EW()?n.get_$EW().get_$A():0));return!1}if(!_mcp.$1W.$A7U(this.get_$nz(),n.get_$nz())){_js.Trace.logInfo(_a.$0.$16,"snapshotExtendedPropertyCount="+(this.get_$nz()?this.get_$nz().get_$A():0)+", contextExtendedPropertyCount="+(n.get_$nz()?n.get_$nz().get_$A():0));return!1}if(this.get_$MW()!==n.get_$MW()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to editor content: snapshotContentLength={0}, contextContentLength={1}",$C(this.get_$MW())?0:this.get_$MW().length,$C(n.get_$MW())?0:n.get_$MW().length);return!1}_js.Trace.logInfo(_a.$0.$16,"Context is clean");return!0},$5b:function(n){if(!n){_js.Trace.logInfo(_a.$0.$16,"Comparing with a null snapshot, this case is always considered equal.");return!0}if(this.get_$Bv()!==n.get_$Bv()){_js.Trace.logInfo(_a.$0.$16,"sourceImportance={0}, targetImportance={1}",this.get_$Bv(),n.get_$Bv());return!1}if(this.get_$3o()!==n.get_$3o()){_js.Trace.logInfo(_a.$0.$16,"sourceSubject={0}, targetSubject={1}",this.get_$3o(),n.get_$3o());return!1}if(this.get_$h4()!==n.get_$h4()){_js.Trace.logInfo(_a.$0.$16,"sourceComplianceId={0}, targetComplianceId={1}",this.get_$h4(),n.get_$h4());return!1}if(this.get_$ET()!==n.get_$ET()){_js.Trace.logInfo(_a.$0.$16,"sourceSensitivity={0}, targetSensitivity={1}",this.get_$ET(),n.get_$ET());return!1}if(this.get_$Qu()!==n.get_$Qu()){_js.Trace.logInfo(_a.$0.$16,"sourceIsDeliveryReceiptRequested={0}, targetIsDeliveryReceiptRequested={1}",this.get_$Qu(),n.get_$Qu());return!1}if(this.get_$Q8()!==n.get_$Q8()){_js.Trace.logInfo(_a.$0.$16,"sourceIsReadReceiptRequested={0}, targetIsReadReceiptRequested={1}",this.get_$Q8(),n.get_$Q8());return!1}var i=this.get_$5Q()?this.get_$5Q().Mailbox:null;var t=n.get_$5Q()?n.get_$5Q().Mailbox:null;if(!_mcp.$1W.$5lv(i,t)){_js.Trace.logInfo(_a.$0.$16,"sourceFrom={0}, targetFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.$1W.$31u(this.get_$79(),n.get_$79(),this.get_$10y(),n.get_$10y())){_js.Trace.logInfo(_a.$0.$16,"sourceToCout={0}, targetToCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$79()?this.get_$79().get_$A():0,n.get_$79()?n.get_$79().get_$A():0,this.get_$10y(),n.get_$10y());return!1}if(!_mcp.$1W.$31u(this.get_$7x(),n.get_$7x(),this.get_$xt(),n.get_$xt())){_js.Trace.logInfo(_a.$0.$16,"sourceCcCout={0}, targetCcCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$7x()?this.get_$7x().get_$A():0,n.get_$7x()?n.get_$7x().get_$A():0,this.get_$xt(),n.get_$xt());return!1}if(!_mcp.$1W.$31u(this.get_$AN(),n.get_$AN(),this.get_$qd(),n.get_$qd())){_js.Trace.logInfo(_a.$0.$16,"sourceBccCout={0}, targetBccCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$AN()?this.get_$AN().get_$A():0,n.get_$AN()?n.get_$AN().get_$A():0,this.get_$qd(),n.get_$qd());return!1}if(!_mcp.$1W.$7WG(this.get_$EW(),n.get_$EW())){_js.Trace.logInfo(_a.$0.$16,"sourceAttachmentCount="+(this.get_$EW()?this.get_$EW().get_$A():0)+", targetAttachmentCount="+(n.get_$EW()?n.get_$EW().get_$A():0));return!1}if(this.get_$MW()!==n.get_$MW()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to editor content: snapshotContentLength={0}, snapshotContentLength={1}",this.get_$MW()?this.get_$MW().length:0,n.get_$MW()?n.get_$MW().length:0);return!1}_js.Trace.logInfo(_a.$0.$16,"snapshot is clean");return!0}};_mcp.$1LB=function(n,t){this.$$d_$Ao7=Function.createDelegate(this,this.$Ao7);if($C(n))throw Error.argumentNull("callback");if(t<=3e3)throw Error.argumentOutOfRange("timeoutPeriod");this.$1iD=t;this.$8E=n};_mcp.$1LB.prototype={$1iD:0,$8E:null,$1Z6:null,$4yk:!0,$1T:function(){!this.$1Z6&&this.$4yk&&(this.$1Z6=_js.$D.get_$Q().$2V(_a.$0.$16,"MailComposeTimer",this.$$d_$Ao7,this.$1iD))},$37Z:function(){_js.Trace.logInfo(_a.$0.$16,"Disabling timer.");this.$4yk=!1;this.$1u()},$1u:function(){if(this.$1Z6){_js.Trace.logInfo(_a.$0.$16,"Clearing timer.");this.$1Z6=_js.$D.get_$Q().$6Q(this.$1Z6)}},$Ao7:function(){_js.Trace.logInfo(_a.$0.$16,"Executing timer callback.");this.$1u();this.$8E()}};_mcp.$8n=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt){this.$$d_$DNE=Function.createDelegate(this,this.$DNE);this.$$d_$94I=Function.createDelegate(this,this.$94I);this.$$d_$7dQ=Function.createDelegate(this,this.$7dQ);this.$$d_$Dmb=Function.createDelegate(this,this.$Dmb);this.$$d_$4tV=Function.createDelegate(this,this.$4tV);_mcp.$8n.resolveInheritance();this.apcl=this.$p;this.rpcl=this.$1B;this.dispose=this.$1v;_mcp.$8n.initializeBase(this);_a.$4.$z(k,"nativeBridge");this.$1sd=4;this.$c=n;this.$2F=t||new _bc.$3e;this.$2F.set_$cD(nt);this.$1d=this.$1aw();this.$j3=i;this.$9M=r;this.$1D3=u;this.$n=new _mcp.$ug(this.$2F);this.$3WB=f;this.$2TL=s;this.$4x=e;this.$I=o;this.$Lx=h;this.$Le=c;this.$N=l;this.$3Y=v;this.$N6=p;this.$F1=a;this.$2Y=w;this.$l7=b;this.$1D=y;this.$l=k;this.$2zk=d;this.$Xj=g;this.$6R=nt;this.$mc=tt;this.$WK=it;this.$16L=rt;this.$11c=ut;this.$tx=ft;this.$1tw=et;this.$sv=ot;this.$39Y=st;this.$2ZP=ht;this.$CY=ct;this.$F4=lt;if(o){var at=o;this.$sY=at.$$d_$Az||(at.$$d_$Az=Function.createDelegate(at,at.$Az))}this.$6R||(this.$3yV=!0);this.$I&&this.$I.get_$U()==="Mouse"&&this.$CIo();_js.Trace.logInfo(_a.$0.$16,"ViewModel created")};_mcp.$8n.$Att=function(){return+new Date+":"+Math.random()};_mcp.$8n.prototype={$j3:null,$c:null,$9M:null,$1D3:null,$3WB:null,$4x:null,$2TL:null,$2F:null,$I:null,$3Y:null,$N6:null,$Lx:null,$N:null,$Le:null,$1D:null,$l:null,$2Y:null,$F4:null,$2zk:null,$Xj:null,$16L:null,$11c:null,$tx:null,$6R:null,$mc:null,$1tw:null,$sv:null,$39Y:null,$l7:null,$1n:null,$n:null,$DE:null,$1d:null,$2mn:!1,$hd:!1,$5XJ:!1,$5cl:null,$5Wc:!1,$1di:!1,$J6:!0,$7DJ:!0,$F1:null,$WK:null,$1sd:0,$wJ:null,$sY:null,$3yV:!1,$5XF:!1,$26L:null,$24d:null,$2ZP:null,$CY:null,get_$8d:function(){return this.$c},set_$13C:function(n){if(this.$1d!==n){this.$1d=n;this.$4("InfoBarViewModel")}return n},get_$4IH:function(){_a.$4.$FY(this.$2ZP.get_$bt(),"MailComposeViewModel: Smime override factory has not been created");return this.$2ZP.get_$1Z()},get_$7G5:function(){return this.$1n.$5m(7).get_$7G5()},get_$2N2:function(){return this.$1n.$5m(0)},get_$5cz:function(){return this.$1n.$5m(11)},get_$2rE:function(){return this.$1n.$5m(2)},get_$AZv:function(){return this.$1n.$5m(14)},get_$eM:function(){return this.$1n.$5m(5)},get_$7eM:function(){return this.$1n.$5m(17)},get_$CMF:function(){return this.$1n.$5m(4)},get_$af:function(){return this.$1n.$5m(1)},get_$C3i:function(){return this.$1n.$5m(6)},get_$iH:function(){return this.$1n.$5m(7)},get_$1Ng:function(){return this.$1n.$5m(8)},get_$2N9:function(){return this.$1n.$5m(9)},get_$3Ma:function(){return this.$1n.$5m(10)},get_$1kA:function(){return this.$1n.$5m(18)},get_$E9M:function(){return this.$1n.$5m(20)},get_$AIA:function(){return this.$1n.$5m(3)},get_$6Xw:function(){return this.$1n.$5m(19)},get_$9Gs:function(){return this.$1n.$5m(25)},get_$5yu:function(){return this.$1n.$5m(21)},get_$39B:function(){return this.$1n.$5m(24)},get_$CIH:function(){return this.$1n.$5m(26)},get_$AZr:function(){return this.$1n.$5m(27)},get_$7Nt:function(){return this.$1n.$5m(13)},get_$Ej1:function(){return this.$1n.$5m(29)},get_$cD:function(){return this.$6R},get_$3yL:function(){return!this.$I.get_$Cp()||!!this.$6R},set_$9kP:function(n){if(this.$5XF!==n){this.$5XF=n;this.$4("ShouldShowModernAttachmentsIntroductionPeek")}return n},get_$7jE:function(){var t=this.get_$3yL();var n=new _a.$3z;n.$Ik("P",t);n.$CX("I",t?this.get_$4wI().toString():"NA");n.$CX("ET",this.$c.$2gg);return n.toString()},get_$C2d:function(){return this.get_$3yL()||this.$I.get_$lN()},set_$CEL:function(n){if(this.$3yV!==n){this.$3yV=n;this.$4("IsReadyForViewInitialization")}return n},get_$4wI:function(){return!!this.$6R},get_$2tB:function(){return this.$1sd},set_$2tB:function(n){if(this.$1sd!==n){this.$1sd=n;this.$4("PopupPanelSize")}return n},get_$3tc:function(){return this.get_$5cz()?this.get_$5cz().$$d_$3tc:this.$$d_$4tV},get_$h1:function(){return this.$DE},set_$h1:function(n){_js.Trace.logInfo(_a.$0.$16,"Shell setting ClosePopupCommand from "+(this.$DE?"non-null":"null")+" to "+(n?"non-null":"null"));this.$DE=n;return n},get_$7ly:function(){return this.$J6},set_$7ly:function(n){this.$J6=n;return n},set_$EbW:function(n){this.$7DJ=n;return n},get_$4uc:function(){return _a.UserAgent.getInstance().$22y},get_$fP:function(){return _a.UserAgent.getInstance().$YL},get_$1du:function(){return _a.UserAgent.getInstance().$zE},get_$jf:function(){return _a.UserAgent.getInstance().$a8},get_$aA:function(){return _a.UserAgent.getInstance().$Ec},get_$SA:function(){return this.$I.get_$U()==="Mouse"?0:1},get_$lN:function(){return OwaApplication.$Oy},get_$AWp:function(){return _a.UserAgent.getInstance().$6RF&&_a.UserAgent.getInstance().get_$8b()},get_$6TZ:function(){return this.$2mn},set_$6TZ:function(n){this.$2mn=n;return n},set_$8Uq:function(n){if(this.$hd!==n){this.$hd=n;this.$4("IsInView")}return n},set_$9kT:function(n){var t=this.get_$9k1();if(this.$5XJ!==t){this.$5XJ=t;this.$4("ShouldShowToolbarMessage")}return n},set_$9qv:function(n){if(this.$5cl!==n){this.$5cl=n;this.$4("ToolbarMessage")}return n},set_$EbV:function(n){var t=this.get_$9k1();if(t!==this.$5Wc){this.$5Wc=t;this.$4("ShouldBlockView")}return n},get_$1Ei:function(){return this.$1di},set_$1Ei:function(n){if(this.$1di!==n){this.$1di=n;this.$4("IsNavigatingAway")}return n},get_$9k1:function(){return this.get_$2N9()&&(this.get_$2N9().get_$3yn()||this.get_$2N9().get_$4y3())?!0:this.get_$iH()&&this.get_$iH().get_$m1()?!0:!1},get_$5za:function(){return!_a.$g.get_$CE()||_a.$g.get_$CE().toLowerCase()!=="pl-pl"},set_$5ED:function(n){this.$wJ=n;return n},set_$9BV:function(n){this.$sY=n;return n},get_$4LS:function(){return this.$c.get_$EzO()},$Dmb:function(n,t){if(this.$c.get_$s0()){this.$2xE();this.$1n.$2xE();this.$4("SmimeInvalidRecipientsDialogViewModel")}else{this.$2F5();this.$1n.$2F5();this.$4("SmimeInvalidRecipientsDialogViewModel")}},$A59:function(){this.$c.$p(_mcp.$V.$4LG,this.$$d_$Dmb)},$2xE:function(){if(this.get_$4LS()&&!this.$24d){_js.Trace.logInfo(_a.$0.$16,"Setting mail compose viewmodel override");this.$24d=this.get_$4IH().$AOe();this.$24d.$3e(this.$1d)}},$2F5:function(){if(this.$24d){this.$24d.$AV();this.$24d=null}},$3e:function(){this.$c.get_$D1()&&(this.$c.get_$23i()||this.$c.get_$3yg())||this.$c.set_$D1(_mcp.$8n.$Att());_js.Trace.logInfo(_a.$0.$16,"Init:Context:"+this.$c.toString());this.$1n||(this.$1n=new _mcp.$1Kw(this,this.$F1,this.$3Y,this.$1D,this.$N6,this.$2Y,this.$l,this.$6R,this.$WK,this.$16L,this.$11c,this.$CY));if(this.get_$4LS()){_js.Trace.logInfo(_a.$0.$16,"Creating Smime override factory");this.$5vW(this.$$d_$7dQ)}else this.$7dQ()},$5vW:function(n){_js.Trace.logInfo(_a.$0.$16,"Calling CreateSmimeOverrideFactoryAsync");var t=this;this.$2ZP.$9(function(i){_js.Trace.logInfo(_a.$0.$16,"Smime override factory created");i.$3e(t.$c,t.$N);_js.Trace.logInfo(_a.$0.$16,"Calling createFactoryCallback");n()})},$7dQ:function(){_js.Trace.logInfo(_a.$0.$16,"Completing initialization");this.$2xE();this.$A59();if(this.$1d){this.$1d.$AV();this.$N.$1p(_y.$n0,new _y.$n0);this.$c.get_$3yg()&&this.$1d.$4s(this.$c.get_$9SK(),null)}this.set_$1Ei(!1);this.$1n.$5m(0).$3e();if(!this.$6R){this.$I.remove_$Xm(this.$$d_$94I);this.$I.add_$Xm(this.$$d_$94I);_js.Trace.logInfo(_a.$0.$16,"Before unload handler has been hooked up")}},$EVh:function(n){this.set_$A2(n);_js.Trace.logInfo(_a.$0.$16,"Set screen view model appbar. ContextId="+this.$c.get_$D1())},$IX:function(){_y.$1b6.prototype.$IX.call(this);var n=this.get_$2N2();if(n.get_$G8()){_js.Trace.logInfo(_a.$0.$16,"PostTransitionIn view model, begin 2nd init since view model is already initialized");n.$7Xi()}else _js.Trace.logInfo(_a.$0.$16,"PostTransitionIn view model, not initialized yet");this.set_$8Uq(!0);_a.$6.acea(null,"VM.MailCompose.Navigate");if(this.$c.get_$3yg()&&this.$c.get_$3Fz()){var i=this.$c.get_$D1();this.$N.$1p(_y.$xN,new _y.$xN(i))}this.$I.get_$U()!=="TouchNarrow"&&this.$c.$48C&&this.$c.$48C();if(this.$I.get_$U()==="Mouse"){var t=this;_js.$D.get_$Q().$6C(_a.$0.$1m,"PreloadOwaFilePicker",function(){var n=t.$1n.$5m(5);n&&n.$Dsu()})}},$Tp:function(){_js.Trace.logInfo(_a.$0.$16,"Post transition out");this.get_$iH().get_$73j()&&(this.$c.get_$3Fz()?_a.$6.$1G(this.get_$iH().get_$73j(),"MailComposeSendClose",null,null,"SentViaNotification"):_a.$6.$1G(this.get_$iH().get_$73j(),"MailComposeSendClose",null,null,"NotSentViaNotificationDueToOtherPendingFailedAsyncSend"));this.get_$iH().get_$DOd()||this.$AV(!1);this.set_$8Uq(!1);_y.$1b6.prototype.$Tp.call(this)},$AV:function(n){_js.Trace.logInfo(_a.$0.$16,"Calling reset on the mail compose view model, context:"+this.$c.toString());this.$2F5();this.$c.$1B(_mcp.$V.$4LG,this.$$d_$Dmb);if(this.$1n){var i=this.get_$2rE();if(i){var t=i.get_$5F();if(t&&t.get_$3J7()){this.$1n.$AV();this.$c&&!n&&this.$c.$AV();this.$1d&&this.$1d.$G6.$1u();this.get_$39B()&&this.get_$39B().$65&&this.get_$39B().$65.$22Q(!1);this.$6R||this.$I.remove_$Xm(this.$$d_$94I);this.$sY=null;t.set_$3J7(!1)}else _js.Trace.logInfo(_a.$0.$16,"Conductor is either null or not navigating away from compose, skipping post transition out processing")}else _js.Trace.logInfo(_a.$0.$16,"Navigation component was null, skipping post transition out processing")}else _js.Trace.logInfo(_a.$0.$16,"Skipping post transition out processing since this instance is already reset and the component map is empty");this.$2mn=!1},$IO:function(){var t=this.$1n.$5m(5);if(t.get_$Q6()){_js.Trace.logInfo(_a.$0.$16,"Dirty due to attachment in progress");return!0}var n=this.$1n.$5m(1);n.$2zW();return this.$c.$IO()},$1aw:function(){$C(this.$1d)&&this.set_$13C(new _y.$5y);return this.$1d},$Dpf:function(){_h.$3n.$Dpd()},$E5I:function(){_h.$3n.$9PF()},$7FW:function(){this.$24d&&this.$24d.$7FW()},$Dgn:function(){this.set_$CEL(!0)},$DSU:function(){var n=new _y.$rM;this.$94I(n);return n.$1NQ},$94I:function(n){this.get_$2rE().$4WJ(n)},$6pz:function(){},$9wn:function(){this.get_$3yL()&&this.$c&&!_js.$9.$o(this.$c.get_$3o())&&!this.$6R&&(document.title=this.$c.get_$3o())},$2A:function(){_js.Trace.logInfo(_a.$0.$16,"Disposing view model, context: "+(this.$c?this.$c.toString():"null"));this.$1n&&this.$1n.$AV();this.$26L&&this.$26L.remove_$1RD(this.$$d_$DNE);_a.$1ad.prototype.$2A.call(this)},$AGt:function(){this.$26L&&this.$26L.$110(!0)},$CIo:function(){if(this.$F4&&this.$3Y&&this.$CY&&_y.$2M.$1Lc(9)&&this.$1D.$4S6(this.$CY.AttachmentDataProviderAvailable)){var n=this;this.$F4.$9(function(t){n.$26L=t.$7k(_u.Strings.l_ModernAttachments_IntroductionPeekTitle_Text,_u.Strings.l_ModernAttachments_IntroductionPeekDescription_Text,10,null,null,9);n.set_$9kP(!0);n.$26L.add_$1RD(n.$$d_$DNE);n.$26L.$1vx()})}},$DNE:function(){this.set_$9kP(!1)},$4tV:function(n,t){return t===1?!this.$7DJ:!1}};_mcp.$ur=function(n,t,i,r,u,f){this.$$d_$Bpj=Function.createDelegate(this,this.$Bpj);this.$$d_$5vN=Function.createDelegate(this,this.$5vN);this.$$d_$AQi=Function.createDelegate(this,this.$AQi);_mcp.$ur.initializeBase(this);this.$5sF=f;this.$8Q=f.$8Q;this.$2Y=n;this.$d=t;this.$5D=f.$5D;this.$7G=i;this.$Xj=r;this.$Bq=u};_mcp.$ur.prototype={$d:null,$2Y:null,$8Q:null,$5D:null,$5sF:null,$7G:null,$Xj:null,$Bq:null,$48:null,$14T:0,$3JE:!1,$4IG:null,$Ej:null,$49Q:null,$4Lj:!1,get_$5F:function(){$C(this.$48)&&(this.$48=new _y.$Cc);return this.$48},set_$5F:function(n){this.$48=n;return n},$2s7:function(n){_a.$6.stPT(_a.$0.$L1,"MailComposeReplyLoad",3);this.$4Lj=!0;this.$Ej=_y.$2F.$1g(_a.$0.$L1,"MailComposeReply",!0);this.$49Q=_y.$2F.$1g(_a.$0.$L1,"MailComposeReplyLoad",!0);this.$2Y.$7Ks("Inference.Reply",this.$8Q.get_$y(),this.$8Q.get_$5O(),this.$5D?this.$5D.get_$I6():null);this.$5Fa(1,n)},$278:function(n){_a.$6.stPT(_a.$0.$L1,"MailComposeReplyAllLoad",3);this.$4Lj=!0;this.$Ej=_y.$2F.$1g(_a.$0.$L1,"MailComposeReplyAll",!0);this.$49Q=_y.$2F.$1g(_a.$0.$L1,"MailComposeReplyAllLoad",!0);this.$2Y.$7Ks("Inference.ReplyAll",this.$8Q.get_$y(),this.$8Q.get_$5O(),this.$5D?this.$5D.get_$I6():null);this.$5Fa(2,n)},$6py:function(n){this.$2Y.$nF("Inference.PostReply",this.$8Q.get_$y());this.$5Fa(12,n)},$26w:function(n){_a.$6.stPT(_a.$0.$L1,"MailComposeForwardLoad",3);this.$4Lj=!0;this.$Ej=_y.$2F.$1g(_a.$0.$L1,"MailComposeForward",!0);this.$49Q=_y.$2F.$1g(_a.$0.$L1,"MailComposeForwardLoad",!0);this.$2Y.$7Ks("Inference.Forward",this.$8Q.get_$y(),this.$8Q.get_$5O(),this.$5D?this.$5D.get_$I6():null);this.$5Fa(3,n)},$5Em:function(n){this.$3JE=!0;this.$26w(n)},$9CP:function(){if(!this.$5sF.get_$4Uh())throw Error.invalidOperation("OnSendAgain is invoked on an item that can't be sent again. ");var t=_g.$c.$2I.nameToId("drafts");var n=new _c.$1DN(this.$8Q.get_$y().Id,t.Id);n.add_$2s(this.$$d_$AQi);n.add_$2b(this.$$d_$5vN);OwaApplication.$2B.$1V(n)},$AQi:function(n){var i=n.$26a;if(i.length>0){var t=this.$Xj.$5uX(_g.$1T.$1yX(i));t.add_$2s(this.$$d_$Bpj);t.add_$2b(this.$$d_$5vN);OwaApplication.$2B.$1V(t)}else this.$5vN(n)},$5vN:function(n){this.$5D.get_$13C().$9U(9500);this.$5D.get_$13C().$4s(9500)},$Bpj:function(n){var t=n;if(t.$Ov){this.$5D.get_$13C().$9U(9500);var i=this.$7G.$35M(t.get_$y(),!1,t.$Ov.get_$106(),t.$Ov.get_$9i());_y.$z.$1Q.get_$Cp()||i.set_$5j(0);_a.$6.acsa(_a.$0.$16,"VM.MailCompose.Navigate");this.get_$5F().$WM(i)}else this.$5vN(n)},$5Fa:function(n,t){this.$14T=n;this.$WM(t)},$WM:function(n){var u=_g.$2g.isInstanceOfType(this.$8Q);n||(n=!_y.$z.$1Q.get_$Cp());var t=this.$7G.$H5(n,!1);t.set_$2C0(this.$4Lj);n&&t.set_$5j(0);var r=null;switch(this.$14T){case 1:r=!t.get_$5j()||u?"MailComposeReplyPopOut":"MailComposeReply";break;case 2:r=!t.get_$5j()||u?"MailComposeReplyAllPopOut":"MailComposeReplyAll";break;case 3:r=!t.get_$5j()||u?"MailComposeForwardPopOut":"MailComposeForward";break;default:break}if(r&&this.$Ej){this.$Ej.$3D=r;t.set_$dn(this.$Ej);t.set_$1NG(this.$49Q);t.$7CU()}t.set_$2se(this.$8Q.get_$3G());this.$5D&&t.set_$19y(this.$5D.get_$19y());t.set_$6X(this.$14T);t.set_$Xa(!0);t.set_$1Ll(!0);t.$3JE=this.$3JE;var i=new _g.$8w;i.Mailbox=new _g.$1K;i.Mailbox.EmailAddress=this.$d.get_$4P().get_$Fv();i.Mailbox.Name=this.$d.get_$4P().get_$Lk();i.Mailbox.MailboxType="Mailbox";i.Mailbox.RoutingType="SMTP";t.set_$Em(i);if(u){var f=this.$8Q;if(f.get_$1Lb())t.$1Tj(f);else{t.set_$1oe(!0);t.set_$14V(this.$8Q.get_$y());t.set_$1Lg(_g.$2g.$1Lg(f))}}else t.$1Tj(this.$8Q);if((_g.$5w.isInstanceOfType(this.$8Q)||u)&&t.$6Tk(this.$8Q)){var o=_a.$b.get_$18m();o&&t.$Ez1(this.$8Q.get_$2y7());if(this.$8Q.get_$X8()||t.get_$s0()&&o){var e=this;this.$uP(function(n){n.$Eu8(t,e.$8Q,e.$14T)})}else{_a.$6.acsa(_a.$0.$16,"VM.MailCompose.Navigate");this.get_$5F().$WM(t)}}else{_a.$6.acsa(_a.$0.$16,"VM.MailCompose.Navigate");this.get_$5F().$WM(t)}},$uP:function(n){_js.Trace.logInfo(_a.$0.$53,"[MailResponseViewModel] Creating Smime command factory.");var t=this;this.$Bq.$9(function(i){if(!t.$4IG){_js.Trace.logInfo(_a.$0.$53,"[MailResponseViewModel] Creating SmimeMailResponseViewModelCommand instance.");t.$4IG=i.$AOk();t.$4IG.$3e(t,t.$d,function(n,t){var i=new _cc.$Dj(200,_cc.$Dj.$H5(n.get_$y(),t.get_$1Lg()));i.$99=t.get_$D1();return i},function(n,t,i){var r=new _mcp.$1Ou(n,t,i);return r.toString()})}_js.Trace.logInfo(_a.$0.$53,"[MailResponseViewModel] Executing smime operation.");n(t.$4IG)})}};_mcp.$14u=function(n,t,i,r,u){this.$2Y=n;this.$d=t;this.$7G=i;this.$Xj=r;this.$Bq=u};_mcp.$14u.prototype={$2Y:null,$d:null,$7G:null,$Xj:null,$Bq:null,$7k:function(n){return new _mcp.$ur(this.$2Y,this.$d,this.$7G,this.$Xj,this.$Bq,n)}};_mcp.$nO=function(){_mcp.$nO.initializeBase(this)};_mcp.$nO.prototype={$2XG:null,$3XJ:"Normal",$3wi:!1,$3yU:!1,$1Yg:!1,$1Yh:!1,$5ZS:!1,$5ZW:!1,$48:null,$5Yt:!1,$5go:!1,$7PL:!1,get_$EA2:function(){if($C(this.$2XG)){this.$2XG=new _js.$X;this.$2XG.$F("Normal");this.$2XG.$F("Personal");this.$2XG.$F("Private");this.$2XG.$F("Confidential")}return this.$2XG},set_$ET:function(n){if(this.$3XJ!==n){this.$3XJ=n;this.$4("Sensitivity")}return n},set_$Qu:function(n){if(this.$3wi!==n){this.$3wi=n;this.$4("IsDeliveryReceiptRequested")}return n},get_$Edq:function(){return!OwaApplication.$Oy},set_$Q8:function(n){if(this.$3yU!==n){this.$3yU=n;this.$4("IsReadReceiptRequested")}return n},get_$EfT:function(){return!OwaApplication.$Oy},set_$Efr:function(n){if(this.$5Yt!==n){this.$5Yt=n;this.$4("ShowSmimeOptions")}return n},set_$PT:function(n){if(this.$1Yg!==n){this.$1Yg=n;this.$4("SmimeEncryptMessage")}return n},set_$T0:function(n){if(this.$1Yh!==n){this.$1Yh=n;this.$4("SmimeSignMessage")}return n},set_$9mn:function(n){if(this.$5ZS!==n){this.$5ZS=n;this.$4("SmimeEncryptMessageIsEnabled")}return n},set_$9mo:function(n){if(this.$5ZW!==n){this.$5ZW=n;this.$4("SmimeSignMessageIsEnabled")}return n},set_$F0f:function(n){if(this.$7PL!==n){this.$7PL=n;this.$4("WaitingForPreviousAction")}return n},set_$5F:function(n){if(this.$48!==n){this.$48=n;this.$4("Conductor")}return n},$1Ti:function(n){this.$5go=n.get_$s0();this.set_$Efr(_a.$b.$43&&_a.$b.get_$231()&&n.$6Tl());this.set_$F0f(!1);this.set_$ET(n.get_$ET());this.set_$Qu(n.get_$Qu());this.set_$Q8(n.get_$Q8());this.set_$PT(n.get_$PT());this.set_$T0(n.get_$T0());this.set_$9mn(n.get_$9mn());this.set_$9mo(n.get_$9mo())}};_mcp.$w4=function(n){this.$5Wp=n};_mcp.$w4.prototype={$5Wp:!1};_mcp.$1NA=function(n,t){this.$2yW=n;this.$3nm=t};_mcp.$1NA.prototype={$2yW:null,$3nm:null};_mcp.$1Ou=function(n,t,i){this.$9LT=new RegExp("<","g");this.$9L9=new RegExp(">","g");this.$vN=n;this.$8Q=t;this.$14T=i};_mcp.$1Ou.prototype={$14T:0,$8Q:null,$vN:!1,toString:function(){_js.Trace.logInfo(_a.$0.$16,"Building message headers for reply/fwd. locally.");var a=this.$v7();var t=this.$8FK(!0);var r=this.$8FK(!1);r&&r.toLowerCase()!==t.toLowerCase()&&(t=String.format(_u.Strings.l_OnBehalfOf_Text,r,t));var o=this.$8Q.get_$173()||this.$8Q.get_$1Ce();var w=o?o.toString():this.$8Q.get_$Dwl();var h=this.$8JW(!0);var e=this.$8JW(!1);var i,n;var s,u;this.$Bvg(s={val:i},u={val:n}),i=s.val,n=u.val;var p=this.$2eP(_nbs.NonBootStrings.l_FromLabel_Text,t);var k=this.$2eP(_nbs.NonBootStrings.l_SentLabel_Text,w);var b=h?this.$2eP(_u.Strings.l_ToRecipientsLabel_Text,h.join("; ")):null;var y=e?this.$2eP(_u.Strings.l_CcRecipientsLabel_Text,e.join("; ")):null;var l=this.$2eP(_u.CommonStrings.l_SubjectLabel_Text,a);var c=i?this.$2eP(_u.MeetingMsgStrings.l_WhenLabel_Text,i):null;var v=n?this.$2eP(_u.MeetingMsgStrings.l_WhereLabel_Text,n):null;var f=this.$AAb(p,k,b,y,l,c,v);return this.$vN?'<p style="color:black;border-top:1pt solid #E1E1E1;padding-top:3pt;margin-bottom:13pt;font-family:Calibri,sans-serif;font-size:11pt">'+f.join("<br/>")+"</p>":String.format("________________________________________{0}{1}{0}{0}","\r\n",f.join("\r\n"))},$AAb:function(){for(var u=[],n=0;n<arguments.length;++n)u[n]=arguments[n];for(var f=new(_ff.$18.$$(String)),r=u,e=r.length,t=0;t<e;++t){var i=r[t];_js.$9.$o(i)||f.$F(i)}return f.$3Q()},$v7:function(){if(this.$8Q.get_$3o())return this.$8Q.get_$3o();else{var n;switch(this.$14T){case 1:case 2:case 12:n=_u.Strings.l_ReplyPrefix_Text;break;case 3:n=_nbs.NonBootStrings.l_ForwardPrefix_Text;break;case 5:n=_nbs.NonBootStrings.l_AcceptPrefix_Text;break;case 6:n=_nbs.NonBootStrings.l_TentativelyAcceptPrefix_Text;break;case 7:n=_nbs.NonBootStrings.l_DeclinePrefix_Text;break;case 8:n=_nbs.NonBootStrings.l_CanceledMeetingMessagePrefix_Text;break;case 9:n=_nbs.NonBootStrings.l_ApprovePrefix_Text;break;case 10:n=_nbs.NonBootStrings.l_RejectPrefix_Text;break;default:n="";break}return String.format(_nbs.NonBootStrings.l_SubjectFormat_Text,n,this.$8Q.get_$14H()||_u.Strings.l_EmptySubjectMask_Text)}},$8FK:function(n){if(_g.$5w.isInstanceOfType(this.$8Q)){var r=this.$8Q;var i=n?r.get_$5Q():r.get_$Em();return i?this.$3t3(i.Mailbox):null}else if(_g.$2g.isInstanceOfType(this.$8Q)){var t=this.$8Q;return t.get_$MD()?this.$3t3(t.get_$MD().Mailbox):null}else return null},$8JW:function(n){if(_g.$5w.isInstanceOfType(this.$8Q)){var i=this.$8Q;return this.$Bsa(n?i.get_$79():i.get_$7x())}else if(_g.$2g.isInstanceOfType(this.$8Q)){var t=this.$8Q;return this.$Bk7(n?t.get_$Bm():t.get_$DH(),n)}else return null},$Bvg:function(n,t){var i=null;var r=null;n.val=t.val=null;if(_g.$Mf.isInstanceOfType(this.$8Q)){var f=this.$8Q;i=f.get_$Q4();r=f.get_$8Ni()}else if(_g.$2g.isInstanceOfType(this.$8Q)){var u=this.$8Q;i=u;r=u}if(r){var e=new _cc.$To;n.val=e.$4L(r,null)||" "}i&&(t.val=i.get_$6E()?i.get_$6E().get_$26()||" ":" ")},$Bsa:function(n){if(!n||!n.get_$A())return null;var t=new(_ff.$18.$$(String));var i=this;n.$Cj(function(n){t.$F(i.$3t3(n))});return t.$3Q()},$Bk7:function(n,t){if(!n||!n.get_$A())return t?[this.$3t3(this.$8Q.get_$MD().Mailbox)]:null;var i=new(_ff.$18.$$(String));var r=this;n.$Cj(function(n){i.$F(r.$3t3(n.get_$AB()))});return i.$3Q()},$3t3:function(n){return n?n.Name||n.OriginalDisplayName||n.EmailAddress||"":""},$2eP:function(n,t){return this.$vN?"<b>"+n+"</b> "+this.$4CY(t):n+" "+t},$4CY:function(n){if(!n)return null;n=n.replace(this.$9LT,"&lt;");n=n.replace(this.$9L9,"&gt;");return n}};_mcp.$187=function(){};_mcp.$187.prototype={$4L:function(n,t){var r=n;var i=null;switch(r){case"Normal":i=_nbs.NonBootStrings.l_Normal_Text;break;case"Personal":i=_nbs.NonBootStrings.l_Personal_Text;break;case"Private":i=_nbs.NonBootStrings.l_Private_Text;break;case"Confidential":i=_nbs.NonBootStrings.l_Confidential_Text;break;default:i=_nbs.NonBootStrings.l_Normal_Text;break}return i},$7en:function(n,t){throw Error.notImplemented();}};_mcp.$se=function(n){_mcp.$se.initializeBase(this,[n])};_mcp.$se.prototype={$Zb:null,$DRP:function(){},$DRO:function(){},$DaK:function(n){},$DaI:function(n){},$DaJ:function(n){},$EWu:function(n){},$DaM:function(n,t){t.val=3;this.$Zb.$11();return!0}};_mcp.$1=function(){};_mcp.$1.get_$wm=function(){return _fm.$G.$9("send","x18","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$73t=function(){return _fm.$G.$9("send-hover","x18","owa","ms-font-color-neutralDark")};_mcp.$1.get_$Dsb=function(){return _fm.$G.$9("post-hover","x16","owa","ms-font-color-neutralDark")};_mcp.$1.get_$9P=function(){return _fm.$G.$9("attachment","x16","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$7Va=function(){return _fm.$G.$9("app-hero","x12","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$7Vb=function(){return _fm.$G.$9("app-hero-hover","x12","owa","ms-font-color-neutralDark")};_mcp.$1.get_$7Ws=function(){return _fm.$G.$9("attachment-hover","x16","owa","ms-font-color-neutralDark")};_mcp.$1.get_$A0=function(){return _fm.$G.$9("pop-out","x18","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$1Wb=function(){return _fm.$G.$9("pop-out-hover","x18","owa","ms-font-color-neutralDark")};_mcp.$1.get_$1Bc=function(){return _fm.$G.$9("add-small","add-small","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$11T=function(){return _fm.$G.$9("add-small-hover","add-small-hover","owa","ms-font-color-neutralDark")};_mcp.$1.get_$40b=function(){return _fm.$G.$9("lock","x16","owa","ms-font-color-neutralSecondary")};_mcp.$1.get_$5jS=function(){return _fm.$G.$9("add-circle-grey-small","x16-circle","owa","ms-border-color-neutralSecondary ms-font-color-neutralSecondary")};_mcp.$1.get_$5jT=function(){return _fm.$G.$9("add-circle-grey-small-pressed","x16-circle","owa","ms-bg-color-neutralSecondary ms-border-color-neutralSecondary ms-font-color-white")};_mcp.$mx=function(n){_mcp.$mx.initializeBase(this,[n])};_mcp.$mx.prototype={$3oa:null,$C2r:function(){this.$3oa&&_rw.$Ag.$6Lp(this.$3oa.get_$S(),this.$3oa.get_$S())},$4T:function(){_js.$7.prototype.$4T.call(this);this.$3oa=this.$u?this.$u.$1N("FromPersona"):null}};_mcp.$mz=function(n,t,i,r,u,f){this.$$d_$DwQ=Function.createDelegate(this,this.$DwQ);this.$$d_$DwR=Function.createDelegate(this,this.$DwR);this.$$d_$A65=Function.createDelegate(this,this.$A65);this.$$d_$BzB=Function.createDelegate(this,this.$BzB);this.$$d_$8L3=Function.createDelegate(this,this.$8L3);this.$$d_$8L4=Function.createDelegate(this,this.$8L4);this.$$d_$8L2=Function.createDelegate(this,this.$8L2);this.$$d_$8L5=Function.createDelegate(this,this.$8L5);this.$$d_$8L8=Function.createDelegate(this,this.$8L8);this.$$d_$BzC=Function.createDelegate(this,this.$BzC);this.$$d_$BzA=Function.createDelegate(this,this.$BzA);this.$$d_$DhP=Function.createDelegate(this,this.$DhP);this.$$d_$26p=Function.createDelegate(this,this.$26p);this.$$d_$DfG=Function.createDelegate(this,this.$DfG);this.$$d_$DdR=Function.createDelegate(this,this.$DdR);this.$$d_$DdQ=Function.createDelegate(this,this.$DdQ);this.$$d_$6o7=Function.createDelegate(this,this.$6o7);this.$$d_$DVO=Function.createDelegate(this,this.$DVO);this.$$d_$6qF=Function.createDelegate(this,this.$6qF);this.$$d_$DSK=Function.createDelegate(this,this.$DSK);this.$$d_$5Ei=Function.createDelegate(this,this.$5Ei);this.$$d_$6oo=Function.createDelegate(this,this.$6oo);this.$$d_$70B=Function.createDelegate(this,this.$70B);this.$$d_$95z=Function.createDelegate(this,this.$95z);this.$$d_$6ne=Function.createDelegate(this,this.$6ne);this.$$d_$Dad=Function.createDelegate(this,this.$Dad);this.$$d_$Dac=Function.createDelegate(this,this.$Dac);this.$$d_$DdO=Function.createDelegate(this,this.$DdO);this.$$d_$DTV=Function.createDelegate(this,this.$DTV);this.$$d_$DvK=Function.createDelegate(this,this.$DvK);this.$$d_$DvL=Function.createDelegate(this,this.$DvL);this.$$d_$7Y0=Function.createDelegate(this,this.$7Y0);this.$$d_$DxB=Function.createDelegate(this,this.$DxB);this.$$d_$4f7=Function.createDelegate(this,this.$4f7);this.$$d_$A9u=Function.createDelegate(this,this.$A9u);this.$$d_$9nZ=Function.createDelegate(this,this.$9nZ);this.$$d_$C2u=Function.createDelegate(this,this.$C2u);this.$$d_$DVQ=Function.createDelegate(this,this.$DVQ);this.$$d_$DWu=Function.createDelegate(this,this.$DWu);this.$$d_$C02=Function.createDelegate(this,this.$C02);this.$$d_$DWy=Function.createDelegate(this,this.$DWy);this.$$d_$Dmw=Function.createDelegate(this,this.$Dmw);this.$$d_$7rU=Function.createDelegate(this,this.$7rU);this.$$d_$5nj=Function.createDelegate(this,this.$5nj);this.$5q={};this.$1aq={};_mcp.$mz.initializeBase(this,[n]);this.$g3=t;this.$1E=i;this.$1D=r;this.$l=f;_js.Trace.logInfo(_a.$0.$16,"View created with layout="+this.$g3);this.$1xL=new _C(this.$$d_$5nj,_a.$0.$16);if(t==="Mouse"&&u.$2r("Water")){this.$3KD=!0;this.set_$6Ms(this.$3KD)}};_mcp.$mz.prototype={$1E:null,$1D:null,$1xL:null,$hB:null,$11h:null,$OL:null,$4H1:!1,$4yn:!1,$4uZ:!1,$4uK:!1,$g3:0,$3aj:!1,$2C5:!1,$hd:!1,$5gp:!1,$4Lh:!1,$3yW:!1,$6U2:!1,$7DG:null,$l:null,$3KD:!1,$18W:!1,$vN:!1,set_$6Ms:function(n){if(this.$18W!==n){this.$18W=n;this.$3i("InContentEditableDivMode","IsReadyToShowContentInRTE")}return n},get_$CEM:function(){return this.$3yW&&!this.$18W},set_$12N:function(n){if(this.$OL!==n){this.$OL=n;this.$Er0()}return n},get_$3z9:function(){return _y.$z.$1Q.get_$lN()?!1:this.$4yn},set_$3z9:function(n){if(this.$4yn!==n){this.$4yn=n;this.$4("IsToRecipientWellPeoplePickerButtonShown")}return n},get_$3wL:function(){return _y.$z.$1Q.get_$lN()?!1:this.$4uZ},set_$3wL:function(n){if(this.$4uZ!==n){this.$4uZ=n;this.$4("IsCcRecipientWellPeoplePickerButtonShown")}return n},get_$3wE:function(){return _y.$z.$1Q.get_$lN()?!1:this.$4uK},set_$3wE:function(n){if(this.$4uK!==n){this.$4uK=n;this.$4("IsBccRecipientWellPeoplePickerButtonShown")}return n},get_$4HC:function(){return!0},set_$6Sv:function(n){if(this.$3yW!==n){this.$3yW=n;this.$3KD&&this.$5q.Ribbon.set_$17(!(n&&this.$vN));this.$3i("IsReadyToShowContent","IsReadyToShowContentInRTE")}return n},set_$4H2:function(n){if(this.$4H1!==n){this.$4H1=n;this.$4("ShouldPreventShiftTabDefault")}return n},set_$CFb:function(n){this.$6U2=n;this.$4("IsTabAnchorNeeded");return n},get_$AXq:function(){return this.$1D.get_$ps()},get_$m:function(){return _a.$0.$16},$9hb:function(){if(this.$OL){_js.Trace.logInfo(_a.$0.$16,"Already have focused control name, skipping set initial focus");return}if(!this.get_$k()){_js.Trace.logInfo(_a.$0.$16,"No data context yet, skipping set initial focus");return}var n=this.get_$k();if(n.get_$af().$GI.$229()<1){_js.Trace.logInfo(_a.$0.$16,"Queue task to set initial focus to To well. Context:"+n.$c.toString());if(this.$1E.get_$JM()||this.$1E.get_$fP())this.$1Jw("ToRecipientWellControl");else{var i=this;_js.$D.get_$Q().$2V(_a.$0.$16,"SetFocusToRecipientWell",function(){i.$1Jw("ToRecipientWellControl")},500)}}else if(_js.$9.$o(this.$5q.SubjectTextBox.get_$S().val())){_js.Trace.logInfo(_a.$0.$16,"Set initial focus to subject. Context: "+n.$c.toString());this.$1Jw("SubjectTextBox");if(this.$1E.get_$Df()){_js.Trace.logInfo(_a.$0.$16,"Queue task to set initial focus to subject for IE. Context:"+n.$c.toString());var t=this;_js.$D.get_$Q().$2V(_a.$0.$16,"SetFocusToSubject",function(){t.$1Jw("SubjectTextBox")},500)}}else{_js.Trace.logInfo(_a.$0.$16,"Set initial focus to body. Context: "+n.$c.toString());if(this.$1E.get_$Df()){_js.Trace.logInfo(_a.$0.$16,"Queue task to set initial focus to body for IE. Context:"+n.$c.toString());_js.$D.get_$Q().$2V(_a.$0.$16,"SetFocusToEditor",this.$$d_$7rU,500)}else this.$7rU()}},$ma:function(n){},$IX:function(n){this.$5gp=!this.get_$k();if(this.$5gp)_js.Trace.logInfo(_a.$0.$16,"PostTransitionIn with null DataContext.");else{var t=this.get_$k();var i=t.get_$2N2();if(i.get_$G8()){this.$4Lh=!!this.$5q.EditorControl;if(this.$4Lh){this.get_$34()?t.get_$4wI()&&!t.$3yV?t.$p("IsReadyForViewInitialization",this.$$d_$Dmw):this.$8Pv():_js.Trace.logInfo(_a.$0.$16,"PostTransitionIn view not active yet. Context:"+t.$c.toString());var r=this.$18W?this.$5q.CED:this.$5q.EditorControl;r.$IX()}else _js.Trace.logInfo(_a.$0.$16,"PostTransitionIn template not applied yet. Context:"+t.$c.toString())}else this.$9jb(i,t.$c);if(this.$g3==="Mouse"){t.$9wn();this.$70B()}}this.$hd=!0},$pf:function(){this.$hd=!1;_js.Trace.logInfo(_a.$0.$16,"PreTransitionOut view");var n=this.$OL;if(n&&n in this.$5q)switch(n){case"FromFieldControl":case"ToRecipientWellControl":case"CcRecipientWellControl":case"BccRecipientWellControl":case"SubjectTextBox":this.$7Yo();this.$3aj=!0;var t=this.$1aq[n];if(t[0]===document.activeElement){_js.Trace.logInfo(_a.$0.$16,"Blur from "+n);t.blur()}this.$OL=null;this.$3aj=!1;break;case"EditorControl":this.$3aj=!0;this.$5q.EditorControl.$A9s();this.$OL=null;this.$3aj=!1;break}else _js.Trace.logInfo(_a.$0.$16," Skip pre-transition out focus related processing for current focused control "+n+", since it's not present in the controls dictionary");"EditorControl"in this.$5q?this.$5q.EditorControl.$pf():_js.Trace.logInfo(_a.$0.$16," Skip calling editor.PreTransitionOut since it's not present in the controls dictionary")},$Tp:function(){_js.Trace.logInfo(_a.$0.$16,"PostTransitionOut view");this.set_$3z9(!0);this.set_$3wL(!1);this.set_$3wE(!1);this.set_$6Sv(!1);var n=this.$5q.EditorControl;n&&n.$Tp()},$3S:function(){this.$1tM();return!0},$2A:function(){_js.Trace.logInfo(_a.$0.$16,"Disposing view");this.$EnN();this.$2Bb();this.$1aq=null;this.$5q=null;this.$OL=null;_js.$7.prototype.$2A.call(this)},$4T:function(){_js.$7.prototype.$4T.call(this);var n=this.$u;var t=null;this.get_$k()&&(t=this.get_$k());if(n){this.$5q.SubjectTextBox=n.$1N("SubjectTextBox");this.$5q.FromFieldControl=n.$1N("FromFieldControl");this.$5q.ToRecipientWellControl=n.$1N("ToRecipientWellControl");this.$5q.CcRecipientWellControl=n.$1N("CcRecipientWellControl");this.$5q.BccRecipientWellControl=n.$1N("BccRecipientWellControl");var r=n.$1N("EditorControl");this.$5q.EditorControl=r;var i=n.$1N("CED");this.$5q.CED=i;if(i){i.$EK=!this.$18W;r.$EK=this.$18W;this.$18W&&i.$EZb()}if(this.$3KD){var u=n.$1N("Ribbon");this.$5q.Ribbon=u;if(this.$18W){u.set_$60J(i);i.$Ea6(r,this.$$d_$DWy)}}this.$5q.CancelConfirmDialog=n.$1N("CancelConfirmDialog");this.$5q.MessageBox=n.$1N("MessageBox");this.$5q.ComposeDockPanel=n.$1N("ComposeDockPanel");this.$5q.ToRecipientButton=n.$1N("ToRecipientButton");this.$5q.CcRecipientButton=n.$1N("CcRecipientButton");this.$5q.BccRecipientButton=n.$1N("BccRecipientButton");this.$5q.QuotedBodyHtmlLabel=n.$1N("QuotedBodyHtmlLabel");if(this.$g3==="Mouse"){this.$5q.SendButton=n.$1N("SendButton");this.$5q.DiscardButton=n.$1N("DiscardButton");this.$5q.InsertButton=n.$1N("InsertButton");this.$5q.AppsButton=n.$1N("AppsButton");this.$5q.AffordanceMenuButton=n.$1N("AffordanceMenuButton");this.$5q.OpenSeperateWindowButton=n.$1N("OpenSeperateWindowButton");this.$5q.ComposeAppsPane=n.$1N("ComposeAppsPane");if(t){this.$vN=t.$c.get_$6P()==="HTML";!this.$vN&&this.$18W&&this.$5nj()}}this.$7DG=new _C(this.$$d_$C02,this.get_$m());r.$5XM=!0;this.$Ea9();if(this.$hd&&!this.$4Lh){_js.Trace.logInfo(_a.$0.$16,"Applied template, already in view and template was not applied at PostTransitionIn, calling PostTransitionIn. Context:"+(t?t.$c.toString():"null"));this.$IX(null)}else _js.Trace.logInfo(_a.$0.$16,"Applying template. Context:"+(t?t.$c.toString():"null"));this.$5q.EditorControl&&this.$5q.EditorControl.$p("IsPlainTextContent",this.$$d_$DWu)}else{_js.Trace.logInfo(_a.$0.$16,"Applying null template. Context:"+(t?t.$c.toString():"null"));this.$5q.SubjectTextBox=null;this.$5q.FromFieldControl=null;this.$5q.ToRecipientWellControl=null;this.$5q.CcRecipientWellControl=null;this.$5q.BccRecipientWellControl=null;this.$5q.EditorControl=null;this.$5q.CED=null;this.$5q.CancelConfirmDialog=null;this.$5q.MessageBox=null;this.$5q.ComposeDockPanel=null}this.$9uv()},$8j:function(){_js.$F.prototype.$8j.call(this);if(this.get_$k()){var n=this.get_$k();var t=n.get_$2N2();this.$vN=n.$c.get_$6P()==="HTML";!this.$vN&&this.$18W&&this.$u&&this.$5nj();if(this.$5gp)if(t.get_$G8()){_js.Trace.logInfo(_a.$0.$16,"DataContext updated, PostTransitionIn with null DataContext and view model initialized, call PostTransitionIn with Context: "+n.$c.toString());this.$IX(null)}else this.$9jb(t,n.$c);t.$4yE?this.$7Wh():t.$p("IsSecondInitializationComplete",this.$$d_$DVQ);n.get_$af().$EXk(this.$$d_$C2u)}else _js.Trace.logInfo(_a.$0.$16,"Updated DataContext to null")},$3T:function(){_js.$7.prototype.$3T.call(this);if(this.$hd&&this.get_$k()&&this.$4Lh){var r=this.get_$k();var u=r.get_$2N2();if(u.get_$G8()){this.set_$6Sv(!0);_js.Trace.logInfo(_a.$0.$16,"Show content on activate. Context:"+r.$c.toString());this.$9hb();this.$1aL();var t=this.$5q.EditorControl;if(t){if(_z.$CS.isInstanceOfType(t)){var n=t;if(n.get_$AUA()){_js.Trace.logInfo(_a.$0.$16,"Restore extendable editor to original height on ready to show content");n.$9PA()}else if(n.get_$AU8()){_js.Trace.logInfo(_a.$0.$16,"Set extendable editor to full screen height on ready to show content");n.$EXe()}}var i=t;if(i.$1R7){_js.Trace.logInfo(_a.$0.$16,"Set editor to current scroll height if it is more than full screen on ready to show content");i.$1OP()}}_js.$D.get_$Q().$2V(_a.$0.$16,"MailCompose.Editor.Resize",this.$$d_$9nZ,500)}}},$1aL:function(){var n=this.get_$k();if(this.$2C5){_js.Trace.logInfo(_a.$0.$16,"Events already bound. Context:"+n.$c.toString());return}if(this.$1E.get_$JM()){$(window.document.body).bind("mousedown",{uiComponent:"Body"},this.$$d_$A9u);var u=this;_js.$D.get_$Q().$2V(_a.$0.$16,"RemoveBodyFocusHandler",function(){$(window.document.body).unbind("mousedown",u.$$d_$A9u)},1e3)}this.$hB=new(_ff.$18.$$(_mcp.$mz.$y8));if(this.$g3==="Mouse"){this.$hB.$F(new _mcp.$mz.$y8("DiscardButton",this.$$d_$4f7));this.$hB.$F(new _mcp.$mz.$y8("InsertButton",this.$$d_$4f7));this.$hB.$F(new _mcp.$mz.$y8("AppsButton",this.$$d_$4f7));this.$hB.$F(new _mcp.$mz.$y8("AffordanceMenuButton",this.$$d_$4f7));this.$hB.$F(new _mcp.$mz.$y8("OpenSeperateWindowButton",this.$$d_$4f7));this.$hB.$F(new _mcp.$mz.$y8("ToRecipientButton",this.$$d_$4f7))}this.$hB.$F(new _mcp.$mz.$y8("SubjectTextBox",this.$$d_$4f7));this.$hB.$F(new _mcp.$mz.$y8("FromFieldControl",this.$$d_$4f7));this.$hB.$F(new _mcp.$mz.$y8("ToRecipientWellControl",this.$$d_$DxB));this.$hB.$F(new _mcp.$mz.$y8("CcRecipientWellControl",this.$$d_$DxB));this.$hB.$F(new _mcp.$mz.$y8("BccRecipientWellControl",this.$$d_$DxB));this.$11h=new(_ff.$18.$$(_mcp.$mz.$y8));this.$11h.$F(new _mcp.$mz.$y8("FromFieldControl",this.$$d_$7Y0));this.$11h.$F(new _mcp.$mz.$y8("ToRecipientWellControl",this.$$d_$7Y0));this.$11h.$F(new _mcp.$mz.$y8("CcRecipientWellControl",this.$$d_$7Y0));this.$11h.$F(new _mcp.$mz.$y8("BccRecipientWellControl",this.$$d_$7Y0));if(n.get_$4wI()){n.$6R.addEventListener("focusin",this.$$d_$DvL,!0);n.$6R.addEventListener("focusout",this.$$d_$DvK,!0)}else{for(var i=0;i<this.$hB.get_$A();i++)this.$5q[this.$hB.get_$E(i).$1Ic].get_$S().bind("focusin",{uiComponent:this.$hB.get_$E(i).$1Ic},this.$hB.get_$E(i).$2cX);for(var t=0;t<this.$11h.get_$A();t++)this.$5q[this.$11h.get_$E(t).$1Ic].get_$S().bind("focusout",{uiComponent:this.$11h.get_$E(t).$1Ic},this.$11h.get_$E(t).$2cX)}this.$4Sp();this.$7ni();this.$5q.CancelConfirmDialog.$p("IsHidden",this.$$d_$DTV);this.$5q.MessageBox.$p("IsHidden",this.$$d_$DdO);n.$1d.$p("ActionPerformed",this.$$d_$Dac);n.$1d.$p("Count",this.$$d_$Dad);n.get_$eM().add_$6ne(this.$$d_$6ne);if(!$C(this.$5q.ComposeAppsPane)){this.$5q.ComposeAppsPane.$p("IsHidden",this.$$d_$95z);_y.$z.$1Q.add_$1Go(this.$$d_$70B);_g.$O.get_$Q().get_$6m().add_$1zw(this.$$d_$6oo)}if(this.$l.$8G(this.$l.get_$IF())&&this.$g3==="TouchWide"){var r=n.get_$39B().$65;if(r){r.add_$2Tb(this.$$d_$5Ei);r.add_$3Ru(this.$$d_$DSK)}}n.$c.$p("SelectedDataCallContext",this.$$d_$6qF);this.$2C5=!0},$2Bb:function(){if(this.$5q){"CancelConfirmDialog"in this.$5q&&this.$5q.CancelConfirmDialog.$1B("IsHidden",this.$$d_$DTV);"MessageBox"in this.$5q&&this.$5q.MessageBox.$1B("IsHidden",this.$$d_$DdO);var u=this.get_$k();if(u&&u.get_$4wI()){u.$6R.removeEventListener("focusin",this.$$d_$DvL,!0);u.$6R.removeEventListener("focusout",this.$$d_$DvK,!0)}else{for(var i=0;i<this.$hB.get_$A();i++)this.$hB.get_$E(i).$1Ic in this.$5q&&this.$5q[this.$hB.get_$E(i).$1Ic].get_$S().unbind("focusin",this.$hB.get_$E(i).$2cX);for(var t=0;t<this.$11h.get_$A();t++)this.$11h.get_$E(t).$1Ic in this.$5q&&this.$5q[this.$11h.get_$E(t).$1Ic].get_$S().unbind("focusout",this.$11h.get_$E(t).$2cX)}"EditorControl"in this.$5q&&this.$5q.EditorControl.$1B("IsPlainTextContent",this.$$d_$DWu);this.$Eru()}if(this.get_$k()){var n=this.get_$k();_js.Trace.logInfo(_a.$0.$16,"Unbind view events on view model. Context:"+n.$c.toString());var e=n.get_$2N2();e.$1B("IsInitialized",this.$$d_$DVO);e.$1B("IsSecondInitializationComplete",this.$$d_$DVQ);n.get_$1kA()&&n.get_$1kA().get_$Tf()&&n.get_$1kA().get_$Tf().$1B("IsShown",this.$$d_$6o7);var r=n.get_$3Ma();if(r){r.$1B("DialogViewModel",this.$$d_$DdQ);r.$E6&&r.$E6.$1B("IsShown",this.$$d_$DdR)}var o=n.get_$af();o&&o.$1B("IsPeoplePickerShown",this.$$d_$DfG);n.$1d.$1B("ActionPerformed",this.$$d_$Dac);n.$1d.$1B("Count",this.$$d_$Dad);n.get_$eM().remove_$6ne(this.$$d_$6ne);n.$1B("IsReadyForViewInitialization",this.$$d_$Dmw);n.get_$eM().get_$9Z()&&n.get_$eM().get_$9Z().remove_$26p(this.$$d_$26p);if(this.$l.$8G(this.$l.get_$IF())&&this.$g3==="TouchWide"){var f=n.get_$39B().$65;if(f){f.remove_$2Tb(this.$$d_$5Ei);f.remove_$3Ru(this.$$d_$DSK)}}n.$c.$1B("SelectedDataCallContext",this.$$d_$6qF)}if(!$C(this.$5q.ComposeAppsPane)){this.$5q.ComposeAppsPane.$1B("IsHidden",this.$$d_$95z);_y.$z.$1Q.remove_$1Go(this.$$d_$70B);_g.$O.get_$Q().get_$6m().remove_$1zw(this.$$d_$6oo)}this.$2C5=!1},$BzA:function(n){_js.Trace.logInfo(_a.$0.$16,"Focused in the RTE");this.set_$12N("EditorControl")},$BzB:function(n){_js.Trace.logInfo(_a.$0.$16,"Focused in the Water");this.set_$12N("CED")},$4f7:function(n){var i=n.data;var t=i.uiComponent;this.$7rK(t)},$DxB:function(n){this.$4f7(n);this.$6K9()},$7Y0:function(n){_js.Trace.logInfo(_a.$0.$16,"User blured from "+this.$OL);if(this.get_$k()&&_mcp.$8n.isInstanceOfType(this.get_$k())&&!this.$3aj&&!this.get_$k().$1di){if(this.$OL==="FromFieldControl"){var t=this.get_$k().get_$af();if(t&&t.get_$1Rx()){var u=t.get_$1Rx().get_$By();_js.$9.$o(u)||t.$4GQ(u,!0)}}var r=this;_js.$D.get_$Q().$2V(this.get_$m(),"Delayed MailTips retrieval",function(){if(r.get_$k()){var n=r.get_$k().get_$6Xw();n.get_$G8()||n.$3e();n.$2yR()}},100);if(_a.$5N.$43){var i=this;_js.$D.get_$Q().$2V(this.get_$m(),"Delayed PolicyTips retrieval",function(){if(i.get_$k()){var n=i.get_$k().get_$9Gs();n.$2BX(1)}},100)}}},$1tM:function(){if(this.$5q&&this.get_$34()&&this.$hd&&this.$OL&&this.get_$k()&&!this.get_$k().$1di){_js.Trace.logInfo(_a.$0.$16,"Restore focus to "+this.$OL);this.$1Jw(this.$OL)}else _js.Trace.logInfo(_a.$0.$16,"Skip restore focus, controls="+(this.$5q?"non-null":"null")+"; Active="+this.get_$34().toString()+"; InView="+this.$hd.toString()+"; Name="+this.$OL+"; VM="+(this.get_$k()?"non-null":"null"))},$1Jw:function(n){this.$7Yo();switch(n){case"SubjectTextBox":case"BccRecipientWellControl":case"CcRecipientWellControl":case"ToRecipientWellControl":case"FromFieldControl":this.$1aq[n].focus();this.set_$12N(n);this.$6K9();break;case"EditorControl":case"CED":this.$5q[n].$3S();this.set_$12N(n);break}},$7Yo:function(){if(this.$1aq&&!("SubjectTextBox"in this.$1aq)){this.$1aq.SubjectTextBox=this.$5q.SubjectTextBox.get_$S();this.$1aq.FromFieldControl=this.$5q.FromFieldControl.get_$S().find("input");this.$1aq.ToRecipientWellControl=this.$5q.ToRecipientWellControl.get_$S().find("input");this.$1aq.CcRecipientWellControl=this.$5q.CcRecipientWellControl.get_$S().find("input");this.$1aq.BccRecipientWellControl=this.$5q.BccRecipientWellControl.get_$S().find("input")}},$A9u:function(n){var i=n.data;var t=i.uiComponent;if(t==="Body"){_js.Trace.logInfo(_a.$0.$16,"MouseDown event on Body is being ignored to prevent hiding the keyboard.");n.preventDefault()}},$Ea9:function(){this.$5q.FromFieldControl.add_$10A(this.$$d_$DhP);this.$5q.ToRecipientWellControl.add_$10A(this.$$d_$DhP);this.$5q.CcRecipientWellControl.add_$10A(this.$$d_$DhP);this.$5q.BccRecipientWellControl.add_$10A(this.$$d_$DhP)},$95z:function(n,t){var i=this.$5q.ComposeAppsPane;i.get_$17()&&this.$1Jw("ToRecipientWellControl")},$6qF:function(n,t){var i=this.get_$k();if(this.$OL==="SubjectTextBox"){i.$c.get_$29B().set_$1Ho("subject");this.$5q.SubjectTextBox.set_$16X(i.$c.get_$29B())}else if(this.$OL==="EditorControl"){"EditorControl"in this.$5q&&this.$5q.EditorControl.set_$16X(i.$c.get_$29B());i.$c.get_$29B().set_$1Ho("body")}else i.$c.get_$29B().set_$6RE(!0)},$EnN:function(){var i=this.$5q.FromFieldControl;var r=this.$5q.ToRecipientWellControl;var n=this.$5q.CcRecipientWellControl;var t=this.$5q.BccRecipientWellControl;i&&i.remove_$10A(this.$$d_$DhP);r&&r.remove_$10A(this.$$d_$DhP);n&&n.remove_$10A(this.$$d_$DhP);t&&t.remove_$10A(this.$$d_$DhP)},$DhP:function(n){if(this.$5q.FromFieldControl===n){var u=n.get_$S().find("input");u.attr("aria-labelledby","MailCompose.FromRecipientWellButton")}else if(this.$5q.ToRecipientWellControl===n){var r=n.get_$S().find("input");r.attr("aria-label",_nbs.NonBootStrings.l_ToRecipients_AT_TextBox_Text);r.attr("role","combobox");r.attr("aria-haspopup","true")}else if(this.$5q.CcRecipientWellControl===n){var t=n.get_$S().find("input");t.attr("aria-label",_nbs.NonBootStrings.l_CcRecipients_AT_TextBox_Text);t.attr("role","combobox");t.attr("aria-haspopup","true")}else if(this.$5q.BccRecipientWellControl===n){var i=n.get_$S().find("input");i.attr("aria-label",_nbs.NonBootStrings.l_BccRecipients_AT_TextBox_Text);i.attr("role","combobox");i.attr("aria-haspopup","true")}},$C2u:function(){var n=this.$5q.FromFieldControl;n&&n.$C2r()},$6K9:function(){switch(this.$OL){case"ToRecipientWellControl":this.set_$3z9(!0);this.set_$3wL(!1);this.set_$3wE(!1);break;case"CcRecipientWellControl":this.set_$3wL(!0);this.set_$3z9(!1);this.set_$3wE(!1);break;case"BccRecipientWellControl":this.set_$3wE(!0);this.set_$3wL(!1);this.set_$3z9(!1);break}},$C02:function(){var n=!0;if(this.$4H1){if(this.$OL==="DiscardButton"){this.$5q.SendButton.$3S();this.set_$12N("SendButton")}else if(this.$OL==="InsertButton"){this.$5q.DiscardButton.$3S();this.set_$12N("DiscardButton");n=!1}else if(this.$OL==="AppsButton"){this.$5q.InsertButton.$3S();this.set_$12N("InsertButton");n=!1}else if(this.$OL==="AffordanceMenuButton"){var i=this.$5q.AppsButton;if(i.get_$17()){this.$5q.InsertButton.$3S();this.set_$12N("InsertButton")}else{i.$3S();this.set_$12N("AppsButton")}n=!1}else if(this.$OL==="OpenSeperateWindowButton"){this.$5q.AffordanceMenuButton.$3S();this.set_$12N("AffordanceMenuButton");n=!1}else if(this.$OL==="ToRecipientButton"){var t=this.get_$k();if(t.get_$af().$4vk||t.$1d.get_$A())this.set_$4H2(!1);else{var u=this.$5q.ComposeAppsPane;if(u.get_$17()){this.$5q.OpenSeperateWindowButton.$3S();this.set_$12N("OpenSeperateWindowButton");n=!1}else this.set_$4H2(!1)}}else if(this.$OL==="ToRecipientWellControl")if(this.$g3==="Mouse"){this.$5q.ToRecipientButton.$3S();this.set_$12N("ToRecipientButton");n=!1}else this.set_$4H2(!1);else if(this.$OL==="CcRecipientWellControl"){this.$5q.CcRecipientButton.$3S();this.set_$12N("CcRecipientButton")}else if(this.$OL==="BccRecipientWellControl"){this.$5q.BccRecipientButton.$3S();this.set_$12N("BccRecipientButton")}if(n){var r=this;_js.$D.get_$Q().$2V(this.get_$m(),"MailComposeView.HandleShiftTabOnRecipientWell",function(){r.set_$4H2(!1)},100)}}},$Er0:function(){if(this.$Ebk()){var n=this.get_$k();switch(this.$OL){case"ToRecipientWellControl":n.get_$af().$GM.$2BY();n.get_$af().$Ge.$2BY();break;case"CcRecipientWellControl":n.get_$af().$GI.$2BY();n.get_$af().$Ge.$2BY();break;case"BccRecipientWellControl":n.get_$af().$GI.$2BY();n.get_$af().$GM.$2BY();break;default:n.get_$af().$GI.$2BY();n.get_$af().$GM.$2BY();n.get_$af().$Ge.$2BY();break}}},$Ebk:function(){return this.$g3!=="Mouse"&&this.get_$k()?!0:!1},$DTV:function(n,t){if(this.$5q.CancelConfirmDialog.get_$17()&&this.get_$k()&&!this.get_$k().$1di){_js.Trace.logInfo(_a.$0.$16,"Restore focus on hide of cancel confirm dialog.");this.$1tM()}},$DdO:function(n,t){if(this.$5q.MessageBox.get_$17()){_js.Trace.logInfo(_a.$0.$16,"Restore focus on hide of message box.");this.$1tM()}},$DVO:function(n,t){var i=this.get_$k();i.get_$2N2().$1B("IsInitialized",this.$$d_$DVO);_js.Trace.logInfo(_a.$0.$16,"Calling PostTransitionIn on initialize of Data Context.");this.$IX(null)},$DVQ:function(n,t){var i=this.get_$k();i.get_$2N2().$1B("IsSecondInitializationComplete",this.$$d_$DVQ);this.$7Wh();this.$g3==="Mouse"&&i.get_$1kA().get_$Tf()&&i.get_$1kA().get_$Tf().$p("IsShown",this.$$d_$6o7);var r=i.get_$3Ma();r.$E6?r.$E6.$p("IsShown",this.$$d_$DdR):r.$p("DialogViewModel",this.$$d_$DdQ);var u=i.get_$af();u&&u.$p("IsPeoplePickerShown",this.$$d_$DfG)},$7Wh:function(){if(this.$g3==="Mouse"){var n=this.get_$k();n&&this.$18W&&(n.get_$7eM().$1xL=this.$1xL)}},$6o7:function(n,t){var i=this.get_$k();if(!i.get_$1kA().get_$Tf().$3W){var r=i.get_$3Ma();var u=this;_js.$D.get_$Q().$2V(this.get_$m(),"MailComposeView.OnContextMenuShownChanged",function(){var t=!r.$E6||!r.$E6.$3W;var n=!i.$2F||!i.$2F.$3W;if(t&&n){_js.Trace.logInfo(_a.$0.$16,"Restore focus on hide of context menu");u.$1tM()}},100)}},$DdQ:function(n,t){var r=this.get_$k();var i=r.get_$3Ma();i.$1B("DialogViewModel",this.$$d_$DdQ);i.$E6.$p("IsShown",this.$$d_$DdR)},$DdR:function(n,t){var r=this.get_$k();var i=this;_js.$D.get_$Q().$2V(this.get_$m(),"MailComposeView.OnMessageOptionsShownChanged",function(){if(!r.get_$3Ma().$E6.$3W){_js.Trace.logInfo(_a.$0.$16,"Restore focus on hide of message options dialog");i.$1tM()}},100)},$DfG:function(n,t){var i=this.get_$k();if(!i.get_$af().$6SW){_js.Trace.logInfo(_a.$0.$16,"Restore focus on hide of people picker");this.$1tM()}},$Dac:function(n,t){this.$1tM()},$Dad:function(n,t){this.$9uv();this.$9nZ()},$9uv:function(){var a=this.$u.$1N("InfoBarControl");if(a){var f=this.get_$k();if(f.$1d.$G6.get_$A()>0){for(var l=new _y.$ty,o=_nbs.NonBootStrings.l_Infobar_AT_Region_Text+". ",n,r=0;r<f.$1d.$G6.get_$A();r++){n="";var t=f.$1d.$G6.get_$E(r);if(_y.$dt.isInstanceOfType(t)){var h=t;h&&(n=h.$3V)}else if(_y.$du.isInstanceOfType(t)){var e=t;e&&(n=e.$3V)}else if(_y.$W4.isInstanceOfType(t)){var i=t;if(i&&_y.$1Ij.isInstanceOfType(i.$Fc)){var u=i.$Fc;u&&u.get_$1F8()&&(n=u.get_$1F8())}}if(n===""){var s=t;s&&(n=l.$4L(s.$5h,null))}o+=n+". "}var c=this.$u.$1N("InfoBarControl").get_$S();c.attr("aria-label",o)}}},$6ne:function(n){n.get_$9Z().add_$26p(this.$$d_$26p)},$26p:function(n){if(n.get_$8O7()){n.set_$8O7(!1);this.set_$12N("EditorControl")}this.$1tM()},$9jb:function(n,t){if(n.$BsK("IsInitialized"))_js.Trace.logInfo(_a.$0.$16,"PostTransitionIn before DataContext was initialized. DataContext initialization handler is already setup. Context:"+t.toString());else{_js.Trace.logInfo(_a.$0.$16,"PostTransitionIn before DataContext was initialized. Adding handler to call PostTransitionIn after DataContext is initialized. Context:"+t.toString());n.$p("IsInitialized",this.$$d_$DVO)}},$4Sp:function(){if("EditorControl"in this.$5q&&this.$5q.EditorControl){var t=this.$5q.EditorControl;t.add_$1s6(this.$$d_$BzA);t.add_$1fh(this.$$d_$BzC);t.add_$2sD(this.$$d_$8L8);t.add_$3SF(this.$$d_$8L5);t.add_$XN(this.$$d_$8L2);t.add_$3SD(this.$$d_$8L4);t.add_$3S8(this.$$d_$8L3)}if("CED"in this.$5q&&this.$5q.CED){var n=this.$5q.CED;n.add_$1s6(this.$$d_$BzB);n.add_$1fh(this.$$d_$BzC);n.add_$2sD(this.$$d_$8L8);n.add_$3SF(this.$$d_$8L5);n.add_$XN(this.$$d_$8L2);n.add_$3SD(this.$$d_$8L4);n.add_$3S8(this.$$d_$8L3)}if(this.$1E.get_$Df()){var i=this.$u.$1N("TabAnchor");i&&i.get_$S().bind("focusin",this.$$d_$A65)}},$Eru:function(){if("EditorControl"in this.$5q&&this.$5q.EditorControl){var t=this.$5q.EditorControl;t.remove_$1s6(this.$$d_$BzA);t.remove_$1fh(this.$$d_$BzC);t.remove_$2sD(this.$$d_$8L8);t.remove_$3SF(this.$$d_$8L5);t.remove_$XN(this.$$d_$8L2);t.remove_$3SD(this.$$d_$8L4);t.remove_$3S8(this.$$d_$8L3)}if("CED"in this.$5q&&this.$5q.CED){var n=this.$5q.CED;n.remove_$1s6(this.$$d_$BzB);n.remove_$1fh(this.$$d_$BzC);n.remove_$2sD(this.$$d_$8L8);n.remove_$3SF(this.$$d_$8L5);n.remove_$XN(this.$$d_$8L2);n.remove_$3SD(this.$$d_$8L4);n.remove_$3S8(this.$$d_$8L3)}if(this.$1E.get_$Df()){var i=this.$u.$1N("TabAnchor");i&&i.get_$S().unbind("focusin")}},$DWu:function(n,t){if(_z.$Ap.isInstanceOfType(n)){var i=n;this.$vN=!i.$Et;i&&this.$vN&&this.get_$k().$c.set_$1vd(i.get_$1K());this.$7ni();if(this.$3KD){var r=this.$5q.Ribbon;r&&r.set_$17(!this.$vN)}if(!this.$vN){var u=this.get_$k();u.get_$1Ng().$Ar()}}},$A65:function(n){var t=new _a.$7E(n);this.$1Jw("EditorControl");t.$Dz()},$BzC:function(n){var t=this.get_$k();t.$c.get_$9lZ()?this.$1Jw("CcRecipientWellControl"):this.$1Jw("SubjectTextBox");n.set_$Dz(!0)},$8L8:function(n){var t=this.get_$k();if(t){t.$c.set_$Ebr(n.get_$Ebs());t.$c.set_$4c8(n.get_$4c8());t.$c.set_$6QA(n.get_$G8());t.$c.set_$6QB(n.get_$dK())}},$8L5:function(n){var t=this.get_$k();t&&t.$1n.$5m(5).$Ez6(n.get_$1m())},$8L2:function(n){var i=this.get_$k();if(i){var t=i.get_$eM().get_$9Z().get_$13C();t.$9U(n.get_$4d9());t.$4s(n.get_$4d9())}},$8L4:function(n){var i=this.get_$k();if(i){var t=i.get_$eM().get_$9Z();t.set_$4Vb(n.get_$4Vb());t.set_$4Vc(n.get_$4Vc());t.set_$2e2(n.get_$2e2());t.get_$2dC().$11()}},$8L3:function(n){var i=this.get_$k();if(i){var t=i.get_$eM().get_$9Z();t.set_$eq(n.get_$lu());t.get_$2dC().$11()}},$9nZ:function(){var n=this.$5q.EditorControl;n.$5XM=!1;n.$Jx()},$6oo:function(n,t){this.$70B()},$70B:function(){},$5Ei:function(){var n=this.$5q.QuotedBodyHtmlLabel;if(n){this.$5q.QuotedBodyHtmlLabel.get_$H1().on("touchstart",null,null,this.$$d_$DwR);this.$5q.QuotedBodyHtmlLabel.get_$H1().on("touchend",null,null,this.$$d_$DwQ)}},$DSK:function(){var n=this.$5q.QuotedBodyHtmlLabel;if(n){this.$5q.QuotedBodyHtmlLabel.get_$H1().off("touchstart",null,this.$$d_$DwR);this.$5q.QuotedBodyHtmlLabel.get_$H1().off("touchend",null,this.$$d_$DwQ)}},$DwQ:function(n){if(n.target.tagName==="A"){var t=n.target.getAttribute("href");this.$l.get_$IF().$2PX(t);n.stopImmediatePropagation();n.preventDefault()}},$DwR:function(n){if(n.target.tagName==="A"){n.stopPropagation();n.preventDefault()}},$8Pv:function(){var n=this.get_$k();this.set_$6Sv(!0);_js.Trace.logInfo(_a.$0.$16,"PostTransitionIn active view. Context: "+n.$c.toString());this.$9hb();this.$1aL();_js.$D.get_$Q().$2V(_a.$0.$16,"MailCompose.Editor.Resize",this.$$d_$9nZ,500)},$Dmw:function(n,t){var i=n;i.$1B("IsReadyForViewInitialization",this.$$d_$Dmw);this.$8Pv()},$5nj:function(){if(this.$18W){var t=this.$5q.CED;var n=this.$5q.EditorControl;var i=this.$5q.Ribbon;i.set_$60J(n);i.set_$17(!0);if(t&&n){n.$EK=!1;n.set_$mf(t.get_$mf());t.$7bs()}this.set_$6Ms(!1);if(n){n.$IX();n.$Jx()}}},$7rU:function(){this.$18W?this.$1Jw("CED"):this.$1Jw("EditorControl")},$DWy:function(){this.set_$6Ms(!1)},$DvL:function(n){for(var t=0;t<this.$hB.get_$A();t++){var r=this.$hB.get_$E(t);var i=this.$5q[r.$1Ic];if(n.target===i.$O||i.get_$S().has(n.target).length){this.$7rK(r.$1Ic);this.$6K9();break}}return!0},$DvK:function(n){for(var t=0;t<this.$11h.get_$A();t++){var r=this.$11h.get_$E(t);var i=this.$5q[r.$1Ic];if(n.target===i.$O||i.get_$S().has(n.target).length){r.$2cX(null);break}}return!0},$7rK:function(n){_js.Trace.logInfo(_a.$0.$16,"Focused in "+n);this.set_$12N(n);this.set_$4H2(n==="CcRecipientWellControl"||n==="BccRecipientWellControl"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="OpenSeperateWindowButton"||n==="AffordanceMenuButton"||n==="InsertButton"||n==="DiscardButton"||n==="AppsButton");if(this.get_$k()&&_mcp.$8n.isInstanceOfType(this.get_$k())){var i=this.get_$k();if(this.$OL==="FromFieldControl"){var t=i.get_$af();t&&t.set_$9kE(!1)}this.$OL==="InsertButton"&&i.$AGt()}},$7ni:function(){var n=this.get_$k();n&&this.set_$CFb(this.$1E.get_$Df()&&n.$c.get_$6P()==="Text"?!0:!1)}};_mcp.$mz.$y8=function(n,t){this.$1Ic=n;this.$2cX=t};_mcp.$mz.$y8.prototype={$1Ic:null,$2cX:null};_mcp._TI=function(){};_mcp._TI.$$cctor=function(){var l="IrmDialogView";new _A(l,function(){_mcp._TI.$1[l]===undefined&&(_mcp._TI.$1[l]=[[[-1,0,["Description"],[_mcp._TI.$D2U],null,"Text",null,_mcp._TI.$H,1,null,null,null]],[[-1,0,["ConversationOwner"],[_mcp._TI.$D2T],null,"Text",null,_mcp._TI.$H,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[0].cloneNode(!0);var i=new _fc.$A(n.children[1]);var t=new _fc.$A(n.children[0]);return new _B(n,[t,i])},_mcp.$147,_js.$7,!1,!1,!1,0,_mcp._TI.$1);var a="MailComposeView._tid1._tid3";new _A(a,function(){_mcp._TI.$1[a]===undefined&&(_mcp._TI.$1[a]=[[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Rt],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[1].cloneNode(!0);var n=new _pe.$2J(t.children[0],_js.$2.Instance.$2(_a.$1x));n.set_$Z6("_mcp_v ms-font-weight-regular ms-font-color-black bidi");n.set_$6("PersonaView.BasicDetailsPopup");n.set_$7L("MailCompose.FromRecipientWellButton");return new _B(t,[n])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var h="MailComposeView._tid1._tid4";new _A(h,function(){_mcp._TI.$1[h]===undefined&&(_mcp._TI.$1[h]=[[[-1,0,["RecipientComponent","FromFindRecipientViewModel"],[_mcp._TI.$Ei,_mcp._TI.$8ut],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[2].cloneNode(!0);var n=new _fp.$I6(t.children[0],_js.$2.Instance.$2(_y.$W),_js.$2.Instance.$2(_ff.$M));n.set_$7L("MailCompose.FromRecipientWellButton");return new _B(t,[n])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var c="MailComposeView._tid1";new _A(c,function(){_mcp._TI.$1[c]===undefined&&(_mcp._TI.$1[c]=[[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_b.$1.get_$nG()],[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_nbs.NonBootStrings.l_FromSendAsLabel_Text],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.$2n,0,null,null,null,_nbs.NonBootStrings.l_FromAddressSelector_AT_Button_Text],[-1,5,["SendAsContextMenuComponent","Menu","IsShown"],[_mcp._TI.$3P2,_mcp._TI.$3Oy,_mcp._TI.$2p],null,"contextMenu",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Rt],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$24(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Rt],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$24(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Rt],null,"IsHidden",null,_mcp._TI.$8,1,new _js.$x([_mcp._TI.get_$24(),_mcp._TI.get_$K()],[null,null]),null,!0],[-1,5,["RecipientComponent","ShouldHighlightFromAsInvalid"],[_mcp._TI.$Ei,_mcp._TI.$8uu],null,"_mcp_d",null,null,0,null,null,null]]]);var t=_mcp._TI._hf.childNodes[3].cloneNode(!0);var u=new _js.$7(t.children[3]);u.set_$6("MailComposeView._tid1._tid4");var f=new _js.$7(t.children[2]);var r=new _js.$7(t.children[1]);r.set_$6("MailComposeView._tid1._tid3");var n=new _fc.$H(t.children[0]);n.set_$6("MailComposeView.FromButtonTemplate");n.set_$3E("MailCompose.FromRecipientWellButton");n.set_$g(0);var i=new _fce.$1D(_js.$2.Instance.$2(_fc.$l),_js.$2.Instance.$2(_ff.$M),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));i.$M(_E.$D(["SendAsContextMenuComponent","Menu"],[_mcp._TI.$3P2,_mcp._TI.$3Oy],null,"MenuDataContext",null,_mcp._TI.$3q,1)).$M(_E.$D(["SendAsContextMenuComponent","Menu","IsShown"],[_mcp._TI.$3P2,_mcp._TI.$3Oy,_mcp._TI.$2p],_mcp._TI.$49,"IsShown",_mcp._TI.$3n,_mcp._TI.$3m,2,null,null,!1));i.$58=3;i.$7Y=1;n.set_$12([i]);return new _B(t,[n,r,f,u]).R({FromPersona:r})},_mcp.$8n,_mcp.$mx,!1,!0,!1,0,_mcp._TI.$1);var p="MailComposeView._tid8";new _A(p,function(){_mcp._TI.$1[p]===undefined&&(_mcp._TI.$1[p]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_u.CommonStrings.l_SubjectLabel_Text]],[[-1,0,["Context","Subject"],[_mcp._TI.$EB,_mcp._TI.$57R],null,"Text",null,_mcp._TI.$H,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[4].cloneNode(!0);var i=new _fc.$A(_B.$3(n,[1,0]));var t=new _fc.$A(n.children[0]);return new _B(n,[t,i])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var w="MailComposeView._tid9._tida";new _A(w,function(){_mcp._TI.$1[w]===undefined&&(_mcp._TI.$1[w]=[[[-1,0,["MeetingComponent","SenderDetailsViewModel"],[_mcp._TI.$1VQ,_mcp._TI.$8up],_mcp._TI.$8uq,"DataContext",_mcp._TI.$2S,_mcp._TI.$Z,2,null,null,null]],[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp._TI.$1VQ,_mcp._TI.$58n],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null]]]);var i=_mcp._TI._hf.childNodes[5].cloneNode(!0);var t=new _pe.$2J(i.children[1],_js.$2.Instance.$2(_a.$1x));t.set_$Z6("_mcp_j ms-font-weight-regular ms-font-color-black bidi");t.set_$6("PersonaView.PresenceBasicDetailsPopup");var n=new _pe.$2J(i.children[0],_js.$2.Instance.$2(_a.$1x));n.set_$Z6("_mcp_j ms-font-weight-regular ms-font-color-black bidi");n.set_$6("PersonaView.PresenceBasicDetailsPopup");return new _B(i,[n,t])},_mcp.$8n,_b.$8M,!1,!0,!1,0,_mcp._TI.$1);var v="MailComposeView._tid9._tidb";new _A(v,function(){_mcp._TI.$1[v]===undefined&&(_mcp._TI.$1[v]=[[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp._TI.$1VQ,_mcp._TI.$58n],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[6].cloneNode(!0);var n=new _pe.$2J(t.children[0],_js.$2.Instance.$2(_a.$1x));n.set_$Z6("_mcp_j ms-font-weight-regular ms-font-color-black bidi");n.set_$6("PersonaView.PresenceBasicDetailsPopup");return new _B(t,[n])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var y="MailComposeView._tid9";new _A(y,function(){_mcp._TI.$1[y]===undefined&&(_mcp._TI.$1[y]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_nbs.NonBootStrings.l_FromLabel_Text]],[[-1,4,null,null,null,"FormatString",null,_mcp._TI.$zl,0,null,null,null,_u.Strings.l_OnBehalfOf_Text],[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp._TI.$1VQ,_mcp._TI.$58o],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp._TI.$1VQ,_mcp._TI.$58o],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]]]);var n=_mcp._TI._hf.childNodes[7].cloneNode(!0);var i=new _js.$7(_B.$3(n,[1,1]));i.set_$6("MailComposeView._tid9._tidb");var t=new _b.$8M(_B.$3(n,[1,0]));t.set_$6("MailComposeView._tid9._tida");var r=new _fc.$A(n.children[0]);return new _B(n,[r,t,i])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var s="MailComposeView._tidc";new _A(s,function(){_mcp._TI.$1[s]===undefined&&(_mcp._TI.$1[s]=[[[-1,0,["Context","WhenLabel"],[_mcp._TI.$EB,_mcp._TI.$8ul],null,"Text",null,_mcp._TI.$H,1,null,null,null]],[[-1,0,["Context","MeetingCalendarTimePeriod"],[_mcp._TI.$EB,_mcp._TI.$8uk],null,"Text",null,_mcp._TI.$H,1,_mcp._TI.get_$2oo(),null,null]]]);var n=_mcp._TI._hf.childNodes[8].cloneNode(!0);var i=new _fc.$A(_B.$3(n,[1,0]));var t=new _fc.$A(n.children[0]);return new _B(n,[t,i])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var i="MailComposeView._tidd";new _A(i,function(){_mcp._TI.$1[i]===undefined&&(_mcp._TI.$1[i]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_nbs.NonBootStrings.l_ProposeNewTimeLabel_Short_Text]],[[-1,0,["Context","ProposedNewTime"],[_mcp._TI.$EB,_mcp._TI.$8pq],null,"Text",null,_mcp._TI.$H,1,_mcp._TI.get_$42P(),null,null]]]);var n=_mcp._TI._hf.childNodes[9].cloneNode(!0);var r=new _fc.$A(_B.$3(n,[1,0]));var t=new _fc.$A(n.children[0]);return new _B(n,[t,r])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var r="MailComposeView._tide";new _A(r,function(){_mcp._TI.$1[r]===undefined&&(_mcp._TI.$1[r]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_u.MeetingMsgStrings.l_WhereLabel_Text]],[[-1,0,["MeetingComponent","LocationViewModel"],[_mcp._TI.$1VQ,_mcp._TI.$8uo],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null]]]);var t=_mcp._TI._hf.childNodes[10].cloneNode(!0);var n=new _cmm.$WU(_B.$3(t,[1,0]));n.set_$3zT(!0);n.set_$4S(!0);var i=new _fc.$A(t.children[0]);return new _B(t,[i,n])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var n="MailComposeView._tidf";new _A(n,function(){_mcp._TI.$1[n]===undefined&&(_mcp._TI.$1[n]=[[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_b.$1.get_$qq()],[-1,4,null,null,null,"HoveredImageId",null,_mcp._TI.$1o,0,null,null,null,_n.$1.get_$1J9()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.$5o,0,null,null,null,_n.$1.get_$1J9()],[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_nbs.NonBootStrings.l_showOriginalMessage_Text],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.$2n,0,null,null,null,_nbs.NonBootStrings.l_showOriginalMessage_Text],[-1,0,["UpgradeComponent","CompleteBodyUpgradeCommand"],[_mcp._TI.$2Rv,_mcp._TI.$8uw],null,"ClickCommand",null,_mcp._TI.$a,1,null,null,null],[-1,0,["UpgradeComponent","ShouldShowQuoteBodyButton"],[_mcp._TI.$2Rv,_mcp._TI.$8uz],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.$5z,0,null,null,0,0],[-1,4,null,null,null,"BusyText",null,_mcp._TI.$BU,0,null,null,null,_nbs.NonBootStrings.l_showOriginalMessage_Text],[-1,0,["UpgradeComponent","IsWaitingForQuotedBody"],[_mcp._TI.$2Rv,_mcp._TI.$8uy],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]]]);var i=_mcp._TI._hf.childNodes[11].cloneNode(!0);var t=new _fce.$20(i.children[1],_js.$2.Instance.$2(_js.$p),_js.$2.Instance.$2(_ff.$C));t.$74=0;t.set_$g(-1);var r=new _fc.$H(i.children[0]);r.set_$g(0);return new _B(i,[r,t])},_mcp.$8n,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var t="MailComposeView.FromButtonTemplate";new _A(t,function(){_mcp._TI.$1[t]===undefined&&(_mcp._TI.$1[t]=[[[-1,1,["Text"],[_mcp._TI.$Tm],null,"Text",null,_mcp._TI.$H,1,null,null,null]],[[-1,1,["CurrentImageId"],[_mcp._TI.$7A],null,"Id",null,_mcp._TI.$14,1,null,null,null]]]);var n=_mcp._TI._hf.childNodes[12].cloneNode(!0);var r=new _fc.$Y(n.children[1],_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));var i=new _fc.$A(n.children[0]);return new _B(n,[i,r]).R({Label:i,Image:r})},Object,_fc.$H,!1,!1,!1,0,_mcp._TI.$1);var e="MailComposeView";new _A(e,function(){_mcp._TI.$1[e]===undefined&&(_mcp._TI.$1[e]=[[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.$5z,0,null,null,0,1],[-1,1,["IsReadyToShowContent"],[_mcp._TI.$25k],null,"IsBusy",null,_mcp._TI.$AD,1,_mcp._TI.get_$K(),null,!1]],[[-1,1,["IsReadyToShowContent"],[_mcp._TI.$25k],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,5,["GenericMailMode"],[_mcp._TI.$8v1],null,"_mcp_N",null,null,0,_mcp._TI.get_$K(),null,null]],[[-1,5,["ExtensibilityComponent","ExtensibilityViewModel","AppPaneIsHidden"],[_mcp._TI.$3P0,_mcp._TI.$3Ov,_mcp._TI.$zo],null,"_mcp_V",null,null,0,_mcp._TI.get_$K(),null,null],[-1,5,["GenericMailMode"],[_mcp._TI.$8v1],null,"_mcp_Q",null,null,0,null,null,null],[-1,5,["DisableMomemtumScrolling"],[_mcp._TI.$D2o],null,"_mcp_J",null,null,0,null,null,null]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp._TI.$5z,0,null,null,0,0],[-1,0,["ToolbarMessage"],[_mcp._TI.$8v7],null,"BusyText",null,_mcp._TI.$BU,1,null,null,null],[-1,0,["ShouldShowToolbarMessage"],[_mcp._TI.$6i9],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,1,["IsReadyToShowContent"],[_mcp._TI.$25k],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["InfoBarViewModel"],[_mcp._TI.$6i6],null,"DataSource",null,_mcp._TI.$OW,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.$1Fj],null,"_mcp_S",null,null,0,null,null,null],[-1,5,["IsInternetExplorer"],[_mcp._TI.$6i8],null,"_mcp_R",null,null,0,null,null,null]],[[-1,5,["DoesSupportRichText"],[_mcp._TI.$8vH],null,"_mcp_4",null,null,1,null,null,null]],[[-1,0,["Context","IsFromShown"],[_mcp._TI.$EB,_mcp._TI.$8pp],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_u.Strings.l_ToRecipientsLabel_Text],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.$2n,0,null,null,null,_nbs.NonBootStrings.l_ToRecipients_AT_Button_Text],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp._TI.$Ei,_mcp._TI.$2Ru,_mcp._TI.$1VP],null,"ClickCommand",null,_mcp._TI.$a,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.$1Fj],null,"_mcp_S",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.$fu],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Ei,_mcp._TI.$1VO],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_mcp.$1.get_$5jS()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.$5o,0,null,null,null,_mcp.$1.get_$5jT()],[-1,1,["IsToRecipientWellPeoplePickerButtonShown"],[_mcp._TI.$8vK],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp._TI.$Ei,_mcp._TI.$2Ru,_mcp._TI.$1VP],null,"ClickCommand",null,_mcp._TI.$a,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$6i7],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","To","ReadWriteRecipientWellViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Ru,_mcp._TI.$3Ox],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3OC],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Ei,_mcp._TI.$1VO],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,0,["RecipientComponent","To","ReadOnlyRecipientWellViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Ru,_mcp._TI.$3Ow],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3OC],null,"Android",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_u.Strings.l_CcRecipientsLabel_Text],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.$2n,0,null,null,null,_nbs.NonBootStrings.l_CcRecipients_AT_Button_Text],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp._TI.$Ei,_mcp._TI.$2Rs,_mcp._TI.$1VP],null,"ClickCommand",null,_mcp._TI.$a,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.$1Fj],null,"_mcp_S",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.$fu],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Ei,_mcp._TI.$1VO],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_mcp.$1.get_$5jS()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.$5o,0,null,null,null,_mcp.$1.get_$5jT()],[-1,1,["IsCcRecipientWellPeoplePickerButtonShown"],[_mcp._TI.$8vJ],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp._TI.$Ei,_mcp._TI.$2Rs,_mcp._TI.$1VP],null,"ClickCommand",null,_mcp._TI.$a,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$6i7],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","Cc","ReadWriteRecipientWellViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Rs,_mcp._TI.$3Ox],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3OC],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Ei,_mcp._TI.$1VO],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,0,["RecipientComponent","Cc","ReadOnlyRecipientWellViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Rs,_mcp._TI.$3Ow],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3OC],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["Context","IsBccShown"],[_mcp._TI.$EB,_mcp._TI.$8po],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_u.Strings.l_BccRecipientsLabel_Text],[-1,4,null,null,null,"AriaLabel",null,_mcp._TI.$2n,0,null,null,null,_nbs.NonBootStrings.l_BccRecipients_AT_Button_Text],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp._TI.$Ei,_mcp._TI.$2Rr,_mcp._TI.$1VP],null,"ClickCommand",null,_mcp._TI.$a,1,null,null,null],[-1,5,["IsFirefox"],[_mcp._TI.$1Fj],null,"_mcp_S",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp._TI.$fu],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Ei,_mcp._TI.$1VO],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_mcp.$1.get_$5jS()],[-1,4,null,null,null,"PressedImageId",null,_mcp._TI.$5o,0,null,null,null,_mcp.$1.get_$5jT()],[-1,1,["IsBccRecipientWellPeoplePickerButtonShown"],[_mcp._TI.$8vI],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp._TI.$Ei,_mcp._TI.$2Rr,_mcp._TI.$1VP],null,"ClickCommand",null,_mcp._TI.$a,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$6i7],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","Bcc","ReadWriteRecipientWellViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Rr,_mcp._TI.$3Ox],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3OC],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp._TI.$Ei,_mcp._TI.$1VO],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,0,["RecipientComponent","Bcc","ReadOnlyRecipientWellViewModel"],[_mcp._TI.$Ei,_mcp._TI.$2Rr,_mcp._TI.$3Ow],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[-1,5,["IsAndroid"],[_mcp._TI.$3OC],null,"_mcp_P",null,null,0,null,null,null]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.$EB,_mcp._TI.$3OJ],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_u.CommonStrings.l_SubjectLabel_Text]],[[-1,4,null,null,null,"ImageId",null,_mcp._TI.$x,0,null,null,null,_mcp.$1.get_$40b()],[-1,0,["ComplianceComponent","ShowIrmInformationCommand"],[_mcp._TI.$58p,_mcp._TI.$D2X],null,"ClickCommand",null,_mcp._TI.$a,1,null,null,null],[-1,0,["ComplianceComponent","IsIrmProtected"],[_mcp._TI.$58p,_mcp._TI.$8ug],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp._TI.$14,0,null,null,null,_n.$1.get_$4CL()],[-1,0,["Context","SmimeSignMessage"],[_mcp._TI.$EB,_mcp._TI.$8pu],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp._TI.$14,0,null,null,null,_n.$1.get_$Y()],[-1,0,["Context","SmimeEncryptMessage"],[_mcp._TI.$EB,_mcp._TI.$8pt],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["ImportanceComponent","IsNormalImportance"],[_mcp._TI.$8v2,_mcp._TI.$8um],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0],[-1,0,["Context","Importance"],[_mcp._TI.$EB,_mcp._TI.$8pn],null,"Id",null,_mcp._TI.$14,1,_mcp._TI.get_$w0(),null,null]],[[-1,0,["Context","Subject"],[_mcp._TI.$EB,_mcp._TI.$57R],_mcp._TI.$8pw,"Text",_mcp._TI.$5L,_mcp._TI.$5G,2,null,null,null],[-1,0,["Context","MaxSubjectLength"],[_mcp._TI.$EB,_mcp._TI.$8uj],null,"MaxLength",null,_mcp._TI.$Ym,1,null,null,0]],[[-1,0,["Context","ShowMeetingReadonlyFields"],[_mcp._TI.$EB,_mcp._TI.$8ps],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.$EB,_mcp._TI.$3OJ],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp._TI.$EB,_mcp._TI.$3OJ],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],null,[[-1,0,["Context","HasProposedNewTime"],[_mcp._TI.$EB,_mcp._TI.$8ui],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$24(),null,!0]],[[-1,0,["Context","HasLocation"],[_mcp._TI.$EB,_mcp._TI.$8pm],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel","ShouldBeHidden"],[_mcp._TI.$44U,_mcp._TI.$6ho,_mcp._TI.$8pF],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel"],[_mcp._TI.$44U,_mcp._TI.$6ho],_mcp._TI.$D2V,"DataContext",_mcp._TI.$2S,_mcp._TI.$Z,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_nbs.NonBootStrings.l_PrintRestricted_Text],[-1,0,["Context","IsPrintRestricted"],[_mcp._TI.$EB,_mcp._TI.$1qk],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,5,["Context","IsPrintRestricted"],[_mcp._TI.$EB,_mcp._TI.$1qk],null,"noScreen:hiddenMsg",null,null,0,null,null,null]],[[-1,4,null,null,null,"EditorAriaLabel",null,_mcp._TI.$1pw,0,null,null,null,_nbs.NonBootStrings.l_MessageBody_AT_TextBox_Text],[-1,1,["IsReadyToShowContent"],[_mcp._TI.$25k],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.$EB,_mcp._TI.$44R],null,"IsCopyRestricted",null,_mcp._TI.$XF,1,null,null,!1],[-1,0,["Context","IsPrintRestricted"],[_mcp._TI.$EB,_mcp._TI.$1qk],null,"ShouldRestrictFramePrinting",null,_mcp._TI.$6dk,1,null,null,!1],[-1,0,["Context","EditorContent"],[_mcp._TI.$EB,_mcp._TI.$6fZ],_mcp._TI.$6fc,"Content",_mcp._TI.$2p7,_mcp._TI.$2p8,2,null,null,null],[-1,0,["Context","RawEditorContent"],[_mcp._TI.$EB,_mcp._TI.$6fa],_mcp._TI.$6fd,"RawContent",_mcp._TI.$1pv,_mcp._TI.$1ea,2,null,null,null],[-1,0,["Context","TextEditorContent"],[_mcp._TI.$EB,_mcp._TI.$6fb],_mcp._TI.$6fe,"TextContent",_mcp._TI.$6dc,_mcp._TI.$6dm,2,null,null,null],[-1,0,["ContentConversionComponent","SwitchToHtmlContent"],[_mcp._TI.$44V,_mcp._TI.$8uh],null,"SwitchToHtmlContent",null,_mcp._TI.$8mQ,1,null,null,null],[-1,0,["ContentConversionComponent","SwitchToPlainTextContent"],[_mcp._TI.$44V,_mcp._TI.$6hp],null,"SwitchToPlainTextContent",null,_mcp._TI.$6dl,1,null,null,null],[-1,0,["EditorResizeComponent","ResizeEditorCommand"],[_mcp._TI.$D2p,_mcp._TI.$D2b],_mcp._TI.$D2c,"ResizeCommand",_mcp._TI.$43E,_mcp._TI.$43F,2,null,null,null],[-1,0,["Context","BodyType"],[_mcp._TI.$EB,_mcp._TI.$8pl],_mcp._TI.$8pv,"IsPlainTextContent",_mcp._TI.$43D,_mcp._TI.$8mP,2,_mcp._TI.get_$8mG(),null,!1],[-1,0,["EditorComponent","EditorCallContext"],[_mcp._TI.$6i5,_mcp._TI.$6hr],_mcp._TI.$6hs,"CallContext",_mcp._TI.$3Nx,_mcp._TI.$3Ny,2,null,null,null],[-1,0,["Context","IsEditorInitialized"],[_mcp._TI.$EB,_mcp._TI.$Cnk],null,"IsInitialized",null,_mcp._TI.$Ced,1,null,null,!1],[-1,0,["TouchComponent","CloseCommand"],[_mcp._TI.$58q,_mcp._TI.$8uv],null,"DiscardCommand",null,_mcp._TI.$2p9,1,null,null,null],[-1,0,["SaveComponent","SaveCommand"],[_mcp._TI.$44W,_mcp._TI.$43o],null,"SaveCommand",null,_mcp._TI.$2pA,1,null,null,null],[-1,0,["SendComponent","SendCommand"],[_mcp._TI.$1VR,_mcp._TI.$2pk],null,"SendCommand",null,_mcp._TI.$3O0,1,null,null,null],[-1,0,["SendComponent","AltSSendCommand"],[_mcp._TI.$1VR,_mcp._TI.$44T],null,"AltSSendCommand",null,_mcp._TI.$562,1,null,null,null],[-1,0,["RecipientComponent","ResolveCommand"],[_mcp._TI.$Ei,_mcp._TI.$44S],null,"ResolveCommand",null,_mcp._TI.$3Nz,1,null,null,null],[-1,0,["LinkPreviewComponent","IsLinkPreviewEnabled"],[_mcp._TI.$k5,_mcp._TI.$6hu],null,"IsLinkPreviewEnabled",null,_mcp._TI.$6dg,1,null,null,!1],[-1,0,["LinkPreviewComponent","GetLinkPreviewRequest"],[_mcp._TI.$k5,_mcp._TI.$6ht],_mcp._TI.$6hz,"GetLinkPreviewRequest",_mcp._TI.$6da,_mcp._TI.$6df,2,null,null,null],[-1,0,["LinkPreviewComponent","LinkPreviewResponse"],[_mcp._TI.$k5,_mcp._TI.$6hv],null,"LinkPreviewResponse",null,_mcp._TI.$6dh,1,null,null,null],[-1,0,["LinkPreviewComponent","YouTubePlayerAnchorClicked"],[_mcp._TI.$k5,_mcp._TI.$6hy],_mcp._TI.$6i2,"YouTubePlayerAnchorClicked",_mcp._TI.$6de,_mcp._TI.$6do,2,null,null,null],[-1,0,["LinkPreviewComponent","OEmbedVideoPlayerAnchorClicked"],[_mcp._TI.$k5,_mcp._TI.$6hw],_mcp._TI.$6i0,"OEmbedVideoPlayerAnchorClicked",_mcp._TI.$6db,_mcp._TI.$6di,2,null,null,null],[-1,0,["LinkPreviewComponent","VideoPlayerHtmlLookup"],[_mcp._TI.$k5,_mcp._TI.$6hx],_mcp._TI.$6i1,"VideoPlayerHtmlLookup",_mcp._TI.$6dd,_mcp._TI.$6dn,2,null,null,null],[-1,5,["Context","IsPrintRestricted"],[_mcp._TI.$EB,_mcp._TI.$1qk],null,"noPrint",null,null,0,null,null,null]],[[-1,1,["IsReadyToShowContent"],[_mcp._TI.$25k],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0],[-1,5,["UpgradeComponent","IsOnDemandUpgradePending"],[_mcp._TI.$2Rv,_mcp._TI.$8ux],null,"_mcp_I",null,null,0,_mcp._TI.get_$K(),null,null]],[[-1,1,["DoesSupportRichText"],[_mcp._TI.$8vH],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.$EB,_mcp._TI.$44R],null,"TextSelectionType",null,_mcp._TI.$3C,1,_mcp._TI.get_$dX(),null,0]],[[-1,0,["Context","IsCopyRestricted"],[_mcp._TI.$EB,_mcp._TI.$44R],null,"IsCopyRestricted",null,_mcp._TI.$XF,1,null,null,!1],[-1,0,["Context","QuotedBody"],[_mcp._TI.$EB,_mcp._TI.$8pr],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$24(),null,!0],[-1,0,["Context","QuotedBody"],[_mcp._TI.$EB,_mcp._TI.$8pr],null,"Html",null,_mcp._TI.$Ix,1,null,null,null]],[[-1,0,["ExtensibilityComponent","ExtensibilityViewModel"],[_mcp._TI.$3P0,_mcp._TI.$3Ov],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[0,0,["AppPaneIsHidden"],[_mcp._TI.$zo],null,"IsHidden",null,_mcp._TI.$8,1,null,null,!0]],[[-1,0,["MessageBoxViewModel"],[_mcp._TI.$8v4],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null]],[[-1,4,null,null,null,"DialogTitle",null,_mcp._TI.$FV,0,null,null,null,_nbs.NonBootStrings.l_CloseMessageConfirmDialogTitle_Text],[-1,0,["TouchComponent","CloseConfirmDialogButtonData"],[_mcp._TI.$58q,_mcp._TI.$Cnn],null,"ButtonDataList",null,_mcp._TI.$FU,1,null,null,null],[-1,0,["TouchComponent","IsCloseConfirmDialogShown"],[_mcp._TI.$58q,_mcp._TI.$Cno],_mcp._TI.$Cnp,"IsShown",_mcp._TI.$4w,_mcp._TI.$4g,2,null,null,!1]],[[-1,0,["ComplianceComponent","DialogViewModel"],[_mcp._TI.$58p,_mcp._TI.$D2W],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[0,0,["IsShown"],[_mcp._TI.$9q],_mcp._TI.$Dj,"IsShown",_mcp._TI.$4w,_mcp._TI.$4g,2,null,null,!1],[0,0,["Title"],[_mcp._TI.$Ha],null,"DialogTitle",null,_mcp._TI.$Dw,1,null,null,null],[0,0,["CloseCommand"],[_mcp._TI.$Eh],null,"CloseCommand",null,_mcp._TI.$BV,1,null,null,null],[0,0,["ContentDataContext"],[_mcp._TI.$HH],null,"ContentDataContext",null,_mcp._TI.$GA,1,null,null,null],[0,0,["FooterButtons"],[_mcp._TI.$DS],null,"ButtonDataList",null,_mcp._TI.$DT,1,null,null,null]],[[-1,0,["MessageOptionsComponent","DialogViewModel"],[_mcp._TI.$8v5,_mcp._TI.$8ur],null,"DataContext",null,_mcp._TI.$Z,1,null,null,null],[0,0,["IsBusy"],[_mcp._TI.$43g],_mcp._TI.$8ow,"IsBusy",_mcp._TI.$6k9,_mcp._TI.$90d,2,null,null,!1],[0,0,["IsShown"],[_mcp._TI.$9q],_mcp._TI.$Dj,"IsShown",_mcp._TI.$4w,_mcp._TI.$4g,2,null,null,!1],[0,0,["Title"],[_mcp._TI.$Ha],null,"DialogTitle",null,_mcp._TI.$Dw,1,null,null,null],[0,0,["CloseCommand"],[_mcp._TI.$Eh],null,"CloseCommand",null,_mcp._TI.$BV,1,null,null,null],[0,0,["ContentDataContext"],[_mcp._TI.$HH],null,"ContentDataContext",null,_mcp._TI.$GA,1,null,null,null],[0,0,["FooterButtons"],[_mcp._TI.$DS],null,"ButtonDataList",null,_mcp._TI.$DT,1,null,null,null]],[[-1,0,["IsNavigatingAway"],[_mcp._TI.$D2s],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]]]);var n=_mcp._TI._hf.childNodes[13].cloneNode(!0);var fi=new _js.$F(n.children[8]);var dt=new _fce.$5M(n.children[7],_js.$2.Instance.$2(_fc.$l),_js.$2.Instance.$2(_ff.$M),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));dt.set_$B1("MessageOptionsView");var kt=new _fce.$5M(n.children[6],_js.$2.Instance.$2(_fc.$l),_js.$2.Instance.$2(_ff.$M),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));kt.set_$B1("IrmDialogView");var ft=new _b.$5L(n.children[5],_js.$2.Instance.$2(_y.$W),_js.$2.Instance.$2(_fc.$l),_js.$2.Instance.$2(_ff.$M),_js.$2.Instance.$2(_ff.$J));ft.set_$iS(!1);var ot=new _js.$7(n.children[4]);ot.set_$6("MessageBoxDefaultView");var ct=new _js.$7(n.children[3]);ct.set_$6("ComposeExtensibilityView");var yt=new _b.$4C(_B.$3(n,[2,1,4,0]));var ti=new _js.$F(_B.$3(n,[2,1,4]));var vt=new _js.$7(_B.$3(n,[2,1,3]));vt.set_$6("MailComposeView._tidf");var t=_js.$2.Instance.$2(_js.$5P.$$(_z.$Ap)).$9(_B.$3(n,[2,1,2]));t.set_$1zR("_mcp_y ms-font-weight-regular ms-font-color-neutralPrimary");t.set_$3IH(!0);t.set_$4S(!0);t.set_$g(-1);t.set_$3n0("0");var si=new _fc.$A(_B.$3(n,[2,1,1,7]));var f=new _js.$7(_B.$3(n,[2,1,1,6,0,0]));f.set_$6("AttachmentWellViewWrapper");f.set_$rk(!0);f.set_$4S(!0);var bi=new _js.$F(_B.$3(n,[2,1,1,6]));var at=new _js.$7(_B.$3(n,[2,1,1,5,4]));at.set_$6("MailComposeView._tide");var wt=new _js.$7(_B.$3(n,[2,1,1,5,3]));wt.set_$6("MailComposeView._tidd");var lt=new _js.$7(_B.$3(n,[2,1,1,5,2]));lt.set_$6("MailComposeView._tidc");var ht=new _js.$7(_B.$3(n,[2,1,1,5,1]));ht.set_$6("MailComposeView._tid9");var bt=new _js.$7(_B.$3(n,[2,1,1,5,0]));bt.set_$6("MailComposeView._tid8");var wi=new _js.$F(_B.$3(n,[2,1,1,5]));var et=new _fc.$1C(_B.$3(n,[2,1,1,4,1,4,0]));et.set_$g(0);var li=new _fc.$Y(_B.$3(n,[2,1,1,4,1,3]),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));var hi=new _fc.$Y(_B.$3(n,[2,1,1,4,1,2]),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));var ai=new _fc.$Y(_B.$3(n,[2,1,1,4,1,1]),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$J));var yi=new _fc.$H(_B.$3(n,[2,1,1,4,1,0]));var gt=new _fc.$A(_B.$3(n,[2,1,1,4,0]));gt.set_$g(-1);var vi=new _js.$F(_B.$3(n,[2,1,1,4]));var c=new _js.$7(_B.$3(n,[2,1,1,3,2,0]));c.set_$6("ReadOnlyRecipientWellView");c.set_$rk(!0);c.set_$4S(!0);var pi=new _js.$F(_B.$3(n,[2,1,1,3,2]));var k=new _js.$7(_B.$3(n,[2,1,1,3,1,1]));k.set_$6("ReadWriteRecipientWellView");k.set_$rk(!0);var s=new _fc.$H(_B.$3(n,[2,1,1,3,1,0,0]));s.$MK=!0;s.set_$g(-1);s.set_$2v(!0);var ci=new _js.$F(_B.$3(n,[2,1,1,3,1,0]));var ri=new _js.$F(_B.$3(n,[2,1,1,3,1]));var b=new _fc.$H(_B.$3(n,[2,1,1,3,0]));b.set_$g(-1);var ni=new _js.$F(_B.$3(n,[2,1,1,3]));var o=new _js.$7(_B.$3(n,[2,1,1,2,2,0]));o.set_$6("ReadOnlyRecipientWellView");o.set_$rk(!0);o.set_$4S(!0);var nr=new _js.$F(_B.$3(n,[2,1,1,2,2]));var u=new _js.$7(_B.$3(n,[2,1,1,2,1,1]));u.set_$6("ReadWriteRecipientWellView");u.set_$rk(!0);u.set_$4S(!0);var h=new _fc.$H(_B.$3(n,[2,1,1,2,1,0,0]));h.$MK=!0;h.set_$g(-1);h.set_$2v(!0);var tr=new _js.$F(_B.$3(n,[2,1,1,2,1,0]));var ir=new _js.$F(_B.$3(n,[2,1,1,2,1]));var it=new _fc.$H(_B.$3(n,[2,1,1,2,0]));it.set_$g(-1);var pt=new _js.$F(_B.$3(n,[2,1,1,2]));var nt=new _js.$7(_B.$3(n,[2,1,1,1,2,0]));nt.set_$6("ReadOnlyRecipientWellView");nt.set_$4S(!0);var gi=new _js.$F(_B.$3(n,[2,1,1,1,2]));var r=new _js.$7(_B.$3(n,[2,1,1,1,1,1]));r.set_$6("ReadWriteRecipientWellView");r.set_$4S(!0);var i=new _fc.$H(_B.$3(n,[2,1,1,1,1,0,0]));i.$MK=!0;i.set_$g(-1);i.set_$2v(!0);var ki=new _js.$F(_B.$3(n,[2,1,1,1,1,0]));var di=new _js.$F(_B.$3(n,[2,1,1,1,1]));var g=new _fc.$H(_B.$3(n,[2,1,1,1,0]));g.set_$g(0);var d=new _mcp.$mx(_B.$3(n,[2,1,1,0,0]));d.set_$6("MailComposeView._tid1");var ii=new _js.$F(_B.$3(n,[2,1,1]));var rt=_js.$2.Instance.$2(_js.$5P.$$(_b.$9I)).$9(_B.$3(n,[2,1,0]));rt.set_$g(0);var ut=new _js.$F(_B.$3(n,[2,1]));ut.set_$g(-1);var st=new _fc.$17;var tt=new _fc.$N;tt.$M(_E.$D(["TouchComponent","CloseCommand"],[_mcp._TI.$58q,_mcp._TI.$8uv],null,"Command",null,_mcp._TI.$i,1));tt.set_$Y("ESC");var p=new _fc.$N;p.$M(_E.$D(["SaveComponent","SaveCommand"],[_mcp._TI.$44W,_mcp._TI.$43o],null,"Command",null,_mcp._TI.$i,1));p.set_$Y("S");p.$2c=2;var l=new _fc.$N;l.$M(_E.$D(["SendComponent","AltSSendCommand"],[_mcp._TI.$1VR,_mcp._TI.$44T],null,"Command",null,_mcp._TI.$i,1)).$M(_E.$D(["DoesSupportAltSForSend"],[_mcp._TI.$8v0],null,"PreventDefault",null,_mcp._TI.$2SE,1,null,null,!1));l.set_$Y("S");l.$2c=4;var y=new _fc.$N;y.$M(_E.$D(["SendComponent","SendCommand"],[_mcp._TI.$1VR,_mcp._TI.$2pk],null,"Command",null,_mcp._TI.$i,1));y.set_$Y("ENTER");y.$2c=2;var v=new _fc.$N;v.$M(_E.$D(["RecipientComponent","ResolveCommand"],[_mcp._TI.$Ei,_mcp._TI.$44S],null,"Command",null,_mcp._TI.$i,1));v.set_$Y("K");v.$2c=2;var a=new _fc.$N;a.$W(_E.$D(["ContextParent","ContextParent","ShiftTabCommand"],[_mcp._TI.$e,_mcp._TI.$e,_mcp._TI.$6iB],null,"Command",null,_mcp._TI.$i,1)).$W(_E.$D(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp._TI.$e,_mcp._TI.$e,_mcp._TI.$3P3],null,"PreventDefault",null,_mcp._TI.$2SE,1,null,null,!1)).$W(_E.$D(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp._TI.$e,_mcp._TI.$e,_mcp._TI.$3P3],null,"StopPropagation",null,_mcp._TI.$6kL,1,null,null,!1));a.set_$Y("TAB");a.$2c=1;st.set_$2h([tt,p,l,y,v,a]);ut.set_$12([st]);var ei=new _fce.$20(_B.$3(n,[2,0]),_js.$2.Instance.$2(_js.$p),_js.$2.Instance.$2(_ff.$C));var oi=new _fce.$1F(n.children[2],_js.$2.Instance.$2(_js.$p),_js.$2.Instance.$2(_ff.$C),_js.$2.Instance.$2(_ff.$M));var ui=new _js.$F(n.children[1]);var w=new _fce.$20(n.children[0],_js.$2.Instance.$2(_js.$p),_js.$2.Instance.$2(_ff.$C));w.$74=0;w.set_$Lp("");return new _B(n,[w,ui,oi,ei,ut,rt,ii,d,g,di,ki,i,r,gi,nt,pt,it,ir,tr,h,u,nr,o,ni,b,ri,ci,s,k,pi,c,vi,gt,yi,ai,hi,li,et,wi,bt,ht,lt,wt,at,bi,f,si,t,vt,ti,yt,ct,ot,ft,kt,dt,fi]).R({InfoBarControl:rt,FromFieldControl:d,ToRecipientButton:g,ToRecipientWellControl:r,CcRecipientWellControl:pt,CcRecipientButton:it,BccRecipientWellControl:ni,BccRecipientButton:b,SubjectTextBox:et,EditorControl:t,QuotedBodyHtmlLabel:yt,MessageBox:ot,CancelConfirmDialog:ft})},_mcp.$8n,_mcp.$mz,!1,!1,!1,0,_mcp._TI.$1);var o="MessageOptionsView._tidC";new _A(o,function(){_mcp._TI.$1[o]===undefined&&(_mcp._TI.$1[o]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_nbs.NonBootStrings.l_Smime_EncryptMessage_Text],[-1,0,["SmimeEncryptMessage"],[_mcp._TI.$D2x],_mcp._TI.$D31,"IsChecked",_mcp._TI.$61,_mcp._TI.$4q,2,null,null,!1],[-1,0,["SmimeEncryptMessageIsEnabled"],[_mcp._TI.$D2y],null,"IsEnabled",null,_mcp._TI.$9z,1,null,null,!1]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_nbs.NonBootStrings.l_Smime_SignMessage_Text],[-1,0,["SmimeSignMessage"],[_mcp._TI.$D2z],_mcp._TI.$D32,"IsChecked",_mcp._TI.$61,_mcp._TI.$4q,2,null,null,!1],[-1,0,["SmimeSignMessageIsEnabled"],[_mcp._TI.$D30],null,"IsEnabled",null,_mcp._TI.$9z,1,null,null,!1]]]);var n=_mcp._TI._hf.childNodes[29].cloneNode(!0);var i=new _fc.$2p(n.children[1],_js.$2.Instance.$2(_ff.$C));var t=new _fc.$2p(n.children[0],_js.$2.Instance.$2(_ff.$C));return new _B(n,[t,i])},_mcp.$nO,_js.$7,!1,!0,!1,0,_mcp._TI.$1);var u="MessageOptionsView.SensitivityTemplate";new _A(u,function(){_mcp._TI.$1[u]===undefined&&(_mcp._TI.$1[u]=[[[-1,1,["DataContext"],[_mcp._TI.$2S],null,"Text",null,_mcp._TI.$H,1,_mcp._TI.get_$8ue(),null,null]]]);var n=_mcp._TI._hf.childNodes[1].cloneNode(!0);var t=new _fc.$A(n.children[0]);return new _B(n,[t])},Object,_js.$7,!1,!1,!1,0,_mcp._TI.$1);var f="MessageOptionsView";new _A(f,function(){_mcp._TI.$1[f]===undefined&&(_mcp._TI.$1[f]=[[[-1,4,null,null,null,"Text",null,_mcp._TI.$H,0,null,null,null,_nbs.NonBootStrings.l_Sensitivity_Text]],[[-1,0,["SensitivityOptions"],[_mcp._TI.$8vB],null,"Options",null,_mcp._TI.$Cd,1,null,null,null],[-1,0,["Sensitivity"],[_mcp._TI.$8vA],_mcp._TI.$8vG,"SelectedValue",_mcp._TI.$CQ,_mcp._TI.$CR,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_nbs.NonBootStrings.l_RequestDeliveryReceipt_Text],[-1,0,["IsDeliveryReceiptRequested"],[_mcp._TI.$8v8],_mcp._TI.$8vE,"IsChecked",_mcp._TI.$61,_mcp._TI.$4q,2,null,null,!1],[-1,0,["ShowDeliveryReceiptRequest"],[_mcp._TI.$8vC],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp._TI.$1W,0,null,null,null,_nbs.NonBootStrings.l_RequestReadReceipt_Text],[-1,0,["IsReadReceiptRequested"],[_mcp._TI.$8v9],_mcp._TI.$8vF,"IsChecked",_mcp._TI.$61,_mcp._TI.$4q,2,null,null,!1],[-1,0,["ShowReadReceiptRequest"],[_mcp._TI.$8vD],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]],[[-1,0,["ShowSmimeOptions"],[_mcp._TI.$D2w],null,"IsHidden",null,_mcp._TI.$8,1,_mcp._TI.get_$K(),null,!0]]]);var n=_mcp._TI._hf.childNodes[30].cloneNode(!0);var i=new _js.$7(n.children[4]);i.set_$6("MessageOptionsView._tidC");var u=new _fc.$2p(n.children[3],_js.$2.Instance.$2(_ff.$C));var e=new _fc.$2p(n.children[2],_js.$2.Instance.$2(_ff.$C));var t=new _fce.$39(n.children[1]);t.set_$CT("MessageOptionsView.SensitivityTemplate");var r=new _fc.$A(n.children[0]);return new _B(n,[r,t,e,u,i])},_mcp.$nO,_js.$7,!1,!1,!1,0,_mcp._TI.$1)};_mcp._TI.$9S=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_mcp_2'></span> <span class='_mcp_2'></span> </div><div> <span></span> </div><div> <div class='_mcp_s ms-font-weight-regular ms-font-color-neutralDark'></div> </div><div> <button type='button' class='_mcp_e'></button> <div class='_mcp_u'></div> <div class='_mcp_c'></div> <div class='_mcp_c'></div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_j ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_q'></span> <span class='_mcp_q'></span> </div><div> <span class='_mcp_q'></span> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_n _mcp_o _mcp_p ms-font-weight-regular ms-font-color-neutralSecondary'></span> <div></div> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_p ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_p'></span> </div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_r'> <span class='_mcp_7'></span> </div> </div><div> <button autoid=\"_mcp_5\" type='button'></button> <div></div> </div><div> <span class='_mcp_g ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_f'></span> </div><div> <div class='_mcp_D'></div>  <div class='ms-bg-color-themePrimary'></div> <div class='_mcp_F'> <div class='_mcp_G ms-font-weight-regular ms-font-color-neutralPrimary'></div> <div>  <div class='_mcp_M'></div> <div class='_mcp_K'> <div class='_mcp_a'> <div class='_mcp_5 _mcp_L _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'></div> </div> <div class='_mcp_5 _mcp_O _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_C'></button> <div> <div class='_mcp_B'> <button type='button'></button> </div> <div autoid=\"_mcp_0\" class='_mcp_8 _mcp_x'></div> </div> <div> <div class='_mcp_8 _mcp_x'></div> </div> </div> <div class='_mcp_5 _mcp_O _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_C'></button> <div> <div class='_mcp_B'> <button type='button'></button> </div> <div autoid=\"_mcp_1\" class='_mcp_8 _mcp_x'></div> </div> <div> <div class='_mcp_8 _mcp_x'></div> </div> </div> <div class='_mcp_5 _mcp_O _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_C'></button> <div> <div class='_mcp_B'> <button type='button'></button> </div> <div autoid=\"_mcp_2\" class='_mcp_8 _mcp_x'></div> </div> <div> <div class='_mcp_8 _mcp_x'></div> </div> </div> <div class='_mcp_5 _mcp_9 _mcp_b ms-border-color-neutralTertiary ms-bg-color-white'> <span class='_mcp_h ms-font-weight-semibold ms-font-color-black _mcp_k'></span> <div class='_mcp_r'> <button type='button' class='_mcp_w _mcp_m'></button> <span class='_mcp_w _mcp_l'></span> <span class='_mcp_w _mcp_l'></span> <span class='_mcp_w _mcp_l'></span> <div class='_mcp_x'> <input autoid=\"_mcp_3\" class='_mcp_s _mcp_t ms-font-weight-regular ms-font-color-neutralSecondary'/> </div> </div> </div> <div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6 ms-bg-color-white'></div> <div class='_mcp_6'></div> <div class='_mcp_6 ms-bg-color-white'></div> </div> <div> <div class='_mcp_5 ms-bg-color-white'> <div></div> </div> </div> <span></span> </div> <div autoid=\"_mcp_4\" class='_mcp_K ms-bg-color-white'></div> <div class='_mcp_H ms-border-color-neutralTertiary'></div> <div class='_mcp_K ms-bg-color-white'> <span class='_mcp_z ms-font-weight-regular'></span> </div> </div> </div> <div class='_mcp_T _mcp_U'></div> <div></div> <div></div> <div></div> <div></div> <div class='_mcp_E'></div>  </div><div>  <span></span> </div><div> <div class='_mcp_t1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_c\" type='button' class='_mcp_h1'></button> <div class='_mcp_w1'></div> <div class='_mcp_e1'></div> <div class='_mcp_e1'></div> </div><div> <span class='_mcp_l1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_p1'> <span autoid=\"_mcp_l\" class='_mcp_m1 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_C1'></span> <span class='_mcp_C1'></span> </div><div> <span class='_mcp_C1'></span> </div><div> <span class='_mcp_l1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_p1'> <div> <span class='_mcp_C1 _mcp_B1 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_D1'></span> <div></div> </div> </div> </div><div> <span class='_mcp_l1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_p1'> <span autoid=\"_mcp_m\" class='_mcp_B1 ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_l1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_p1'> <span autoid=\"_mcp_n\" class='_mcp_B1 ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_l1 ms-font-weight-semibold ms-font-color-black _mcp_n1'></span> <div class='_mcp_p1'> <span class='_mcp_a1'></span> </div> </div><div> <button autoid=\"_mcp_o\" type='button'></button> <div></div> </div><div> <span class='_mcp_j1 ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_i1'></span> </div><div> <iframe autoid=\"_mcp_s\" class='_mcp_Y1'></iframe> </div><div> <div class='_mcp_Z1'> <span></span> </div> </div><div> <div class='_mcp_R1'></div> <span class='_mcp_R1'></span> <div class='_mcp_11 ms-bg-color-white'> <div class='_mcp_31'>  <span class='_mcp_51'> <div class='_mcp_M1'> <button autoid=\"_mcp_6\" type='button' class='_mcp_H1 ms-font-weight-regular sendButton'></button> <button type='button' class='_mcp_H1 ms-font-weight-regular sendButton'></button> </div> <div class='_mcp_M1'> <button autoid=\"_mcp_7\" type='button' class='_mcp_H1 ms-font-weight-regular closeButton'></button> </div> <div class='_mcp_M1'> <button autoid=\"_mcp_8\" type='button' class='_mcp_H1 ms-font-weight-regular includeButton'></button> </div> <div class='_mcp_M1'> <button autoid=\"_mcp_9\" type='button' class='_mcp_H1 ms-font-weight-regular _mcp_K1'></button> </div> <button autoid=\"_mcp_a\" type='button' class='_mcp_H1 ms-font-weight-regular'></button> </span> <span class='_mcp_61'> <button autoid=\"_mcp_b\" type='button' class='_mcp_H1 ms-font-weight-regular'></button> </span> </div> <div class='_mcp_41 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> <div class='_mcp_Y'> <div class='_mcp_Z _mcp_X1'></div> <div class='_mcp_Z'> <div class='_mcp_01 ms-bg-color-white customScrollBar'>  <div class='_mcp_71 ms-font-weight-regular'></div> <div class='_mcp_81 _mcp_d1 ms-border-color-neutralTertiary'></div> <div class='_mcp_81 _mcp_b1 _mcp_d1 ms-border-color-neutralTertiary'> <button autoid=\"_mcp_d\" type='button' class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_V1'></button> <div class='_mcp_p1 _mcp_r1 _mcp_q1'> <div class='_mcp_U1'> <button autoid=\"_mcp_e\" type='button'></button> </div> <div autoid=\"_mcp_f\" class='_mcp_O1'></div> </div> <div class='_mcp_p1 _mcp_r1 _mcp_q1'> <div class='_mcp_O1'></div> </div>  </div> <div class='_mcp_81 _mcp_b1 _mcp_d1 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_V1'></button> <div class='_mcp_p1 _mcp_r1 _mcp_q1'> <div class='_mcp_U1'> <button type='button'></button> </div> <div autoid=\"_mcp_g\" class='_mcp_O1'></div> </div> <div class='_mcp_p1 _mcp_r1'> <div class='_mcp_O1'></div> </div>  </div> <div class='_mcp_81 _mcp_b1 _mcp_d1 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_V1'></button> <div class='_mcp_p1 _mcp_r1 _mcp_q1'> <div class='peoplePickerContainer'> <button type='button'></button> </div> <div autoid=\"_mcp_h\" class='_mcp_O1'></div> </div> <div class='_mcp_p1 _mcp_r1'> <div class='_mcp_O1'></div> </div>  </div> <div class='_mcp_81'> <span class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_o1 '></span> <span class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_o1 '></span> </div> <div class='_mcp_81 _mcp_91 _mcp_d1 ms-border-color-neutralTertiary'> <span class='_mcp_k1 ms-font-weight-semibold ms-font-color-black _mcp_o1'></span> <div class='_mcp_p1'> <span class='_mcp_Q1'></span> <span autoid=\"_mcp_i\" class='_mcp_P1'></span> <span autoid=\"_mcp_j\" class='_mcp_P1'></span> <span class='_mcp_P1'></span> <div class='_mcp_O1'> <input autoid=\"_mcp_k\" class='_mcp_t1 _mcp_u1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div> <div class='_mcp_c1'></div> <div class='_mcp_c1'></div> <div class='_mcp_c1'></div> <div class='_mcp_c1'></div> <div class='_mcp_c1'></div> </div> <div class='_mcp_y1 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_z1'></div> </div> <span></span> <span></span> <div class='_mcp_W ms-bg-color-white'></div> <div class='_mcp_E1 _mcp_F1 ms-font-color-neutralDark'></div> <div class='_mcp_E1 ms-bg-color-white'></div> <div class='_mcp_02 ms-border-color-neutralTertiary'></div> </div> </div> <div></div> <div class='_mcp_S1 ms-bg-color-white'></div> <div autoid=\"_mcp_p\"></div> <div></div> <div></div>  <div autoid=\"_mcp_q\"></div> <div autoid=\"_mcp_r\"></div>     </div><div> <button autoid=\"_mcp_w\" type='button' class='_mcp_32'></button> <button autoid=\"_mcp_x\" type='button' class='_mcp_32'></button> </div><div> <span class='_mcp_12 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div autoid=\"_mcp_t\" class='_mcp_22'></div> <button autoid=\"_mcp_u\" type='button' class='_mcp_32'></button> <button autoid=\"_mcp_v\" type='button' class='_mcp_32'></button>  <div></div> <div class='_mcp_42'></div>  </div><div> <span class='_mcp_52 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_62'></div> <button type='button' class='_mcp_72'></button> <button type='button' class='_mcp_72'></button>  </div>";_js.$F.get_$9G().appendChild(n);return n};_mcp._TI.$D2U=function(n){return n.$Ql};_mcp._TI.$D2T=function(n){return n.$4Wj};_mcp._TI.$Ei=function(n){return n.get_$af()};_mcp._TI.$2Rt=function(n){return n.$o5};_mcp._TI.$8ut=function(n){return n.get_$1Rx()};_mcp._TI.$3P2=function(n){return n.get_$E9M()};_mcp._TI.$3Oy=function(n){return n.get_$Tf()};_mcp._TI.$2p=function(n){return n.$3W};_mcp._TI.$3n=function(n){return n.get_$1C()};_mcp._TI.$8uu=function(n){return n.$5Wu};_mcp._TI.$EB=function(n){return n.$c};_mcp._TI.$57R=function(n){return n.get_$3o()};_mcp._TI.$1VQ=function(n){return n.get_$CMF()};_mcp._TI.$8up=function(n){return n.get_$2va()};_mcp._TI.$2S=function(n){return n.get_$k()};_mcp._TI.$58n=function(n){return n.get_$4fr()};_mcp._TI.$58o=function(n){return n.get_$6Rl()};_mcp._TI.$8ul=function(n){return n.get_$F16()};_mcp._TI.$8uk=function(n){return n.get_$1pY()};_mcp._TI.$8pq=function(n){return n.get_$5KW()};_mcp._TI.$8uo=function(n){return n.get_$51J()};_mcp._TI.$2Rv=function(n){return n.get_$7Nt()};_mcp._TI.$8uw=function(n){return n.get_$7dN()};_mcp._TI.$8uz=function(n){return n.get_$9kQ()};_mcp._TI.$8uy=function(n){return n.get_$8YE()};_mcp._TI.$Tm=function(n){return n.$3V};_mcp._TI.$7A=function(n){return n.get_$ZZ()};_mcp._TI.$25k=function(n){return n.$3yW};_mcp._TI.$8v1=function(n){return n.get_$lN()};_mcp._TI.$3P0=function(n){return n.get_$39B()};_mcp._TI.$3Ov=function(n){return n.$65};_mcp._TI.$zo=function(n){return n.get_$1Pe()};_mcp._TI.$D2o=function(n){return n.get_$AWp()};_mcp._TI.$8v7=function(n){return n.$5cl};_mcp._TI.$6i9=function(n){return n.$5XJ};_mcp._TI.$58q=function(n){return n.get_$5cz()};_mcp._TI.$8uv=function(n){return n.$5a};_mcp._TI.$44W=function(n){return n.get_$1Ng()};_mcp._TI.$43o=function(n){return n.get_$1AP()};_mcp._TI.$1VR=function(n){return n.get_$iH()};_mcp._TI.$44T=function(n){return n.$1a3};_mcp._TI.$8v0=function(n){return n.get_$5za()};_mcp._TI.$2pk=function(n){return n.get_$2XC()};_mcp._TI.$44S=function(n){return n.$1Nd};_mcp._TI.$e=function(n){return n.$7Q};_mcp._TI.$6iB=function(n){return n.$7DG};_mcp._TI.$3P3=function(n){return n.$4H1};_mcp._TI.$6i6=function(n){return n.$1d};_mcp._TI.$1Fj=function(n){return n.get_$jf()};_mcp._TI.$6i8=function(n){return n.get_$aA()};_mcp._TI.$8vH=function(n){return n.get_$AXq()};_mcp._TI.$8pp=function(n){return n.get_$ow()};_mcp._TI.$2Ru=function(n){return n.$GI};_mcp._TI.$1VP=function(n){return n.get_$E5p()};_mcp._TI.$fu=function(n){return n.get_$4uc()};_mcp._TI.$1VO=function(n){return n.$NH};_mcp._TI.$8vK=function(n){return n.get_$3z9()};_mcp._TI.$6i7=function(n){return n.get_$fP()};_mcp._TI.$3Ox=function(n){return n.$5X};_mcp._TI.$3OC=function(n){return n.get_$fP()};_mcp._TI.$3Ow=function(n){return n.$RC};_mcp._TI.$2Rs=function(n){return n.$GM};_mcp._TI.$8vJ=function(n){return n.get_$3wL()};_mcp._TI.$8po=function(n){return n.get_$1LT()};_mcp._TI.$2Rr=function(n){return n.$Ge};_mcp._TI.$8vI=function(n){return n.get_$3wE()};_mcp._TI.$3OJ=function(n){return n.get_$23R()};_mcp._TI.$58p=function(n){return n.get_$AIA()};_mcp._TI.$D2X=function(n){return n.$4HZ};_mcp._TI.$8ug=function(n){return n.$2O3};_mcp._TI.$8pu=function(n){return n.get_$T0()};_mcp._TI.$8pt=function(n){return n.get_$PT()};_mcp._TI.$8v2=function(n){return n.get_$C3i()};_mcp._TI.$8um=function(n){return n.$4x8};_mcp._TI.$8pn=function(n){return n.get_$Bv()};_mcp._TI.$5L=function(n){return n.get_$1K()};_mcp._TI.$8uj=function(n){return n.get_$6Yk()};_mcp._TI.$8ps=function(n){return n.get_$9lZ()};_mcp._TI.$8ui=function(n){return n.get_$2MC()};_mcp._TI.$8pm=function(n){return n.get_$3Fs()};_mcp._TI.$44U=function(n){return n.get_$eM()};_mcp._TI.$6ho=function(n){return n.get_$9Z()};_mcp._TI.$8pF=function(n){return n.get_$kd()};_mcp._TI.$1qk=function(n){return n.get_$CE8()};_mcp._TI.$44R=function(n){return n.get_$2Nf()};_mcp._TI.$6fZ=function(n){return n.get_$MW()};_mcp._TI.$2p7=function(n){return n.get_$DY()};_mcp._TI.$6fa=function(n){return n.get_$dp()};_mcp._TI.$1pv=function(n){return n.get_$mf()};_mcp._TI.$6fb=function(n){return n.get_$1vd()};_mcp._TI.$6dc=function(n){return n.get_$7JM()};_mcp._TI.$44V=function(n){return n.get_$7eM()};_mcp._TI.$8uh=function(n){return n.$7I9};_mcp._TI.$6hp=function(n){return n.$7IB};_mcp._TI.$D2p=function(n){return n.get_$AZv()};_mcp._TI.$D2b=function(n){return n.get_$3W0()};_mcp._TI.$43E=function(n){return n.$10W};_mcp._TI.$8pl=function(n){return n.get_$6P()};_mcp._TI.$43D=function(n){return n.$Et};_mcp._TI.$6i5=function(n){return n.get_$AZr()};_mcp._TI.$6hr=function(n){return n.$r4};_mcp._TI.$3Nx=function(n){return n.$1QD};_mcp._TI.$Cnk=function(n){return n.get_$6QA()};_mcp._TI.$k5=function(n){return n.get_$CIH()};_mcp._TI.$6hu=function(n){return n.$Sc};_mcp._TI.$6ht=function(n){return n.$rc};_mcp._TI.$6da=function(n){return n.$rc};_mcp._TI.$6hv=function(n){return n.$24N};_mcp._TI.$6hy=function(n){return n.$ck};_mcp._TI.$6de=function(n){return n.$ck};_mcp._TI.$6hw=function(n){return n.$c8};_mcp._TI.$6db=function(n){return n.$c8};_mcp._TI.$6hx=function(n){return n.$Va};_mcp._TI.$6dd=function(n){return n.$Va};_mcp._TI.$8ux=function(n){return n.get_$CDN()};_mcp._TI.$8pr=function(n){return n.get_$1gL()};_mcp._TI.$8v4=function(n){return n.$2F};_mcp._TI.$Cnn=function(n){return n.get_$5rl()};_mcp._TI.$Cno=function(n){return n.get_$2Na()};_mcp._TI.$4w=function(n){return n.get_$1C()};_mcp._TI.$D2W=function(n){return n.$E6};_mcp._TI.$9q=function(n){return n.$3W};_mcp._TI.$Ha=function(n){return n.$7w};_mcp._TI.$Eh=function(n){return n.$5a};_mcp._TI.$HH=function(n){return n.$Vo};_mcp._TI.$DS=function(n){return n.$9B};_mcp._TI.$8v5=function(n){return n.get_$3Ma()};_mcp._TI.$8ur=function(n){return n.$E6};_mcp._TI.$43g=function(n){return n.$G7};_mcp._TI.$6k9=function(n){return n.$G7};_mcp._TI.$D2s=function(n){return n.$1di};_mcp._TI.$3P1=function(n){return n.get_$1du()};_mcp._TI.$8us=function(n){return n.$5xt};_mcp._TI.$D2g=function(n){return n.$1Zi};_mcp._TI.$D2d=function(n){return n.$1W5};_mcp._TI.$8v3=function(n){return n.get_$2N2()};_mcp._TI.$8un=function(n){return n.$4UR};_mcp._TI.$6i3=function(n){return n.get_$CDy()};_mcp._TI.$3Oz=function(n){return n.get_$5yu()};_mcp._TI.$58m=function(n){return n.$Fp};_mcp._TI.$Cnj=function(n){return n.get_$3uZ()};_mcp._TI.$8uf=function(n){return n.get_$Tf()};_mcp._TI.$D2u=function(n){return n.$5XF};_mcp._TI.$8v6=function(n){return n.$26L};_mcp._TI.$k2=function(n){return n.get_$22r()};_mcp._TI.$1eh=function(n){return n.get_$1C()};_mcp._TI.$1eY=function(n){return n.get_$1C()};_mcp._TI.$fp=function(n){return n.get_$S()};_mcp._TI.$8pX=function(n){return n.get_$2xe()};_mcp._TI.$8pY=function(n){return n.get_$5Xc()};_mcp._TI.$6i4=function(n){return n.get_$1kA()};_mcp._TI.$6hq=function(n){return n.get_$Tf()};_mcp._TI.$D2q=function(n){return n.get_$C2d()};_mcp._TI.$D2r=function(n){return n.get_$2N9()};_mcp._TI.$Cnm=function(n){return n.get_$DnI()};_mcp._TI.$Cmy=function(n){return n.get_$3hN()};_mcp._TI.$sG=function(n){return n.$G6};_mcp._TI.$EM=function(n){return n.get_$A()};_mcp._TI.$D2m=function(n){return n.get_$CFq()};_mcp._TI.$D2n=function(n){return n.get_$Eoj()};_mcp._TI.$D2l=function(n){return n.get_$C9I()};_mcp._TI.$D2k=function(n){return n.get_$AEI()};_mcp._TI.$D2j=function(n){return n.get_$A9M()};_mcp._TI.$Cnl=function(n){return n.get_$19y()};_mcp._TI.$D35=function(n){return n.$6U2};_mcp._TI.$D33=function(n){return n.$18W};_mcp._TI.$D34=function(n){return n.get_$CEM()};_mcp._TI.$D2t=function(n){return n.$5Wc};_mcp._TI.$D2Y=function(n){return n.$1kw};_mcp._TI.$D2Z=function(n){return n.$237};_mcp._TI.$1ef=function(n){return n.$6R};_mcp._TI.$D2v=function(n){return n.get_$7G5()};_mcp._TI.$D2f=function(n){return n.$1YZ};_mcp._TI.$D2e=function(n){return n.$1YX};_mcp._TI.$D2x=function(n){return n.$1Yg};_mcp._TI.$61=function(n){return n.$HT};_mcp._TI.$D2y=function(n){return n.$5ZS};_mcp._TI.$D2z=function(n){return n.$1Yh};_mcp._TI.$D30=function(n){return n.$5ZW};_mcp._TI.$8vB=function(n){return n.get_$EA2()};_mcp._TI.$8vA=function(n){return n.$3XJ};_mcp._TI.$CQ=function(n){return n.get_$BK()};_mcp._TI.$8v8=function(n){return n.$3wi};_mcp._TI.$8vC=function(n){return n.get_$Edq()};_mcp._TI.$8v9=function(n){return n.$3yU};_mcp._TI.$8vD=function(n){return n.get_$EfT()};_mcp._TI.$D2w=function(n){return n.$5Yt};_mcp._TI.$H=function(n,t){n.set_$1K(t)};_mcp._TI.$Z=function(n,t){n.set_$k(t)};_mcp._TI.$x=function(n,t){n.set_$BI(t)};_mcp._TI.$1W=function(n,t){n.set_$1K(t)};_mcp._TI.$2n=function(n,t){n.set_$4E(t)};_mcp._TI.$3q=function(n,t){n.set_$KX(t)};_mcp._TI.$49=function(n,t){n.set_$1C(t)};_mcp._TI.$3m=function(n,t){n.set_$1C(t)};_mcp._TI.$8=function(n,t){n.set_$17(t)};_mcp._TI.$8uq=function(n,t){n.set_$2va(t)};_mcp._TI.$zl=function(n,t){n.set_$1lg(t)};_mcp._TI.$a=function(n,t){n.set_$4k(t)};_mcp._TI.$1o=function(n,t){n.set_$Es(t)};_mcp._TI.$5o=function(n,t){n.set_$ac(t)};_mcp._TI.$5z=function(n,t){n.set_$NV(t)};_mcp._TI.$BU=function(n,t){n.set_$Lp(t)};_mcp._TI.$14=function(n,t){n.set_$2O(t)};_mcp._TI.$AD=function(n,t){n.set_$7d(t)};_mcp._TI.$i=function(n,t){n.$6G=t};_mcp._TI.$2SE=function(n,t){n.$QO=t};_mcp._TI.$6kL=function(n,t){n.$GG=t};_mcp._TI.$OW=function(n,t){n.set_$20(t)};_mcp._TI.$8pw=function(n,t){n.set_$3o(t)};_mcp._TI.$5G=function(n,t){n.set_$1K(t)};_mcp._TI.$Ym=function(n,t){n.set_$D6(t)};_mcp._TI.$D2V=function(n,t){n.set_$9Z(t)};_mcp._TI.$XF=function(n,t){n.set_$2Nf(t)};_mcp._TI.$6dk=function(n,t){n.set_$EcA(t)};_mcp._TI.$6fc=function(n,t){n.set_$MW(t)};_mcp._TI.$2p8=function(n,t){n.set_$DY(t)};_mcp._TI.$6fd=function(n,t){n.set_$dp(t)};_mcp._TI.$1ea=function(n,t){n.set_$mf(t)};_mcp._TI.$6fe=function(n,t){n.set_$1vd(t)};_mcp._TI.$6dm=function(n,t){n.set_$7JM(t)};_mcp._TI.$8mQ=function(n,t){n.set_$7IA(t)};_mcp._TI.$6dl=function(n,t){n.set_$7IC(t)};_mcp._TI.$D2c=function(n,t){n.set_$3W0(t)};_mcp._TI.$43F=function(n,t){n.set_$70A(t)};_mcp._TI.$8pv=function(n,t){n.set_$6P(t)};_mcp._TI.$8mP=function(n,t){n.set_$4xV(t)};_mcp._TI.$6hs=function(n,t){n.set_$Nf(t)};_mcp._TI.$3Ny=function(n,t){n.set_$16X(t)};_mcp._TI.$Ced=function(n,t){n.set_$G8(t)};_mcp._TI.$1pw=function(n,t){n.$2HS=t};_mcp._TI.$2p9=function(n,t){n.$Fp=t};_mcp._TI.$2pA=function(n,t){n.$E0=t};_mcp._TI.$3O0=function(n,t){n.$LB=t};_mcp._TI.$562=function(n,t){n.$1a3=t};_mcp._TI.$3Nz=function(n,t){n.$1Nd=t};_mcp._TI.$6dg=function(n,t){n.$Sc=t};_mcp._TI.$6hz=function(n,t){n.set_$4o7(t)};_mcp._TI.$6df=function(n,t){n.set_$4o7(t)};_mcp._TI.$6dh=function(n,t){n.set_$3LC(t)};_mcp._TI.$6i2=function(n,t){n.set_$1wV(t)};_mcp._TI.$6do=function(n,t){n.set_$1wV(t)};_mcp._TI.$6i0=function(n,t){n.set_$1rz(t)};_mcp._TI.$6di=function(n,t){n.set_$1rz(t)};_mcp._TI.$6i1=function(n,t){n.set_$1ZX(t)};_mcp._TI.$6dn=function(n,t){n.set_$1ZX(t)};_mcp._TI.$3C=function(n,t){n.set_$VY(t)};_mcp._TI.$Ix=function(n,t){n.set_$Sa(t)};_mcp._TI.$FV=function(n,t){n.set_$ID(t)};_mcp._TI.$FU=function(n,t){n.set_$IA(t)};_mcp._TI.$Cnp=function(n,t){n.set_$2Na(t)};_mcp._TI.$4g=function(n,t){n.set_$1C(t)};_mcp._TI.$Dj=function(n,t){n.set_$1C(t)};_mcp._TI.$Dw=function(n,t){n.set_$ID(t)};_mcp._TI.$BV=function(n,t){n.set_$H4(t)};_mcp._TI.$GA=function(n,t){n.set_$FD(t)};_mcp._TI.$DT=function(n,t){n.set_$IA(t)};_mcp._TI.$8ow=function(n,t){n.set_$7d(t)};_mcp._TI.$90d=function(n,t){n.set_$7d(t)};_mcp._TI.$LY=function(n,t){n.set_$Br(t)};_mcp._TI.$1l=function(n,t){n.set_$4E(t)};_mcp._TI.$db=function(n,t){n.set_$2t(t)};_mcp._TI.$aM=function(n,t){n.set_$1A3(t)};_mcp._TI.$1ei=function(n,t){n.set_$1C(t)};_mcp._TI.$1eZ=function(n,t){n.set_$1C(t)};_mcp._TI.$Yg=function(n,t){n.set_$T5(t)};_mcp._TI.$1b=function(n,t){n.set_$3u(t)};_mcp._TI.$6iA=function(n,t){n.$Zb=t};_mcp._TI.$8i=function(n,t){n.set_$g(t)};_mcp._TI.$D2a=function(n,t){n.set_$2lr(t)};_mcp._TI.$1fA=function(n,t){n.set_$cD(t)};_mcp._TI.$D2i=function(n,t){n.set_$3bI(t)};_mcp._TI.$D2h=function(n,t){n.set_$3b5(t)};_mcp._TI.$D31=function(n,t){n.set_$PT(t)};_mcp._TI.$4q=function(n,t){n.set_$8x(t)};_mcp._TI.$9z=function(n,t){n.set_$2t(t)};_mcp._TI.$D32=function(n,t){n.set_$T0(t)};_mcp._TI.$Cd=function(n,t){n.set_$B5(t)};_mcp._TI.$8vG=function(n,t){n.set_$ET(t)};_mcp._TI.$CR=function(n,t){n.set_$BK(t)};_mcp._TI.$8vE=function(n,t){n.set_$Qu(t)};_mcp._TI.$8vF=function(n,t){n.set_$Q8(t)};_mcp._TI.get_$24=function(){_mcp._TI.$47||(_mcp._TI.$47=new _fc.$6Q);return _mcp._TI.$47};_mcp._TI.get_$K=function(){_mcp._TI.$2L||(_mcp._TI.$2L=new _fc.$42);return _mcp._TI.$2L};_mcp._TI.get_$2oo=function(){_mcp._TI.$11B||(_mcp._TI.$11B=new _cc.$To);return _mcp._TI.$11B};_mcp._TI.get_$42P=function(){_mcp._TI.$11A||(_mcp._TI.$11A=new _cc.$Zr);return _mcp._TI.$11A};_mcp._TI.get_$w0=function(){_mcp._TI.$Xi||(_mcp._TI.$Xi=new _n.$RQ);return _mcp._TI.$Xi};_mcp._TI.get_$8mG=function(){_mcp._TI.$4Mq||(_mcp._TI.$4Mq=new _b.$1BV);return _mcp._TI.$4Mq};_mcp._TI.get_$dX=function(){_mcp._TI.$1PH||(_mcp._TI.$1PH=new _n.$rQ);return _mcp._TI.$1PH};_mcp._TI.get_$7s=function(){_mcp._TI.$DL||(_mcp._TI.$DL=new _fce.$ES);return _mcp._TI.$DL};_mcp._TI.get_$ft=function(){_mcp._TI.$Pd||(_mcp._TI.$Pd=new _n.$MW);return _mcp._TI.$Pd};_mcp._TI.get_$8ue=function(){_mcp._TI.$4NV||(_mcp._TI.$4NV=new _mcp.$187);return _mcp._TI.$4NV};MailComposeComponent.registerClass("MailComposeComponent",null,_a.$1X7);_mcp.$sN.registerClass("_mcp.$sN",_h.$TS.$$(_g.$ac,_g.$WF));_mcp.$14n.registerClass("_mcp.$14n",_js.$Ec);_mcp.$Gn.registerClass("_mcp.$Gn",_mcp.$14n,_y.$1WH,IMailComposeOverridable);_mcp.$Kn.registerClass("_mcp.$Kn",_mcp.$14n,IMailComposeSaveComponent,IMailComposeOverridable);_mcp.$1Ku.registerClass("_mcp.$1Ku",_mcp.$Kn);_mcp.$JQ.registerClass("_mcp.$JQ",_mcp.$14n);_mcp.$1Kw.registerClass("_mcp.$1Kw");_mcp.$1Kx.registerClass("_mcp.$1Kx",_mcp.$14n);_mcp.$Ow.registerClass("_mcp.$Ow",_mcp.$14n);_mcp.$1Kz.registerClass("_mcp.$1Kz",_mcp.$14n);_mcp.$1L0.registerClass("_mcp.$1L0",_mcp.$14n);_mcp.$eU.registerClass("_mcp.$eU",_mcp.$14n);_mcp.$1L3.registerClass("_mcp.$1L3",_mcp.$14n);_mcp.$eT.registerClass("_mcp.$eT",_mcp.$14n);_mcp.$14o.registerClass("_mcp.$14o",_mcp.$14n);_mcp.$MZ.registerClass("_mcp.$MZ",_mcp.$14n,_y.$1Vj);_mcp.$7y.registerClass("_mcp.$7y",_mcp.$14n);_mcp.$1L5.registerClass("_mcp.$1L5",_mcp.$14n);_mcp.$1L6.registerClass("_mcp.$1L6",_mcp.$14n,_y.$1Vu);_mcp.$1L7.registerClass("_mcp.$1L7",_mcp.$14n);_mcp.$Ma.registerClass("_mcp.$Ma",_mcp.$14n);_mcp.$HY.registerClass("_mcp.$HY",_mcp.$14n,_y.$1YS);_mcp.$JR.registerClass("_mcp.$JR",_js.$Ec);_mcp.$3t.registerClass("_mcp.$3t",_mcp.$14n);_mcp.$II.registerClass("_mcp.$II",_mcp.$14n);_mcp.$G6.registerClass("_mcp.$G6",_mcp.$14n,IMailComposeSendComponent,IMailComposeOverridable);_mcp.$1LA.registerClass("_mcp.$1LA",_mcp.$14n);_mcp.$1L9.registerClass("_mcp.$1L9",_mcp.$14n);_mcp.$G7.registerClass("_mcp.$G7",_mcp.$14n);_mcp.$ui.registerClass("_mcp.$ui",_mcp.$14n,IMailComposeTouchComponent);_mcp.$1LC.registerClass("_mcp.$1LC",_mcp.$14n);_mcp.$1L4.registerClass("_mcp.$1L4",_mcp.$14n);_mcp.$1L8.registerClass("_mcp.$1L8",_mcp.$14n);_mcp.$1L1.registerClass("_mcp.$1L1",_mcp.$14n,_y.$1Vn,_y.$1Vo,_y.$1Vk);_mcp.$1LD.registerClass("_mcp.$1LD",null,_y.$13W);_mcp.$1PW.registerClass("_mcp.$1PW",null,ISendEvent);_mcp.$1PX.registerClass("_mcp.$1PX",null,ISendFailedEvent);_mcp.$pc.registerClass("_mcp.$pc",null,ISendFailedO365Event);_mcp.$184.registerClass("_mcp.$184",null,ISendFailureRemoveO365Event);_mcp.$1Pc.registerClass("_mcp.$1Pc",null,ISendSucceededEvent);_mcp.$mv.registerClass("_mcp.$mv",null,IMailComposeActionFactory);_mcp.$1Kv.registerClass("_mcp.$1Kv");_mcp.$1Ky.registerClass("_mcp.$1Ky",null,IMailComposeContextFactory);_mcp.$14q.registerClass("_mcp.$14q",null,IMailComposeViewModelFactory,_bc.$1Jj);_mcp.$147.registerClass("_mcp.$147",_a.$En);_mcp.$ug.registerClass("_mcp.$ug",_js.$Ec,_y.$1Vt);_mcp.$V.registerClass("_mcp.$V",_a.$1ad,_g.$1Yi,_y.$1Vr,_bc.$1Uj);_mcp.$uh.registerClass("_mcp.$uh",null,IMailComposeDiscardManager);_mcp.$1W.registerClass("_mcp.$1W",_a.$10v);_mcp.$1LB.registerClass("_mcp.$1LB");_mcp.$8n.registerClass("_mcp.$8n",_y.$1b6,_y.$Cz,_y.$ID,_bc.$mB,_a.$1Y6,_js.$13p,Sys.IDisposable,_y.$13q,_y.$tg,_bc.$Kk,_bc.$e2,_y.$IC,IMailComposeOverridable);_mcp.$ur.registerClass("_mcp.$ur",_a.$En,_y.$1Vq);_mcp.$14u.registerClass("_mcp.$14u",null,IMailResponseViewModelFactory);_mcp.$nO.registerClass("_mcp.$nO",_a.$En);_mcp.$w4.registerClass("_mcp.$w4");_mcp.$1NA.registerClass("_mcp.$1NA");_mcp.$1Ou.registerClass("_mcp.$1Ou");_mcp.$187.registerClass("_mcp.$187",null,_js.$1KJ);_mcp.$se.registerClass("_mcp.$se",_js.$F,_b.$1J7);_mcp.$1.registerClass("_mcp.$1");_mcp.$mx.registerClass("_mcp.$mx",_js.$7);_mcp.$mz.registerClass("_mcp.$mz",_js.$7,_ff.$FA);_mcp.$mz.$y8.registerClass("_mcp.$mz.$y8");_mcp._TI.registerClass("_mcp._TI");_mcp.$Gn.$5mq=new _H("AttachmentWellViewModel",_y.$1IQ,_mcp.$Gn);_mcp.$Gn.$24o=new _H("Menu",_fm.$1u,_mcp.$14n);_mcp.$JQ.$6Wy=new _y.$2a(_u.CommonStrings.l_LoadingPermissions_LowerCase_Text,null,null);_mcp.$Ow.$24o=new _H("Menu",_fm.$1u,_mcp.$Ow);_mcp.$eT.$3Tw=[6800,3200,3205,3210,3215,3220,3100,3105,3110,3115,3120,3250,3255,3260];_mcp.$MZ.$wS=[84,85,86,87];_mcp.$7y.$65A=new _H("FromDetailsViewModel",_pe.$96,_mcp.$7y);_mcp.$7y.$73m=new _H("SenderDetailsViewModel",_pe.$96,_mcp.$7y);_mcp.$7y.$6XG=new _H("LocationViewModel",_cc.$Cb,_mcp.$7y);_mcp.$7y.$6Rm=new _H("IsMeetingForwardOnBehalfOf",Boolean,_mcp.$7y);_mcp.$7y.$DxN=new _H("RecurrencePatternDataObject",_cc.$Cj,_mcp.$7y);_mcp.$JR.$2to=7;_mcp.$JR.$5LD=1;_mcp.$3t.$70C=new _H("ResizeEditorCommand",_js.$Ct,_mcp.$3t);_mcp.$Kn.$wS=[60,40,43,1001,700,50,800,88,89];_mcp.$II.$24o=new _H("Menu",_fm.$1u,_mcp.$II);_mcp.$G6.$6Yh=10;_mcp.$G6.$8bp="MailSatisfactionSurvey";_mcp.$G6.$wS=[62,45,46,47,700,55,70,65,66,75,800,88,80,48,89];_mcp.$G7.$9mU=_a.UserAgent.getInstance().$Ec?_js.$9.$5K("{0}{0}","<P></P>"):_js.$9.$5K("{0}{0}","<P><BR></P>");_mcp.$G7.$9L7=new RegExp("[\n\r]+","g");_mcp.$V.$7Oy=new _H("ViewModelId",String,_mcp.$V);_mcp.$V.$48c=new _H("Operation",_y.$1m,_mcp.$V);_mcp.$V.$26K=new _H("Mode",_y.$Ox,_mcp.$V);_mcp.$V.$6rP=new _H("OriginalId",_g.$1T,_mcp.$V);_mcp.$V.$6rN=new _H("OriginalDocumentId",Number,_mcp.$V);_mcp.$V.$6rQ=new _H("OriginalItem",_g.$11,_mcp.$V);_mcp.$V.$5zt=new _H("DraftId",_g.$1T,_mcp.$V);_mcp.$V.$7H7=new _H("StoreId",String,_mcp.$V);_mcp.$V.$qH=new _H("Subject",String,_mcp.$V,"");_mcp.$V.$72n=new _H("SelectedDataCallContext",_fm.$1In,_mcp.$V);_mcp.$V.$38L=new _H("EditorContent",String,_mcp.$V,"");_mcp.$V.$6wi=new _H("RawEditorContent",String,_mcp.$V);_mcp.$V.$7JN=new _H("TextEditorContent",String,_mcp.$V);_mcp.$V.$5o1=new _H("BodyType",String,_mcp.$V);_mcp.$V.$2aq=new _H("ToRecipients",_js.$IB,_mcp.$V);_mcp.$V.$5Zp=new _H("SpeechResultRecipients",_js.$IB,_mcp.$V);_mcp.$V.$3dI=new _H("ToQueryString",String,_mcp.$V);_mcp.$V.$2Es=new _H("CcRecipients",_js.$IB,_mcp.$V);_mcp.$V.$342=new _H("CcQueryString",String,_mcp.$V);_mcp.$V.$2EB=new _H("BccRecipients",_js.$IB,_mcp.$V);_mcp.$V.$32n=new _H("BccQueryString",String,_mcp.$V);_mcp.$V.$5WZ=new _H("AutoAddSignature",Boolean,_mcp.$V,!0);_mcp.$V.$3Gg=new _H("Importance",String,_mcp.$V,"Normal");_mcp.$V.$6wU=new _H("QuotedBody",String,_mcp.$V);_mcp.$V.$7G2=new _H("SmimeContent",String,_mcp.$V);_mcp.$V.$7G4=new _H("SmimeErrorCode",Number,_mcp.$V);_mcp.$V.$7G6=new _H("SmimeRecipientCerts",Array,_mcp.$V);_mcp.$V.$7G7=new _H("SmimeSigningCert",String,_mcp.$V);_mcp.$V.$6PW=new _H("IsComplete",Boolean,_mcp.$V);_mcp.$V.$4wl=new _H("IsMeeting",Boolean,_mcp.$V);_mcp.$V.$6Rn=new _H("IsMeetingForward",Boolean,_mcp.$V);_mcp.$V.$6T5=new _H("IsReplyAllOnBcc",Boolean,_mcp.$V);_mcp.$V.$3LQ=new _H("Location",_g.$3Q,_mcp.$V);_mcp.$V.$6Kg=new _H("HasLocation",Boolean,_mcp.$V);_mcp.$V.$6Yq=new _H("MeetingCalendarTimePeriod",_cc.$86,_mcp.$V);_mcp.$V.$6w3=new _H("ProposedNewTime",_cc.$9d,_mcp.$V);_mcp.$V.$2Ie=new _H("From",_g.$8w,_mcp.$V);_mcp.$V.$73n=new _H("Sender",_g.$8w,_mcp.$V);_mcp.$V.$6UV=new _H("IsUpgraded",Boolean,_mcp.$V);_mcp.$V.$6Qd=new _H("IsFromShown",Boolean,_mcp.$V);_mcp.$V.$6P7=new _H("IsBccShown",Boolean,_mcp.$V);_mcp.$V.$3T9=new _H("ParentFolderNameToPost",String,_mcp.$V);_mcp.$V.$6sU=new _H("ParentFolderIdToPost",_g.$38,_mcp.$V);_mcp.$V.$2E4=new _H("AttachmentCollection",_js.$X,_mcp.$V);_mcp.$V.$5mm=new _H("AttachmentsToHide",Array,_mcp.$V);_mcp.$V.$7Nv=new _H("UpgradeFailed",Boolean,_mcp.$V);_mcp.$V.$5nc=new _H("Baseline",_mcp.$1W,_mcp.$V);_mcp.$V.$6KN=new _H("HasBeenSavedByUser",Boolean,_mcp.$V);_mcp.$V.$6T7=new _H("IsReplyForward",Boolean,_mcp.$V);_mcp.$V.$5zu=new _H("Draft",_g.$11,_mcp.$V);_mcp.$V.$70y=new _H("RightsManagementLicenseData",_g.$gn,_mcp.$V);_mcp.$V.$34Z=new _H("ComplianceId",String,_mcp.$V);_mcp.$V.$6PN=new _H("IsClassified",Boolean,_mcp.$V);_mcp.$V.$5r0=new _H("ClassificationGuid",String,_mcp.$V);_mcp.$V.$5r2=new _H("Classification",String,_mcp.$V);_mcp.$V.$5qz=new _H("ClassificationDescription",String,_mcp.$V);_mcp.$V.$5r1=new _H("ClassificationKeep",Boolean,_mcp.$V);_mcp.$V.$3XK=new _H("Sensitivity",String,_mcp.$V,"Normal");_mcp.$V.$3I6=new _H("IsDeliveryReceiptRequested",Boolean,_mcp.$V);_mcp.$V.$3JS=new _H("IsReadReceiptRequested",Boolean,_mcp.$V);_mcp.$V.$3bQ=new _H("SmimeEncryptMessage",Boolean,_mcp.$V);_mcp.$V.$3bT=new _H("SmimeSignMessage",Boolean,_mcp.$V);_mcp.$V.$356=new _H("ConversationId",_g.$1T,_mcp.$V);_mcp.$V.$6sR=new _H("ParentConversationNodeId",String,_mcp.$V);_mcp.$V.$6SP=new _H("IsOriginalIdCalendarItemId",Boolean,_mcp.$V);_mcp.$V.$6SH=new _H("IsOccurrenceReferencingMaster",Boolean,_mcp.$V);_mcp.$V.$6Sd=new _H("IsPoppedOutFromInline",Boolean,_mcp.$V);_mcp.$V.$6RV=new _H("IsLoadedDraft",Boolean,_mcp.$V);_mcp.$V.$7PO=new _H("WasCleanNewMessageBeforePopout",Boolean,_mcp.$V);_mcp.$V.$6LW=new _H("HideIncludeEntrypoint",Boolean,_mcp.$V,!1);_mcp.$V.$7PQ=new _H("WasSavingBeforePopout",Boolean,_mcp.$V,!1);_mcp.$V.$6S6=new _H("IsMovedToDraftFromOutbox",Boolean,_mcp.$V,!1);_mcp.$V.$6t3=new _H("PerfContext",_a.$5V,_mcp.$V,null);_mcp.$V.$6t2=new _H("PerfContextE2E",_a.$5V,_mcp.$V,null);_mcp.$V.$7PT=new _H("WaterfallTraceStarted",Boolean,_mcp.$V,null);_mcp.$V.$9Pe=new _H("RichTextEditorSupported",Boolean,_mcp.$V,null);_mcp.$V.$6MC=new _H("HtmlSupportedProperty",Boolean,_mcp.$V,null);_mcp.$V.$5zV=new _H("DlpSenderOverride",String,_mcp.$V,null);_mcp.$V.$5zU=new _H("DlpFalsePositive",String,_mcp.$V,null);_mcp.$V.$5zT=new _H("DlpDetectedClassification",String,_mcp.$V,null);_mcp.$V.$62d=new _H("ExplicitLogonUser",String,_mcp.$V,null);_mcp.$V.$6Mm=new _H("IncludeOriginalFromInToRecipients",Boolean,_mcp.$V,!1);_mcp.$V.$2Hu=new _H("ExtendedPropertyCollection",_js.$X,_mcp.$V,null);_mcp.$V.$6SJ=new _H("IsOnDemandUpgradeRequested",Boolean,_mcp.$V,!1);_mcp.$V.$6TE=new _H("IsResumingSendFailure",Boolean,_mcp.$V,!1);_mcp.$V.$6Kr=new _H("HasSentViaNotification",Boolean,_mcp.$V,!1);_mcp.$V.$73p=new _H("SendFailureInfobarMessageId",_bc.InfoBarMessageId,_mcp.$V,45);_mcp.$V.$ab=new _H("PopoutPerfContext",_a.$5V,_mcp.$V);_mcp.$V.$5yT=new _H("DiagnosticContent",String,_mcp.$V);_mcp.$V.$4LG="UseOverride";_mcp.$V.$1h0=null;_mcp.$V.$$cctor();_mcp.$1W.$qH=new _H("Subject",String,_mcp.$1W,"");_mcp.$1W.$38L=new _H("EditorContent",String,_mcp.$1W,"");_mcp.$1W.$2aq=new _H("ToRecipients",_js.$X,_mcp.$1W);_mcp.$1W.$3dI=new _H("ToQueryString",String,_mcp.$1W);_mcp.$1W.$2Es=new _H("CcRecipients",_js.$X,_mcp.$1W);_mcp.$1W.$342=new _H("CcQueryString",String,_mcp.$1W);_mcp.$1W.$2EB=new _H("BccRecipients",_js.$X,_mcp.$1W);_mcp.$1W.$32n=new _H("BccQueryString",String,_mcp.$1W);_mcp.$1W.$3Gg=new _H("Importance",String,_mcp.$1W,"Normal");_mcp.$1W.$2Ie=new _H("From",_g.$1K,_mcp.$1W);_mcp.$1W.$34Z=new _H("ComplianceId",String,_mcp.$1W);_mcp.$1W.$3XK=new _H("Sensitivity",String,_mcp.$1W,"Normal");_mcp.$1W.$3I6=new _H("IsDeliveryReceiptRequested",Boolean,_mcp.$1W);_mcp.$1W.$3JS=new _H("IsReadReceiptRequested",Boolean,_mcp.$1W);_mcp.$1W.$3bQ=new _H("SmimeEncryptMessage",Boolean,_mcp.$1W);_mcp.$1W.$3bT=new _H("SmimeSignMessage",Boolean,_mcp.$1W);_mcp.$1W.$2E4=new _H("AttachmentCollection",_js.$X,_mcp.$1W);_mcp.$1W.$2Hu=new _H("ExtendedPropertyCollection",_js.$X,_mcp.$1W,null);_mcp.$1W.$4cK=new _a.$CA(_g.$1K);_mcp.$1W.$$cctor();_mcp.$ur.$L=_a.$0.$16;_mcp._TI._hf=_mcp._TI.$9S();_mcp._TI.$47=null;_mcp._TI.$2L=null;_mcp._TI.$11B=null;_mcp._TI.$11A=null;_mcp._TI.$Xi=null;_mcp._TI.$4Mq=null;_mcp._TI.$1PH=null;_mcp._TI.$DL=null;_mcp._TI.$Pd=null;_mcp._TI.$4NV=null;_mcp._TI.$1={};_mcp._TI.$$cctor();
window.scriptsLoaded['microsoft.exchange.clients.owa2.client.mail.compose.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.exchange.clients.owa2.client.mail.compose.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
